[2024-10-22 19:09:00,142][flwr][INFO] - Starting Flower simulation, config: num_rounds=50, no round_timeout
[2024-10-22 19:09:26,446][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:172.18.62.5': 1.0, 'node:__internal_head__': 1.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'GPU': 3.0, 'memory': 780189125632.0, 'object_store_memory': 200000000000.0}
[2024-10-22 19:09:26,449][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-10-22 19:09:26,449][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-10-22 19:09:26,566][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-10-22 19:09:26,567][flwr][INFO] - [INIT]
[2024-10-22 19:09:26,567][flwr][INFO] - Requesting initial parameters from one random client
[2024-10-22 19:09:31,511][flwr][INFO] - Received initial parameters from one random client
[2024-10-22 19:09:31,511][flwr][INFO] - Evaluating initial global parameters
[2024-10-22 19:13:08,502][flwr][INFO] - initial parameters (loss, other metrics): 0.7173831695536879, OrderedDict([('ind_iou_0', 0.011860696316309528), ('ind_dice_liver_0', tensor(0.1390, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0074, dtype=torch.float64)), ('ind_iou_1', 0.012155620791068723), ('ind_dice_liver_1', tensor(0.1491, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0092, dtype=torch.float64)), ('all_iou', 0.011903673395072261), ('all_dice_liver', tensor(0.1404, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0077, dtype=torch.float64))])
[2024-10-22 19:13:08,506][flwr][INFO] - 
[2024-10-22 19:13:08,506][flwr][INFO] - [ROUND 1]
[2024-10-22 19:13:08,507][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:17:36,751][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:17:36,776][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-10-22 19:20:21,129][flwr][INFO] - fit progress: (1, 0.08687405248681927, OrderedDict([('ind_iou_0', 0.47232486878483493), ('ind_dice_liver_0', tensor(0.6057, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0051, dtype=torch.float64)), ('ind_iou_1', 0.7276499227845881), ('ind_dice_liver_1', tensor(0.8153, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0080, dtype=torch.float64)), ('all_iou', 0.5090804880705804), ('all_dice_liver', tensor(0.6357, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0055, dtype=torch.float64))]), 432.62316172383726)
[2024-10-22 19:20:21,138][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:20:29,196][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:20:29,198][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:20:29,198][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:20:29,199][flwr][INFO] - 
[2024-10-22 19:20:29,199][flwr][INFO] - [ROUND 2]
[2024-10-22 19:20:29,199][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:24:58,039][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:27:36,060][flwr][INFO] - fit progress: (2, 0.0848312007703536, OrderedDict([('ind_iou_0', 0.5786383701448586), ('ind_dice_liver_0', tensor(0.7033, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0069, dtype=torch.float64)), ('ind_iou_1', 0.7318853486392739), ('ind_dice_liver_1', tensor(0.8347, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0121, dtype=torch.float64)), ('all_iou', 0.6002899876353792), ('all_dice_liver', tensor(0.7217, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0076, dtype=torch.float64))]), 867.5535700328182)
[2024-10-22 19:27:36,064][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:27:41,641][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:27:41,642][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:27:41,643][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:27:41,643][flwr][INFO] - 
[2024-10-22 19:27:41,643][flwr][INFO] - [ROUND 3]
[2024-10-22 19:27:41,643][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:32:13,592][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:34:51,288][flwr][INFO] - fit progress: (3, 0.10409257245867885, OrderedDict([('ind_iou_0', 0.5520429784438088), ('ind_dice_liver_0', tensor(0.6855, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0062, dtype=torch.float64)), ('ind_iou_1', 0.7434870853803357), ('ind_dice_liver_1', tensor(0.8481, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0113, dtype=torch.float64)), ('all_iou', 0.5794149004309701), ('all_dice_liver', tensor(0.7087, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0070, dtype=torch.float64))]), 1302.7818812499754)
[2024-10-22 19:34:51,293][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:34:58,907][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:34:58,907][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:34:58,908][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:34:58,909][flwr][INFO] - 
[2024-10-22 19:34:58,909][flwr][INFO] - [ROUND 4]
[2024-10-22 19:34:58,910][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:39:27,916][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:42:15,619][flwr][INFO] - fit progress: (4, 0.1235387665072252, OrderedDict([('ind_iou_0', 0.5452967656487652), ('ind_dice_liver_0', tensor(0.6838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0051, dtype=torch.float64)), ('ind_iou_1', 0.7537485462999396), ('ind_dice_liver_1', tensor(0.8591, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0112, dtype=torch.float64)), ('all_iou', 0.5752554454061927), ('all_dice_liver', tensor(0.7088, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0060, dtype=torch.float64))]), 1747.1131343648303)
[2024-10-22 19:42:15,623][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:42:21,959][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:42:21,960][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:42:21,960][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:42:21,960][flwr][INFO] - 
[2024-10-22 19:42:21,960][flwr][INFO] - [ROUND 5]
[2024-10-22 19:42:21,960][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:46:47,176][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:49:28,847][flwr][INFO] - fit progress: (5, 0.11298447400900044, OrderedDict([('ind_iou_0', 0.6073347323981415), ('ind_dice_liver_0', tensor(0.7349, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0112, dtype=torch.float64)), ('ind_iou_1', 0.7531719588917413), ('ind_dice_liver_1', tensor(0.8613, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0199, dtype=torch.float64)), ('all_iou', 0.627930743985751), ('all_dice_liver', tensor(0.7527, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0124, dtype=torch.float64))]), 2180.3414594288915)
[2024-10-22 19:49:28,852][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:49:34,974][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:49:34,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:49:34,976][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:49:34,976][flwr][INFO] - 
[2024-10-22 19:49:34,977][flwr][INFO] - [ROUND 6]
[2024-10-22 19:49:34,977][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 19:54:03,055][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 19:56:54,679][flwr][INFO] - fit progress: (6, 0.11960052199180814, OrderedDict([('ind_iou_0', 0.6189428697432084), ('ind_dice_liver_0', tensor(0.7458, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0119, dtype=torch.float64)), ('ind_iou_1', 0.7592621925690537), ('ind_dice_liver_1', tensor(0.8661, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0221, dtype=torch.float64)), ('all_iou', 0.6385998419946105), ('all_dice_liver', tensor(0.7625, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0132, dtype=torch.float64))]), 2626.1731515398715)
[2024-10-22 19:56:54,683][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 19:57:01,909][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 19:57:01,909][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 19:57:01,910][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 19:57:01,911][flwr][INFO] - 
[2024-10-22 19:57:01,911][flwr][INFO] - [ROUND 7]
[2024-10-22 19:57:01,911][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:01:29,525][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:04:17,806][flwr][INFO] - fit progress: (7, 0.12480262646676403, OrderedDict([('ind_iou_0', 0.6212484891595069), ('ind_dice_liver_0', tensor(0.7497, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0204, dtype=torch.float64)), ('ind_iou_1', 0.7542648918423273), ('ind_dice_liver_1', tensor(0.8622, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0265, dtype=torch.float64)), ('all_iou', 0.6400890011519084), ('all_dice_liver', tensor(0.7656, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0211, dtype=torch.float64))]), 3069.299907709006)
[2024-10-22 20:04:17,810][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:04:24,691][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:04:24,691][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:04:24,692][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:04:24,692][flwr][INFO] - 
[2024-10-22 20:04:24,693][flwr][INFO] - [ROUND 8]
[2024-10-22 20:04:24,693][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:08:58,439][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:11:57,004][flwr][INFO] - fit progress: (8, 0.12521522242713587, OrderedDict([('ind_iou_0', 0.6399997384058395), ('ind_dice_liver_0', tensor(0.7657, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0193, dtype=torch.float64)), ('ind_iou_1', 0.7555509341058975), ('ind_dice_liver_1', tensor(0.8644, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0245, dtype=torch.float64)), ('all_iou', 0.6562435736769473), ('all_dice_liver', tensor(0.7795, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0198, dtype=torch.float64))]), 3528.4983031018637)
[2024-10-22 20:11:57,008][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:12:03,582][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:12:03,582][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:12:03,582][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:12:03,583][flwr][INFO] - 
[2024-10-22 20:12:03,583][flwr][INFO] - [ROUND 9]
[2024-10-22 20:12:03,584][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:16:31,333][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:19:19,710][flwr][INFO] - fit progress: (9, 0.12555691585240997, OrderedDict([('ind_iou_0', 0.6486682810590206), ('ind_dice_liver_0', tensor(0.7733, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0176, dtype=torch.float64)), ('ind_iou_1', 0.7589647028931543), ('ind_dice_liver_1', tensor(0.8667, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0246, dtype=torch.float64)), ('all_iou', 0.6641990758050949), ('all_dice_liver', tensor(0.7863, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0185, dtype=torch.float64))]), 3971.204204058973)
[2024-10-22 20:19:19,714][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:19:27,668][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:19:27,669][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:19:27,670][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:19:27,670][flwr][INFO] - 
[2024-10-22 20:19:27,671][flwr][INFO] - [ROUND 10]
[2024-10-22 20:19:27,671][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:23:54,488][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:26:40,884][flwr][INFO] - fit progress: (10, 0.13390452065485528, OrderedDict([('ind_iou_0', 0.6265105013222145), ('ind_dice_liver_0', tensor(0.7529, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0152, dtype=torch.float64)), ('ind_iou_1', 0.7584976968410262), ('ind_dice_liver_1', tensor(0.8659, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0221, dtype=torch.float64)), ('all_iou', 0.6452285332308397), ('all_dice_liver', tensor(0.7688, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0159, dtype=torch.float64))]), 4412.377764443867)
[2024-10-22 20:26:40,888][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:26:47,706][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:26:47,707][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:26:47,707][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:26:47,707][flwr][INFO] - 
[2024-10-22 20:26:47,708][flwr][INFO] - [ROUND 11]
[2024-10-22 20:26:47,708][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:31:16,190][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:33:58,421][flwr][INFO] - fit progress: (11, 0.14277586128950762, OrderedDict([('ind_iou_0', 0.6345803619411285), ('ind_dice_liver_0', tensor(0.7596, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0202, dtype=torch.float64)), ('ind_iou_1', 0.7607964765755003), ('ind_dice_liver_1', tensor(0.8687, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0241, dtype=torch.float64)), ('all_iou', 0.6522775725853509), ('all_dice_liver', tensor(0.7748, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0205, dtype=torch.float64))]), 4849.914681301918)
[2024-10-22 20:33:58,425][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:34:04,497][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:34:04,497][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:34:04,498][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:34:04,499][flwr][INFO] - 
[2024-10-22 20:34:04,499][flwr][INFO] - [ROUND 12]
[2024-10-22 20:34:04,500][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:38:31,657][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:41:10,493][flwr][INFO] - fit progress: (12, 0.14824903592114183, OrderedDict([('ind_iou_0', 0.6321599932083363), ('ind_dice_liver_0', tensor(0.7601, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0282, dtype=torch.float64)), ('ind_iou_1', 0.761350964726288), ('ind_dice_liver_1', tensor(0.8685, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0257, dtype=torch.float64)), ('all_iou', 0.6504198729489246), ('all_dice_liver', tensor(0.7753, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0272, dtype=torch.float64))]), 5281.9869215500075)
[2024-10-22 20:41:10,497][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:41:17,078][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:41:17,079][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:41:17,080][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:41:17,081][flwr][INFO] - 
[2024-10-22 20:41:17,081][flwr][INFO] - [ROUND 13]
[2024-10-22 20:41:17,082][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:45:45,060][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:48:30,122][flwr][INFO] - fit progress: (13, 0.15518856731388697, OrderedDict([('ind_iou_0', 0.6269084627343463), ('ind_dice_liver_0', tensor(0.7543, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0321, dtype=torch.float64)), ('ind_iou_1', 0.7651448996279298), ('ind_dice_liver_1', tensor(0.8712, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0308, dtype=torch.float64)), ('all_iou', 0.6463807010055296), ('all_dice_liver', tensor(0.7707, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0319, dtype=torch.float64))]), 5721.615541138919)
[2024-10-22 20:48:30,125][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:48:36,890][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:48:36,891][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:48:36,891][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:48:36,892][flwr][INFO] - 
[2024-10-22 20:48:36,892][flwr][INFO] - [ROUND 14]
[2024-10-22 20:48:36,893][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 20:53:04,568][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 20:55:48,931][flwr][INFO] - fit progress: (14, 0.1357456902940493, OrderedDict([('ind_iou_0', 0.668875528713196), ('ind_dice_liver_0', tensor(0.7889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0313, dtype=torch.float64)), ('ind_iou_1', 0.7539751330649799), ('ind_dice_liver_1', tensor(0.8632, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0283, dtype=torch.float64)), ('all_iou', 0.6805949596168117), ('all_dice_liver', tensor(0.7991, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0308, dtype=torch.float64))]), 6160.425416852813)
[2024-10-22 20:55:48,936][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 20:55:57,001][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 20:55:57,001][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 20:55:57,002][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 20:55:57,002][flwr][INFO] - 
[2024-10-22 20:55:57,003][flwr][INFO] - [ROUND 15]
[2024-10-22 20:55:57,003][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:00:26,846][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:03:12,376][flwr][INFO] - fit progress: (15, 0.16578937449511552, OrderedDict([('ind_iou_0', 0.6271813225325651), ('ind_dice_liver_0', tensor(0.7540, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0544, dtype=torch.float64)), ('ind_iou_1', 0.763284442323747), ('ind_dice_liver_1', tensor(0.8699, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0251, dtype=torch.float64)), ('all_iou', 0.6463953929857222), ('all_dice_liver', tensor(0.7704, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0492, dtype=torch.float64))]), 6603.870305975899)
[2024-10-22 21:03:12,381][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:03:18,700][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:03:18,701][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:03:18,702][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:03:18,702][flwr][INFO] - 
[2024-10-22 21:03:18,703][flwr][INFO] - [ROUND 16]
[2024-10-22 21:03:18,703][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:07:48,150][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:10:38,115][flwr][INFO] - fit progress: (16, 0.13840613379220115, OrderedDict([('ind_iou_0', 0.6616097777912086), ('ind_dice_liver_0', tensor(0.7838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0293, dtype=torch.float64)), ('ind_iou_1', 0.7625759951659632), ('ind_dice_liver_1', tensor(0.8707, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0237, dtype=torch.float64)), ('all_iou', 0.6756636591149762), ('all_dice_liver', tensor(0.7959, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0280, dtype=torch.float64))]), 7049.609360148897)
[2024-10-22 21:10:38,120][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:10:44,228][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:10:44,228][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:10:44,229][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:10:44,229][flwr][INFO] - 
[2024-10-22 21:10:44,230][flwr][INFO] - [ROUND 17]
[2024-10-22 21:10:44,230][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:15:11,969][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:17:50,035][flwr][INFO] - fit progress: (17, 0.14772838421919138, OrderedDict([('ind_iou_0', 0.6397948697261826), ('ind_dice_liver_0', tensor(0.7650, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0472, dtype=torch.float64)), ('ind_iou_1', 0.7666529691579314), ('ind_dice_liver_1', tensor(0.8727, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0280, dtype=torch.float64)), ('all_iou', 0.6576190001556668), ('all_dice_liver', tensor(0.7801, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0437, dtype=torch.float64))]), 7481.528681386961)
[2024-10-22 21:17:50,039][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:17:56,340][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:17:56,341][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:17:56,342][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:17:56,342][flwr][INFO] - 
[2024-10-22 21:17:56,342][flwr][INFO] - [ROUND 18]
[2024-10-22 21:17:56,342][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:22:23,962][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:25:11,305][flwr][INFO] - fit progress: (18, 0.16108666362595078, OrderedDict([('ind_iou_0', 0.6327088036834538), ('ind_dice_liver_0', tensor(0.7590, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0449, dtype=torch.float64)), ('ind_iou_1', 0.7676631682767762), ('ind_dice_liver_1', tensor(0.8738, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0226, dtype=torch.float64)), ('all_iou', 0.6517141058607431), ('all_dice_liver', tensor(0.7752, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0408, dtype=torch.float64))]), 7922.798747770023)
[2024-10-22 21:25:11,309][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:25:17,902][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:25:17,902][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:25:17,903][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:25:17,903][flwr][INFO] - 
[2024-10-22 21:25:17,904][flwr][INFO] - [ROUND 19]
[2024-10-22 21:25:17,904][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:29:47,308][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:32:36,288][flwr][INFO] - fit progress: (19, 0.15346456782120896, OrderedDict([('ind_iou_0', 0.655178240996763), ('ind_dice_liver_0', tensor(0.7775, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0555, dtype=torch.float64)), ('ind_iou_1', 0.7627363927627326), ('ind_dice_liver_1', tensor(0.8703, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0380, dtype=torch.float64)), ('all_iou', 0.6700973549485246), ('all_dice_liver', tensor(0.7903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0527, dtype=torch.float64))]), 8367.78230796801)
[2024-10-22 21:32:36,292][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:32:42,627][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:32:42,627][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:32:42,628][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:32:42,629][flwr][INFO] - 
[2024-10-22 21:32:42,629][flwr][INFO] - [ROUND 20]
[2024-10-22 21:32:42,630][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:37:12,748][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:39:51,709][flwr][INFO] - fit progress: (20, 0.17915458985724575, OrderedDict([('ind_iou_0', 0.615145520643455), ('ind_dice_liver_0', tensor(0.7444, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0473, dtype=torch.float64)), ('ind_iou_1', 0.7712819194256879), ('ind_dice_liver_1', tensor(0.8762, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0291, dtype=torch.float64)), ('all_iou', 0.637275169215888), ('all_dice_liver', tensor(0.7630, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0444, dtype=torch.float64))]), 8803.203239148017)
[2024-10-22 21:39:51,713][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:39:59,630][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:39:59,631][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:39:59,631][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:39:59,632][flwr][INFO] - 
[2024-10-22 21:39:59,632][flwr][INFO] - [ROUND 21]
[2024-10-22 21:39:59,632][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:44:28,939][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:46:59,359][flwr][INFO] - fit progress: (21, 0.15277609409275666, OrderedDict([('ind_iou_0', 0.6676652568642081), ('ind_dice_liver_0', tensor(0.7885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0370, dtype=torch.float64)), ('ind_iou_1', 0.7609398011438048), ('ind_dice_liver_1', tensor(0.8688, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0310, dtype=torch.float64)), ('all_iou', 0.6806465925867367), ('all_dice_liver', tensor(0.7996, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0364, dtype=torch.float64))]), 9230.852614399977)
[2024-10-22 21:46:59,363][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:47:05,580][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:47:05,581][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:47:05,581][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:47:05,581][flwr][INFO] - 
[2024-10-22 21:47:05,582][flwr][INFO] - [ROUND 22]
[2024-10-22 21:47:05,582][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:51:35,083][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 21:54:17,195][flwr][INFO] - fit progress: (22, 0.17080434453909688, OrderedDict([('ind_iou_0', 0.6331369126086431), ('ind_dice_liver_0', tensor(0.7577, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0548, dtype=torch.float64)), ('ind_iou_1', 0.7613675497543101), ('ind_dice_liver_1', tensor(0.8693, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0294, dtype=torch.float64)), ('all_iou', 0.6512946836846096), ('all_dice_liver', tensor(0.7736, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0503, dtype=torch.float64))]), 9668.688956080005)
[2024-10-22 21:54:17,199][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 21:54:25,097][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 21:54:25,098][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 21:54:25,099][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 21:54:25,099][flwr][INFO] - 
[2024-10-22 21:54:25,100][flwr][INFO] - [ROUND 23]
[2024-10-22 21:54:25,100][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 21:58:53,648][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:01:37,995][flwr][INFO] - fit progress: (23, 0.16918761550767794, OrderedDict([('ind_iou_0', 0.6543445125195483), ('ind_dice_liver_0', tensor(0.7788, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0510, dtype=torch.float64)), ('ind_iou_1', 0.7667223739047364), ('ind_dice_liver_1', tensor(0.8731, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0301, dtype=torch.float64)), ('all_iou', 0.6699978978001411), ('all_dice_liver', tensor(0.7919, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0463, dtype=torch.float64))]), 10109.489021230955)
[2024-10-22 22:01:37,999][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:01:45,051][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:01:45,051][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:01:45,051][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:01:45,051][flwr][INFO] - 
[2024-10-22 22:01:45,052][flwr][INFO] - [ROUND 24]
[2024-10-22 22:01:45,052][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:06:13,505][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:08:54,372][flwr][INFO] - fit progress: (24, 0.16777113753518816, OrderedDict([('ind_iou_0', 0.6555079564198724), ('ind_dice_liver_0', tensor(0.7790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0574, dtype=torch.float64)), ('ind_iou_1', 0.7650513904595208), ('ind_dice_liver_1', tensor(0.8722, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0298, dtype=torch.float64)), ('all_iou', 0.6709036303842407), ('all_dice_liver', tensor(0.7921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0526, dtype=torch.float64))]), 10545.865586205851)
[2024-10-22 22:08:54,376][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:09:01,111][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:09:01,112][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:09:01,113][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:09:01,113][flwr][INFO] - 
[2024-10-22 22:09:01,114][flwr][INFO] - [ROUND 25]
[2024-10-22 22:09:01,114][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:13:28,312][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:16:05,224][flwr][INFO] - fit progress: (25, 0.1741506409555156, OrderedDict([('ind_iou_0', 0.6718489901865764), ('ind_dice_liver_0', tensor(0.7929, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0549, dtype=torch.float64)), ('ind_iou_1', 0.7638932824429149), ('ind_dice_liver_1', tensor(0.8714, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0281, dtype=torch.float64)), ('all_iou', 0.6845918940625014), ('all_dice_liver', tensor(0.8038, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0508, dtype=torch.float64))]), 10976.718318594852)
[2024-10-22 22:16:05,228][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:16:13,325][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:16:13,326][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:16:13,327][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:16:13,328][flwr][INFO] - 
[2024-10-22 22:16:13,328][flwr][INFO] - [ROUND 26]
[2024-10-22 22:16:13,329][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:20:41,443][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:23:20,389][flwr][INFO] - fit progress: (26, 0.17576611685707177, OrderedDict([('ind_iou_0', 0.6543797462614147), ('ind_dice_liver_0', tensor(0.7771, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0545, dtype=torch.float64)), ('ind_iou_1', 0.7709189836595406), ('ind_dice_liver_1', tensor(0.8766, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0273, dtype=torch.float64)), ('all_iou', 0.6705742353130854), ('all_dice_liver', tensor(0.7909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0506, dtype=torch.float64))]), 11411.883161661914)
[2024-10-22 22:23:20,393][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:23:26,903][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:23:26,904][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:23:26,904][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:23:26,904][flwr][INFO] - 
[2024-10-22 22:23:26,904][flwr][INFO] - [ROUND 27]
[2024-10-22 22:23:26,904][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:27:53,396][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:30:28,423][flwr][INFO] - fit progress: (27, 0.1808615925290719, OrderedDict([('ind_iou_0', 0.6520859616757495), ('ind_dice_liver_0', tensor(0.7757, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0505, dtype=torch.float64)), ('ind_iou_1', 0.7701296916509018), ('ind_dice_liver_1', tensor(0.8761, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0278, dtype=torch.float64)), ('all_iou', 0.6684795536373207), ('all_dice_liver', tensor(0.7897, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0461, dtype=torch.float64))]), 11839.916582065867)
[2024-10-22 22:30:28,427][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:30:34,681][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:30:34,681][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:30:34,682][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:30:34,683][flwr][INFO] - 
[2024-10-22 22:30:34,683][flwr][INFO] - [ROUND 28]
[2024-10-22 22:30:34,683][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:35:03,530][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:37:43,773][flwr][INFO] - fit progress: (28, 0.19759595378069142, OrderedDict([('ind_iou_0', 0.6385243932328148), ('ind_dice_liver_0', tensor(0.7648, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0548, dtype=torch.float64)), ('ind_iou_1', 0.7727279133240487), ('ind_dice_liver_1', tensor(0.8780, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0199, dtype=torch.float64)), ('all_iou', 0.6572931583451233), ('all_dice_liver', tensor(0.7806, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0484, dtype=torch.float64))]), 12275.266718053957)
[2024-10-22 22:37:43,777][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:37:49,712][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:37:49,712][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:37:49,712][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:37:49,712][flwr][INFO] - 
[2024-10-22 22:37:49,712][flwr][INFO] - [ROUND 29]
[2024-10-22 22:37:49,713][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:42:18,157][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:44:57,350][flwr][INFO] - fit progress: (29, 0.1775134268830455, OrderedDict([('ind_iou_0', 0.6698039066858616), ('ind_dice_liver_0', tensor(0.7903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0514, dtype=torch.float64)), ('ind_iou_1', 0.7651326875756467), ('ind_dice_liver_1', tensor(0.8724, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0316, dtype=torch.float64)), ('all_iou', 0.6829033340698955), ('all_dice_liver', tensor(0.8016, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0485, dtype=torch.float64))]), 12708.843583039008)
[2024-10-22 22:44:57,354][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:45:04,991][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:45:04,991][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:45:04,992][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:45:04,993][flwr][INFO] - 
[2024-10-22 22:45:04,993][flwr][INFO] - [ROUND 30]
[2024-10-22 22:45:04,995][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:49:34,690][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:52:19,739][flwr][INFO] - fit progress: (30, 0.17774761092383023, OrderedDict([('ind_iou_0', 0.678426625001988), ('ind_dice_liver_0', tensor(0.7971, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0580, dtype=torch.float64)), ('ind_iou_1', 0.7622097022528329), ('ind_dice_liver_1', tensor(0.8705, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0355, dtype=torch.float64)), ('all_iou', 0.6898312653825248), ('all_dice_liver', tensor(0.8071, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0550, dtype=torch.float64))]), 13151.232661433984)
[2024-10-22 22:52:19,743][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:52:27,339][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:52:27,339][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:52:27,340][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:52:27,340][flwr][INFO] - 
[2024-10-22 22:52:27,340][flwr][INFO] - [ROUND 31]
[2024-10-22 22:52:27,340][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 22:56:52,017][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 22:59:34,710][flwr][INFO] - fit progress: (31, 0.18038483025979232, OrderedDict([('ind_iou_0', 0.6765524579400672), ('ind_dice_liver_0', tensor(0.7966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0580, dtype=torch.float64)), ('ind_iou_1', 0.763503206537126), ('ind_dice_liver_1', tensor(0.8714, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0386, dtype=torch.float64)), ('all_iou', 0.688452790275343), ('all_dice_liver', tensor(0.8069, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0555, dtype=torch.float64))]), 13586.204370471882)
[2024-10-22 22:59:34,714][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 22:59:43,117][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 22:59:43,117][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 22:59:43,117][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 22:59:43,117][flwr][INFO] - 
[2024-10-22 22:59:43,117][flwr][INFO] - [ROUND 32]
[2024-10-22 22:59:43,117][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:04:08,871][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:07:02,973][flwr][INFO] - fit progress: (32, 0.18959884621250933, OrderedDict([('ind_iou_0', 0.6666502777742433), ('ind_dice_liver_0', tensor(0.7877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0521, dtype=torch.float64)), ('ind_iou_1', 0.7703300351535398), ('ind_dice_liver_1', tensor(0.8763, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0260, dtype=torch.float64)), ('all_iou', 0.6810098696095176), ('all_dice_liver', tensor(0.8000, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0490, dtype=torch.float64))]), 14034.46655914886)
[2024-10-22 23:07:02,977][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:07:10,798][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:07:10,799][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:07:10,800][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:07:10,800][flwr][INFO] - 
[2024-10-22 23:07:10,800][flwr][INFO] - [ROUND 33]
[2024-10-22 23:07:10,801][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:11:39,055][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:14:19,865][flwr][INFO] - fit progress: (33, 0.18586877061774446, OrderedDict([('ind_iou_0', 0.6763294071844954), ('ind_dice_liver_0', tensor(0.7961, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0600, dtype=torch.float64)), ('ind_iou_1', 0.7684281652248823), ('ind_dice_liver_1', tensor(0.8753, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0308, dtype=torch.float64)), ('all_iou', 0.688947007642415), ('all_dice_liver', tensor(0.8071, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0561, dtype=torch.float64))]), 14471.359249177855)
[2024-10-22 23:14:19,869][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:14:28,704][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:14:28,705][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:14:28,706][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:14:28,706][flwr][INFO] - 
[2024-10-22 23:14:28,706][flwr][INFO] - [ROUND 34]
[2024-10-22 23:14:28,706][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:19:03,309][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:21:42,066][flwr][INFO] - fit progress: (34, 0.1962721639752776, OrderedDict([('ind_iou_0', 0.6708519898934023), ('ind_dice_liver_0', tensor(0.7919, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0620, dtype=torch.float64)), ('ind_iou_1', 0.7668988117421206), ('ind_dice_liver_1', tensor(0.8739, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0310, dtype=torch.float64)), ('all_iou', 0.684099686347312), ('all_dice_liver', tensor(0.8033, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0575, dtype=torch.float64))]), 14913.560136741027)
[2024-10-22 23:21:42,070][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:21:48,644][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:21:48,644][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:21:48,644][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:21:48,645][flwr][INFO] - 
[2024-10-22 23:21:48,645][flwr][INFO] - [ROUND 35]
[2024-10-22 23:21:48,646][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:26:14,582][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:29:00,565][flwr][INFO] - fit progress: (35, 0.1975475674376697, OrderedDict([('ind_iou_0', 0.6346532525575366), ('ind_dice_liver_0', tensor(0.7594, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0657, dtype=torch.float64)), ('ind_iou_1', 0.7663147727582432), ('ind_dice_liver_1', tensor(0.8726, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0285, dtype=torch.float64)), ('all_iou', 0.6532511115786459), ('all_dice_liver', tensor(0.7755, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0591, dtype=torch.float64))]), 15352.059262760915)
[2024-10-22 23:29:00,571][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:29:06,873][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:29:06,874][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:29:06,875][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:29:06,875][flwr][INFO] - 
[2024-10-22 23:29:06,876][flwr][INFO] - [ROUND 36]
[2024-10-22 23:29:06,876][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:33:33,618][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:36:11,063][flwr][INFO] - fit progress: (36, 0.2072957332452821, OrderedDict([('ind_iou_0', 0.6478745912978613), ('ind_dice_liver_0', tensor(0.7714, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0653, dtype=torch.float64)), ('ind_iou_1', 0.7765203723786229), ('ind_dice_liver_1', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0287, dtype=torch.float64)), ('all_iou', 0.6660053554374418), ('all_dice_liver', tensor(0.7869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0600, dtype=torch.float64))]), 15782.557222737)
[2024-10-22 23:36:11,067][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:36:17,611][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:36:17,611][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:36:17,612][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:36:17,613][flwr][INFO] - 
[2024-10-22 23:36:17,613][flwr][INFO] - [ROUND 37]
[2024-10-22 23:36:17,614][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:40:45,552][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:43:33,147][flwr][INFO] - fit progress: (37, 0.19686389454799277, OrderedDict([('ind_iou_0', 0.6330792932012825), ('ind_dice_liver_0', tensor(0.7604, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0579, dtype=torch.float64)), ('ind_iou_1', 0.7677218512853319), ('ind_dice_liver_1', tensor(0.8736, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0236, dtype=torch.float64)), ('all_iou', 0.6521076798197167), ('all_dice_liver', tensor(0.7765, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0527, dtype=torch.float64))]), 16224.640795778949)
[2024-10-22 23:43:33,151][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:43:38,931][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:43:38,931][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:43:38,932][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:43:38,932][flwr][INFO] - 
[2024-10-22 23:43:38,933][flwr][INFO] - [ROUND 38]
[2024-10-22 23:43:38,933][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:48:06,507][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:50:49,450][flwr][INFO] - fit progress: (38, 0.20685568795644022, OrderedDict([('ind_iou_0', 0.646983052521453), ('ind_dice_liver_0', tensor(0.7707, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0679, dtype=torch.float64)), ('ind_iou_1', 0.769368830235227), ('ind_dice_liver_1', tensor(0.8749, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0277, dtype=torch.float64)), ('all_iou', 0.6641033887023836), ('all_dice_liver', tensor(0.7854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0622, dtype=torch.float64))]), 16660.94422701001)
[2024-10-22 23:50:49,455][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:50:55,168][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:50:55,168][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:50:55,169][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:50:55,169][flwr][INFO] - 
[2024-10-22 23:50:55,170][flwr][INFO] - [ROUND 39]
[2024-10-22 23:50:55,170][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-22 23:55:21,001][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-22 23:58:09,880][flwr][INFO] - fit progress: (39, 0.21089010827323654, OrderedDict([('ind_iou_0', 0.6479459942103605), ('ind_dice_liver_0', tensor(0.7715, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0737, dtype=torch.float64)), ('ind_iou_1', 0.767762029456455), ('ind_dice_liver_1', tensor(0.8734, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0354, dtype=torch.float64)), ('all_iou', 0.6647342351353488), ('all_dice_liver', tensor(0.7859, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0677, dtype=torch.float64))]), 17101.373929010937)
[2024-10-22 23:58:09,884][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-22 23:58:16,550][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-22 23:58:16,551][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-22 23:58:16,552][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-22 23:58:16,552][flwr][INFO] - 
[2024-10-22 23:58:16,553][flwr][INFO] - [ROUND 40]
[2024-10-22 23:58:16,554][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:02:46,694][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:05:19,430][flwr][INFO] - fit progress: (40, 0.1865659275592141, OrderedDict([('ind_iou_0', 0.6577648894843848), ('ind_dice_liver_0', tensor(0.7784, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0667, dtype=torch.float64)), ('ind_iou_1', 0.7701461372736603), ('ind_dice_liver_1', tensor(0.8757, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0330, dtype=torch.float64)), ('all_iou', 0.6735519621663566), ('all_dice_liver', tensor(0.7921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0618, dtype=torch.float64))]), 17530.924433422973)
[2024-10-23 00:05:19,435][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:05:25,784][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:05:25,785][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:05:25,785][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:05:25,786][flwr][INFO] - 
[2024-10-23 00:05:25,786][flwr][INFO] - [ROUND 41]
[2024-10-23 00:05:25,786][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:09:53,125][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:12:28,955][flwr][INFO] - fit progress: (41, 0.20250122937955664, OrderedDict([('ind_iou_0', 0.661355410088525), ('ind_dice_liver_0', tensor(0.7827, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0695, dtype=torch.float64)), ('ind_iou_1', 0.7721390049982297), ('ind_dice_liver_1', tensor(0.8772, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0309, dtype=torch.float64)), ('all_iou', 0.6767945181787847), ('all_dice_liver', tensor(0.7959, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0633, dtype=torch.float64))]), 17960.448550118832)
[2024-10-23 00:12:28,958][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:12:35,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:12:35,257][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:12:35,258][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:12:35,258][flwr][INFO] - 
[2024-10-23 00:12:35,258][flwr][INFO] - [ROUND 42]
[2024-10-23 00:12:35,258][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:17:02,152][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:19:49,908][flwr][INFO] - fit progress: (42, 0.2064326711873219, OrderedDict([('ind_iou_0', 0.6642132755134812), ('ind_dice_liver_0', tensor(0.7855, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0651, dtype=torch.float64)), ('ind_iou_1', 0.7728672190272297), ('ind_dice_liver_1', tensor(0.8781, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0324, dtype=torch.float64)), ('all_iou', 0.6793466295145195), ('all_dice_liver', tensor(0.7985, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0590, dtype=torch.float64))]), 18401.40183048183)
[2024-10-23 00:19:49,916][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:19:57,707][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:19:57,708][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:19:57,709][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:19:57,709][flwr][INFO] - 
[2024-10-23 00:19:57,710][flwr][INFO] - [ROUND 43]
[2024-10-23 00:19:57,710][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:24:26,878][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:27:19,274][flwr][INFO] - fit progress: (43, 0.20807751982953496, OrderedDict([('ind_iou_0', 0.6731866524049307), ('ind_dice_liver_0', tensor(0.7926, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0732, dtype=torch.float64)), ('ind_iou_1', 0.7673160036772249), ('ind_dice_liver_1', tensor(0.8743, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0387, dtype=torch.float64)), ('all_iou', 0.686221577669616), ('all_dice_liver', tensor(0.8040, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0681, dtype=torch.float64))]), 18850.767784197815)
[2024-10-23 00:27:19,278][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:27:26,818][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:27:26,819][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:27:26,820][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:27:26,820][flwr][INFO] - 
[2024-10-23 00:27:26,821][flwr][INFO] - [ROUND 44]
[2024-10-23 00:27:26,821][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:31:52,788][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:34:40,223][flwr][INFO] - fit progress: (44, 0.24527589526800456, OrderedDict([('ind_iou_0', 0.6352963048067246), ('ind_dice_liver_0', tensor(0.7586, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0759, dtype=torch.float64)), ('ind_iou_1', 0.7762049148232166), ('ind_dice_liver_1', tensor(0.8800, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0342, dtype=torch.float64)), ('all_iou', 0.6551313146211646), ('all_dice_liver', tensor(0.7757, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0688, dtype=torch.float64))]), 19291.716765261954)
[2024-10-23 00:34:40,226][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:34:46,058][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:34:46,058][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:34:46,058][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:34:46,059][flwr][INFO] - 
[2024-10-23 00:34:46,059][flwr][INFO] - [ROUND 45]
[2024-10-23 00:34:46,059][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:39:12,882][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:41:54,233][flwr][INFO] - fit progress: (45, 0.2212972283799924, OrderedDict([('ind_iou_0', 0.6599591178670763), ('ind_dice_liver_0', tensor(0.7810, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0675, dtype=torch.float64)), ('ind_iou_1', 0.7713316847426815), ('ind_dice_liver_1', tensor(0.8768, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0353, dtype=torch.float64)), ('all_iou', 0.6753705775398553), ('all_dice_liver', tensor(0.7943, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0632, dtype=torch.float64))]), 19725.726564114913)
[2024-10-23 00:41:54,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:42:01,506][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:42:01,507][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:42:01,507][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:42:01,508][flwr][INFO] - 
[2024-10-23 00:42:01,509][flwr][INFO] - [ROUND 46]
[2024-10-23 00:42:01,509][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:46:31,342][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:49:21,875][flwr][INFO] - fit progress: (46, 0.22911115807489715, OrderedDict([('ind_iou_0', 0.6551148037934577), ('ind_dice_liver_0', tensor(0.7763, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0697, dtype=torch.float64)), ('ind_iou_1', 0.7745676811854526), ('ind_dice_liver_1', tensor(0.8787, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0350, dtype=torch.float64)), ('all_iou', 0.6717459648506803), ('all_dice_liver', tensor(0.7905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0642, dtype=torch.float64))]), 20173.36905434495)
[2024-10-23 00:49:21,879][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:49:30,488][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:49:30,489][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:49:30,490][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:49:30,490][flwr][INFO] - 
[2024-10-23 00:49:30,490][flwr][INFO] - [ROUND 47]
[2024-10-23 00:49:30,491][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 00:53:59,802][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 00:56:40,771][flwr][INFO] - fit progress: (47, 0.22199838591342597, OrderedDict([('ind_iou_0', 0.6728154010557585), ('ind_dice_liver_0', tensor(0.7923, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0709, dtype=torch.float64)), ('ind_iou_1', 0.7714630738433893), ('ind_dice_liver_1', tensor(0.8768, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0374, dtype=torch.float64)), ('all_iou', 0.6863395762182527), ('all_dice_liver', tensor(0.8039, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0664, dtype=torch.float64))]), 20612.2653271209)
[2024-10-23 00:56:40,776][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 00:56:47,085][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 00:56:47,085][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 00:56:47,086][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 00:56:47,086][flwr][INFO] - 
[2024-10-23 00:56:47,086][flwr][INFO] - [ROUND 48]
[2024-10-23 00:56:47,086][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 01:01:17,591][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 01:03:52,228][flwr][INFO] - fit progress: (48, 0.22473484135144975, OrderedDict([('ind_iou_0', 0.6692207692345924), ('ind_dice_liver_0', tensor(0.7898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0680, dtype=torch.float64)), ('ind_iou_1', 0.769135986147941), ('ind_dice_liver_1', tensor(0.8751, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0365, dtype=torch.float64)), ('all_iou', 0.6830953816682823), ('all_dice_liver', tensor(0.8017, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0641, dtype=torch.float64))]), 21043.72238496598)
[2024-10-23 01:03:52,232][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 01:03:59,001][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 01:03:59,001][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 01:03:59,002][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 01:03:59,002][flwr][INFO] - 
[2024-10-23 01:03:59,002][flwr][INFO] - [ROUND 49]
[2024-10-23 01:03:59,002][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 01:08:29,321][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 01:11:02,507][flwr][INFO] - fit progress: (49, 0.2281616340031171, OrderedDict([('ind_iou_0', 0.6712673363828235), ('ind_dice_liver_0', tensor(0.7914, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0651, dtype=torch.float64)), ('ind_iou_1', 0.7736944069192568), ('ind_dice_liver_1', tensor(0.8792, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0279, dtype=torch.float64)), ('all_iou', 0.6853729061938372), ('all_dice_liver', tensor(0.8035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0613, dtype=torch.float64))]), 21474.0006060889)
[2024-10-23 01:11:02,513][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 01:11:10,270][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 01:11:10,271][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 01:11:10,271][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 01:11:10,271][flwr][INFO] - 
[2024-10-23 01:11:10,271][flwr][INFO] - [ROUND 50]
[2024-10-23 01:11:10,271][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-10-23 01:15:38,134][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-10-23 01:18:10,983][flwr][INFO] - fit progress: (50, 0.23725850773086962, OrderedDict([('ind_iou_0', 0.6667965787349326), ('ind_dice_liver_0', tensor(0.7881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0709, dtype=torch.float64)), ('ind_iou_1', 0.7731046885898021), ('ind_dice_liver_1', tensor(0.8782, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0331, dtype=torch.float64)), ('all_iou', 0.6814223241927044), ('all_dice_liver', tensor(0.8005, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0654, dtype=torch.float64))]), 21902.47696893988)
[2024-10-23 01:18:10,987][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-10-23 01:18:17,005][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-23 01:18:17,006][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=498419, ip=172.18.62.5, actor_id=9e855a67bd496ba774e1f88601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511240374f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-23 01:18:17,007][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-10-23 01:18:17,009][flwr][INFO] - 
[2024-10-23 01:18:17,009][flwr][INFO] - [SUMMARY]
[2024-10-23 01:18:17,010][flwr][INFO] - Run finished 50 round(s) in 21908.50s
[2024-10-23 01:18:17,165][flwr][INFO] - 	History (loss, centralized):
[2024-10-23 01:18:17,166][flwr][INFO] - 		round 0: 0.7173831695536879
[2024-10-23 01:18:17,166][flwr][INFO] - 		round 1: 0.08687405248681927
[2024-10-23 01:18:17,167][flwr][INFO] - 		round 2: 0.0848312007703536
[2024-10-23 01:18:17,167][flwr][INFO] - 		round 3: 0.10409257245867885
[2024-10-23 01:18:17,168][flwr][INFO] - 		round 4: 0.1235387665072252
[2024-10-23 01:18:17,168][flwr][INFO] - 		round 5: 0.11298447400900044
[2024-10-23 01:18:17,168][flwr][INFO] - 		round 6: 0.11960052199180814
[2024-10-23 01:18:17,169][flwr][INFO] - 		round 7: 0.12480262646676403
[2024-10-23 01:18:17,170][flwr][INFO] - 		round 8: 0.12521522242713587
[2024-10-23 01:18:17,170][flwr][INFO] - 		round 9: 0.12555691585240997
[2024-10-23 01:18:17,170][flwr][INFO] - 		round 10: 0.13390452065485528
[2024-10-23 01:18:17,171][flwr][INFO] - 		round 11: 0.14277586128950762
[2024-10-23 01:18:17,171][flwr][INFO] - 		round 12: 0.14824903592114183
[2024-10-23 01:18:17,172][flwr][INFO] - 		round 13: 0.15518856731388697
[2024-10-23 01:18:17,172][flwr][INFO] - 		round 14: 0.1357456902940493
[2024-10-23 01:18:17,172][flwr][INFO] - 		round 15: 0.16578937449511552
[2024-10-23 01:18:17,173][flwr][INFO] - 		round 16: 0.13840613379220115
[2024-10-23 01:18:17,173][flwr][INFO] - 		round 17: 0.14772838421919138
[2024-10-23 01:18:17,173][flwr][INFO] - 		round 18: 0.16108666362595078
[2024-10-23 01:18:17,174][flwr][INFO] - 		round 19: 0.15346456782120896
[2024-10-23 01:18:17,174][flwr][INFO] - 		round 20: 0.17915458985724575
[2024-10-23 01:18:17,175][flwr][INFO] - 		round 21: 0.15277609409275666
[2024-10-23 01:18:17,175][flwr][INFO] - 		round 22: 0.17080434453909688
[2024-10-23 01:18:17,175][flwr][INFO] - 		round 23: 0.16918761550767794
[2024-10-23 01:18:17,176][flwr][INFO] - 		round 24: 0.16777113753518816
[2024-10-23 01:18:17,176][flwr][INFO] - 		round 25: 0.1741506409555156
[2024-10-23 01:18:17,177][flwr][INFO] - 		round 26: 0.17576611685707177
[2024-10-23 01:18:17,177][flwr][INFO] - 		round 27: 0.1808615925290719
[2024-10-23 01:18:17,177][flwr][INFO] - 		round 28: 0.19759595378069142
[2024-10-23 01:18:17,178][flwr][INFO] - 		round 29: 0.1775134268830455
[2024-10-23 01:18:17,178][flwr][INFO] - 		round 30: 0.17774761092383023
[2024-10-23 01:18:17,178][flwr][INFO] - 		round 31: 0.18038483025979232
[2024-10-23 01:18:17,179][flwr][INFO] - 		round 32: 0.18959884621250933
[2024-10-23 01:18:17,179][flwr][INFO] - 		round 33: 0.18586877061774446
[2024-10-23 01:18:17,180][flwr][INFO] - 		round 34: 0.1962721639752776
[2024-10-23 01:18:17,180][flwr][INFO] - 		round 35: 0.1975475674376697
[2024-10-23 01:18:17,180][flwr][INFO] - 		round 36: 0.2072957332452821
[2024-10-23 01:18:17,181][flwr][INFO] - 		round 37: 0.19686389454799277
[2024-10-23 01:18:17,181][flwr][INFO] - 		round 38: 0.20685568795644022
[2024-10-23 01:18:17,182][flwr][INFO] - 		round 39: 0.21089010827323654
[2024-10-23 01:18:17,182][flwr][INFO] - 		round 40: 0.1865659275592141
[2024-10-23 01:18:17,182][flwr][INFO] - 		round 41: 0.20250122937955664
[2024-10-23 01:18:17,183][flwr][INFO] - 		round 42: 0.2064326711873219
[2024-10-23 01:18:17,183][flwr][INFO] - 		round 43: 0.20807751982953496
[2024-10-23 01:18:17,184][flwr][INFO] - 		round 44: 0.24527589526800456
[2024-10-23 01:18:17,184][flwr][INFO] - 		round 45: 0.2212972283799924
[2024-10-23 01:18:17,184][flwr][INFO] - 		round 46: 0.22911115807489715
[2024-10-23 01:18:17,185][flwr][INFO] - 		round 47: 0.22199838591342597
[2024-10-23 01:18:17,185][flwr][INFO] - 		round 48: 0.22473484135144975
[2024-10-23 01:18:17,186][flwr][INFO] - 		round 49: 0.2281616340031171
[2024-10-23 01:18:17,186][flwr][INFO] - 		round 50: 0.23725850773086962
[2024-10-23 01:18:17,186][flwr][INFO] - 	History (metrics, centralized):
[2024-10-23 01:18:17,187][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1404, dtype=torch.float64)),
[2024-10-23 01:18:17,187][flwr][INFO] - 	                    (1, tensor(0.6357, dtype=torch.float64)),
[2024-10-23 01:18:17,188][flwr][INFO] - 	                    (2, tensor(0.7217, dtype=torch.float64)),
[2024-10-23 01:18:17,188][flwr][INFO] - 	                    (3, tensor(0.7087, dtype=torch.float64)),
[2024-10-23 01:18:17,188][flwr][INFO] - 	                    (4, tensor(0.7088, dtype=torch.float64)),
[2024-10-23 01:18:17,189][flwr][INFO] - 	                    (5, tensor(0.7527, dtype=torch.float64)),
[2024-10-23 01:18:17,189][flwr][INFO] - 	                    (6, tensor(0.7625, dtype=torch.float64)),
[2024-10-23 01:18:17,190][flwr][INFO] - 	                    (7, tensor(0.7656, dtype=torch.float64)),
[2024-10-23 01:18:17,190][flwr][INFO] - 	                    (8, tensor(0.7795, dtype=torch.float64)),
[2024-10-23 01:18:17,190][flwr][INFO] - 	                    (9, tensor(0.7863, dtype=torch.float64)),
[2024-10-23 01:18:17,191][flwr][INFO] - 	                    (10, tensor(0.7688, dtype=torch.float64)),
[2024-10-23 01:18:17,191][flwr][INFO] - 	                    (11, tensor(0.7748, dtype=torch.float64)),
[2024-10-23 01:18:17,192][flwr][INFO] - 	                    (12, tensor(0.7753, dtype=torch.float64)),
[2024-10-23 01:18:17,192][flwr][INFO] - 	                    (13, tensor(0.7707, dtype=torch.float64)),
[2024-10-23 01:18:17,192][flwr][INFO] - 	                    (14, tensor(0.7991, dtype=torch.float64)),
[2024-10-23 01:18:17,193][flwr][INFO] - 	                    (15, tensor(0.7704, dtype=torch.float64)),
[2024-10-23 01:18:17,193][flwr][INFO] - 	                    (16, tensor(0.7959, dtype=torch.float64)),
[2024-10-23 01:18:17,194][flwr][INFO] - 	                    (17, tensor(0.7801, dtype=torch.float64)),
[2024-10-23 01:18:17,194][flwr][INFO] - 	                    (18, tensor(0.7752, dtype=torch.float64)),
[2024-10-23 01:18:17,194][flwr][INFO] - 	                    (19, tensor(0.7903, dtype=torch.float64)),
[2024-10-23 01:18:17,195][flwr][INFO] - 	                    (20, tensor(0.7630, dtype=torch.float64)),
[2024-10-23 01:18:17,195][flwr][INFO] - 	                    (21, tensor(0.7996, dtype=torch.float64)),
[2024-10-23 01:18:17,196][flwr][INFO] - 	                    (22, tensor(0.7736, dtype=torch.float64)),
[2024-10-23 01:18:17,196][flwr][INFO] - 	                    (23, tensor(0.7919, dtype=torch.float64)),
[2024-10-23 01:18:17,196][flwr][INFO] - 	                    (24, tensor(0.7921, dtype=torch.float64)),
[2024-10-23 01:18:17,197][flwr][INFO] - 	                    (25, tensor(0.8038, dtype=torch.float64)),
[2024-10-23 01:18:17,197][flwr][INFO] - 	                    (26, tensor(0.7909, dtype=torch.float64)),
[2024-10-23 01:18:17,197][flwr][INFO] - 	                    (27, tensor(0.7897, dtype=torch.float64)),
[2024-10-23 01:18:17,198][flwr][INFO] - 	                    (28, tensor(0.7806, dtype=torch.float64)),
[2024-10-23 01:18:17,198][flwr][INFO] - 	                    (29, tensor(0.8016, dtype=torch.float64)),
[2024-10-23 01:18:17,199][flwr][INFO] - 	                    (30, tensor(0.8071, dtype=torch.float64)),
[2024-10-23 01:18:17,199][flwr][INFO] - 	                    (31, tensor(0.8069, dtype=torch.float64)),
[2024-10-23 01:18:17,199][flwr][INFO] - 	                    (32, tensor(0.8000, dtype=torch.float64)),
[2024-10-23 01:18:17,200][flwr][INFO] - 	                    (33, tensor(0.8071, dtype=torch.float64)),
[2024-10-23 01:18:17,200][flwr][INFO] - 	                    (34, tensor(0.8033, dtype=torch.float64)),
[2024-10-23 01:18:17,201][flwr][INFO] - 	                    (35, tensor(0.7755, dtype=torch.float64)),
[2024-10-23 01:18:17,201][flwr][INFO] - 	                    (36, tensor(0.7869, dtype=torch.float64)),
[2024-10-23 01:18:17,201][flwr][INFO] - 	                    (37, tensor(0.7765, dtype=torch.float64)),
[2024-10-23 01:18:17,202][flwr][INFO] - 	                    (38, tensor(0.7854, dtype=torch.float64)),
[2024-10-23 01:18:17,202][flwr][INFO] - 	                    (39, tensor(0.7859, dtype=torch.float64)),
[2024-10-23 01:18:17,203][flwr][INFO] - 	                    (40, tensor(0.7921, dtype=torch.float64)),
[2024-10-23 01:18:17,203][flwr][INFO] - 	                    (41, tensor(0.7959, dtype=torch.float64)),
[2024-10-23 01:18:17,203][flwr][INFO] - 	                    (42, tensor(0.7985, dtype=torch.float64)),
[2024-10-23 01:18:17,204][flwr][INFO] - 	                    (43, tensor(0.8040, dtype=torch.float64)),
[2024-10-23 01:18:17,204][flwr][INFO] - 	                    (44, tensor(0.7757, dtype=torch.float64)),
[2024-10-23 01:18:17,204][flwr][INFO] - 	                    (45, tensor(0.7943, dtype=torch.float64)),
[2024-10-23 01:18:17,205][flwr][INFO] - 	                    (46, tensor(0.7905, dtype=torch.float64)),
[2024-10-23 01:18:17,205][flwr][INFO] - 	                    (47, tensor(0.8039, dtype=torch.float64)),
[2024-10-23 01:18:17,206][flwr][INFO] - 	                    (48, tensor(0.8017, dtype=torch.float64)),
[2024-10-23 01:18:17,206][flwr][INFO] - 	                    (49, tensor(0.8035, dtype=torch.float64)),
[2024-10-23 01:18:17,206][flwr][INFO] - 	                    (50, tensor(0.8005, dtype=torch.float64))],
[2024-10-23 01:18:17,207][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-10-23 01:18:17,207][flwr][INFO] - 	                     (1, tensor(0.0055, dtype=torch.float64)),
[2024-10-23 01:18:17,207][flwr][INFO] - 	                     (2, tensor(0.0076, dtype=torch.float64)),
[2024-10-23 01:18:17,208][flwr][INFO] - 	                     (3, tensor(0.0070, dtype=torch.float64)),
[2024-10-23 01:18:17,208][flwr][INFO] - 	                     (4, tensor(0.0060, dtype=torch.float64)),
[2024-10-23 01:18:17,209][flwr][INFO] - 	                     (5, tensor(0.0124, dtype=torch.float64)),
[2024-10-23 01:18:17,209][flwr][INFO] - 	                     (6, tensor(0.0132, dtype=torch.float64)),
[2024-10-23 01:18:17,209][flwr][INFO] - 	                     (7, tensor(0.0211, dtype=torch.float64)),
[2024-10-23 01:18:17,210][flwr][INFO] - 	                     (8, tensor(0.0198, dtype=torch.float64)),
[2024-10-23 01:18:17,210][flwr][INFO] - 	                     (9, tensor(0.0185, dtype=torch.float64)),
[2024-10-23 01:18:17,211][flwr][INFO] - 	                     (10, tensor(0.0159, dtype=torch.float64)),
[2024-10-23 01:18:17,211][flwr][INFO] - 	                     (11, tensor(0.0205, dtype=torch.float64)),
[2024-10-23 01:18:17,211][flwr][INFO] - 	                     (12, tensor(0.0272, dtype=torch.float64)),
[2024-10-23 01:18:17,212][flwr][INFO] - 	                     (13, tensor(0.0319, dtype=torch.float64)),
[2024-10-23 01:18:17,212][flwr][INFO] - 	                     (14, tensor(0.0308, dtype=torch.float64)),
[2024-10-23 01:18:17,213][flwr][INFO] - 	                     (15, tensor(0.0492, dtype=torch.float64)),
[2024-10-23 01:18:17,213][flwr][INFO] - 	                     (16, tensor(0.0280, dtype=torch.float64)),
[2024-10-23 01:18:17,213][flwr][INFO] - 	                     (17, tensor(0.0437, dtype=torch.float64)),
[2024-10-23 01:18:17,214][flwr][INFO] - 	                     (18, tensor(0.0408, dtype=torch.float64)),
[2024-10-23 01:18:17,214][flwr][INFO] - 	                     (19, tensor(0.0527, dtype=torch.float64)),
[2024-10-23 01:18:17,214][flwr][INFO] - 	                     (20, tensor(0.0444, dtype=torch.float64)),
[2024-10-23 01:18:17,215][flwr][INFO] - 	                     (21, tensor(0.0364, dtype=torch.float64)),
[2024-10-23 01:18:17,215][flwr][INFO] - 	                     (22, tensor(0.0503, dtype=torch.float64)),
[2024-10-23 01:18:17,216][flwr][INFO] - 	                     (23, tensor(0.0463, dtype=torch.float64)),
[2024-10-23 01:18:17,216][flwr][INFO] - 	                     (24, tensor(0.0526, dtype=torch.float64)),
[2024-10-23 01:18:17,216][flwr][INFO] - 	                     (25, tensor(0.0508, dtype=torch.float64)),
[2024-10-23 01:18:17,217][flwr][INFO] - 	                     (26, tensor(0.0506, dtype=torch.float64)),
[2024-10-23 01:18:17,217][flwr][INFO] - 	                     (27, tensor(0.0461, dtype=torch.float64)),
[2024-10-23 01:18:17,218][flwr][INFO] - 	                     (28, tensor(0.0484, dtype=torch.float64)),
[2024-10-23 01:18:17,218][flwr][INFO] - 	                     (29, tensor(0.0485, dtype=torch.float64)),
[2024-10-23 01:18:17,218][flwr][INFO] - 	                     (30, tensor(0.0550, dtype=torch.float64)),
[2024-10-23 01:18:17,219][flwr][INFO] - 	                     (31, tensor(0.0555, dtype=torch.float64)),
[2024-10-23 01:18:17,219][flwr][INFO] - 	                     (32, tensor(0.0490, dtype=torch.float64)),
[2024-10-23 01:18:17,219][flwr][INFO] - 	                     (33, tensor(0.0561, dtype=torch.float64)),
[2024-10-23 01:18:17,220][flwr][INFO] - 	                     (34, tensor(0.0575, dtype=torch.float64)),
[2024-10-23 01:18:17,220][flwr][INFO] - 	                     (35, tensor(0.0591, dtype=torch.float64)),
[2024-10-23 01:18:17,221][flwr][INFO] - 	                     (36, tensor(0.0600, dtype=torch.float64)),
[2024-10-23 01:18:17,221][flwr][INFO] - 	                     (37, tensor(0.0527, dtype=torch.float64)),
[2024-10-23 01:18:17,221][flwr][INFO] - 	                     (38, tensor(0.0622, dtype=torch.float64)),
[2024-10-23 01:18:17,222][flwr][INFO] - 	                     (39, tensor(0.0677, dtype=torch.float64)),
[2024-10-23 01:18:17,222][flwr][INFO] - 	                     (40, tensor(0.0618, dtype=torch.float64)),
[2024-10-23 01:18:17,223][flwr][INFO] - 	                     (41, tensor(0.0633, dtype=torch.float64)),
[2024-10-23 01:18:17,223][flwr][INFO] - 	                     (42, tensor(0.0590, dtype=torch.float64)),
[2024-10-23 01:18:17,223][flwr][INFO] - 	                     (43, tensor(0.0681, dtype=torch.float64)),
[2024-10-23 01:18:17,224][flwr][INFO] - 	                     (44, tensor(0.0688, dtype=torch.float64)),
[2024-10-23 01:18:17,224][flwr][INFO] - 	                     (45, tensor(0.0632, dtype=torch.float64)),
[2024-10-23 01:18:17,224][flwr][INFO] - 	                     (46, tensor(0.0642, dtype=torch.float64)),
[2024-10-23 01:18:17,225][flwr][INFO] - 	                     (47, tensor(0.0664, dtype=torch.float64)),
[2024-10-23 01:18:17,225][flwr][INFO] - 	                     (48, tensor(0.0641, dtype=torch.float64)),
[2024-10-23 01:18:17,226][flwr][INFO] - 	                     (49, tensor(0.0613, dtype=torch.float64)),
[2024-10-23 01:18:17,226][flwr][INFO] - 	                     (50, tensor(0.0654, dtype=torch.float64))],
[2024-10-23 01:18:17,226][flwr][INFO] - 	 'all_iou': [(0, 0.011903673395072261),
[2024-10-23 01:18:17,227][flwr][INFO] - 	             (1, 0.5090804880705804),
[2024-10-23 01:18:17,227][flwr][INFO] - 	             (2, 0.6002899876353792),
[2024-10-23 01:18:17,228][flwr][INFO] - 	             (3, 0.5794149004309701),
[2024-10-23 01:18:17,228][flwr][INFO] - 	             (4, 0.5752554454061927),
[2024-10-23 01:18:17,228][flwr][INFO] - 	             (5, 0.627930743985751),
[2024-10-23 01:18:17,229][flwr][INFO] - 	             (6, 0.6385998419946105),
[2024-10-23 01:18:17,229][flwr][INFO] - 	             (7, 0.6400890011519084),
[2024-10-23 01:18:17,230][flwr][INFO] - 	             (8, 0.6562435736769473),
[2024-10-23 01:18:17,230][flwr][INFO] - 	             (9, 0.6641990758050949),
[2024-10-23 01:18:17,230][flwr][INFO] - 	             (10, 0.6452285332308397),
[2024-10-23 01:18:17,231][flwr][INFO] - 	             (11, 0.6522775725853509),
[2024-10-23 01:18:17,231][flwr][INFO] - 	             (12, 0.6504198729489246),
[2024-10-23 01:18:17,232][flwr][INFO] - 	             (13, 0.6463807010055296),
[2024-10-23 01:18:17,232][flwr][INFO] - 	             (14, 0.6805949596168117),
[2024-10-23 01:18:17,232][flwr][INFO] - 	             (15, 0.6463953929857222),
[2024-10-23 01:18:17,233][flwr][INFO] - 	             (16, 0.6756636591149762),
[2024-10-23 01:18:17,233][flwr][INFO] - 	             (17, 0.6576190001556668),
[2024-10-23 01:18:17,234][flwr][INFO] - 	             (18, 0.6517141058607431),
[2024-10-23 01:18:17,234][flwr][INFO] - 	             (19, 0.6700973549485246),
[2024-10-23 01:18:17,234][flwr][INFO] - 	             (20, 0.637275169215888),
[2024-10-23 01:18:17,235][flwr][INFO] - 	             (21, 0.6806465925867367),
[2024-10-23 01:18:17,235][flwr][INFO] - 	             (22, 0.6512946836846096),
[2024-10-23 01:18:17,235][flwr][INFO] - 	             (23, 0.6699978978001411),
[2024-10-23 01:18:17,236][flwr][INFO] - 	             (24, 0.6709036303842407),
[2024-10-23 01:18:17,236][flwr][INFO] - 	             (25, 0.6845918940625014),
[2024-10-23 01:18:17,237][flwr][INFO] - 	             (26, 0.6705742353130854),
[2024-10-23 01:18:17,237][flwr][INFO] - 	             (27, 0.6684795536373207),
[2024-10-23 01:18:17,237][flwr][INFO] - 	             (28, 0.6572931583451233),
[2024-10-23 01:18:17,238][flwr][INFO] - 	             (29, 0.6829033340698955),
[2024-10-23 01:18:17,238][flwr][INFO] - 	             (30, 0.6898312653825248),
[2024-10-23 01:18:17,239][flwr][INFO] - 	             (31, 0.688452790275343),
[2024-10-23 01:18:17,239][flwr][INFO] - 	             (32, 0.6810098696095176),
[2024-10-23 01:18:17,239][flwr][INFO] - 	             (33, 0.688947007642415),
[2024-10-23 01:18:17,240][flwr][INFO] - 	             (34, 0.684099686347312),
[2024-10-23 01:18:17,240][flwr][INFO] - 	             (35, 0.6532511115786459),
[2024-10-23 01:18:17,241][flwr][INFO] - 	             (36, 0.6660053554374418),
[2024-10-23 01:18:17,241][flwr][INFO] - 	             (37, 0.6521076798197167),
[2024-10-23 01:18:17,242][flwr][INFO] - 	             (38, 0.6641033887023836),
[2024-10-23 01:18:17,242][flwr][INFO] - 	             (39, 0.6647342351353488),
[2024-10-23 01:18:17,242][flwr][INFO] - 	             (40, 0.6735519621663566),
[2024-10-23 01:18:17,243][flwr][INFO] - 	             (41, 0.6767945181787847),
[2024-10-23 01:18:17,243][flwr][INFO] - 	             (42, 0.6793466295145195),
[2024-10-23 01:18:17,243][flwr][INFO] - 	             (43, 0.686221577669616),
[2024-10-23 01:18:17,244][flwr][INFO] - 	             (44, 0.6551313146211646),
[2024-10-23 01:18:17,244][flwr][INFO] - 	             (45, 0.6753705775398553),
[2024-10-23 01:18:17,245][flwr][INFO] - 	             (46, 0.6717459648506803),
[2024-10-23 01:18:17,245][flwr][INFO] - 	             (47, 0.6863395762182527),
[2024-10-23 01:18:17,245][flwr][INFO] - 	             (48, 0.6830953816682823),
[2024-10-23 01:18:17,246][flwr][INFO] - 	             (49, 0.6853729061938372),
[2024-10-23 01:18:17,246][flwr][INFO] - 	             (50, 0.6814223241927044)],
[2024-10-23 01:18:17,246][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1390, dtype=torch.float64)),
[2024-10-23 01:18:17,247][flwr][INFO] - 	                      (1, tensor(0.6057, dtype=torch.float64)),
[2024-10-23 01:18:17,247][flwr][INFO] - 	                      (2, tensor(0.7033, dtype=torch.float64)),
[2024-10-23 01:18:17,248][flwr][INFO] - 	                      (3, tensor(0.6855, dtype=torch.float64)),
[2024-10-23 01:18:17,248][flwr][INFO] - 	                      (4, tensor(0.6838, dtype=torch.float64)),
[2024-10-23 01:18:17,248][flwr][INFO] - 	                      (5, tensor(0.7349, dtype=torch.float64)),
[2024-10-23 01:18:17,249][flwr][INFO] - 	                      (6, tensor(0.7458, dtype=torch.float64)),
[2024-10-23 01:18:17,249][flwr][INFO] - 	                      (7, tensor(0.7497, dtype=torch.float64)),
[2024-10-23 01:18:17,249][flwr][INFO] - 	                      (8, tensor(0.7657, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (9, tensor(0.7733, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (10, tensor(0.7529, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (11, tensor(0.7596, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (12, tensor(0.7601, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (13, tensor(0.7543, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (14, tensor(0.7889, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (15, tensor(0.7540, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (16, tensor(0.7838, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (17, tensor(0.7650, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (18, tensor(0.7590, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (19, tensor(0.7775, dtype=torch.float64)),
[2024-10-23 01:18:17,250][flwr][INFO] - 	                      (20, tensor(0.7444, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (21, tensor(0.7885, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (22, tensor(0.7577, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (23, tensor(0.7788, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (24, tensor(0.7790, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (25, tensor(0.7929, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (26, tensor(0.7771, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (27, tensor(0.7757, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (28, tensor(0.7648, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (29, tensor(0.7903, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (30, tensor(0.7971, dtype=torch.float64)),
[2024-10-23 01:18:17,251][flwr][INFO] - 	                      (31, tensor(0.7966, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (32, tensor(0.7877, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (33, tensor(0.7961, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (34, tensor(0.7919, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (35, tensor(0.7594, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (36, tensor(0.7714, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (37, tensor(0.7604, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (38, tensor(0.7707, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (39, tensor(0.7715, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (40, tensor(0.7784, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (41, tensor(0.7827, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (42, tensor(0.7855, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (43, tensor(0.7926, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (44, tensor(0.7586, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (45, tensor(0.7810, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (46, tensor(0.7763, dtype=torch.float64)),
[2024-10-23 01:18:17,252][flwr][INFO] - 	                      (47, tensor(0.7923, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (48, tensor(0.7898, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (49, tensor(0.7914, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (50, tensor(0.7881, dtype=torch.float64))],
[2024-10-23 01:18:17,253][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1491, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (1, tensor(0.8153, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (2, tensor(0.8347, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (3, tensor(0.8481, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (4, tensor(0.8591, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (5, tensor(0.8613, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (6, tensor(0.8661, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (7, tensor(0.8622, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (8, tensor(0.8644, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (9, tensor(0.8667, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (10, tensor(0.8659, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (11, tensor(0.8687, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (12, tensor(0.8685, dtype=torch.float64)),
[2024-10-23 01:18:17,253][flwr][INFO] - 	                      (13, tensor(0.8712, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (14, tensor(0.8632, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (15, tensor(0.8699, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (16, tensor(0.8707, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (17, tensor(0.8727, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (18, tensor(0.8738, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (19, tensor(0.8703, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (20, tensor(0.8762, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (21, tensor(0.8688, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (22, tensor(0.8693, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (23, tensor(0.8731, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (24, tensor(0.8722, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (25, tensor(0.8714, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (26, tensor(0.8766, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (27, tensor(0.8761, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (28, tensor(0.8780, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (29, tensor(0.8724, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (30, tensor(0.8705, dtype=torch.float64)),
[2024-10-23 01:18:17,254][flwr][INFO] - 	                      (31, tensor(0.8714, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (32, tensor(0.8763, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (33, tensor(0.8753, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (34, tensor(0.8739, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (35, tensor(0.8726, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (36, tensor(0.8809, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (37, tensor(0.8736, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (38, tensor(0.8749, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (39, tensor(0.8734, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (40, tensor(0.8757, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (41, tensor(0.8772, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (42, tensor(0.8781, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (43, tensor(0.8743, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (44, tensor(0.8800, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (45, tensor(0.8768, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (46, tensor(0.8787, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (47, tensor(0.8768, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (48, tensor(0.8751, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (49, tensor(0.8792, dtype=torch.float64)),
[2024-10-23 01:18:17,255][flwr][INFO] - 	                      (50, tensor(0.8782, dtype=torch.float64))],
[2024-10-23 01:18:17,255][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0074, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (1, tensor(0.0051, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (2, tensor(0.0069, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (3, tensor(0.0062, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (4, tensor(0.0051, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (5, tensor(0.0112, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (6, tensor(0.0119, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (7, tensor(0.0204, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (8, tensor(0.0193, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (9, tensor(0.0176, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (10, tensor(0.0152, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (11, tensor(0.0202, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (12, tensor(0.0282, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (13, tensor(0.0321, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (14, tensor(0.0313, dtype=torch.float64)),
[2024-10-23 01:18:17,256][flwr][INFO] - 	                       (15, tensor(0.0544, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (16, tensor(0.0293, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (17, tensor(0.0472, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (18, tensor(0.0449, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (19, tensor(0.0555, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (20, tensor(0.0473, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (21, tensor(0.0370, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (22, tensor(0.0548, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (23, tensor(0.0510, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (24, tensor(0.0574, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (25, tensor(0.0549, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (26, tensor(0.0545, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (27, tensor(0.0505, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (28, tensor(0.0548, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (29, tensor(0.0514, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (30, tensor(0.0580, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (31, tensor(0.0580, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (32, tensor(0.0521, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (33, tensor(0.0600, dtype=torch.float64)),
[2024-10-23 01:18:17,257][flwr][INFO] - 	                       (34, tensor(0.0620, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (35, tensor(0.0657, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (36, tensor(0.0653, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (37, tensor(0.0579, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (38, tensor(0.0679, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (39, tensor(0.0737, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (40, tensor(0.0667, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (41, tensor(0.0695, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (42, tensor(0.0651, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (43, tensor(0.0732, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (44, tensor(0.0759, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (45, tensor(0.0675, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (46, tensor(0.0697, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (47, tensor(0.0709, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (48, tensor(0.0680, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (49, tensor(0.0651, dtype=torch.float64)),
[2024-10-23 01:18:17,258][flwr][INFO] - 	                       (50, tensor(0.0709, dtype=torch.float64))],
[2024-10-23 01:18:17,259][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0092, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (1, tensor(0.0080, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (2, tensor(0.0121, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (3, tensor(0.0113, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (4, tensor(0.0112, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (5, tensor(0.0199, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (6, tensor(0.0221, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (7, tensor(0.0265, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (8, tensor(0.0245, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (9, tensor(0.0246, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (10, tensor(0.0221, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (11, tensor(0.0241, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (12, tensor(0.0257, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (13, tensor(0.0308, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (14, tensor(0.0283, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (15, tensor(0.0251, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (16, tensor(0.0237, dtype=torch.float64)),
[2024-10-23 01:18:17,259][flwr][INFO] - 	                       (17, tensor(0.0280, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (18, tensor(0.0226, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (19, tensor(0.0380, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (20, tensor(0.0291, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (21, tensor(0.0310, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (22, tensor(0.0294, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (23, tensor(0.0301, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (24, tensor(0.0298, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (25, tensor(0.0281, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (26, tensor(0.0273, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (27, tensor(0.0278, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (28, tensor(0.0199, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (29, tensor(0.0316, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (30, tensor(0.0355, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (31, tensor(0.0386, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (32, tensor(0.0260, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (33, tensor(0.0308, dtype=torch.float64)),
[2024-10-23 01:18:17,260][flwr][INFO] - 	                       (34, tensor(0.0310, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (35, tensor(0.0285, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (36, tensor(0.0287, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (37, tensor(0.0236, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (38, tensor(0.0277, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (39, tensor(0.0354, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (40, tensor(0.0330, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (41, tensor(0.0309, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (42, tensor(0.0324, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (43, tensor(0.0387, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (44, tensor(0.0342, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (45, tensor(0.0353, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (46, tensor(0.0350, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (47, tensor(0.0374, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (48, tensor(0.0365, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (49, tensor(0.0279, dtype=torch.float64)),
[2024-10-23 01:18:17,261][flwr][INFO] - 	                       (50, tensor(0.0331, dtype=torch.float64))],
[2024-10-23 01:18:17,261][flwr][INFO] - 	 'ind_iou_0': [(0, 0.011860696316309528),
[2024-10-23 01:18:17,261][flwr][INFO] - 	               (1, 0.47232486878483493),
[2024-10-23 01:18:17,261][flwr][INFO] - 	               (2, 0.5786383701448586),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (3, 0.5520429784438088),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (4, 0.5452967656487652),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (5, 0.6073347323981415),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (6, 0.6189428697432084),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (7, 0.6212484891595069),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (8, 0.6399997384058395),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (9, 0.6486682810590206),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (10, 0.6265105013222145),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (11, 0.6345803619411285),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (12, 0.6321599932083363),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (13, 0.6269084627343463),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (14, 0.668875528713196),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (15, 0.6271813225325651),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (16, 0.6616097777912086),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (17, 0.6397948697261826),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (18, 0.6327088036834538),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (19, 0.655178240996763),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (20, 0.615145520643455),
[2024-10-23 01:18:17,262][flwr][INFO] - 	               (21, 0.6676652568642081),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (22, 0.6331369126086431),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (23, 0.6543445125195483),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (24, 0.6555079564198724),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (25, 0.6718489901865764),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (26, 0.6543797462614147),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (27, 0.6520859616757495),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (28, 0.6385243932328148),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (29, 0.6698039066858616),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (30, 0.678426625001988),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (31, 0.6765524579400672),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (32, 0.6666502777742433),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (33, 0.6763294071844954),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (34, 0.6708519898934023),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (35, 0.6346532525575366),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (36, 0.6478745912978613),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (37, 0.6330792932012825),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (38, 0.646983052521453),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (39, 0.6479459942103605),
[2024-10-23 01:18:17,263][flwr][INFO] - 	               (40, 0.6577648894843848),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (41, 0.661355410088525),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (42, 0.6642132755134812),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (43, 0.6731866524049307),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (44, 0.6352963048067246),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (45, 0.6599591178670763),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (46, 0.6551148037934577),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (47, 0.6728154010557585),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (48, 0.6692207692345924),
[2024-10-23 01:18:17,264][flwr][INFO] - 	               (49, 0.6712673363828235),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (50, 0.6667965787349326)],
[2024-10-23 01:18:17,265][flwr][INFO] - 	 'ind_iou_1': [(0, 0.012155620791068723),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (1, 0.7276499227845881),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (2, 0.7318853486392739),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (3, 0.7434870853803357),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (4, 0.7537485462999396),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (5, 0.7531719588917413),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (6, 0.7592621925690537),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (7, 0.7542648918423273),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (8, 0.7555509341058975),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (9, 0.7589647028931543),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (10, 0.7584976968410262),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (11, 0.7607964765755003),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (12, 0.761350964726288),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (13, 0.7651448996279298),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (14, 0.7539751330649799),
[2024-10-23 01:18:17,265][flwr][INFO] - 	               (15, 0.763284442323747),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (16, 0.7625759951659632),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (17, 0.7666529691579314),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (18, 0.7676631682767762),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (19, 0.7627363927627326),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (20, 0.7712819194256879),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (21, 0.7609398011438048),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (22, 0.7613675497543101),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (23, 0.7667223739047364),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (24, 0.7650513904595208),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (25, 0.7638932824429149),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (26, 0.7709189836595406),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (27, 0.7701296916509018),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (28, 0.7727279133240487),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (29, 0.7651326875756467),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (30, 0.7622097022528329),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (31, 0.763503206537126),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (32, 0.7703300351535398),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (33, 0.7684281652248823),
[2024-10-23 01:18:17,266][flwr][INFO] - 	               (34, 0.7668988117421206),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (35, 0.7663147727582432),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (36, 0.7765203723786229),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (37, 0.7677218512853319),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (38, 0.769368830235227),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (39, 0.767762029456455),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (40, 0.7701461372736603),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (41, 0.7721390049982297),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (42, 0.7728672190272297),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (43, 0.7673160036772249),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (44, 0.7762049148232166),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (45, 0.7713316847426815),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (46, 0.7745676811854526),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (47, 0.7714630738433893),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (48, 0.769135986147941),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (49, 0.7736944069192568),
[2024-10-23 01:18:17,267][flwr][INFO] - 	               (50, 0.7731046885898021)]}
[2024-10-23 01:18:17,267][flwr][INFO] - 
