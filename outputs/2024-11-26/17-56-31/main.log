[2024-11-26 17:56:32,127][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-11-26 17:56:54,828][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'node:172.18.62.4': 1.0, 'object_store_memory': 200000000000.0, 'memory': 850095004672.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[2024-11-26 17:56:54,828][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-26 17:56:54,828][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-26 17:56:54,851][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-26 17:56:54,852][flwr][INFO] - [INIT]
[2024-11-26 17:56:54,852][flwr][INFO] - Requesting initial parameters from one random client
[2024-11-26 17:56:58,367][flwr][INFO] - Received initial parameters from one random client
[2024-11-26 17:56:58,368][flwr][INFO] - Evaluating initial global parameters
[2024-11-26 18:02:03,006][flwr][INFO] - initial parameters (loss, other metrics): 0.7043031710932003, OrderedDict([('ind_iou_0', 0.0654708156290535), ('ind_dice_liver_0', tensor(0.1688, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0653650756211594), ('ind_dice_liver_1', tensor(0.1675, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0076, dtype=torch.float64)), ('all_iou', 0.06546496448727193), ('all_dice_liver', tensor(0.1687, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
[2024-11-26 18:02:03,010][flwr][INFO] - 
[2024-11-26 18:02:03,010][flwr][INFO] - [ROUND 1]
[2024-11-26 18:02:03,011][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 18:58:14,608][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-26 18:58:14,651][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-11-26 19:02:07,605][flwr][INFO] - fit progress: (1, 0.006403941509627275, OrderedDict([('ind_iou_0', 0.9457119029730147), ('ind_dice_liver_0', tensor(0.9678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5714, dtype=torch.float64)), ('ind_iou_1', 0.9412999127239885), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4677, dtype=torch.float64)), ('all_iou', 0.9454104017544205), ('all_dice_liver', tensor(0.9675, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5643, dtype=torch.float64))]), 3604.595059569925)
[2024-11-26 19:02:07,613][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 19:03:51,270][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-26 19:03:51,270][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 19:03:51,271][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 19:03:51,271][flwr][INFO] - 
[2024-11-26 19:03:51,271][flwr][INFO] - [ROUND 2]
[2024-11-26 19:03:51,272][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 19:58:19,338][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-26 20:02:28,599][flwr][INFO] - fit progress: (2, 0.0050533997839567, OrderedDict([('ind_iou_0', 0.9558546715981541), ('ind_dice_liver_0', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6164, dtype=torch.float64)), ('ind_iou_1', 0.9546260626172512), ('ind_dice_liver_1', tensor(0.9706, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5241, dtype=torch.float64)), ('all_iou', 0.9558033147938135), ('all_dice_liver', tensor(0.9729, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6097, dtype=torch.float64))]), 7225.589760400355)
[2024-11-26 20:02:28,604][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 20:04:07,765][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-26 20:04:07,766][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 20:04:07,766][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 20:04:07,767][flwr][INFO] - 
[2024-11-26 20:04:07,767][flwr][INFO] - [ROUND 3]
[2024-11-26 20:04:07,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 20:58:46,301][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-26 21:02:21,831][flwr][INFO] - fit progress: (3, 0.004342904730891536, OrderedDict([('ind_iou_0', 0.9611622124712068), ('ind_dice_liver_0', tensor(0.9759, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6428, dtype=torch.float64)), ('ind_iou_1', 0.9613343719006978), ('ind_dice_liver_1', tensor(0.9740, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5480, dtype=torch.float64)), ('all_iou', 0.9612137366980711), ('all_dice_liver', tensor(0.9757, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6363, dtype=torch.float64))]), 10818.82154962048)
[2024-11-26 21:02:21,835][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 21:04:00,481][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-26 21:04:00,482][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 21:04:00,482][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 21:04:00,482][flwr][INFO] - 
[2024-11-26 21:04:00,482][flwr][INFO] - [ROUND 4]
[2024-11-26 21:04:00,483][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 21:59:01,692][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-26 22:03:13,995][flwr][INFO] - fit progress: (4, 0.00428442600560812, OrderedDict([('ind_iou_0', 0.961981781158944), ('ind_dice_liver_0', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6504, dtype=torch.float64)), ('ind_iou_1', 0.9631077033224844), ('ind_dice_liver_1', tensor(0.9753, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5672, dtype=torch.float64)), ('all_iou', 0.9621756644492357), ('all_dice_liver', tensor(0.9765, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6444, dtype=torch.float64))]), 14470.985487732105)
[2024-11-26 22:03:13,999][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 22:04:54,292][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-26 22:04:54,292][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 22:04:54,293][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 22:04:54,293][flwr][INFO] - 
[2024-11-26 22:04:54,293][flwr][INFO] - [ROUND 5]
[2024-11-26 22:04:54,293][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 22:59:35,495][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-26 23:03:39,047][flwr][INFO] - fit progress: (5, 0.0038780910125739794, OrderedDict([('ind_iou_0', 0.965663195835508), ('ind_dice_liver_0', tensor(0.9797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6696, dtype=torch.float64)), ('ind_iou_1', 0.9674989241556511), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5793, dtype=torch.float64)), ('all_iou', 0.9658667418898235), ('all_dice_liver', tensor(0.9796, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6634, dtype=torch.float64))]), 18096.037496413104)
[2024-11-26 23:03:39,051][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 23:05:22,229][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-26 23:05:22,229][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 23:05:22,230][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 23:05:22,230][flwr][INFO] - 
[2024-11-26 23:05:22,230][flwr][INFO] - [ROUND 6]
[2024-11-26 23:05:22,231][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 23:59:31,556][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 00:03:35,063][flwr][INFO] - fit progress: (6, 0.0034814376804831477, OrderedDict([('ind_iou_0', 0.969225818066841), ('ind_dice_liver_0', tensor(0.9819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6857, dtype=torch.float64)), ('ind_iou_1', 0.9708177589102281), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5941, dtype=torch.float64)), ('all_iou', 0.9694482975683638), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 21692.05340414215)
[2024-11-27 00:03:35,067][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 00:05:11,466][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 00:05:11,466][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 00:05:11,467][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 00:05:11,467][flwr][INFO] - 
[2024-11-27 00:05:11,467][flwr][INFO] - [ROUND 7]
[2024-11-27 00:05:11,468][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 00:59:47,791][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 01:03:49,575][flwr][INFO] - fit progress: (7, 0.00341646312508958, OrderedDict([('ind_iou_0', 0.9702473909970715), ('ind_dice_liver_0', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6928, dtype=torch.float64)), ('ind_iou_1', 0.9722542917346813), ('ind_dice_liver_1', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.970521052330803), ('all_dice_liver', tensor(0.9831, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6866, dtype=torch.float64))]), 25306.564948599786)
[2024-11-27 01:03:49,578][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 01:05:19,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 01:05:19,867][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 01:05:19,868][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 01:05:19,868][flwr][INFO] - 
[2024-11-27 01:05:19,868][flwr][INFO] - [ROUND 8]
[2024-11-27 01:05:19,868][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 02:00:14,356][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 02:03:53,812][flwr][INFO] - fit progress: (8, 0.0033416935203953533, OrderedDict([('ind_iou_0', 0.9713154943676034), ('ind_dice_liver_0', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6961, dtype=torch.float64)), ('ind_iou_1', 0.9739228376175606), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6105, dtype=torch.float64)), ('all_iou', 0.9716201160878497), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6911, dtype=torch.float64))]), 28910.801945668645)
[2024-11-27 02:03:53,815][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 02:05:30,070][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 02:05:30,072][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 02:05:30,073][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 02:05:30,073][flwr][INFO] - 
[2024-11-27 02:05:30,074][flwr][INFO] - [ROUND 9]
[2024-11-27 02:05:30,074][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 02:59:35,329][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 03:03:12,757][flwr][INFO] - fit progress: (9, 0.0031887487254208496, OrderedDict([('ind_iou_0', 0.9726674898525501), ('ind_dice_liver_0', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7034, dtype=torch.float64)), ('ind_iou_1', 0.9764959335030695), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6155, dtype=torch.float64)), ('all_iou', 0.9730584856279966), ('all_dice_liver', tensor(0.9846, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6977, dtype=torch.float64))]), 32469.747321762145)
[2024-11-27 03:03:12,761][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 03:04:35,924][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 03:04:35,924][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 03:04:35,925][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 03:04:35,925][flwr][INFO] - 
[2024-11-27 03:04:35,925][flwr][INFO] - [ROUND 10]
[2024-11-27 03:04:35,925][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 03:59:06,795][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 04:02:25,402][flwr][INFO] - fit progress: (10, 0.0031744974584503633, OrderedDict([('ind_iou_0', 0.9731415026687117), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7059, dtype=torch.float64)), ('ind_iou_1', 0.9769288572292162), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6213, dtype=torch.float64)), ('all_iou', 0.9735583709284229), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7007, dtype=torch.float64))]), 36022.39226648584)
[2024-11-27 04:02:25,405][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 04:03:55,829][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 04:03:55,830][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 04:03:55,830][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 04:03:55,831][flwr][INFO] - 
[2024-11-27 04:03:55,831][flwr][INFO] - [ROUND 11]
[2024-11-27 04:03:55,831][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 04:58:38,289][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 05:02:40,941][flwr][INFO] - fit progress: (11, 0.0032392938357227517, OrderedDict([('ind_iou_0', 0.9733371411296339), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7114, dtype=torch.float64)), ('ind_iou_1', 0.9759590171282189), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6226, dtype=torch.float64)), ('all_iou', 0.9736761676674213), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7062, dtype=torch.float64))]), 39637.93171007)
[2024-11-27 05:02:40,945][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 05:04:32,374][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 05:04:32,374][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 05:04:32,374][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 05:04:32,375][flwr][INFO] - 
[2024-11-27 05:04:32,375][flwr][INFO] - [ROUND 12]
[2024-11-27 05:04:32,375][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 05:59:10,847][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 06:02:59,409][flwr][INFO] - fit progress: (12, 0.003113147121766642, OrderedDict([('ind_iou_0', 0.9743088004215644), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7159, dtype=torch.float64)), ('ind_iou_1', 0.9789127333155198), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6292, dtype=torch.float64)), ('all_iou', 0.9747876703321112), ('all_dice_liver', tensor(0.9862, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7105, dtype=torch.float64))]), 43256.399252084084)
[2024-11-27 06:02:59,414][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 06:04:37,888][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 06:04:37,889][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 06:04:37,889][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 06:04:37,890][flwr][INFO] - 
[2024-11-27 06:04:37,890][flwr][INFO] - [ROUND 13]
[2024-11-27 06:04:37,890][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 06:58:56,351][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 07:02:39,780][flwr][INFO] - fit progress: (13, 0.003114633645040651, OrderedDict([('ind_iou_0', 0.9744859314952669), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7177, dtype=torch.float64)), ('ind_iou_1', 0.978323456236889), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6329, dtype=torch.float64)), ('all_iou', 0.9749266880949851), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7132, dtype=torch.float64))]), 46836.769941624254)
[2024-11-27 07:02:39,783][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 07:04:14,097][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 07:04:14,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 07:04:14,098][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 07:04:14,098][flwr][INFO] - 
[2024-11-27 07:04:14,099][flwr][INFO] - [ROUND 14]
[2024-11-27 07:04:14,099][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 07:58:47,159][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 08:02:55,684][flwr][INFO] - fit progress: (14, 0.003128955120444475, OrderedDict([('ind_iou_0', 0.9744850239653781), ('ind_dice_liver_0', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7182, dtype=torch.float64)), ('ind_iou_1', 0.9787596868650466), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6331, dtype=torch.float64)), ('all_iou', 0.9749733388701632), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7135, dtype=torch.float64))]), 50452.67399511486)
[2024-11-27 08:02:55,687][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 08:04:30,178][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 08:04:30,178][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 08:04:30,179][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 08:04:30,180][flwr][INFO] - 
[2024-11-27 08:04:30,180][flwr][INFO] - [ROUND 15]
[2024-11-27 08:04:30,182][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 08:59:33,819][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 09:04:03,294][flwr][INFO] - fit progress: (15, 0.003097495119675427, OrderedDict([('ind_iou_0', 0.9750988712910427), ('ind_dice_liver_0', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7184, dtype=torch.float64)), ('ind_iou_1', 0.9801168821024651), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6361, dtype=torch.float64)), ('all_iou', 0.9756268551453247), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7142, dtype=torch.float64))]), 54120.284065227956)
[2024-11-27 09:04:03,297][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 09:05:36,425][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 09:05:36,425][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 09:05:36,426][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 09:05:36,426][flwr][INFO] - 
[2024-11-27 09:05:36,426][flwr][INFO] - [ROUND 16]
[2024-11-27 09:05:36,426][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 09:59:52,761][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 10:03:52,071][flwr][INFO] - fit progress: (16, 0.003077752173487341, OrderedDict([('ind_iou_0', 0.975376872640335), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9801341479914036), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6383, dtype=torch.float64)), ('all_iou', 0.9759010390385884), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7162, dtype=torch.float64))]), 57709.06129354425)
[2024-11-27 10:03:52,075][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 10:05:24,367][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 10:05:24,367][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 10:05:24,368][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 10:05:24,368][flwr][INFO] - 
[2024-11-27 10:05:24,368][flwr][INFO] - [ROUND 17]
[2024-11-27 10:05:24,368][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 11:03:13,490][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 11:06:47,045][flwr][INFO] - fit progress: (17, 0.003101708240503629, OrderedDict([('ind_iou_0', 0.9754605427624762), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7245, dtype=torch.float64)), ('ind_iou_1', 0.9803693830912049), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6384, dtype=torch.float64)), ('all_iou', 0.9759901091540316), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7200, dtype=torch.float64))]), 61484.03571880702)
[2024-11-27 11:06:47,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 11:08:24,873][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 11:08:24,874][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 11:08:24,875][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 11:08:24,875][flwr][INFO] - 
[2024-11-27 11:08:24,876][flwr][INFO] - [ROUND 18]
[2024-11-27 11:08:24,876][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 12:03:32,511][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 12:07:42,475][flwr][INFO] - fit progress: (18, 0.0030500399148120465, OrderedDict([('ind_iou_0', 0.9759720405646746), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7252, dtype=torch.float64)), ('ind_iou_1', 0.9812195080396462), ('ind_dice_liver_1', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6340, dtype=torch.float64)), ('all_iou', 0.9765187778575708), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7197, dtype=torch.float64))]), 65139.46501265466)
[2024-11-27 12:07:42,478][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 12:09:13,289][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 12:09:13,294][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 12:09:13,294][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 12:09:13,295][flwr][INFO] - 
[2024-11-27 12:09:13,295][flwr][INFO] - [ROUND 19]
[2024-11-27 12:09:13,295][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 13:03:48,603][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 13:07:30,862][flwr][INFO] - fit progress: (19, 0.0031872902655759195, OrderedDict([('ind_iou_0', 0.9747182211406173), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7186, dtype=torch.float64)), ('ind_iou_1', 0.9795783950002596), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6344, dtype=torch.float64)), ('all_iou', 0.9752275279538544), ('all_dice_liver', tensor(0.9867, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 68727.85286227334)
[2024-11-27 13:07:30,866][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 13:08:58,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 13:08:58,625][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 13:08:58,625][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 13:08:58,626][flwr][INFO] - 
[2024-11-27 13:08:58,626][flwr][INFO] - [ROUND 20]
[2024-11-27 13:08:58,626][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 14:04:13,112][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 14:08:38,016][flwr][INFO] - fit progress: (20, 0.0030948775219116426, OrderedDict([('ind_iou_0', 0.9763184793903508), ('ind_dice_liver_0', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7267, dtype=torch.float64)), ('ind_iou_1', 0.9814863108263304), ('ind_dice_liver_1', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6410, dtype=torch.float64)), ('all_iou', 0.9768614437893962), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7222, dtype=torch.float64))]), 72395.00679384638)
[2024-11-27 14:08:38,020][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 14:10:23,436][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 14:10:23,437][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 14:10:23,437][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 14:10:23,437][flwr][INFO] - 
[2024-11-27 14:10:23,437][flwr][INFO] - [ROUND 21]
[2024-11-27 14:10:23,437][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 15:06:42,329][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 15:10:27,843][flwr][INFO] - fit progress: (21, 0.0031354548059089396, OrderedDict([('ind_iou_0', 0.9763531444778881), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7259, dtype=torch.float64)), ('ind_iou_1', 0.9822307635014473), ('ind_dice_liver_1', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6343, dtype=torch.float64)), ('all_iou', 0.9769643321446412), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7208, dtype=torch.float64))]), 76104.83306309488)
[2024-11-27 15:10:27,847][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 15:12:12,420][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 15:12:12,420][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 15:12:12,421][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 15:12:12,421][flwr][INFO] - 
[2024-11-27 15:12:12,421][flwr][INFO] - [ROUND 22]
[2024-11-27 15:12:12,422][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 16:07:17,375][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 16:10:44,418][flwr][INFO] - fit progress: (22, 0.003127146368695691, OrderedDict([('ind_iou_0', 0.9766949693617846), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7261, dtype=torch.float64)), ('ind_iou_1', 0.9824695692320257), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6472, dtype=torch.float64)), ('all_iou', 0.9773331726056703), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7223, dtype=torch.float64))]), 79721.40822484065)
[2024-11-27 16:10:44,421][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 16:12:10,733][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 16:12:10,733][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 16:12:10,733][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 16:12:10,734][flwr][INFO] - 
[2024-11-27 16:12:10,734][flwr][INFO] - [ROUND 23]
[2024-11-27 16:12:10,734][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 17:06:38,314][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 17:10:35,565][flwr][INFO] - fit progress: (23, 0.0031902870739168986, OrderedDict([('ind_iou_0', 0.9765998676573923), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7298, dtype=torch.float64)), ('ind_iou_1', 0.9818668819528756), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6507, dtype=torch.float64)), ('all_iou', 0.9771830425257341), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7261, dtype=torch.float64))]), 83312.55548828561)
[2024-11-27 17:10:35,568][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 17:12:12,612][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 17:12:12,613][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 17:12:12,614][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 17:12:12,614][flwr][INFO] - 
[2024-11-27 17:12:12,614][flwr][INFO] - [ROUND 24]
[2024-11-27 17:12:12,614][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 18:08:26,860][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 18:12:16,562][flwr][INFO] - fit progress: (24, 0.0032035952562678885, OrderedDict([('ind_iou_0', 0.9765716768931899), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7253, dtype=torch.float64)), ('ind_iou_1', 0.9823264104283586), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6457, dtype=torch.float64)), ('all_iou', 0.9771847812712986), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7214, dtype=torch.float64))]), 87013.55242092162)
[2024-11-27 18:12:16,566][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 18:14:08,907][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 18:14:08,908][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 18:14:08,908][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 18:14:08,909][flwr][INFO] - 
[2024-11-27 18:14:08,909][flwr][INFO] - [ROUND 25]
[2024-11-27 18:14:08,909][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 19:08:36,159][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 19:12:48,120][flwr][INFO] - fit progress: (25, 0.003220780934904803, OrderedDict([('ind_iou_0', 0.9768842555751251), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7334, dtype=torch.float64)), ('ind_iou_1', 0.9826953341122924), ('ind_dice_liver_1', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.9775215141593329), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7292, dtype=torch.float64))]), 90645.11069815606)
[2024-11-27 19:12:48,124][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 19:14:15,703][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 19:14:15,703][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 19:14:15,704][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 19:14:15,704][flwr][INFO] - 
[2024-11-27 19:14:15,704][flwr][INFO] - [ROUND 26]
[2024-11-27 19:14:15,704][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 20:08:50,956][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 20:12:38,245][flwr][INFO] - fit progress: (26, 0.0032055707557312922, OrderedDict([('ind_iou_0', 0.977081121955697), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7326, dtype=torch.float64)), ('ind_iou_1', 0.9832299150543478), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9777226295561737), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 94235.23493678123)
[2024-11-27 20:12:38,248][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 20:14:18,734][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 20:14:18,734][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 20:14:18,735][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 20:14:18,735][flwr][INFO] - 
[2024-11-27 20:14:18,735][flwr][INFO] - [ROUND 27]
[2024-11-27 20:14:18,736][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 21:09:11,126][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 21:13:25,380][flwr][INFO] - fit progress: (27, 0.003180830807986533, OrderedDict([('ind_iou_0', 0.9770779384077869), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9829497834094191), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6463, dtype=torch.float64)), ('all_iou', 0.9777096114753222), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7285, dtype=torch.float64))]), 97882.37020867411)
[2024-11-27 21:13:25,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 21:15:22,562][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 21:15:22,563][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 21:15:22,564][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 21:15:22,564][flwr][INFO] - 
[2024-11-27 21:15:22,564][flwr][INFO] - [ROUND 28]
[2024-11-27 21:15:22,564][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 22:09:38,958][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 22:12:59,900][flwr][INFO] - fit progress: (28, 0.0030749148139109952, OrderedDict([('ind_iou_0', 0.9766038663891664), ('ind_dice_liver_0', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7274, dtype=torch.float64)), ('ind_iou_1', 0.9829444883558459), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6450, dtype=torch.float64)), ('all_iou', 0.9772533363148271), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7235, dtype=torch.float64))]), 101456.89081193227)
[2024-11-27 22:12:59,904][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 22:14:47,192][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 22:14:47,193][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 22:14:47,194][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 22:14:47,195][flwr][INFO] - 
[2024-11-27 22:14:47,195][flwr][INFO] - [ROUND 29]
[2024-11-27 22:14:47,195][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 23:11:28,310][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-27 23:15:22,234][flwr][INFO] - fit progress: (29, 0.003239431041685973, OrderedDict([('ind_iou_0', 0.9771579020015174), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7362, dtype=torch.float64)), ('ind_iou_1', 0.9827492238639275), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6519, dtype=torch.float64)), ('all_iou', 0.9777782367369191), ('all_dice_liver', tensor(0.9887, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7318, dtype=torch.float64))]), 105199.22395419516)
[2024-11-27 23:15:22,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 23:16:57,081][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 23:16:57,083][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 23:16:57,084][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 23:16:57,084][flwr][INFO] - 
[2024-11-27 23:16:57,084][flwr][INFO] - [ROUND 30]
[2024-11-27 23:16:57,084][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 00:11:27,163][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 00:14:43,848][flwr][INFO] - fit progress: (30, 0.003128368396275454, OrderedDict([('ind_iou_0', 0.9770598963066148), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7300, dtype=torch.float64)), ('ind_iou_1', 0.9834096667568272), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6469, dtype=torch.float64)), ('all_iou', 0.9777167415541976), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7257, dtype=torch.float64))]), 108760.83885056339)
[2024-11-28 00:14:43,852][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 00:16:18,600][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 00:16:18,601][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 00:16:18,602][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 00:16:18,602][flwr][INFO] - 
[2024-11-28 00:16:18,602][flwr][INFO] - [ROUND 31]
[2024-11-28 00:16:18,602][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 01:11:06,538][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 01:15:24,636][flwr][INFO] - fit progress: (31, 0.0033036262822956483, OrderedDict([('ind_iou_0', 0.9772058546250926), ('ind_dice_liver_0', tensor(0.9886, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7340, dtype=torch.float64)), ('ind_iou_1', 0.98373459356043), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6515, dtype=torch.float64)), ('all_iou', 0.9778886283113024), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7296, dtype=torch.float64))]), 112401.62685490958)
[2024-11-28 01:15:24,640][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 01:17:12,764][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 01:17:12,765][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 01:17:12,766][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 01:17:12,766][flwr][INFO] - 
[2024-11-28 01:17:12,766][flwr][INFO] - [ROUND 32]
[2024-11-28 01:17:12,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 02:11:56,394][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 02:15:44,117][flwr][INFO] - fit progress: (32, 0.0033247283091226, OrderedDict([('ind_iou_0', 0.9771013596485085), ('ind_dice_liver_0', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7292, dtype=torch.float64)), ('ind_iou_1', 0.9831964486404262), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6499, dtype=torch.float64)), ('all_iou', 0.9777682028722582), ('all_dice_liver', tensor(0.9888, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7252, dtype=torch.float64))]), 116021.10767742898)
[2024-11-28 02:15:44,121][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 02:17:19,706][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 02:17:19,706][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 02:17:19,707][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 02:17:19,707][flwr][INFO] - 
[2024-11-28 02:17:19,708][flwr][INFO] - [ROUND 33]
[2024-11-28 02:17:19,708][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 03:12:02,975][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 03:15:35,868][flwr][INFO] - fit progress: (33, 0.003349078092535827, OrderedDict([('ind_iou_0', 0.9775453114911077), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9834223331254398), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.9781960487068289), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7288, dtype=torch.float64))]), 119612.85828338284)
[2024-11-28 03:15:35,872][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 03:17:13,073][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 03:17:13,073][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 03:17:13,073][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 03:17:13,074][flwr][INFO] - 
[2024-11-28 03:17:13,074][flwr][INFO] - [ROUND 34]
[2024-11-28 03:17:13,074][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 04:11:32,218][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 04:15:17,333][flwr][INFO] - fit progress: (34, 0.003353211362724382, OrderedDict([('ind_iou_0', 0.9772829394300393), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7308, dtype=torch.float64)), ('ind_iou_1', 0.9833995105342614), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9779637942300693), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7276, dtype=torch.float64))]), 123194.32335294224)
[2024-11-28 04:15:17,341][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 04:16:44,373][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 04:16:44,373][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 04:16:44,373][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 04:16:44,374][flwr][INFO] - 
[2024-11-28 04:16:44,374][flwr][INFO] - [ROUND 35]
[2024-11-28 04:16:44,375][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 05:11:44,497][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 05:15:43,962][flwr][INFO] - fit progress: (35, 0.0033571563036802286, OrderedDict([('ind_iou_0', 0.9775531473892802), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7342, dtype=torch.float64)), ('ind_iou_1', 0.9837240287323227), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6542, dtype=torch.float64)), ('all_iou', 0.9782252014943089), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 126820.95278156735)
[2024-11-28 05:15:43,966][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 05:17:15,049][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 05:17:15,049][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 05:17:15,050][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 05:17:15,050][flwr][INFO] - 
[2024-11-28 05:17:15,050][flwr][INFO] - [ROUND 36]
[2024-11-28 05:17:15,050][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 06:11:15,259][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 06:14:33,920][flwr][INFO] - fit progress: (36, 0.0033593382400390775, OrderedDict([('ind_iou_0', 0.9776834292482883), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7344, dtype=torch.float64)), ('ind_iou_1', 0.9844340170053905), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.978415033148792), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 130350.91049361695)
[2024-11-28 06:14:33,924][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 06:16:16,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 06:16:16,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 06:16:16,554][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 06:16:16,554][flwr][INFO] - 
[2024-11-28 06:16:16,554][flwr][INFO] - [ROUND 37]
[2024-11-28 06:16:16,555][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 07:10:59,145][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 07:15:10,375][flwr][INFO] - fit progress: (37, 0.003391125607282127, OrderedDict([('ind_iou_0', 0.975856935517315), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7284, dtype=torch.float64)), ('ind_iou_1', 0.9812323215621994), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.976485285706244), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 133987.3654365111)
[2024-11-28 07:15:10,378][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 07:16:56,084][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 07:16:56,084][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 07:16:56,084][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 07:16:56,085][flwr][INFO] - 
[2024-11-28 07:16:56,085][flwr][INFO] - [ROUND 38]
[2024-11-28 07:16:56,085][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 08:11:42,953][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 08:15:13,721][flwr][INFO] - fit progress: (38, 0.003389941358093868, OrderedDict([('ind_iou_0', 0.9777797292241379), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7314, dtype=torch.float64)), ('ind_iou_1', 0.9840722890283032), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6513, dtype=torch.float64)), ('all_iou', 0.9784804151009112), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7279, dtype=torch.float64))]), 137590.71143726725)
[2024-11-28 08:15:13,725][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 08:16:58,880][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 08:16:58,881][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 08:16:58,891][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 08:16:58,891][flwr][INFO] - 
[2024-11-28 08:16:58,891][flwr][INFO] - [ROUND 39]
[2024-11-28 08:16:58,892][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 09:11:24,664][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 09:15:15,379][flwr][INFO] - fit progress: (39, 0.0034429413905449203, OrderedDict([('ind_iou_0', 0.9776902596651321), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7346, dtype=torch.float64)), ('ind_iou_1', 0.9846206547509245), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6562, dtype=torch.float64)), ('all_iou', 0.9784404527758714), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7311, dtype=torch.float64))]), 141192.36931552086)
[2024-11-28 09:15:15,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 09:16:47,538][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 09:16:47,539][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 09:16:47,539][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 09:16:47,539][flwr][INFO] - 
[2024-11-28 09:16:47,539][flwr][INFO] - [ROUND 40]
[2024-11-28 09:16:47,540][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 10:11:08,447][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 10:14:43,138][flwr][INFO] - fit progress: (40, 0.003396845251481258, OrderedDict([('ind_iou_0', 0.9777814739801413), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7363, dtype=torch.float64)), ('ind_iou_1', 0.984919181733902), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6555, dtype=torch.float64)), ('all_iou', 0.9785395152780921), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7326, dtype=torch.float64))]), 144760.12871477474)
[2024-11-28 10:14:43,143][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 10:16:27,543][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 10:16:27,543][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 10:16:27,543][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 10:16:27,543][flwr][INFO] - 
[2024-11-28 10:16:27,543][flwr][INFO] - [SUMMARY]
[2024-11-28 10:16:27,543][flwr][INFO] - Run finished 40 round(s) in 144864.53s
[2024-11-28 10:16:27,660][flwr][INFO] - 	History (loss, centralized):
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 0: 0.7043031710932003
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 1: 0.006403941509627275
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 2: 0.0050533997839567
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 3: 0.004342904730891536
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 4: 0.00428442600560812
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 5: 0.0038780910125739794
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 6: 0.0034814376804831477
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 7: 0.00341646312508958
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 8: 0.0033416935203953533
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 9: 0.0031887487254208496
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 10: 0.0031744974584503633
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 11: 0.0032392938357227517
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 12: 0.003113147121766642
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 13: 0.003114633645040651
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 14: 0.003128955120444475
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 15: 0.003097495119675427
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 16: 0.003077752173487341
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 17: 0.003101708240503629
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 18: 0.0030500399148120465
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 19: 0.0031872902655759195
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 20: 0.0030948775219116426
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 21: 0.0031354548059089396
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 22: 0.003127146368695691
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 23: 0.0031902870739168986
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 24: 0.0032035952562678885
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 25: 0.003220780934904803
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 26: 0.0032055707557312922
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 27: 0.003180830807986533
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 28: 0.0030749148139109952
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 29: 0.003239431041685973
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 30: 0.003128368396275454
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 31: 0.0033036262822956483
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 32: 0.0033247283091226
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 33: 0.003349078092535827
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 34: 0.003353211362724382
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 35: 0.0033571563036802286
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 36: 0.0033593382400390775
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 37: 0.003391125607282127
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 38: 0.003389941358093868
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 39: 0.0034429413905449203
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 40: 0.003396845251481258
[2024-11-28 10:16:27,662][flwr][INFO] - 	History (metrics, centralized):
[2024-11-28 10:16:27,662][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1687, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (1, tensor(0.9675, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (2, tensor(0.9729, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (3, tensor(0.9757, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (4, tensor(0.9765, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (5, tensor(0.9796, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (6, tensor(0.9819, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (7, tensor(0.9831, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (8, tensor(0.9840, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (9, tensor(0.9846, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (10, tensor(0.9854, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (11, tensor(0.9854, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (12, tensor(0.9862, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (13, tensor(0.9864, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (14, tensor(0.9864, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (15, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (16, tensor(0.9871, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (17, tensor(0.9871, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (18, tensor(0.9874, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (19, tensor(0.9867, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (20, tensor(0.9878, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (21, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (22, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (23, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (24, tensor(0.9881, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (25, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (26, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (27, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (28, tensor(0.9881, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (29, tensor(0.9887, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (30, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (31, tensor(0.9889, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (32, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (33, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (34, tensor(0.9889, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (35, tensor(0.9891, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (36, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (37, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (38, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (39, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (40, tensor(0.9894, dtype=torch.float64))],
[2024-11-28 10:16:27,664][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                     (1, tensor(0.5643, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                     (2, tensor(0.6097, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (3, tensor(0.6363, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (4, tensor(0.6444, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (5, tensor(0.6634, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (6, tensor(0.6793, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (7, tensor(0.6866, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (8, tensor(0.6911, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (9, tensor(0.6977, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (10, tensor(0.7007, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (11, tensor(0.7062, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (12, tensor(0.7105, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (13, tensor(0.7132, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (14, tensor(0.7135, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (15, tensor(0.7142, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (16, tensor(0.7162, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (17, tensor(0.7200, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (18, tensor(0.7197, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (19, tensor(0.7139, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (20, tensor(0.7222, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (21, tensor(0.7208, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (22, tensor(0.7223, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (23, tensor(0.7261, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (24, tensor(0.7214, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (25, tensor(0.7292, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (26, tensor(0.7283, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (27, tensor(0.7285, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (28, tensor(0.7235, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (29, tensor(0.7318, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (30, tensor(0.7257, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (31, tensor(0.7296, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (32, tensor(0.7252, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (33, tensor(0.7288, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (34, tensor(0.7276, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (35, tensor(0.7307, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (36, tensor(0.7307, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (37, tensor(0.7243, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (38, tensor(0.7279, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (39, tensor(0.7311, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (40, tensor(0.7326, dtype=torch.float64))],
[2024-11-28 10:16:27,666][flwr][INFO] - 	 'all_iou': [(0, 0.06546496448727193),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (1, 0.9454104017544205),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (2, 0.9558033147938135),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (3, 0.9612137366980711),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (4, 0.9621756644492357),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (5, 0.9658667418898235),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (6, 0.9694482975683638),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (7, 0.970521052330803),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (8, 0.9716201160878497),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (9, 0.9730584856279966),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (10, 0.9735583709284229),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (11, 0.9736761676674213),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (12, 0.9747876703321112),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (13, 0.9749266880949851),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (14, 0.9749733388701632),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (15, 0.9756268551453247),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (16, 0.9759010390385884),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (17, 0.9759901091540316),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (18, 0.9765187778575708),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (19, 0.9752275279538544),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (20, 0.9768614437893962),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (21, 0.9769643321446412),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (22, 0.9773331726056703),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (23, 0.9771830425257341),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (24, 0.9771847812712986),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (25, 0.9775215141593329),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (26, 0.9777226295561737),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (27, 0.9777096114753222),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (28, 0.9772533363148271),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (29, 0.9777782367369191),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (30, 0.9777167415541976),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (31, 0.9778886283113024),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (32, 0.9777682028722582),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (33, 0.9781960487068289),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (34, 0.9779637942300693),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (35, 0.9782252014943089),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (36, 0.978415033148792),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (37, 0.976485285706244),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (38, 0.9784804151009112),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (39, 0.9784404527758714),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (40, 0.9785395152780921)],
[2024-11-28 10:16:27,668][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1688, dtype=torch.float64)),
[2024-11-28 10:16:27,668][flwr][INFO] - 	                      (1, tensor(0.9678, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (2, tensor(0.9731, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (3, tensor(0.9759, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (4, tensor(0.9766, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (5, tensor(0.9797, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (6, tensor(0.9819, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (7, tensor(0.9830, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (8, tensor(0.9840, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (9, tensor(0.9845, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (10, tensor(0.9853, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (11, tensor(0.9853, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (12, tensor(0.9860, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (13, tensor(0.9863, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (14, tensor(0.9862, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (15, tensor(0.9867, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (16, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (17, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (18, tensor(0.9872, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (19, tensor(0.9865, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (20, tensor(0.9876, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (21, tensor(0.9877, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (22, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (23, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (24, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (25, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (26, tensor(0.9883, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (27, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (28, tensor(0.9878, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (29, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (30, tensor(0.9883, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (31, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (32, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (33, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (34, tensor(0.9887, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (35, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (36, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (37, tensor(0.9877, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (38, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (39, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (40, tensor(0.9891, dtype=torch.float64))],
[2024-11-28 10:16:27,670][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1675, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (1, tensor(0.9641, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (2, tensor(0.9706, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (3, tensor(0.9740, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (4, tensor(0.9753, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (5, tensor(0.9791, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (6, tensor(0.9817, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (7, tensor(0.9830, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (8, tensor(0.9842, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (9, tensor(0.9855, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (10, tensor(0.9863, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (11, tensor(0.9856, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (12, tensor(0.9875, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (13, tensor(0.9873, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (14, tensor(0.9875, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (15, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (16, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (17, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (18, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (19, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (20, tensor(0.9894, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (21, tensor(0.9899, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (22, tensor(0.9900, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (23, tensor(0.9897, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (24, tensor(0.9901, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (25, tensor(0.9903, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (26, tensor(0.9906, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (27, tensor(0.9906, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (28, tensor(0.9901, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (29, tensor(0.9905, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (30, tensor(0.9907, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (31, tensor(0.9911, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (32, tensor(0.9907, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (33, tensor(0.9909, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (34, tensor(0.9909, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (35, tensor(0.9911, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (36, tensor(0.9915, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (37, tensor(0.9895, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (38, tensor(0.9914, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (39, tensor(0.9917, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (40, tensor(0.9918, dtype=torch.float64))],
[2024-11-28 10:16:27,672][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (1, tensor(0.5714, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (2, tensor(0.6164, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (3, tensor(0.6428, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (4, tensor(0.6504, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (5, tensor(0.6696, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (6, tensor(0.6857, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (7, tensor(0.6928, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (8, tensor(0.6961, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (9, tensor(0.7034, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (10, tensor(0.7059, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (11, tensor(0.7114, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (12, tensor(0.7159, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (13, tensor(0.7177, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (14, tensor(0.7182, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (15, tensor(0.7184, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (16, tensor(0.7204, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (17, tensor(0.7245, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (18, tensor(0.7252, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (19, tensor(0.7186, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (20, tensor(0.7267, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (21, tensor(0.7259, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (22, tensor(0.7261, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (23, tensor(0.7298, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (24, tensor(0.7253, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (25, tensor(0.7334, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (26, tensor(0.7326, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (27, tensor(0.7329, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (28, tensor(0.7274, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (29, tensor(0.7362, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (30, tensor(0.7300, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (31, tensor(0.7340, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (32, tensor(0.7292, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (33, tensor(0.7329, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (34, tensor(0.7308, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (35, tensor(0.7342, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (36, tensor(0.7344, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (37, tensor(0.7284, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (38, tensor(0.7314, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (39, tensor(0.7346, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (40, tensor(0.7363, dtype=torch.float64))],
[2024-11-28 10:16:27,674][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0076, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (1, tensor(0.4677, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (2, tensor(0.5241, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (3, tensor(0.5480, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (4, tensor(0.5672, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (5, tensor(0.5793, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (6, tensor(0.5941, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (7, tensor(0.6000, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (8, tensor(0.6105, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (9, tensor(0.6155, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (10, tensor(0.6213, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (11, tensor(0.6226, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (12, tensor(0.6292, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (13, tensor(0.6329, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (14, tensor(0.6331, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (15, tensor(0.6361, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (16, tensor(0.6383, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (17, tensor(0.6384, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (18, tensor(0.6340, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (19, tensor(0.6344, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (20, tensor(0.6410, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (21, tensor(0.6343, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (22, tensor(0.6472, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (23, tensor(0.6507, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (24, tensor(0.6457, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (25, tensor(0.6486, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (26, tensor(0.6481, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (27, tensor(0.6463, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (28, tensor(0.6450, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (29, tensor(0.6519, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (30, tensor(0.6469, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (31, tensor(0.6515, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (32, tensor(0.6499, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (33, tensor(0.6522, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (34, tensor(0.6540, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (35, tensor(0.6542, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (36, tensor(0.6544, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (37, tensor(0.6486, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (38, tensor(0.6513, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (39, tensor(0.6562, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (40, tensor(0.6555, dtype=torch.float64))],
[2024-11-28 10:16:27,676][flwr][INFO] - 	 'ind_iou_0': [(0, 0.0654708156290535),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (1, 0.9457119029730147),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (2, 0.9558546715981541),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (3, 0.9611622124712068),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (4, 0.961981781158944),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (5, 0.965663195835508),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (6, 0.969225818066841),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (7, 0.9702473909970715),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (8, 0.9713154943676034),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (9, 0.9726674898525501),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (10, 0.9731415026687117),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (11, 0.9733371411296339),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (12, 0.9743088004215644),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (13, 0.9744859314952669),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (14, 0.9744850239653781),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (15, 0.9750988712910427),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (16, 0.975376872640335),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (17, 0.9754605427624762),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (18, 0.9759720405646746),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (19, 0.9747182211406173),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (20, 0.9763184793903508),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (21, 0.9763531444778881),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (22, 0.9766949693617846),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (23, 0.9765998676573923),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (24, 0.9765716768931899),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (25, 0.9768842555751251),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (26, 0.977081121955697),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (27, 0.9770779384077869),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (28, 0.9766038663891664),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (29, 0.9771579020015174),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (30, 0.9770598963066148),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (31, 0.9772058546250926),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (32, 0.9771013596485085),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (33, 0.9775453114911077),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (34, 0.9772829394300393),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (35, 0.9775531473892802),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (36, 0.9776834292482883),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (37, 0.975856935517315),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (38, 0.9777797292241379),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (39, 0.9776902596651321),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (40, 0.9777814739801413)],
[2024-11-28 10:16:27,678][flwr][INFO] - 	 'ind_iou_1': [(0, 0.0653650756211594),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (1, 0.9412999127239885),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (2, 0.9546260626172512),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (3, 0.9613343719006978),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (4, 0.9631077033224844),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (5, 0.9674989241556511),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (6, 0.9708177589102281),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (7, 0.9722542917346813),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (8, 0.9739228376175606),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (9, 0.9764959335030695),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (10, 0.9769288572292162),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (11, 0.9759590171282189),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (12, 0.9789127333155198),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (13, 0.978323456236889),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (14, 0.9787596868650466),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (15, 0.9801168821024651),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (16, 0.9801341479914036),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (17, 0.9803693830912049),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (18, 0.9812195080396462),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (19, 0.9795783950002596),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (20, 0.9814863108263304),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (21, 0.9822307635014473),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (22, 0.9824695692320257),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (23, 0.9818668819528756),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (24, 0.9823264104283586),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (25, 0.9826953341122924),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (26, 0.9832299150543478),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (27, 0.9829497834094191),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (28, 0.9829444883558459),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (29, 0.9827492238639275),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (30, 0.9834096667568272),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (31, 0.98373459356043),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (32, 0.9831964486404262),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (33, 0.9834223331254398),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (34, 0.9833995105342614),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (35, 0.9837240287323227),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (36, 0.9844340170053905),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (37, 0.9812323215621994),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (38, 0.9840722890283032),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (39, 0.9846206547509245),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (40, 0.984919181733902)]}
[2024-11-28 10:16:27,680][flwr][INFO] - 
