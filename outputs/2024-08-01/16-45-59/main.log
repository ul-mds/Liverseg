[2024-08-01 16:45:59,307][flwr][INFO] - Starting Flower simulation, config: num_rounds=15, no round_timeout
[2024-08-01 16:46:02,015][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 73424788071.0, 'GPU': 1.0, 'CPU': 8.0, 'accelerator_type:T4': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 35753480601.0, 'node:10.50.9.88': 1.0}
[2024-08-01 16:46:02,015][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-08-01 16:46:02,015][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-08-01 16:46:02,029][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
[2024-08-01 16:46:02,029][flwr][INFO] - [INIT]
[2024-08-01 16:46:02,029][flwr][INFO] - Requesting initial parameters from one random client
[2024-08-01 16:46:05,147][flwr][INFO] - Received initial parameters from one random client
[2024-08-01 16:46:05,147][flwr][INFO] - Evaluating initial global parameters
[2024-08-01 16:51:19,396][flwr][INFO] - initial parameters (loss, other metrics): 0.7203297974220034, OrderedDict([('ind_iou_0', 0.04804648753878414), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035764), ('ind_dice_liver_1', tensor(0.1540, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985079), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))])
[2024-08-01 16:51:19,401][flwr][INFO] - 
[2024-08-01 16:51:19,401][flwr][INFO] - [ROUND 1]
[2024-08-01 16:51:19,402][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 16:53:41,556][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 16:53:41,557][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 17:14:59,406][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 17:14:59,406][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 17:14:59,407][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 17:20:13,658][flwr][INFO] - fit progress: (1, 0.7203297965394905, OrderedDict([('ind_iou_0', 0.04804648753878418), ('ind_dice_liver_0', tensor(0.1522, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780358355), ('ind_dice_liver_1', tensor(0.1532, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985085), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 1734.2570683239028)
[2024-08-01 17:20:13,663][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 17:20:13,957][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 17:20:13,957][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 17:20:14,146][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 17:20:14,146][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 17:20:14,147][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 17:20:14,147][flwr][INFO] - 
[2024-08-01 17:20:14,147][flwr][INFO] - [ROUND 2]
[2024-08-01 17:20:14,147][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 17:22:32,182][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 17:22:32,182][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 17:43:47,726][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 17:43:47,726][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 17:43:47,727][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 17:49:00,991][flwr][INFO] - fit progress: (2, 0.7203297995232247, OrderedDict([('ind_iou_0', 0.048046487538784204), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035916), ('ind_dice_liver_1', tensor(0.1535, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850684), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 3461.590215186123)
[2024-08-01 17:49:00,996][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 17:49:01,294][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 17:49:01,294][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 17:49:01,460][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 17:49:01,460][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 17:49:01,461][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 17:49:01,461][flwr][INFO] - 
[2024-08-01 17:49:01,461][flwr][INFO] - [ROUND 3]
[2024-08-01 17:49:01,461][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 17:51:19,755][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 17:51:19,756][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 18:12:36,041][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 18:12:36,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 18:12:36,042][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 18:17:49,836][flwr][INFO] - fit progress: (3, 0.720329799355127, OrderedDict([('ind_iou_0', 0.04804648753878408), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035814), ('ind_dice_liver_1', tensor(0.1537, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850754), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 5190.43462086888)
[2024-08-01 18:17:49,840][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 18:17:50,130][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 18:17:50,130][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 18:17:50,294][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 18:17:50,294][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 18:17:50,295][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 18:17:50,295][flwr][INFO] - 
[2024-08-01 18:17:50,295][flwr][INFO] - [ROUND 4]
[2024-08-01 18:17:50,295][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 18:20:08,289][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 18:20:08,289][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 18:41:23,311][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 18:41:23,311][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 18:41:23,312][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 18:46:36,265][flwr][INFO] - fit progress: (4, 0.7203297961472624, OrderedDict([('ind_iou_0', 0.04804648753878422), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780358945), ('ind_dice_liver_1', tensor(0.1542, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.0480444259298507), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 6916.863542688079)
[2024-08-01 18:46:36,269][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 18:46:36,551][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 18:46:36,551][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 18:46:36,716][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 18:46:36,716][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 18:46:36,717][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 18:46:36,717][flwr][INFO] - 
[2024-08-01 18:46:36,717][flwr][INFO] - [ROUND 5]
[2024-08-01 18:46:36,717][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 19:07:52,838][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 19:07:52,838][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 19:10:10,841][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 19:10:10,841][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 19:10:10,842][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 19:15:24,591][flwr][INFO] - fit progress: (5, 0.7203297982765, OrderedDict([('ind_iou_0', 0.04804648753878412), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780359174), ('ind_dice_liver_1', tensor(0.1539, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985084), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 8645.190214259084)
[2024-08-01 19:15:24,596][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 19:15:24,876][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 19:15:24,876][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 19:15:25,038][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 19:15:25,039][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 19:15:25,039][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 19:15:25,039][flwr][INFO] - 
[2024-08-01 19:15:25,039][flwr][INFO] - [ROUND 6]
[2024-08-01 19:15:25,040][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 19:17:43,327][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 19:17:43,328][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 19:39:00,541][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 19:39:00,541][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 19:39:00,542][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 19:44:12,437][flwr][INFO] - fit progress: (6, 0.7203297994952084, OrderedDict([('ind_iou_0', 0.04804648753878455), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035807), ('ind_dice_liver_1', tensor(0.1533, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985077), ('all_dice_liver', tensor(0.1527, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 10373.035885422956)
[2024-08-01 19:44:12,442][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 19:44:12,834][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 19:44:12,834][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 19:44:12,999][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 19:44:12,999][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 19:44:13,000][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 19:44:13,000][flwr][INFO] - 
[2024-08-01 19:44:13,000][flwr][INFO] - [ROUND 7]
[2024-08-01 19:44:13,000][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 20:05:27,794][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 20:05:27,795][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 20:07:45,664][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 20:07:45,664][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 20:07:45,665][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 20:12:59,318][flwr][INFO] - fit progress: (7, 0.7203297987527769, OrderedDict([('ind_iou_0', 0.04804648753878453), ('ind_dice_liver_0', tensor(0.1525, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780359334), ('ind_dice_liver_1', tensor(0.1539, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985069), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 12099.91714768624)
[2024-08-01 20:12:59,323][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 20:12:59,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 20:12:59,606][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 20:12:59,771][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 20:12:59,771][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 20:12:59,772][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 20:12:59,772][flwr][INFO] - 
[2024-08-01 20:12:59,772][flwr][INFO] - [ROUND 8]
[2024-08-01 20:12:59,772][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 20:15:17,827][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 20:15:17,827][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 20:36:33,590][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 20:36:33,590][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 20:36:33,591][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 20:41:47,054][flwr][INFO] - fit progress: (8, 0.7203298011621774, OrderedDict([('ind_iou_0', 0.048046487538784446), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035748), ('ind_dice_liver_1', tensor(0.1539, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850754), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 13827.652911800891)
[2024-08-01 20:41:47,059][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 20:41:47,350][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 20:41:47,350][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 20:41:47,513][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 20:41:47,514][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 20:41:47,514][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 20:41:47,514][flwr][INFO] - 
[2024-08-01 20:41:47,514][flwr][INFO] - [ROUND 9]
[2024-08-01 20:41:47,515][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 20:44:05,519][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 20:44:05,520][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 21:05:24,570][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 21:05:24,570][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 21:05:24,571][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 21:10:35,885][flwr][INFO] - fit progress: (9, 0.7203297986407118, OrderedDict([('ind_iou_0', 0.048046487538784356), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878036006), ('ind_dice_liver_1', tensor(0.1532, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985081), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 15556.484112798236)
[2024-08-01 21:10:35,890][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 21:10:36,196][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 21:10:36,196][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 21:10:36,363][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 21:10:36,364][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 21:10:36,364][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 21:10:36,364][flwr][INFO] - 
[2024-08-01 21:10:36,364][flwr][INFO] - [ROUND 10]
[2024-08-01 21:10:36,365][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 21:12:54,375][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 21:12:54,375][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 21:34:09,512][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 21:34:09,512][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 21:34:09,513][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 21:39:21,651][flwr][INFO] - fit progress: (10, 0.7203297963153602, OrderedDict([('ind_iou_0', 0.04804648753878439), ('ind_dice_liver_0', tensor(0.1522, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035994), ('ind_dice_liver_1', tensor(0.1534, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850816), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 17282.250236897264)
[2024-08-01 21:39:21,656][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 21:39:21,942][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 21:39:21,942][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 21:39:22,106][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 21:39:22,106][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 21:39:22,106][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 21:39:22,106][flwr][INFO] - 
[2024-08-01 21:39:22,106][flwr][INFO] - [ROUND 11]
[2024-08-01 21:39:22,107][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 22:00:38,195][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 22:00:38,196][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 22:02:56,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 22:02:56,257][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 22:02:56,257][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 22:08:10,525][flwr][INFO] - fit progress: (11, 0.7203297978002232, OrderedDict([('ind_iou_0', 0.048046487538784315), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035831), ('ind_dice_liver_1', tensor(0.1540, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985076), ('all_dice_liver', tensor(0.1526, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 19011.124220245983)
[2024-08-01 22:08:10,530][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 22:08:10,813][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 22:08:10,814][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 22:08:10,979][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 22:08:10,979][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 22:08:10,980][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 22:08:10,980][flwr][INFO] - 
[2024-08-01 22:08:10,980][flwr][INFO] - [ROUND 12]
[2024-08-01 22:08:10,980][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 22:10:33,662][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 22:10:33,663][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 22:34:23,097][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 22:34:23,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 22:34:23,098][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 22:40:29,747][flwr][INFO] - fit progress: (12, 0.7203297976181173, OrderedDict([('ind_iou_0', 0.048046487538784224), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035999), ('ind_dice_liver_1', tensor(0.1534, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.04804442592985071), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 20950.346004759893)
[2024-08-01 22:40:29,752][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 22:40:30,042][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 22:40:30,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 22:40:30,208][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 22:40:30,209][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 22:40:30,209][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 22:40:30,209][flwr][INFO] - 
[2024-08-01 22:40:30,209][flwr][INFO] - [ROUND 13]
[2024-08-01 22:40:30,210][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 23:05:47,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 23:05:47,141][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 23:08:36,847][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 23:08:36,848][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 23:08:36,848][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 23:14:46,673][flwr][INFO] - fit progress: (13, 0.7203297987247606, OrderedDict([('ind_iou_0', 0.048046487538784), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780358314), ('ind_dice_liver_1', tensor(0.1536, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850636), ('all_dice_liver', tensor(0.1525, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0094, dtype=torch.float64))]), 23007.27205491904)
[2024-08-01 23:14:46,678][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 23:14:46,959][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 23:14:46,959][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 23:14:47,126][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 23:14:47,126][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 23:14:47,126][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 23:14:47,126][flwr][INFO] - 
[2024-08-01 23:14:47,127][flwr][INFO] - [ROUND 14]
[2024-08-01 23:14:47,127][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 23:39:32,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 23:39:32,389][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 23:42:00,810][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 23:42:00,810][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-01 23:42:00,811][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-01 23:47:20,320][flwr][INFO] - fit progress: (14, 0.720329797968321, OrderedDict([('ind_iou_0', 0.048046487538784134), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.04802529878035901), ('ind_dice_liver_1', tensor(0.1535, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.048044425929850844), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 24960.918819685)
[2024-08-01 23:47:20,325][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-01 23:47:20,611][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 23:47:20,611][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 23:47:20,774][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-01 23:47:20,774][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-01 23:47:20,774][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-01 23:47:20,775][flwr][INFO] - 
[2024-08-01 23:47:20,775][flwr][INFO] - [ROUND 15]
[2024-08-01 23:47:20,775][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-01 23:49:45,817][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-01 23:49:45,818][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-02 00:11:46,310][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

[2024-08-02 00:11:46,310][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 65, in fit
    train(self.model,self.trainloader,self.valloader,optimizer,criterion,self.device, self.cfg.local_epochs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 181, in train
    val_log = validate(net, validloader, criterion)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 216, in validate
    output = model(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 99, in forward
    e1 = self.Conv1(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 35, in forward
    x = self.conv(x)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
[2024-08-02 00:11:46,311][flwr][INFO] - aggregate_fit: received 0 results and 2 failures
[2024-08-02 00:17:16,622][flwr][INFO] - fit progress: (15, 0.7203298002376399, OrderedDict([('ind_iou_0', 0.04804648753878413), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0095, dtype=torch.float64)), ('ind_iou_1', 0.048025298780358175), ('ind_dice_liver_1', tensor(0.1536, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0082, dtype=torch.float64)), ('all_iou', 0.0480444259298508), ('all_dice_liver', tensor(0.1524, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0093, dtype=torch.float64))]), 26757.220644324087)
[2024-08-02 00:17:16,627][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-02 00:17:16,911][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-02 00:17:16,911][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-02 00:17:17,091][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)

[2024-08-02 00:17:17,091][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/home/mmaia/fedliver_v2/client.py", line 76, in evaluate
    loss, log = test(self.model, self.valloader,criterion, self.device)
  File "/home/mmaia/fedliver_v2/model/unet.py", line 255, in test
    for j, (input, target) in tqdm(enumerate(testloader), total=len(testloader)):
ValueError: too many values to unpack (expected 2)

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2988144, ip=10.50.9.88, actor_id=71262bf3954fe9ea90174c2601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f81cc24b6a0>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: too many values to unpack (expected 2)
[2024-08-02 00:17:17,092][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-02 00:17:17,092][flwr][INFO] - 
[2024-08-02 00:17:17,092][flwr][INFO] - [SUMMARY]
[2024-08-02 00:17:17,092][flwr][INFO] - Run finished 15 round(s) in 26757.69s
[2024-08-02 00:17:17,155][flwr][INFO] - 	History (loss, centralized):
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 0: 0.7203297974220034
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 1: 0.7203297965394905
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 2: 0.7203297995232247
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 3: 0.720329799355127
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 4: 0.7203297961472624
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 5: 0.7203297982765
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 6: 0.7203297994952084
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 7: 0.7203297987527769
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 8: 0.7203298011621774
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 9: 0.7203297986407118
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 10: 0.7203297963153602
[2024-08-02 00:17:17,156][flwr][INFO] - 		round 11: 0.7203297978002232
[2024-08-02 00:17:17,157][flwr][INFO] - 		round 12: 0.7203297976181173
[2024-08-02 00:17:17,157][flwr][INFO] - 		round 13: 0.7203297987247606
[2024-08-02 00:17:17,157][flwr][INFO] - 		round 14: 0.720329797968321
[2024-08-02 00:17:17,157][flwr][INFO] - 		round 15: 0.7203298002376399
[2024-08-02 00:17:17,157][flwr][INFO] - 	History (metrics, centralized):
[2024-08-02 00:17:17,157][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (1, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (2, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (3, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (4, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (5, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (6, tensor(0.1527, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (7, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (8, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (9, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (10, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,157][flwr][INFO] - 	                    (11, tensor(0.1526, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                    (12, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                    (13, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                    (14, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                    (15, tensor(0.1524, dtype=torch.float64))],
[2024-08-02 00:17:17,158][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (1, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (2, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (3, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (4, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (5, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (6, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (7, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (8, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (9, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (10, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (11, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (12, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,158][flwr][INFO] - 	                     (13, tensor(0.0094, dtype=torch.float64)),
[2024-08-02 00:17:17,159][flwr][INFO] - 	                     (14, tensor(0.0093, dtype=torch.float64)),
[2024-08-02 00:17:17,159][flwr][INFO] - 	                     (15, tensor(0.0093, dtype=torch.float64))],
[2024-08-02 00:17:17,159][flwr][INFO] - 	 'all_iou': [(0, 0.04804442592985079),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (1, 0.04804442592985085),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (2, 0.048044425929850684),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (3, 0.048044425929850754),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (4, 0.0480444259298507),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (5, 0.04804442592985084),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (6, 0.04804442592985077),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (7, 0.04804442592985069),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (8, 0.048044425929850754),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (9, 0.04804442592985081),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (10, 0.048044425929850816),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (11, 0.04804442592985076),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (12, 0.04804442592985071),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (13, 0.048044425929850636),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (14, 0.048044425929850844),
[2024-08-02 00:17:17,159][flwr][INFO] - 	             (15, 0.0480444259298508)],
[2024-08-02 00:17:17,160][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (1, tensor(0.1522, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (2, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (3, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (4, tensor(0.1523, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (5, tensor(0.1523, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (6, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (7, tensor(0.1525, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (8, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (9, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (10, tensor(0.1522, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (11, tensor(0.1524, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (12, tensor(0.1523, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (13, tensor(0.1523, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (14, tensor(0.1523, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (15, tensor(0.1523, dtype=torch.float64))],
[2024-08-02 00:17:17,160][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1540, dtype=torch.float64)),
[2024-08-02 00:17:17,160][flwr][INFO] - 	                      (1, tensor(0.1532, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (2, tensor(0.1535, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (3, tensor(0.1537, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (4, tensor(0.1542, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (5, tensor(0.1539, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (6, tensor(0.1533, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (7, tensor(0.1539, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (8, tensor(0.1539, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (9, tensor(0.1532, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (10, tensor(0.1534, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (11, tensor(0.1540, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (12, tensor(0.1534, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (13, tensor(0.1536, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (14, tensor(0.1535, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                      (15, tensor(0.1536, dtype=torch.float64))],
[2024-08-02 00:17:17,161][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                       (1, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                       (2, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,161][flwr][INFO] - 	                       (3, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (4, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (5, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (6, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (7, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (8, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (9, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (10, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (11, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (12, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (13, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (14, tensor(0.0095, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (15, tensor(0.0095, dtype=torch.float64))],
[2024-08-02 00:17:17,162][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (1, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (2, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (3, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,162][flwr][INFO] - 	                       (4, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (5, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (6, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (7, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (8, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (9, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (10, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (11, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (12, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (13, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (14, tensor(0.0082, dtype=torch.float64)),
[2024-08-02 00:17:17,163][flwr][INFO] - 	                       (15, tensor(0.0082, dtype=torch.float64))],
[2024-08-02 00:17:17,163][flwr][INFO] - 	 'ind_iou_0': [(0, 0.04804648753878414),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (1, 0.04804648753878418),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (2, 0.048046487538784204),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (3, 0.04804648753878408),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (4, 0.04804648753878422),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (5, 0.04804648753878412),
[2024-08-02 00:17:17,163][flwr][INFO] - 	               (6, 0.04804648753878455),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (7, 0.04804648753878453),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (8, 0.048046487538784446),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (9, 0.048046487538784356),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (10, 0.04804648753878439),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (11, 0.048046487538784315),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (12, 0.048046487538784224),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (13, 0.048046487538784),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (14, 0.048046487538784134),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (15, 0.04804648753878413)],
[2024-08-02 00:17:17,164][flwr][INFO] - 	 'ind_iou_1': [(0, 0.04802529878035764),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (1, 0.048025298780358355),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (2, 0.04802529878035916),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (3, 0.04802529878035814),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (4, 0.048025298780358945),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (5, 0.048025298780359174),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (6, 0.04802529878035807),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (7, 0.048025298780359334),
[2024-08-02 00:17:17,164][flwr][INFO] - 	               (8, 0.04802529878035748),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (9, 0.04802529878036006),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (10, 0.04802529878035994),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (11, 0.04802529878035831),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (12, 0.04802529878035999),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (13, 0.048025298780358314),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (14, 0.04802529878035901),
[2024-08-02 00:17:17,165][flwr][INFO] - 	               (15, 0.048025298780358175)]}
[2024-08-02 00:17:17,165][flwr][INFO] - 
