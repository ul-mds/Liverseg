[2024-10-04 10:02:00,046][flwr][INFO] - Starting Flower simulation, config: num_rounds=30, no round_timeout
[2024-10-04 10:02:21,251][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 860879084544.0, 'node:__internal_head__': 1.0, 'node:172.18.62.3': 1.0, 'GPU': 3.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'object_store_memory': 200000000000.0}
[2024-10-04 10:02:21,251][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-10-04 10:02:21,251][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-10-04 10:02:21,267][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-10-04 10:02:21,267][flwr][INFO] - [INIT]
[2024-10-04 10:02:21,268][flwr][INFO] - Requesting initial parameters from one random client
[2024-10-04 10:02:24,741][flwr][INFO] - Received initial parameters from one random client
[2024-10-04 10:02:24,741][flwr][INFO] - Evaluating initial global parameters
[2024-10-04 10:05:18,034][flwr][INFO] - initial parameters (loss, other metrics): 0.5575170021079542, OrderedDict([('ind_iou_0', 1.5419592718617657e-10), ('ind_dice_liver_0', tensor(0.1524, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0083, dtype=torch.float64)), ('ind_iou_1', 1.5568234532978525e-10), ('ind_dice_liver_1', tensor(0.1518, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0096, dtype=torch.float64)), ('all_iou', 1.5912025585105526e-10), ('all_dice_liver', tensor(0.1519, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0095, dtype=torch.float64))])
[2024-10-04 10:05:18,042][flwr][INFO] - 
[2024-10-04 10:05:18,042][flwr][INFO] - [ROUND 1]
[2024-10-04 10:05:18,043][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 10:25:14,727][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 10:25:14,790][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-10-04 10:29:12,033][flwr][INFO] - fit progress: (1, 0.02934991501875826, OrderedDict([('ind_iou_0', 0.8754435199114211), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0648, dtype=torch.float64)), ('ind_iou_1', 0.8981156870463922), ('ind_dice_liver_1', tensor(0.8622, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1161, dtype=torch.float64)), ('all_iou', 0.8959688858228723), ('all_dice_liver', tensor(0.8601, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1111, dtype=torch.float64))]), 1433.9905853886157)
[2024-10-04 10:29:12,046][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 10:29:18,139][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 10:29:18,140][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 10:29:55,603][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 10:29:55,603][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 10:29:55,603][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 10:29:55,603][flwr][INFO] - 
[2024-10-04 10:29:55,603][flwr][INFO] - [ROUND 2]
[2024-10-04 10:29:55,604][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 10:49:42,446][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 10:53:22,051][flwr][INFO] - fit progress: (2, 0.009907775157657655, OrderedDict([('ind_iou_0', 0.9179624878984024), ('ind_dice_liver_0', tensor(0.9373, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3430, dtype=torch.float64)), ('ind_iou_1', 0.9275564471127771), ('ind_dice_liver_1', tensor(0.9449, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4157, dtype=torch.float64)), ('all_iou', 0.9263346042904719), ('all_dice_liver', tensor(0.9438, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4118, dtype=torch.float64))]), 2884.009011052549)
[2024-10-04 10:53:22,055][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 10:53:28,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 10:53:28,625][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 10:54:05,564][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 10:54:05,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 10:54:05,565][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 10:54:05,565][flwr][INFO] - 
[2024-10-04 10:54:05,565][flwr][INFO] - [ROUND 3]
[2024-10-04 10:54:05,565][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 11:13:52,748][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 11:17:42,415][flwr][INFO] - fit progress: (3, 0.008068044227137548, OrderedDict([('ind_iou_0', 0.9263890648761245), ('ind_dice_liver_0', tensor(0.9518, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3376, dtype=torch.float64)), ('ind_iou_1', 0.9357663123595424), ('ind_dice_liver_1', tensor(0.9571, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4275, dtype=torch.float64)), ('all_iou', 0.9348580900182325), ('all_dice_liver', tensor(0.9566, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4232, dtype=torch.float64))]), 4344.37283989042)
[2024-10-04 11:17:42,419][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 11:17:48,731][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 11:17:48,731][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 11:18:21,812][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 11:18:21,812][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 11:18:21,813][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 11:18:21,813][flwr][INFO] - 
[2024-10-04 11:18:21,814][flwr][INFO] - [ROUND 4]
[2024-10-04 11:18:21,814][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 11:38:18,798][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 11:42:14,027][flwr][INFO] - fit progress: (4, 0.006115679080148264, OrderedDict([('ind_iou_0', 0.9430929880699351), ('ind_dice_liver_0', tensor(0.9612, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.4775, dtype=torch.float64)), ('ind_iou_1', 0.9477986618381777), ('ind_dice_liver_1', tensor(0.9657, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5691, dtype=torch.float64)), ('all_iou', 0.9473717788590111), ('all_dice_liver', tensor(0.9654, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5702, dtype=torch.float64))]), 5815.984255947173)
[2024-10-04 11:42:14,030][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 11:42:20,475][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 11:42:20,475][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 11:42:57,604][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 11:42:57,605][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 11:42:57,605][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 11:42:57,605][flwr][INFO] - 
[2024-10-04 11:42:57,605][flwr][INFO] - [ROUND 5]
[2024-10-04 11:42:57,605][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 12:02:55,661][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 12:06:55,138][flwr][INFO] - fit progress: (5, 0.005120454829068008, OrderedDict([('ind_iou_0', 0.9551154516291739), ('ind_dice_liver_0', tensor(0.9702, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5304, dtype=torch.float64)), ('ind_iou_1', 0.9555494024854061), ('ind_dice_liver_1', tensor(0.9725, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6215, dtype=torch.float64)), ('all_iou', 0.9553998094425686), ('all_dice_liver', tensor(0.9723, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6214, dtype=torch.float64))]), 7297.095645317808)
[2024-10-04 12:06:55,143][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 12:07:01,760][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:07:01,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:07:38,564][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:07:38,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:07:38,565][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 12:07:38,565][flwr][INFO] - 
[2024-10-04 12:07:38,566][flwr][INFO] - [ROUND 6]
[2024-10-04 12:07:38,566][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 12:27:36,010][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 12:31:36,078][flwr][INFO] - fit progress: (6, 0.004756963614004497, OrderedDict([('ind_iou_0', 0.9583311506156051), ('ind_dice_liver_0', tensor(0.9716, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5396, dtype=torch.float64)), ('ind_iou_1', 0.9588814246684157), ('ind_dice_liver_1', tensor(0.9739, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6265, dtype=torch.float64)), ('all_iou', 0.958769118829597), ('all_dice_liver', tensor(0.9737, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6271, dtype=torch.float64))]), 8778.035719886422)
[2024-10-04 12:31:36,084][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 12:31:42,937][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:31:42,938][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:32:19,157][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:32:19,158][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:32:19,158][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 12:32:19,158][flwr][INFO] - 
[2024-10-04 12:32:19,158][flwr][INFO] - [ROUND 7]
[2024-10-04 12:32:19,158][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 12:52:18,474][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 12:56:18,298][flwr][INFO] - fit progress: (7, 0.004394150343772842, OrderedDict([('ind_iou_0', 0.9618806274068702), ('ind_dice_liver_0', tensor(0.9743, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5585, dtype=torch.float64)), ('ind_iou_1', 0.9617714631394205), ('ind_dice_liver_1', tensor(0.9763, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6478, dtype=torch.float64)), ('all_iou', 0.9616509816954025), ('all_dice_liver', tensor(0.9760, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6484, dtype=torch.float64))]), 10260.255902579054)
[2024-10-04 12:56:18,304][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 12:56:25,260][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:56:25,260][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:57:01,986][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 12:57:01,986][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 12:57:01,987][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 12:57:01,987][flwr][INFO] - 
[2024-10-04 12:57:01,987][flwr][INFO] - [ROUND 8]
[2024-10-04 12:57:01,987][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 13:17:00,534][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 13:20:59,649][flwr][INFO] - fit progress: (8, 0.004497748196122842, OrderedDict([('ind_iou_0', 0.9600760334811267), ('ind_dice_liver_0', tensor(0.9733, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5601, dtype=torch.float64)), ('ind_iou_1', 0.9605003193739639), ('ind_dice_liver_1', tensor(0.9756, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6500, dtype=torch.float64)), ('all_iou', 0.9604312254010082), ('all_dice_liver', tensor(0.9754, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6497, dtype=torch.float64))]), 11741.607019802555)
[2024-10-04 13:20:59,655][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 13:21:06,132][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 13:21:06,133][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 13:21:47,199][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 13:21:47,199][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 13:21:47,200][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 13:21:47,200][flwr][INFO] - 
[2024-10-04 13:21:47,200][flwr][INFO] - [ROUND 9]
[2024-10-04 13:21:47,200][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 13:41:47,996][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 13:45:50,404][flwr][INFO] - fit progress: (9, 0.004157913512562333, OrderedDict([('ind_iou_0', 0.9635910260213789), ('ind_dice_liver_0', tensor(0.9759, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5655, dtype=torch.float64)), ('ind_iou_1', 0.9631760253521308), ('ind_dice_liver_1', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6511, dtype=torch.float64)), ('all_iou', 0.9632859068111592), ('all_dice_liver', tensor(0.9770, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6535, dtype=torch.float64))]), 13232.362063081935)
[2024-10-04 13:45:50,409][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 13:45:57,618][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 13:45:57,619][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 13:46:38,594][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 13:46:38,594][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 13:46:38,595][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 13:46:38,595][flwr][INFO] - 
[2024-10-04 13:46:38,595][flwr][INFO] - [ROUND 10]
[2024-10-04 13:46:38,595][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 14:06:41,252][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 14:10:41,458][flwr][INFO] - fit progress: (10, 0.003907302134319019, OrderedDict([('ind_iou_0', 0.9665595321234832), ('ind_dice_liver_0', tensor(0.9785, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5751, dtype=torch.float64)), ('ind_iou_1', 0.9656491925298181), ('ind_dice_liver_1', tensor(0.9795, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6664, dtype=torch.float64)), ('all_iou', 0.9657056867820183), ('all_dice_liver', tensor(0.9794, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6684, dtype=torch.float64))]), 14723.415391998366)
[2024-10-04 14:10:41,462][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 14:10:48,269][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 14:10:48,269][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 14:11:29,552][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 14:11:29,552][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 14:11:29,553][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 14:11:29,553][flwr][INFO] - 
[2024-10-04 14:11:29,553][flwr][INFO] - [ROUND 11]
[2024-10-04 14:11:29,553][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 14:31:31,704][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 14:35:31,520][flwr][INFO] - fit progress: (11, 0.003769933157813868, OrderedDict([('ind_iou_0', 0.9680994354853699), ('ind_dice_liver_0', tensor(0.9790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5918, dtype=torch.float64)), ('ind_iou_1', 0.9664881265065681), ('ind_dice_liver_1', tensor(0.9799, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6797, dtype=torch.float64)), ('all_iou', 0.9666242278633564), ('all_dice_liver', tensor(0.9798, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6824, dtype=torch.float64))]), 16213.477167043835)
[2024-10-04 14:35:31,523][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 14:35:37,976][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 14:35:37,976][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 14:36:19,506][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 14:36:19,507][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 14:36:19,507][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 14:36:19,507][flwr][INFO] - 
[2024-10-04 14:36:19,507][flwr][INFO] - [ROUND 12]
[2024-10-04 14:36:19,507][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 14:56:22,369][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 15:00:24,311][flwr][INFO] - fit progress: (12, 0.0037744396955505907, OrderedDict([('ind_iou_0', 0.9678618162907766), ('ind_dice_liver_0', tensor(0.9789, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5870, dtype=torch.float64)), ('ind_iou_1', 0.9663491637222463), ('ind_dice_liver_1', tensor(0.9799, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6687, dtype=torch.float64)), ('all_iou', 0.9664668193480485), ('all_dice_liver', tensor(0.9798, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6718, dtype=torch.float64))]), 17706.26813127473)
[2024-10-04 15:00:24,318][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 15:00:31,303][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:00:31,304][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:01:12,427][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:01:12,427][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:01:12,427][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 15:01:12,428][flwr][INFO] - 
[2024-10-04 15:01:12,428][flwr][INFO] - [ROUND 13]
[2024-10-04 15:01:12,428][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 15:21:21,282][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 15:25:22,236][flwr][INFO] - fit progress: (13, 0.0035804611278892648, OrderedDict([('ind_iou_0', 0.969813759100039), ('ind_dice_liver_0', tensor(0.9802, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5945, dtype=torch.float64)), ('ind_iou_1', 0.9681038366550222), ('ind_dice_liver_1', tensor(0.9809, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6807, dtype=torch.float64)), ('all_iou', 0.9682524046860291), ('all_dice_liver', tensor(0.9808, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6843, dtype=torch.float64))]), 19204.193855129182)
[2024-10-04 15:25:22,243][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 15:25:29,582][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:25:29,582][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:26:10,615][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:26:10,615][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:26:10,616][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 15:26:10,616][flwr][INFO] - 
[2024-10-04 15:26:10,616][flwr][INFO] - [ROUND 14]
[2024-10-04 15:26:10,616][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 15:46:19,202][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 15:50:23,514][flwr][INFO] - fit progress: (14, 0.0036875048189365977, OrderedDict([('ind_iou_0', 0.9686487518635383), ('ind_dice_liver_0', tensor(0.9802, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6033, dtype=torch.float64)), ('ind_iou_1', 0.9673299908394578), ('ind_dice_liver_1', tensor(0.9809, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6912, dtype=torch.float64)), ('all_iou', 0.9674681395692944), ('all_dice_liver', tensor(0.9808, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6926, dtype=torch.float64))]), 20705.471658820286)
[2024-10-04 15:50:23,524][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 15:50:30,478][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:50:30,478][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:51:12,297][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 15:51:12,297][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 15:51:12,298][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 15:51:12,298][flwr][INFO] - 
[2024-10-04 15:51:12,298][flwr][INFO] - [ROUND 15]
[2024-10-04 15:51:12,298][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 16:11:18,996][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 16:15:20,911][flwr][INFO] - fit progress: (15, 0.0034704647720249678, OrderedDict([('ind_iou_0', 0.9712968388273351), ('ind_dice_liver_0', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6005, dtype=torch.float64)), ('ind_iou_1', 0.969168965581938), ('ind_dice_liver_1', tensor(0.9818, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6887, dtype=torch.float64)), ('all_iou', 0.9693495084841669), ('all_dice_liver', tensor(0.9818, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6913, dtype=torch.float64))]), 22202.86864363402)
[2024-10-04 16:15:20,919][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 16:15:28,353][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 16:15:28,353][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 16:16:09,826][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 16:16:09,826][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 16:16:09,826][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 16:16:09,826][flwr][INFO] - 
[2024-10-04 16:16:09,827][flwr][INFO] - [ROUND 16]
[2024-10-04 16:16:09,827][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 16:36:17,077][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 16:40:19,153][flwr][INFO] - fit progress: (16, 0.0034450547749419573, OrderedDict([('ind_iou_0', 0.9715051675166304), ('ind_dice_liver_0', tensor(0.9818, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6038, dtype=torch.float64)), ('ind_iou_1', 0.9696685195438036), ('ind_dice_liver_1', tensor(0.9821, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6955, dtype=torch.float64)), ('all_iou', 0.9698678717797771), ('all_dice_liver', tensor(0.9821, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6984, dtype=torch.float64))]), 23701.11074273847)
[2024-10-04 16:40:19,160][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 16:40:26,207][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 16:40:26,208][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 16:41:07,984][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 16:41:07,985][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 16:41:07,985][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 16:41:07,985][flwr][INFO] - 
[2024-10-04 16:41:07,985][flwr][INFO] - [ROUND 17]
[2024-10-04 16:41:07,986][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 17:01:15,327][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 17:05:17,599][flwr][INFO] - fit progress: (17, 0.0032826853783081093, OrderedDict([('ind_iou_0', 0.9739784494778574), ('ind_dice_liver_0', tensor(0.9834, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6159, dtype=torch.float64)), ('ind_iou_1', 0.9709901686810779), ('ind_dice_liver_1', tensor(0.9833, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7028, dtype=torch.float64)), ('all_iou', 0.9712528223169185), ('all_dice_liver', tensor(0.9833, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7062, dtype=torch.float64))]), 25199.556712254882)
[2024-10-04 17:05:17,607][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 17:05:24,598][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:05:24,598][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:06:06,393][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:06:06,393][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:06:06,394][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 17:06:06,394][flwr][INFO] - 
[2024-10-04 17:06:06,394][flwr][INFO] - [ROUND 18]
[2024-10-04 17:06:06,394][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 17:26:17,532][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 17:30:21,102][flwr][INFO] - fit progress: (18, 0.0038413047141009193, OrderedDict([('ind_iou_0', 0.9685473215913585), ('ind_dice_liver_0', tensor(0.9802, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5897, dtype=torch.float64)), ('ind_iou_1', 0.9663523857475483), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6826, dtype=torch.float64)), ('all_iou', 0.9665754438326508), ('all_dice_liver', tensor(0.9804, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6848, dtype=torch.float64))]), 26703.059139953926)
[2024-10-04 17:30:21,109][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 17:30:28,565][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:30:28,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:31:09,579][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:31:09,579][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:31:09,580][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 17:31:09,580][flwr][INFO] - 
[2024-10-04 17:31:09,580][flwr][INFO] - [ROUND 19]
[2024-10-04 17:31:09,581][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 17:51:19,778][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 17:55:25,016][flwr][INFO] - fit progress: (19, 0.003158091206747062, OrderedDict([('ind_iou_0', 0.9752522695670917), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6207, dtype=torch.float64)), ('ind_iou_1', 0.972353029052824), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7135, dtype=torch.float64)), ('all_iou', 0.9726313235654857), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7174, dtype=torch.float64))]), 28206.97359804623)
[2024-10-04 17:55:25,024][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 17:55:32,126][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:55:32,127][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:56:13,315][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 17:56:13,316][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 17:56:13,316][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 17:56:13,316][flwr][INFO] - 
[2024-10-04 17:56:13,317][flwr][INFO] - [ROUND 20]
[2024-10-04 17:56:13,317][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 18:16:22,486][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 18:20:25,535][flwr][INFO] - fit progress: (20, 0.00305148833316393, OrderedDict([('ind_iou_0', 0.976544167297734), ('ind_dice_liver_0', tensor(0.9847, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6284, dtype=torch.float64)), ('ind_iou_1', 0.9732731767631084), ('ind_dice_liver_1', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7180, dtype=torch.float64)), ('all_iou', 0.9736221263261353), ('all_dice_liver', tensor(0.9845, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7215, dtype=torch.float64))]), 29707.49301606603)
[2024-10-04 18:20:25,543][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 18:20:32,154][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 18:20:32,155][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 18:21:13,986][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 18:21:13,986][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 18:21:13,987][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 18:21:13,987][flwr][INFO] - 
[2024-10-04 18:21:13,987][flwr][INFO] - [ROUND 21]
[2024-10-04 18:21:13,987][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 18:41:22,803][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 18:45:24,511][flwr][INFO] - fit progress: (21, 0.0031263937151768673, OrderedDict([('ind_iou_0', 0.9755375201822827), ('ind_dice_liver_0', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6249, dtype=torch.float64)), ('ind_iou_1', 0.972951434164231), ('ind_dice_liver_1', tensor(0.9847, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7163, dtype=torch.float64)), ('all_iou', 0.9732341801136365), ('all_dice_liver', tensor(0.9847, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7183, dtype=torch.float64))]), 31206.46892957017)
[2024-10-04 18:45:24,519][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 18:45:31,367][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 18:45:31,368][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 18:46:12,806][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 18:46:12,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 18:46:12,807][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 18:46:12,808][flwr][INFO] - 
[2024-10-04 18:46:12,808][flwr][INFO] - [ROUND 22]
[2024-10-04 18:46:12,808][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 19:06:21,230][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 19:10:23,172][flwr][INFO] - fit progress: (22, 0.003138749201133077, OrderedDict([('ind_iou_0', 0.9754013210540633), ('ind_dice_liver_0', tensor(0.9844, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6207, dtype=torch.float64)), ('ind_iou_1', 0.9727878725784133), ('ind_dice_liver_1', tensor(0.9844, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7168, dtype=torch.float64)), ('all_iou', 0.9730274423603547), ('all_dice_liver', tensor(0.9844, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7201, dtype=torch.float64))]), 32705.129312267527)
[2024-10-04 19:10:23,180][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 19:10:30,400][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 19:10:30,400][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 19:11:11,870][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 19:11:11,871][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 19:11:11,871][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 19:11:11,871][flwr][INFO] - 
[2024-10-04 19:11:11,872][flwr][INFO] - [ROUND 23]
[2024-10-04 19:11:11,872][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 19:31:20,490][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 19:35:21,629][flwr][INFO] - fit progress: (23, 0.0030043457435021564, OrderedDict([('ind_iou_0', 0.9773528095773236), ('ind_dice_liver_0', tensor(0.9857, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6299, dtype=torch.float64)), ('ind_iou_1', 0.973954613576737), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7200, dtype=torch.float64)), ('all_iou', 0.9742858402719722), ('all_dice_liver', tensor(0.9853, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7234, dtype=torch.float64))]), 34203.586978998035)
[2024-10-04 19:35:21,637][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 19:35:28,729][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 19:35:28,729][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 19:36:10,376][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 19:36:10,376][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 19:36:10,377][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 19:36:10,377][flwr][INFO] - 
[2024-10-04 19:36:10,377][flwr][INFO] - [ROUND 24]
[2024-10-04 19:36:10,377][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 19:56:19,107][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 20:00:21,911][flwr][INFO] - fit progress: (24, 0.0029767204064834255, OrderedDict([('ind_iou_0', 0.97765562415856), ('ind_dice_liver_0', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6331, dtype=torch.float64)), ('ind_iou_1', 0.9740614040606135), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7271, dtype=torch.float64)), ('all_iou', 0.9744245381453935), ('all_dice_liver', tensor(0.9853, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7305, dtype=torch.float64))]), 35703.86907092668)
[2024-10-04 20:00:21,919][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 20:00:28,727][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:00:28,727][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:01:09,883][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:01:09,883][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:01:09,884][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 20:01:09,884][flwr][INFO] - 
[2024-10-04 20:01:09,884][flwr][INFO] - [ROUND 25]
[2024-10-04 20:01:09,885][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 20:21:17,819][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 20:25:18,535][flwr][INFO] - fit progress: (25, 0.0030769878781436734, OrderedDict([('ind_iou_0', 0.9770532291346234), ('ind_dice_liver_0', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6294, dtype=torch.float64)), ('ind_iou_1', 0.9737432431673843), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7205, dtype=torch.float64)), ('all_iou', 0.9740992892284794), ('all_dice_liver', tensor(0.9855, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 37200.49263286963)
[2024-10-04 20:25:18,542][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 20:25:25,346][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:25:25,346][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:26:06,738][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:26:06,738][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:26:06,739][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 20:26:06,739][flwr][INFO] - 
[2024-10-04 20:26:06,739][flwr][INFO] - [ROUND 26]
[2024-10-04 20:26:06,739][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 20:46:15,138][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 20:50:16,038][flwr][INFO] - fit progress: (26, 0.0029397322125973664, OrderedDict([('ind_iou_0', 0.9785502022164622), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6362, dtype=torch.float64)), ('ind_iou_1', 0.9749636524452845), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7297, dtype=torch.float64)), ('all_iou', 0.9753265074346754), ('all_dice_liver', tensor(0.9861, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7340, dtype=torch.float64))]), 38697.99540777132)
[2024-10-04 20:50:16,046][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 20:50:23,437][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:50:23,438][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:51:05,154][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 20:51:05,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 20:51:05,155][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 20:51:05,155][flwr][INFO] - 
[2024-10-04 20:51:05,155][flwr][INFO] - [ROUND 27]
[2024-10-04 20:51:05,155][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 21:11:17,213][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 21:15:24,918][flwr][INFO] - fit progress: (27, 0.003036746304656229, OrderedDict([('ind_iou_0', 0.977425969752139), ('ind_dice_liver_0', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6288, dtype=torch.float64)), ('ind_iou_1', 0.9737595527636835), ('ind_dice_liver_1', tensor(0.9854, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7237, dtype=torch.float64)), ('all_iou', 0.9741071612757559), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7271, dtype=torch.float64))]), 40206.87602129765)
[2024-10-04 21:15:24,926][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 21:15:32,239][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 21:15:32,239][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 21:16:15,468][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 21:16:15,468][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 21:16:15,468][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 21:16:15,468][flwr][INFO] - 
[2024-10-04 21:16:15,469][flwr][INFO] - [ROUND 28]
[2024-10-04 21:16:15,469][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 21:36:25,430][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 21:40:33,360][flwr][INFO] - fit progress: (28, 0.0030635280342560293, OrderedDict([('ind_iou_0', 0.9780276464323182), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6379, dtype=torch.float64)), ('ind_iou_1', 0.9743188269811832), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7322, dtype=torch.float64)), ('all_iou', 0.9747412471958845), ('all_dice_liver', tensor(0.9859, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7358, dtype=torch.float64))]), 41715.31737301126)
[2024-10-04 21:40:33,367][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 21:40:40,626][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 21:40:40,627][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 21:41:23,985][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 21:41:23,985][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 21:41:23,986][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 21:41:23,986][flwr][INFO] - 
[2024-10-04 21:41:23,986][flwr][INFO] - [ROUND 29]
[2024-10-04 21:41:23,986][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 22:01:37,321][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 22:05:43,197][flwr][INFO] - fit progress: (29, 0.002909097314831942, OrderedDict([('ind_iou_0', 0.9793628666771607), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6365, dtype=torch.float64)), ('ind_iou_1', 0.9752449652136981), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7358, dtype=torch.float64)), ('all_iou', 0.9756985479053496), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7387, dtype=torch.float64))]), 43225.154152678326)
[2024-10-04 22:05:43,204][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 22:05:50,204][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 22:05:50,204][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 22:06:33,458][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 22:06:33,458][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 22:06:33,459][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 22:06:33,460][flwr][INFO] - 
[2024-10-04 22:06:33,460][flwr][INFO] - [ROUND 30]
[2024-10-04 22:06:33,460][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-04 22:26:42,649][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-04 22:30:45,349][flwr][INFO] - fit progress: (30, 0.0028950859495678305, OrderedDict([('ind_iou_0', 0.9793712962927957), ('ind_dice_liver_0', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6321, dtype=torch.float64)), ('ind_iou_1', 0.975374045631373), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.7279, dtype=torch.float64)), ('all_iou', 0.9757972240347645), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7311, dtype=torch.float64))]), 44727.30651144683)
[2024-10-04 22:30:45,356][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-04 22:30:52,186][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 22:30:52,187][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214570, ip=172.18.62.3, actor_id=743b46f5d56f69045331591301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15459c8dda00>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 22:31:34,094][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-04 22:31:34,095][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1214572, ip=172.18.62.3, actor_id=6b6f23789ac0a7b44147fce201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1554786c8a30>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-04 22:31:34,096][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-04 22:31:34,096][flwr][INFO] - 
[2024-10-04 22:31:34,096][flwr][INFO] - [SUMMARY]
[2024-10-04 22:31:34,096][flwr][INFO] - Run finished 30 round(s) in 44776.05s
[2024-10-04 22:31:34,187][flwr][INFO] - 	History (loss, centralized):
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 0: 0.5575170021079542
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 1: 0.02934991501875826
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 2: 0.009907775157657655
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 3: 0.008068044227137548
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 4: 0.006115679080148264
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 5: 0.005120454829068008
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 6: 0.004756963614004497
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 7: 0.004394150343772842
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 8: 0.004497748196122842
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 9: 0.004157913512562333
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 10: 0.003907302134319019
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 11: 0.003769933157813868
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 12: 0.0037744396955505907
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 13: 0.0035804611278892648
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 14: 0.0036875048189365977
[2024-10-04 22:31:34,188][flwr][INFO] - 		round 15: 0.0034704647720249678
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 16: 0.0034450547749419573
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 17: 0.0032826853783081093
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 18: 0.0038413047141009193
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 19: 0.003158091206747062
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 20: 0.00305148833316393
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 21: 0.0031263937151768673
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 22: 0.003138749201133077
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 23: 0.0030043457435021564
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 24: 0.0029767204064834255
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 25: 0.0030769878781436734
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 26: 0.0029397322125973664
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 27: 0.003036746304656229
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 28: 0.0030635280342560293
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 29: 0.002909097314831942
[2024-10-04 22:31:34,189][flwr][INFO] - 		round 30: 0.0028950859495678305
[2024-10-04 22:31:34,189][flwr][INFO] - 	History (metrics, centralized):
[2024-10-04 22:31:34,189][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1519, dtype=torch.float64)),
[2024-10-04 22:31:34,189][flwr][INFO] - 	                    (1, tensor(0.8601, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (2, tensor(0.9438, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (3, tensor(0.9566, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (4, tensor(0.9654, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (5, tensor(0.9723, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (6, tensor(0.9737, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (7, tensor(0.9760, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (8, tensor(0.9754, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (9, tensor(0.9770, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (10, tensor(0.9794, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (11, tensor(0.9798, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (12, tensor(0.9798, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (13, tensor(0.9808, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (14, tensor(0.9808, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (15, tensor(0.9818, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (16, tensor(0.9821, dtype=torch.float64)),
[2024-10-04 22:31:34,190][flwr][INFO] - 	                    (17, tensor(0.9833, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (18, tensor(0.9804, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (19, tensor(0.9840, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (20, tensor(0.9845, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (21, tensor(0.9847, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (22, tensor(0.9844, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (23, tensor(0.9853, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (24, tensor(0.9853, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (25, tensor(0.9855, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (26, tensor(0.9861, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (27, tensor(0.9854, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (28, tensor(0.9859, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (29, tensor(0.9864, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                    (30, tensor(0.9864, dtype=torch.float64))],
[2024-10-04 22:31:34,191][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0095, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                     (1, tensor(0.1111, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                     (2, tensor(0.4118, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                     (3, tensor(0.4232, dtype=torch.float64)),
[2024-10-04 22:31:34,191][flwr][INFO] - 	                     (4, tensor(0.5702, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (5, tensor(0.6214, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (6, tensor(0.6271, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (7, tensor(0.6484, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (8, tensor(0.6497, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (9, tensor(0.6535, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (10, tensor(0.6684, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (11, tensor(0.6824, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (12, tensor(0.6718, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (13, tensor(0.6843, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (14, tensor(0.6926, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (15, tensor(0.6913, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (16, tensor(0.6984, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (17, tensor(0.7062, dtype=torch.float64)),
[2024-10-04 22:31:34,192][flwr][INFO] - 	                     (18, tensor(0.6848, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (19, tensor(0.7174, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (20, tensor(0.7215, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (21, tensor(0.7183, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (22, tensor(0.7201, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (23, tensor(0.7234, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (24, tensor(0.7305, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (25, tensor(0.7243, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (26, tensor(0.7340, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (27, tensor(0.7271, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (28, tensor(0.7358, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (29, tensor(0.7387, dtype=torch.float64)),
[2024-10-04 22:31:34,193][flwr][INFO] - 	                     (30, tensor(0.7311, dtype=torch.float64))],
[2024-10-04 22:31:34,193][flwr][INFO] - 	 'all_iou': [(0, 1.5912025585105526e-10),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (1, 0.8959688858228723),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (2, 0.9263346042904719),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (3, 0.9348580900182325),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (4, 0.9473717788590111),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (5, 0.9553998094425686),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (6, 0.958769118829597),
[2024-10-04 22:31:34,193][flwr][INFO] - 	             (7, 0.9616509816954025),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (8, 0.9604312254010082),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (9, 0.9632859068111592),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (10, 0.9657056867820183),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (11, 0.9666242278633564),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (12, 0.9664668193480485),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (13, 0.9682524046860291),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (14, 0.9674681395692944),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (15, 0.9693495084841669),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (16, 0.9698678717797771),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (17, 0.9712528223169185),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (18, 0.9665754438326508),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (19, 0.9726313235654857),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (20, 0.9736221263261353),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (21, 0.9732341801136365),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (22, 0.9730274423603547),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (23, 0.9742858402719722),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (24, 0.9744245381453935),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (25, 0.9740992892284794),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (26, 0.9753265074346754),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (27, 0.9741071612757559),
[2024-10-04 22:31:34,194][flwr][INFO] - 	             (28, 0.9747412471958845),
[2024-10-04 22:31:34,195][flwr][INFO] - 	             (29, 0.9756985479053496),
[2024-10-04 22:31:34,195][flwr][INFO] - 	             (30, 0.9757972240347645)],
[2024-10-04 22:31:34,195][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1524, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (1, tensor(0.8496, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (2, tensor(0.9373, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (3, tensor(0.9518, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (4, tensor(0.9612, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (5, tensor(0.9702, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (6, tensor(0.9716, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (7, tensor(0.9743, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (8, tensor(0.9733, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (9, tensor(0.9759, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (10, tensor(0.9785, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (11, tensor(0.9790, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (12, tensor(0.9789, dtype=torch.float64)),
[2024-10-04 22:31:34,195][flwr][INFO] - 	                      (13, tensor(0.9802, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (14, tensor(0.9802, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (15, tensor(0.9813, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (16, tensor(0.9818, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (17, tensor(0.9834, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (18, tensor(0.9802, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (19, tensor(0.9841, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (20, tensor(0.9847, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (21, tensor(0.9848, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (22, tensor(0.9844, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (23, tensor(0.9857, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (24, tensor(0.9859, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (25, tensor(0.9859, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (26, tensor(0.9866, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (27, tensor(0.9859, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (28, tensor(0.9866, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (29, tensor(0.9872, dtype=torch.float64)),
[2024-10-04 22:31:34,196][flwr][INFO] - 	                      (30, tensor(0.9871, dtype=torch.float64))],
[2024-10-04 22:31:34,196][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1518, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (1, tensor(0.8622, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (2, tensor(0.9449, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (3, tensor(0.9571, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (4, tensor(0.9657, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (5, tensor(0.9725, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (6, tensor(0.9739, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (7, tensor(0.9763, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (8, tensor(0.9756, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (9, tensor(0.9771, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (10, tensor(0.9795, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (11, tensor(0.9799, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (12, tensor(0.9799, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (13, tensor(0.9809, dtype=torch.float64)),
[2024-10-04 22:31:34,197][flwr][INFO] - 	                      (14, tensor(0.9809, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (15, tensor(0.9818, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (16, tensor(0.9821, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (17, tensor(0.9833, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (18, tensor(0.9804, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (19, tensor(0.9840, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (20, tensor(0.9845, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (21, tensor(0.9847, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (22, tensor(0.9844, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (23, tensor(0.9852, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (24, tensor(0.9853, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (25, tensor(0.9855, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (26, tensor(0.9860, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (27, tensor(0.9854, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (28, tensor(0.9858, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (29, tensor(0.9863, dtype=torch.float64)),
[2024-10-04 22:31:34,198][flwr][INFO] - 	                      (30, tensor(0.9863, dtype=torch.float64))],
[2024-10-04 22:31:34,198][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0083, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (1, tensor(0.0648, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (2, tensor(0.3430, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (3, tensor(0.3376, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (4, tensor(0.4775, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (5, tensor(0.5304, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (6, tensor(0.5396, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (7, tensor(0.5585, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (8, tensor(0.5601, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (9, tensor(0.5655, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (10, tensor(0.5751, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (11, tensor(0.5918, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (12, tensor(0.5870, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (13, tensor(0.5945, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (14, tensor(0.6033, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (15, tensor(0.6005, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (16, tensor(0.6038, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (17, tensor(0.6159, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (18, tensor(0.5897, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (19, tensor(0.6207, dtype=torch.float64)),
[2024-10-04 22:31:34,199][flwr][INFO] - 	                       (20, tensor(0.6284, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (21, tensor(0.6249, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (22, tensor(0.6207, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (23, tensor(0.6299, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (24, tensor(0.6331, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (25, tensor(0.6294, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (26, tensor(0.6362, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (27, tensor(0.6288, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (28, tensor(0.6379, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (29, tensor(0.6365, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (30, tensor(0.6321, dtype=torch.float64))],
[2024-10-04 22:31:34,200][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0096, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (1, tensor(0.1161, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (2, tensor(0.4157, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (3, tensor(0.4275, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (4, tensor(0.5691, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (5, tensor(0.6215, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (6, tensor(0.6265, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (7, tensor(0.6478, dtype=torch.float64)),
[2024-10-04 22:31:34,200][flwr][INFO] - 	                       (8, tensor(0.6500, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (9, tensor(0.6511, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (10, tensor(0.6664, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (11, tensor(0.6797, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (12, tensor(0.6687, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (13, tensor(0.6807, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (14, tensor(0.6912, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (15, tensor(0.6887, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (16, tensor(0.6955, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (17, tensor(0.7028, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (18, tensor(0.6826, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (19, tensor(0.7135, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (20, tensor(0.7180, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (21, tensor(0.7163, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (22, tensor(0.7168, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (23, tensor(0.7200, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (24, tensor(0.7271, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (25, tensor(0.7205, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (26, tensor(0.7297, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (27, tensor(0.7237, dtype=torch.float64)),
[2024-10-04 22:31:34,201][flwr][INFO] - 	                       (28, tensor(0.7322, dtype=torch.float64)),
[2024-10-04 22:31:34,202][flwr][INFO] - 	                       (29, tensor(0.7358, dtype=torch.float64)),
[2024-10-04 22:31:34,202][flwr][INFO] - 	                       (30, tensor(0.7279, dtype=torch.float64))],
[2024-10-04 22:31:34,202][flwr][INFO] - 	 'ind_iou_0': [(0, 1.5419592718617657e-10),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (1, 0.8754435199114211),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (2, 0.9179624878984024),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (3, 0.9263890648761245),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (4, 0.9430929880699351),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (5, 0.9551154516291739),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (6, 0.9583311506156051),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (7, 0.9618806274068702),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (8, 0.9600760334811267),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (9, 0.9635910260213789),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (10, 0.9665595321234832),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (11, 0.9680994354853699),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (12, 0.9678618162907766),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (13, 0.969813759100039),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (14, 0.9686487518635383),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (15, 0.9712968388273351),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (16, 0.9715051675166304),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (17, 0.9739784494778574),
[2024-10-04 22:31:34,202][flwr][INFO] - 	               (18, 0.9685473215913585),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (19, 0.9752522695670917),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (20, 0.976544167297734),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (21, 0.9755375201822827),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (22, 0.9754013210540633),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (23, 0.9773528095773236),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (24, 0.97765562415856),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (25, 0.9770532291346234),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (26, 0.9785502022164622),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (27, 0.977425969752139),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (28, 0.9780276464323182),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (29, 0.9793628666771607),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (30, 0.9793712962927957)],
[2024-10-04 22:31:34,203][flwr][INFO] - 	 'ind_iou_1': [(0, 1.5568234532978525e-10),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (1, 0.8981156870463922),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (2, 0.9275564471127771),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (3, 0.9357663123595424),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (4, 0.9477986618381777),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (5, 0.9555494024854061),
[2024-10-04 22:31:34,203][flwr][INFO] - 	               (6, 0.9588814246684157),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (7, 0.9617714631394205),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (8, 0.9605003193739639),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (9, 0.9631760253521308),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (10, 0.9656491925298181),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (11, 0.9664881265065681),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (12, 0.9663491637222463),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (13, 0.9681038366550222),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (14, 0.9673299908394578),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (15, 0.969168965581938),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (16, 0.9696685195438036),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (17, 0.9709901686810779),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (18, 0.9663523857475483),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (19, 0.972353029052824),
[2024-10-04 22:31:34,204][flwr][INFO] - 	               (20, 0.9732731767631084),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (21, 0.972951434164231),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (22, 0.9727878725784133),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (23, 0.973954613576737),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (24, 0.9740614040606135),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (25, 0.9737432431673843),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (26, 0.9749636524452845),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (27, 0.9737595527636835),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (28, 0.9743188269811832),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (29, 0.9752449652136981),
[2024-10-04 22:31:34,205][flwr][INFO] - 	               (30, 0.975374045631373)]}
[2024-10-04 22:31:34,205][flwr][INFO] - 
