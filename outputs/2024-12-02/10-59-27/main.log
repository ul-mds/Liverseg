[2024-12-02 10:59:28,294][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-12-02 10:59:51,600][flwr][INFO] - Flower VCE: Ray initialized with resources: {'object_store_memory': 200000000000.0, 'GPU': 3.0, 'node:172.18.62.2': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 846183984128.0, 'node:__internal_head__': 1.0}
[2024-12-02 10:59:51,600][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-02 10:59:51,601][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-02 10:59:51,649][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-02 10:59:51,649][flwr][INFO] - [INIT]
[2024-12-02 10:59:51,650][flwr][INFO] - Requesting initial parameters from one random client
[2024-12-02 10:59:55,504][flwr][INFO] - Received initial parameters from one random client
[2024-12-02 10:59:55,504][flwr][INFO] - Evaluating initial global parameters
[2024-12-02 11:05:26,095][flwr][INFO] - initial parameters (loss, other metrics): 0.7025126381946659, OrderedDict([('ind_iou_0', 0.01798301739228557), ('ind_dice_liver_0', tensor(0.1541, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0086, dtype=torch.float64)), ('ind_iou_1', 0.018857945583812354), ('ind_dice_liver_1', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.018069193949506995), ('all_dice_liver', tensor(0.1539, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[2024-12-02 11:05:26,190][flwr][INFO] - 
[2024-12-02 11:05:26,190][flwr][INFO] - [ROUND 1]
[2024-12-02 11:05:26,190][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:15:12,172][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 11:15:12,197][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-12-02 11:17:48,690][flwr][INFO] - fit progress: (1, 0.06533749376143486, OrderedDict([('ind_iou_0', 0.7041531619332229), ('ind_dice_liver_0', tensor(0.8179, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1117, dtype=torch.float64)), ('ind_iou_1', 0.9375965819501104), ('ind_dice_liver_1', tensor(0.9538, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3129, dtype=torch.float64)), ('all_iou', 0.727316112938662), ('all_dice_liver', tensor(0.8313, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1339, dtype=torch.float64))]), 742.5006239442155)
[2024-12-02 11:17:48,697][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:19:08,149][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:19:08,150][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 11:19:08,150][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:19:08,151][flwr][INFO] - 
[2024-12-02 11:19:08,151][flwr][INFO] - [ROUND 2]
[2024-12-02 11:19:08,152][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:28:49,127][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 11:31:23,584][flwr][INFO] - fit progress: (2, 0.061394247736706535, OrderedDict([('ind_iou_0', 0.7194946885207562), ('ind_dice_liver_0', tensor(0.8350, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1377, dtype=torch.float64)), ('ind_iou_1', 0.944296759365001), ('ind_dice_liver_1', tensor(0.9625, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4492, dtype=torch.float64)), ('all_iou', 0.7417931011789024), ('all_dice_liver', tensor(0.8476, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1716, dtype=torch.float64))]), 1557.3939261799678)
[2024-12-02 11:31:23,587][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:32:35,001][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:32:35,001][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 11:32:35,001][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:32:35,001][flwr][INFO] - 
[2024-12-02 11:32:35,001][flwr][INFO] - [ROUND 3]
[2024-12-02 11:32:35,002][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:42:00,406][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 11:44:21,628][flwr][INFO] - fit progress: (3, 0.07691254839611181, OrderedDict([('ind_iou_0', 0.7094079618685047), ('ind_dice_liver_0', tensor(0.8313, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1225, dtype=torch.float64)), ('ind_iou_1', 0.9580016892356201), ('ind_dice_liver_1', tensor(0.9729, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4798, dtype=torch.float64)), ('all_iou', 0.7339828838071676), ('all_dice_liver', tensor(0.8453, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1610, dtype=torch.float64))]), 2335.4384021395817)
[2024-12-02 11:44:21,632][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:45:41,433][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:45:41,433][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 11:45:41,434][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:45:41,434][flwr][INFO] - 
[2024-12-02 11:45:41,434][flwr][INFO] - [ROUND 4]
[2024-12-02 11:45:41,434][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:54:49,885][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 11:57:12,654][flwr][INFO] - fit progress: (4, 0.07207691698444743, OrderedDict([('ind_iou_0', 0.7270871639813715), ('ind_dice_liver_0', tensor(0.8431, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1780, dtype=torch.float64)), ('ind_iou_1', 0.9633678403530899), ('ind_dice_liver_1', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5325, dtype=torch.float64)), ('all_iou', 0.7504383510157522), ('all_dice_liver', tensor(0.8563, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2160, dtype=torch.float64))]), 3106.46458590962)
[2024-12-02 11:57:12,658][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:58:21,061][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:58:21,061][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 11:58:21,061][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:58:21,061][flwr][INFO] - 
[2024-12-02 11:58:21,061][flwr][INFO] - [ROUND 5]
[2024-12-02 11:58:21,061][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:07:31,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 12:10:35,114][flwr][INFO] - fit progress: (5, 0.06331943691748014, OrderedDict([('ind_iou_0', 0.7419651041102922), ('ind_dice_liver_0', tensor(0.8533, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1326, dtype=torch.float64)), ('ind_iou_1', 0.9625522077531313), ('ind_dice_liver_1', tensor(0.9764, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5092, dtype=torch.float64)), ('all_iou', 0.7637925635909898), ('all_dice_liver', tensor(0.8654, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1728, dtype=torch.float64))]), 3908.924595230259)
[2024-12-02 12:10:35,118][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:11:45,647][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 12:11:45,647][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:11:45,647][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:11:45,647][flwr][INFO] - 
[2024-12-02 12:11:45,648][flwr][INFO] - [ROUND 6]
[2024-12-02 12:11:45,648][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:20:43,963][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 12:23:06,848][flwr][INFO] - fit progress: (6, 0.07585824414928234, OrderedDict([('ind_iou_0', 0.7224517294530366), ('ind_dice_liver_0', tensor(0.8398, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1447, dtype=torch.float64)), ('ind_iou_1', 0.9633174649826567), ('ind_dice_liver_1', tensor(0.9770, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5303, dtype=torch.float64)), ('all_iou', 0.74626084945478), ('all_dice_liver', tensor(0.8534, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1858, dtype=torch.float64))]), 4660.658047207631)
[2024-12-02 12:23:06,851][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:24:16,312][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 12:24:16,313][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:24:16,314][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:24:16,314][flwr][INFO] - 
[2024-12-02 12:24:16,314][flwr][INFO] - [ROUND 7]
[2024-12-02 12:24:16,314][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:33:56,807][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 12:36:35,214][flwr][INFO] - fit progress: (7, 0.0897120629245134, OrderedDict([('ind_iou_0', 0.7218763264937371), ('ind_dice_liver_0', tensor(0.8418, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9692948080432837), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5715, dtype=torch.float64)), ('all_iou', 0.7463114849414169), ('all_dice_liver', tensor(0.8556, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2196, dtype=torch.float64))]), 5469.0244574462995)
[2024-12-02 12:36:35,218][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:37:52,020][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 12:37:52,021][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:37:52,022][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:37:52,022][flwr][INFO] - 
[2024-12-02 12:37:52,022][flwr][INFO] - [ROUND 8]
[2024-12-02 12:37:52,022][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:47:36,070][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 12:50:13,814][flwr][INFO] - fit progress: (8, 0.10556496886999371, OrderedDict([('ind_iou_0', 0.7023686250431647), ('ind_dice_liver_0', tensor(0.8287, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1529, dtype=torch.float64)), ('ind_iou_1', 0.9701511841865161), ('ind_dice_liver_1', tensor(0.9827, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5772, dtype=torch.float64)), ('all_iou', 0.7288425552887139), ('all_dice_liver', tensor(0.8439, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1987, dtype=torch.float64))]), 6287.6246060896665)
[2024-12-02 12:50:13,818][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:51:32,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 12:51:32,389][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:51:32,389][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:51:32,390][flwr][INFO] - 
[2024-12-02 12:51:32,390][flwr][INFO] - [ROUND 9]
[2024-12-02 12:51:32,390][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:01:02,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 13:03:38,155][flwr][INFO] - fit progress: (9, 0.09029007634307468, OrderedDict([('ind_iou_0', 0.721936273853132), ('ind_dice_liver_0', tensor(0.8439, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1838, dtype=torch.float64)), ('ind_iou_1', 0.9720497372165715), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5878, dtype=torch.float64)), ('all_iou', 0.7466206317299993), ('all_dice_liver', tensor(0.8578, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2268, dtype=torch.float64))]), 7091.965386918746)
[2024-12-02 13:03:38,159][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:04:58,077][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 13:04:58,078][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:04:58,079][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:04:58,079][flwr][INFO] - 
[2024-12-02 13:04:58,079][flwr][INFO] - [ROUND 10]
[2024-12-02 13:04:58,079][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:14:36,214][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 13:17:11,394][flwr][INFO] - fit progress: (10, 0.09569710588180122, OrderedDict([('ind_iou_0', 0.7320079239608482), ('ind_dice_liver_0', tensor(0.8506, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1814, dtype=torch.float64)), ('ind_iou_1', 0.9719249580257454), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5883, dtype=torch.float64)), ('all_iou', 0.7557082247861632), ('all_dice_liver', tensor(0.8638, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 7905.204765388742)
[2024-12-02 13:17:11,398][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:18:29,912][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 13:18:29,912][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:18:29,912][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:18:29,912][flwr][INFO] - 
[2024-12-02 13:18:29,912][flwr][INFO] - [ROUND 11]
[2024-12-02 13:18:29,912][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:28:02,519][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 13:30:40,363][flwr][INFO] - fit progress: (11, 0.09649466932446704, OrderedDict([('ind_iou_0', 0.7312641775839636), ('ind_dice_liver_0', tensor(0.8509, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2031, dtype=torch.float64)), ('ind_iou_1', 0.9731929023227956), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5917, dtype=torch.float64)), ('all_iou', 0.7551510841301642), ('all_dice_liver', tensor(0.8641, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2450, dtype=torch.float64))]), 8714.172932119109)
[2024-12-02 13:30:40,366][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:31:54,603][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 13:31:54,603][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:31:54,604][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:31:54,604][flwr][INFO] - 
[2024-12-02 13:31:54,604][flwr][INFO] - [ROUND 12]
[2024-12-02 13:31:54,605][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:41:46,375][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 13:44:29,617][flwr][INFO] - fit progress: (12, 0.09931049717786222, OrderedDict([('ind_iou_0', 0.7307315109103913), ('ind_dice_liver_0', tensor(0.8512, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1831, dtype=torch.float64)), ('ind_iou_1', 0.9751504991954452), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6070, dtype=torch.float64)), ('all_iou', 0.7548512285605786), ('all_dice_liver', tensor(0.8645, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2284, dtype=torch.float64))]), 9543.427189936861)
[2024-12-02 13:44:29,621][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:45:43,655][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 13:45:43,656][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:45:43,660][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:45:43,660][flwr][INFO] - 
[2024-12-02 13:45:43,661][flwr][INFO] - [ROUND 13]
[2024-12-02 13:45:43,661][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:55:27,315][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 13:57:55,701][flwr][INFO] - fit progress: (13, 0.09290033466388625, OrderedDict([('ind_iou_0', 0.7362298969330995), ('ind_dice_liver_0', tensor(0.8551, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1851, dtype=torch.float64)), ('ind_iou_1', 0.9727027078988038), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5923, dtype=torch.float64)), ('all_iou', 0.7595787382708291), ('all_dice_liver', tensor(0.8679, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2285, dtype=torch.float64))]), 10349.511825078167)
[2024-12-02 13:57:55,705][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:59:07,934][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 13:59:07,936][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:59:07,937][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:59:07,937][flwr][INFO] - 
[2024-12-02 13:59:07,937][flwr][INFO] - [ROUND 14]
[2024-12-02 13:59:07,937][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:08:55,515][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 14:11:26,233][flwr][INFO] - fit progress: (14, 0.10395984017499474, OrderedDict([('ind_iou_0', 0.7372483988966657), ('ind_dice_liver_0', tensor(0.8560, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1852, dtype=torch.float64)), ('ind_iou_1', 0.9740743225676086), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5949, dtype=torch.float64)), ('all_iou', 0.7606229436488575), ('all_dice_liver', tensor(0.8688, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2286, dtype=torch.float64))]), 11160.043261723593)
[2024-12-02 14:11:26,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:12:42,766][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 14:12:42,766][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:12:42,767][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:12:42,767][flwr][INFO] - 
[2024-12-02 14:12:42,767][flwr][INFO] - [ROUND 15]
[2024-12-02 14:12:42,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:22:11,855][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 14:24:46,012][flwr][INFO] - fit progress: (15, 0.10052120273558514, OrderedDict([('ind_iou_0', 0.7205718522029123), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1878, dtype=torch.float64)), ('ind_iou_1', 0.9742031996262013), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6006, dtype=torch.float64)), ('all_iou', 0.7455866286429177), ('all_dice_liver', tensor(0.8586, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2314, dtype=torch.float64))]), 11959.822050550953)
[2024-12-02 14:24:46,015][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:26:06,506][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 14:26:06,506][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:26:06,506][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:26:06,507][flwr][INFO] - 
[2024-12-02 14:26:06,507][flwr][INFO] - [ROUND 16]
[2024-12-02 14:26:06,507][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:35:38,245][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 14:38:09,707][flwr][INFO] - fit progress: (16, 0.10332481511397892, OrderedDict([('ind_iou_0', 0.7232672097729499), ('ind_dice_liver_0', tensor(0.8457, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1939, dtype=torch.float64)), ('ind_iou_1', 0.9740651857748662), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6042, dtype=torch.float64)), ('all_iou', 0.748020095222177), ('all_dice_liver', tensor(0.8595, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2378, dtype=torch.float64))]), 12763.517516203225)
[2024-12-02 14:38:09,711][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:39:25,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 14:39:25,141][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:39:25,141][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:39:25,141][flwr][INFO] - 
[2024-12-02 14:39:25,141][flwr][INFO] - [ROUND 17]
[2024-12-02 14:39:25,141][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:48:59,762][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 14:51:38,777][flwr][INFO] - fit progress: (17, 0.10705830874685619, OrderedDict([('ind_iou_0', 0.7291407390627709), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1582, dtype=torch.float64)), ('ind_iou_1', 0.9749448409879337), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6004, dtype=torch.float64)), ('all_iou', 0.7533919837400301), ('all_dice_liver', tensor(0.8636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2047, dtype=torch.float64))]), 13572.587025783956)
[2024-12-02 14:51:38,781][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:52:58,015][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 14:52:58,016][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:52:58,016][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:52:58,017][flwr][INFO] - 
[2024-12-02 14:52:58,017][flwr][INFO] - [ROUND 18]
[2024-12-02 14:52:58,021][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:02:38,706][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 15:05:09,067][flwr][INFO] - fit progress: (18, 0.11272720182829456, OrderedDict([('ind_iou_0', 0.7316116301981007), ('ind_dice_liver_0', tensor(0.8534, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9750643659019975), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6186, dtype=torch.float64)), ('all_iou', 0.7556379610584132), ('all_dice_liver', tensor(0.8666, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2340, dtype=torch.float64))]), 14382.876874608919)
[2024-12-02 15:05:09,071][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:06:30,700][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 15:06:30,701][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:06:30,702][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:06:30,702][flwr][INFO] - 
[2024-12-02 15:06:30,702][flwr][INFO] - [ROUND 19]
[2024-12-02 15:06:30,702][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:16:15,042][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 15:18:56,289][flwr][INFO] - fit progress: (19, 0.11003257228885462, OrderedDict([('ind_iou_0', 0.7306175085206605), ('ind_dice_liver_0', tensor(0.8516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1595, dtype=torch.float64)), ('ind_iou_1', 0.9743329883733235), ('ind_dice_liver_1', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6010, dtype=torch.float64)), ('all_iou', 0.7546480231703984), ('all_dice_liver', tensor(0.8650, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2062, dtype=torch.float64))]), 15210.099638123065)
[2024-12-02 15:18:56,293][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:20:16,298][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 15:20:16,298][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:20:16,299][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:20:16,299][flwr][INFO] - 
[2024-12-02 15:20:16,300][flwr][INFO] - [ROUND 20]
[2024-12-02 15:20:16,300][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:29:39,629][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 15:32:11,845][flwr][INFO] - fit progress: (20, 0.12063597879504318, OrderedDict([('ind_iou_0', 0.7274818247053653), ('ind_dice_liver_0', tensor(0.8502, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1828, dtype=torch.float64)), ('ind_iou_1', 0.9747492124143237), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6117, dtype=torch.float64)), ('all_iou', 0.751880585438273), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2282, dtype=torch.float64))]), 16005.654988894239)
[2024-12-02 15:32:11,848][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:33:32,193][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 15:33:32,193][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:33:32,193][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:33:32,194][flwr][INFO] - 
[2024-12-02 15:33:32,194][flwr][INFO] - [ROUND 21]
[2024-12-02 15:33:32,194][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:43:20,633][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 15:46:01,206][flwr][INFO] - fit progress: (21, 0.12181818578176325, OrderedDict([('ind_iou_0', 0.7259691697398462), ('ind_dice_liver_0', tensor(0.8499, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1862, dtype=torch.float64)), ('ind_iou_1', 0.9751794542399312), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6136, dtype=torch.float64)), ('all_iou', 0.7505551985901607), ('all_dice_liver', tensor(0.8635, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2313, dtype=torch.float64))]), 16835.016364563257)
[2024-12-02 15:46:01,210][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:47:20,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 15:47:20,624][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:47:20,624][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:47:20,624][flwr][INFO] - 
[2024-12-02 15:47:20,625][flwr][INFO] - [ROUND 22]
[2024-12-02 15:47:20,625][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:56:54,703][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 15:59:27,471][flwr][INFO] - fit progress: (22, 0.12501691785296615, OrderedDict([('ind_iou_0', 0.7269812776285638), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.9750270047811321), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6100, dtype=torch.float64)), ('all_iou', 0.7514634898345732), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 17641.281647524796)
[2024-12-02 15:59:27,475][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:00:42,409][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 16:00:42,410][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:00:42,410][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:00:42,410][flwr][INFO] - 
[2024-12-02 16:00:42,410][flwr][INFO] - [ROUND 23]
[2024-12-02 16:00:42,410][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:10:26,966][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 16:12:58,303][flwr][INFO] - fit progress: (23, 0.12641964560500862, OrderedDict([('ind_iou_0', 0.7237389437328068), ('ind_dice_liver_0', tensor(0.8476, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1639, dtype=torch.float64)), ('ind_iou_1', 0.9746424105262835), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6072, dtype=torch.float64)), ('all_iou', 0.7484836549077853), ('all_dice_liver', tensor(0.8614, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2104, dtype=torch.float64))]), 18452.11366850231)
[2024-12-02 16:12:58,307][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:14:17,809][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 16:14:17,809][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:14:17,810][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:14:17,810][flwr][INFO] - 
[2024-12-02 16:14:17,810][flwr][INFO] - [ROUND 24]
[2024-12-02 16:14:17,811][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:24:08,962][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 16:26:46,834][flwr][INFO] - fit progress: (24, 0.14115346669951426, OrderedDict([('ind_iou_0', 0.7261652971136258), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1709, dtype=torch.float64)), ('ind_iou_1', 0.9750677650726011), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6147, dtype=torch.float64)), ('all_iou', 0.7507343272368976), ('all_dice_liver', tensor(0.8633, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2176, dtype=torch.float64))]), 19280.644142654724)
[2024-12-02 16:26:46,838][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:28:08,071][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 16:28:08,072][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:28:08,072][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:28:08,072][flwr][INFO] - 
[2024-12-02 16:28:08,072][flwr][INFO] - [ROUND 25]
[2024-12-02 16:28:08,072][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:37:52,051][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 16:40:31,465][flwr][INFO] - fit progress: (25, 0.145335698921198, OrderedDict([('ind_iou_0', 0.715965063410553), ('ind_dice_liver_0', tensor(0.8416, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1812, dtype=torch.float64)), ('ind_iou_1', 0.9749645790131531), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6046, dtype=torch.float64)), ('all_iou', 0.7415246571227045), ('all_dice_liver', tensor(0.8560, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2261, dtype=torch.float64))]), 20105.274953315966)
[2024-12-02 16:40:31,468][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:41:48,724][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 16:41:48,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:41:48,724][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:41:48,725][flwr][INFO] - 
[2024-12-02 16:41:48,725][flwr][INFO] - [ROUND 26]
[2024-12-02 16:41:48,725][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:51:26,645][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 16:54:01,816][flwr][INFO] - fit progress: (26, 0.145688148781294, OrderedDict([('ind_iou_0', 0.7166411077297714), ('ind_dice_liver_0', tensor(0.8424, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1638, dtype=torch.float64)), ('ind_iou_1', 0.9752426309106433), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6110, dtype=torch.float64)), ('all_iou', 0.7421560010601862), ('all_dice_liver', tensor(0.8567, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2107, dtype=torch.float64))]), 20915.62586519867)
[2024-12-02 16:54:01,819][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:55:16,710][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 16:55:16,710][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:55:16,711][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:55:16,711][flwr][INFO] - 
[2024-12-02 16:55:16,711][flwr][INFO] - [ROUND 27]
[2024-12-02 16:55:16,712][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:04:54,224][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 17:07:42,252][flwr][INFO] - fit progress: (27, 0.1439196403845414, OrderedDict([('ind_iou_0', 0.7228876470446968), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1647, dtype=torch.float64)), ('ind_iou_1', 0.974704673544276), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.7477293069758247), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2106, dtype=torch.float64))]), 21736.062817586586)
[2024-12-02 17:07:42,256][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:09:01,871][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 17:09:01,871][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:09:01,871][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:09:01,871][flwr][INFO] - 
[2024-12-02 17:09:01,871][flwr][INFO] - [ROUND 28]
[2024-12-02 17:09:01,872][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:18:37,892][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 17:21:17,165][flwr][INFO] - fit progress: (28, 0.10407194326926293, OrderedDict([('ind_iou_0', 0.7150969245980148), ('ind_dice_liver_0', tensor(0.8399, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1748, dtype=torch.float64)), ('ind_iou_1', 0.9748310864525674), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6121, dtype=torch.float64)), ('all_iou', 0.7407270313668036), ('all_dice_liver', tensor(0.8544, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2210, dtype=torch.float64))]), 22550.975610208698)
[2024-12-02 17:21:17,169][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:22:37,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 17:22:37,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:22:37,918][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:22:37,918][flwr][INFO] - 
[2024-12-02 17:22:37,918][flwr][INFO] - [ROUND 29]
[2024-12-02 17:22:37,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:32:07,938][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 17:34:42,223][flwr][INFO] - fit progress: (29, 0.13381527420000464, OrderedDict([('ind_iou_0', 0.7251840270681922), ('ind_dice_liver_0', tensor(0.8489, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1764, dtype=torch.float64)), ('ind_iou_1', 0.974930778806632), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6073, dtype=torch.float64)), ('all_iou', 0.7498316317235971), ('all_dice_liver', tensor(0.8626, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2220, dtype=torch.float64))]), 23356.033204157837)
[2024-12-02 17:34:42,226][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:35:56,245][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 17:35:56,246][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:35:56,246][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:35:56,246][flwr][INFO] - 
[2024-12-02 17:35:56,247][flwr][INFO] - [ROUND 30]
[2024-12-02 17:35:56,247][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:45:32,235][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 17:48:06,354][flwr][INFO] - fit progress: (30, 0.13423243710675967, OrderedDict([('ind_iou_0', 0.7251276649787706), ('ind_dice_liver_0', tensor(0.8487, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1767, dtype=torch.float64)), ('ind_iou_1', 0.9749845369549209), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6064, dtype=torch.float64)), ('all_iou', 0.749790806966832), ('all_dice_liver', tensor(0.8624, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2223, dtype=torch.float64))]), 24160.164721524343)
[2024-12-02 17:48:06,358][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:49:25,865][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 17:49:25,865][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:49:25,866][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:49:25,866][flwr][INFO] - 
[2024-12-02 17:49:25,866][flwr][INFO] - [ROUND 31]
[2024-12-02 17:49:25,866][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:59:11,887][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 18:01:47,154][flwr][INFO] - fit progress: (31, 0.14497658857880835, OrderedDict([('ind_iou_0', 0.7218559494756757), ('ind_dice_liver_0', tensor(0.8465, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1750, dtype=torch.float64)), ('ind_iou_1', 0.975331847743366), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6085, dtype=torch.float64)), ('all_iou', 0.7468716469303294), ('all_dice_liver', tensor(0.8605, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2209, dtype=torch.float64))]), 24980.96465636231)
[2024-12-02 18:01:47,158][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:03:07,239][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 18:03:07,240][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:03:07,240][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:03:07,240][flwr][INFO] - 
[2024-12-02 18:03:07,241][flwr][INFO] - [ROUND 32]
[2024-12-02 18:03:07,241][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:12:44,317][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 18:15:23,832][flwr][INFO] - fit progress: (32, 0.1490333661126963, OrderedDict([('ind_iou_0', 0.7244723153791756), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1687, dtype=torch.float64)), ('ind_iou_1', 0.9753367262195519), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7492265490148974), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2154, dtype=torch.float64))]), 25797.642084081657)
[2024-12-02 18:15:23,835][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:16:38,756][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 18:16:38,757][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:16:38,757][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:16:38,757][flwr][INFO] - 
[2024-12-02 18:16:38,758][flwr][INFO] - [ROUND 33]
[2024-12-02 18:16:38,758][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:27:25,000][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 18:31:06,993][flwr][INFO] - fit progress: (33, 0.15407388924740645, OrderedDict([('ind_iou_0', 0.719385541729906), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1674, dtype=torch.float64)), ('ind_iou_1', 0.9752021171127921), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6144, dtype=torch.float64)), ('all_iou', 0.7446340566078806), ('all_dice_liver', tensor(0.8588, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2143, dtype=torch.float64))]), 26740.803437235765)
[2024-12-02 18:31:06,997][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:32:30,640][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 18:32:30,641][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:32:30,641][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:32:30,642][flwr][INFO] - 
[2024-12-02 18:32:30,642][flwr][INFO] - [ROUND 34]
[2024-12-02 18:32:30,642][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:43:45,241][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 18:46:42,516][flwr][INFO] - fit progress: (34, 0.12359339377934758, OrderedDict([('ind_iou_0', 0.722000433033335), ('ind_dice_liver_0', tensor(0.8464, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1656, dtype=torch.float64)), ('ind_iou_1', 0.9750464313811438), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7469834162389144), ('all_dice_liver', tensor(0.8603, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2126, dtype=torch.float64))]), 27676.32599514723)
[2024-12-02 18:46:42,519][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:48:03,654][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 18:48:03,654][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:48:03,654][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:48:03,655][flwr][INFO] - 
[2024-12-02 18:48:03,655][flwr][INFO] - [ROUND 35]
[2024-12-02 18:48:03,655][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:57:40,031][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 19:00:19,121][flwr][INFO] - fit progress: (35, 0.1513446753040647, OrderedDict([('ind_iou_0', 0.7247695011816836), ('ind_dice_liver_0', tensor(0.8495, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9753209283612883), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6208, dtype=torch.float64)), ('all_iou', 0.7494996712214848), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2341, dtype=torch.float64))]), 28492.9313440891)
[2024-12-02 19:00:19,124][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:01:41,386][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 19:01:41,386][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:01:41,387][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:01:41,387][flwr][INFO] - 
[2024-12-02 19:01:41,387][flwr][INFO] - [ROUND 36]
[2024-12-02 19:01:41,388][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:12:26,105][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 19:15:29,467][flwr][INFO] - fit progress: (36, 0.1520834437976774, OrderedDict([('ind_iou_0', 0.7238246357946218), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1853, dtype=torch.float64)), ('ind_iou_1', 0.9753277144781742), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7486477461270815), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2304, dtype=torch.float64))]), 29403.277303904295)
[2024-12-02 19:15:29,470][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:16:52,772][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 19:16:52,773][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:16:52,774][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:16:52,774][flwr][INFO] - 
[2024-12-02 19:16:52,774][flwr][INFO] - [ROUND 37]
[2024-12-02 19:16:52,774][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:26:27,925][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 19:29:29,636][flwr][INFO] - fit progress: (37, 0.15254300538872398, OrderedDict([('ind_iou_0', 0.7263629967892827), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9751100342387964), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6180, dtype=torch.float64)), ('all_iou', 0.7509109777724438), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2236, dtype=torch.float64))]), 30243.44679978583)
[2024-12-02 19:29:29,640][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:30:47,744][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 19:30:47,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:30:47,745][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:30:47,745][flwr][INFO] - 
[2024-12-02 19:30:47,745][flwr][INFO] - [ROUND 38]
[2024-12-02 19:30:47,746][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:40:30,955][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 19:42:59,393][flwr][INFO] - fit progress: (38, 0.15611548511943737, OrderedDict([('ind_iou_0', 0.7226870228934359), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1680, dtype=torch.float64)), ('ind_iou_1', 0.9750581862326032), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6096, dtype=torch.float64)), ('all_iou', 0.7475960839987092), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2147, dtype=torch.float64))]), 31053.203277233988)
[2024-12-02 19:42:59,397][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:44:14,831][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 19:44:14,832][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:44:14,833][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:44:14,833][flwr][INFO] - 
[2024-12-02 19:44:14,834][flwr][INFO] - [ROUND 39]
[2024-12-02 19:44:14,834][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:54:53,969][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 19:57:35,366][flwr][INFO] - fit progress: (39, 0.1617509433337433, OrderedDict([('ind_iou_0', 0.725677992368557), ('ind_dice_liver_0', tensor(0.8494, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.975357226864584), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6159, dtype=torch.float64)), ('all_iou', 0.7503227118118482), ('all_dice_liver', tensor(0.8631, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2254, dtype=torch.float64))]), 31929.176393420435)
[2024-12-02 19:57:35,369][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:58:49,189][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 19:58:49,189][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:58:49,189][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:58:49,190][flwr][INFO] - 
[2024-12-02 19:58:49,190][flwr][INFO] - [ROUND 40]
[2024-12-02 19:58:49,190][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 20:08:45,879][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-02 20:11:21,049][flwr][INFO] - fit progress: (40, 0.17482483374900612, OrderedDict([('ind_iou_0', 0.7220656703344716), ('ind_dice_liver_0', tensor(0.8470, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1740, dtype=torch.float64)), ('ind_iou_1', 0.9755206556225807), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.7470864741444693), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2212, dtype=torch.float64))]), 32754.85919907689)
[2024-12-02 20:11:21,052][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 20:12:41,986][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 20:12:41,987][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 20:12:41,988][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 20:12:41,988][flwr][INFO] - 
[2024-12-02 20:12:41,988][flwr][INFO] - [SUMMARY]
[2024-12-02 20:12:41,988][flwr][INFO] - Run finished 40 round(s) in 32835.80s
[2024-12-02 20:12:42,118][flwr][INFO] - 	History (loss, centralized):
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 0: 0.7025126381946659
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 1: 0.06533749376143486
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 2: 0.061394247736706535
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 3: 0.07691254839611181
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 4: 0.07207691698444743
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 5: 0.06331943691748014
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 6: 0.07585824414928234
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 7: 0.0897120629245134
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 8: 0.10556496886999371
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 9: 0.09029007634307468
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 10: 0.09569710588180122
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 11: 0.09649466932446704
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 12: 0.09931049717786222
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 13: 0.09290033466388625
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 14: 0.10395984017499474
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 15: 0.10052120273558514
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 16: 0.10332481511397892
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 17: 0.10705830874685619
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 18: 0.11272720182829456
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 19: 0.11003257228885462
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 20: 0.12063597879504318
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 21: 0.12181818578176325
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 22: 0.12501691785296615
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 23: 0.12641964560500862
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 24: 0.14115346669951426
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 25: 0.145335698921198
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 26: 0.145688148781294
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 27: 0.1439196403845414
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 28: 0.10407194326926293
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 29: 0.13381527420000464
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 30: 0.13423243710675967
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 31: 0.14497658857880835
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 32: 0.1490333661126963
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 33: 0.15407388924740645
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 34: 0.12359339377934758
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 35: 0.1513446753040647
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 36: 0.1520834437976774
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 37: 0.15254300538872398
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 38: 0.15611548511943737
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 39: 0.1617509433337433
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 40: 0.17482483374900612
[2024-12-02 20:12:42,120][flwr][INFO] - 	History (metrics, centralized):
[2024-12-02 20:12:42,120][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1539, dtype=torch.float64)),
[2024-12-02 20:12:42,120][flwr][INFO] - 	                    (1, tensor(0.8313, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (2, tensor(0.8476, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (3, tensor(0.8453, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (4, tensor(0.8563, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (5, tensor(0.8654, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (6, tensor(0.8534, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (7, tensor(0.8556, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (8, tensor(0.8439, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (9, tensor(0.8578, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (10, tensor(0.8638, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (11, tensor(0.8641, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (12, tensor(0.8645, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (13, tensor(0.8679, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (14, tensor(0.8688, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (15, tensor(0.8586, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (16, tensor(0.8595, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (17, tensor(0.8636, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (18, tensor(0.8666, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (19, tensor(0.8650, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (20, tensor(0.8637, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (21, tensor(0.8635, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (22, tensor(0.8632, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (23, tensor(0.8614, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (24, tensor(0.8633, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (25, tensor(0.8560, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (26, tensor(0.8567, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (27, tensor(0.8610, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (28, tensor(0.8544, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (29, tensor(0.8626, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (30, tensor(0.8624, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (31, tensor(0.8605, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (32, tensor(0.8621, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (33, tensor(0.8588, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (34, tensor(0.8603, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (35, tensor(0.8632, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (36, tensor(0.8621, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (37, tensor(0.8637, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (38, tensor(0.8610, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                    (39, tensor(0.8631, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                    (40, tensor(0.8610, dtype=torch.float64))],
[2024-12-02 20:12:42,123][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (1, tensor(0.1339, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (2, tensor(0.1716, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (3, tensor(0.1610, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (4, tensor(0.2160, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (5, tensor(0.1728, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (6, tensor(0.1858, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (7, tensor(0.2196, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (8, tensor(0.1987, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (9, tensor(0.2268, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (10, tensor(0.2247, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (11, tensor(0.2450, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (12, tensor(0.2284, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (13, tensor(0.2285, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (14, tensor(0.2286, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (15, tensor(0.2314, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (16, tensor(0.2378, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (17, tensor(0.2047, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (18, tensor(0.2340, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (19, tensor(0.2062, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (20, tensor(0.2282, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (21, tensor(0.2313, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (22, tensor(0.2247, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (23, tensor(0.2104, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (24, tensor(0.2176, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (25, tensor(0.2261, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (26, tensor(0.2107, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (27, tensor(0.2106, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (28, tensor(0.2210, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (29, tensor(0.2220, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (30, tensor(0.2223, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (31, tensor(0.2209, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (32, tensor(0.2154, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (33, tensor(0.2143, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (34, tensor(0.2126, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (35, tensor(0.2341, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (36, tensor(0.2304, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (37, tensor(0.2236, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (38, tensor(0.2147, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (39, tensor(0.2254, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (40, tensor(0.2212, dtype=torch.float64))],
[2024-12-02 20:12:42,125][flwr][INFO] - 	 'all_iou': [(0, 0.018069193949506995),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (1, 0.727316112938662),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (2, 0.7417931011789024),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (3, 0.7339828838071676),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (4, 0.7504383510157522),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (5, 0.7637925635909898),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (6, 0.74626084945478),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (7, 0.7463114849414169),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (8, 0.7288425552887139),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (9, 0.7466206317299993),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (10, 0.7557082247861632),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (11, 0.7551510841301642),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (12, 0.7548512285605786),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (13, 0.7595787382708291),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (14, 0.7606229436488575),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (15, 0.7455866286429177),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (16, 0.748020095222177),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (17, 0.7533919837400301),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (18, 0.7556379610584132),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (19, 0.7546480231703984),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (20, 0.751880585438273),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (21, 0.7505551985901607),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (22, 0.7514634898345732),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (23, 0.7484836549077853),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (24, 0.7507343272368976),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (25, 0.7415246571227045),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (26, 0.7421560010601862),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (27, 0.7477293069758247),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (28, 0.7407270313668036),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (29, 0.7498316317235971),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (30, 0.749790806966832),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (31, 0.7468716469303294),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (32, 0.7492265490148974),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (33, 0.7446340566078806),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (34, 0.7469834162389144),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (35, 0.7494996712214848),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (36, 0.7486477461270815),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (37, 0.7509109777724438),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (38, 0.7475960839987092),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (39, 0.7503227118118482),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (40, 0.7470864741444693)],
[2024-12-02 20:12:42,127][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1541, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (1, tensor(0.8179, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (2, tensor(0.8350, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (3, tensor(0.8313, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (4, tensor(0.8431, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (5, tensor(0.8533, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (6, tensor(0.8398, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (7, tensor(0.8418, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (8, tensor(0.8287, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (9, tensor(0.8439, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (10, tensor(0.8506, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (11, tensor(0.8509, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (12, tensor(0.8512, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (13, tensor(0.8551, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (14, tensor(0.8560, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (15, tensor(0.8447, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (16, tensor(0.8457, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (17, tensor(0.8501, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (18, tensor(0.8534, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (19, tensor(0.8516, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (20, tensor(0.8502, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (21, tensor(0.8499, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (22, tensor(0.8496, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (23, tensor(0.8476, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (24, tensor(0.8496, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (25, tensor(0.8416, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (26, tensor(0.8424, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (27, tensor(0.8471, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (28, tensor(0.8399, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (29, tensor(0.8489, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (30, tensor(0.8487, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (31, tensor(0.8465, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (32, tensor(0.8483, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (33, tensor(0.8447, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (34, tensor(0.8464, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (35, tensor(0.8495, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (36, tensor(0.8483, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (37, tensor(0.8501, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (38, tensor(0.8471, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (39, tensor(0.8494, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (40, tensor(0.8470, dtype=torch.float64))],
[2024-12-02 20:12:42,129][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1523, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (1, tensor(0.9538, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (2, tensor(0.9625, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (3, tensor(0.9729, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (4, tensor(0.9766, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (5, tensor(0.9764, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (6, tensor(0.9770, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (7, tensor(0.9817, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (8, tensor(0.9827, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (9, tensor(0.9839, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (10, tensor(0.9842, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (11, tensor(0.9852, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (12, tensor(0.9864, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (13, tensor(0.9851, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (14, tensor(0.9862, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (15, tensor(0.9856, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (16, tensor(0.9861, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (17, tensor(0.9869, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (18, tensor(0.9870, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (19, tensor(0.9867, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (20, tensor(0.9872, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (21, tensor(0.9875, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (22, tensor(0.9874, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (23, tensor(0.9874, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (24, tensor(0.9877, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (25, tensor(0.9877, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (26, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (27, tensor(0.9878, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (28, tensor(0.9869, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (29, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (30, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (31, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (32, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (33, tensor(0.9880, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (34, tensor(0.9876, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (35, tensor(0.9882, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (36, tensor(0.9883, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (37, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (38, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (39, tensor(0.9883, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (40, tensor(0.9884, dtype=torch.float64))],
[2024-12-02 20:12:42,131][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0086, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (1, tensor(0.1117, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (2, tensor(0.1377, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (3, tensor(0.1225, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (4, tensor(0.1780, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (5, tensor(0.1326, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (6, tensor(0.1447, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (7, tensor(0.1775, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (8, tensor(0.1529, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (9, tensor(0.1838, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (10, tensor(0.1814, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (11, tensor(0.2031, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (12, tensor(0.1831, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (13, tensor(0.1851, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (14, tensor(0.1852, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (15, tensor(0.1878, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (16, tensor(0.1939, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (17, tensor(0.1582, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (18, tensor(0.1886, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (19, tensor(0.1595, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (20, tensor(0.1828, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (21, tensor(0.1862, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (22, tensor(0.1794, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (23, tensor(0.1639, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (24, tensor(0.1709, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (25, tensor(0.1812, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (26, tensor(0.1638, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (27, tensor(0.1647, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (28, tensor(0.1748, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (29, tensor(0.1764, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (30, tensor(0.1767, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (31, tensor(0.1750, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (32, tensor(0.1687, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (33, tensor(0.1674, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (34, tensor(0.1656, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (35, tensor(0.1886, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (36, tensor(0.1853, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (37, tensor(0.1775, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (38, tensor(0.1680, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (39, tensor(0.1794, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (40, tensor(0.1740, dtype=torch.float64))],
[2024-12-02 20:12:42,133][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (1, tensor(0.3129, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (2, tensor(0.4492, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (3, tensor(0.4798, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (4, tensor(0.5325, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (5, tensor(0.5092, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (6, tensor(0.5303, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (7, tensor(0.5715, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (8, tensor(0.5772, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (9, tensor(0.5878, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (10, tensor(0.5883, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (11, tensor(0.5917, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (12, tensor(0.6070, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (13, tensor(0.5923, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (14, tensor(0.5949, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (15, tensor(0.6006, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (16, tensor(0.6042, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (17, tensor(0.6004, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (18, tensor(0.6186, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (19, tensor(0.6010, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (20, tensor(0.6117, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (21, tensor(0.6136, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (22, tensor(0.6100, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (23, tensor(0.6072, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (24, tensor(0.6147, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (25, tensor(0.6046, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (26, tensor(0.6110, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (27, tensor(0.6000, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (28, tensor(0.6121, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (29, tensor(0.6073, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (30, tensor(0.6064, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (31, tensor(0.6085, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (32, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (33, tensor(0.6144, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (34, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (35, tensor(0.6208, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (36, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (37, tensor(0.6180, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (38, tensor(0.6096, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (39, tensor(0.6159, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (40, tensor(0.6222, dtype=torch.float64))],
[2024-12-02 20:12:42,135][flwr][INFO] - 	 'ind_iou_0': [(0, 0.01798301739228557),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (1, 0.7041531619332229),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (2, 0.7194946885207562),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (3, 0.7094079618685047),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (4, 0.7270871639813715),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (5, 0.7419651041102922),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (6, 0.7224517294530366),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (7, 0.7218763264937371),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (8, 0.7023686250431647),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (9, 0.721936273853132),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (10, 0.7320079239608482),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (11, 0.7312641775839636),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (12, 0.7307315109103913),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (13, 0.7362298969330995),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (14, 0.7372483988966657),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (15, 0.7205718522029123),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (16, 0.7232672097729499),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (17, 0.7291407390627709),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (18, 0.7316116301981007),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (19, 0.7306175085206605),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (20, 0.7274818247053653),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (21, 0.7259691697398462),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (22, 0.7269812776285638),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (23, 0.7237389437328068),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (24, 0.7261652971136258),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (25, 0.715965063410553),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (26, 0.7166411077297714),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (27, 0.7228876470446968),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (28, 0.7150969245980148),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (29, 0.7251840270681922),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (30, 0.7251276649787706),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (31, 0.7218559494756757),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (32, 0.7244723153791756),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (33, 0.719385541729906),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (34, 0.722000433033335),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (35, 0.7247695011816836),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (36, 0.7238246357946218),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (37, 0.7263629967892827),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (38, 0.7226870228934359),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (39, 0.725677992368557),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (40, 0.7220656703344716)],
[2024-12-02 20:12:42,137][flwr][INFO] - 	 'ind_iou_1': [(0, 0.018857945583812354),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (1, 0.9375965819501104),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (2, 0.944296759365001),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (3, 0.9580016892356201),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (4, 0.9633678403530899),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (5, 0.9625522077531313),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (6, 0.9633174649826567),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (7, 0.9692948080432837),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (8, 0.9701511841865161),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (9, 0.9720497372165715),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (10, 0.9719249580257454),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (11, 0.9731929023227956),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (12, 0.9751504991954452),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (13, 0.9727027078988038),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (14, 0.9740743225676086),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (15, 0.9742031996262013),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (16, 0.9740651857748662),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (17, 0.9749448409879337),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (18, 0.9750643659019975),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (19, 0.9743329883733235),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (20, 0.9747492124143237),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (21, 0.9751794542399312),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (22, 0.9750270047811321),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (23, 0.9746424105262835),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (24, 0.9750677650726011),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (25, 0.9749645790131531),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (26, 0.9752426309106433),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (27, 0.974704673544276),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (28, 0.9748310864525674),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (29, 0.974930778806632),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (30, 0.9749845369549209),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (31, 0.975331847743366),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (32, 0.9753367262195519),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (33, 0.9752021171127921),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (34, 0.9750464313811438),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (35, 0.9753209283612883),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (36, 0.9753277144781742),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (37, 0.9751100342387964),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (38, 0.9750581862326032),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (39, 0.975357226864584),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (40, 0.9755206556225807)]}
[2024-12-02 20:12:42,139][flwr][INFO] - 
