[2024-10-01 16:55:30,283][flwr][INFO] - Starting Flower simulation, config: num_rounds=30, no round_timeout
[2024-10-01 16:55:55,736][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 707378764800.0, 'GPU': 3.0, 'object_store_memory': 200000000000.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'node:__internal_head__': 1.0, 'node:172.18.62.10': 1.0}
[2024-10-01 16:55:55,736][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-10-01 16:55:55,736][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-10-01 16:55:55,766][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-10-01 16:55:55,766][flwr][INFO] - [INIT]
[2024-10-01 16:55:55,766][flwr][INFO] - Requesting initial parameters from one random client
[2024-10-01 16:56:00,027][flwr][INFO] - Received initial parameters from one random client
[2024-10-01 16:56:00,027][flwr][INFO] - Evaluating initial global parameters
[2024-10-01 16:58:57,018][flwr][INFO] - initial parameters (loss, other metrics): 0.7281117153223757, OrderedDict([('ind_iou_0', 0.003725915704650801), ('ind_dice_liver_0', tensor(0.1429, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0075, dtype=torch.float64)), ('ind_iou_1', 0.004166603943351437), ('ind_dice_liver_1', tensor(0.1410, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0086, dtype=torch.float64)), ('all_iou', 0.004123726168775153), ('all_dice_liver', tensor(0.1412, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[2024-10-01 16:58:57,023][flwr][INFO] - 
[2024-10-01 16:58:57,023][flwr][INFO] - [ROUND 1]
[2024-10-01 16:58:57,023][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 17:37:30,384][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 17:37:30,422][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-10-01 17:40:20,414][flwr][INFO] - fit progress: (1, 0.03965299664356348, OrderedDict([('ind_iou_0', 0.6924223443479007), ('ind_dice_liver_0', tensor(0.7597, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0458, dtype=torch.float64)), ('ind_iou_1', 0.7460485691955977), ('ind_dice_liver_1', tensor(0.7950, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0857, dtype=torch.float64)), ('all_iou', 0.7408308824536591), ('all_dice_liver', tensor(0.7916, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0818, dtype=torch.float64))]), 2483.391558378935)
[2024-10-01 17:40:20,418][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 17:40:25,966][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 17:40:25,966][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 17:40:53,753][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 17:40:53,753][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 17:40:53,753][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 17:40:53,754][flwr][INFO] - 
[2024-10-01 17:40:53,754][flwr][INFO] - [ROUND 2]
[2024-10-01 17:40:53,754][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 18:06:55,893][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 18:09:45,760][flwr][INFO] - fit progress: (2, 0.053943382096825004, OrderedDict([('ind_iou_0', 0.6924491068627191), ('ind_dice_liver_0', tensor(0.7789, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0763, dtype=torch.float64)), ('ind_iou_1', 0.6940456646373012), ('ind_dice_liver_1', tensor(0.7606, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1283, dtype=torch.float64)), ('all_iou', 0.6938903238808561), ('all_dice_liver', tensor(0.7624, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1233, dtype=torch.float64))]), 4248.737762955949)
[2024-10-01 18:09:45,764][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 18:09:51,656][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 18:09:51,657][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 18:10:19,567][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 18:10:19,567][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 18:10:19,568][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 18:10:19,568][flwr][INFO] - 
[2024-10-01 18:10:19,568][flwr][INFO] - [ROUND 3]
[2024-10-01 18:10:19,568][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 18:33:41,868][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 18:36:33,579][flwr][INFO] - fit progress: (3, 0.040592302622853044, OrderedDict([('ind_iou_0', 0.7202913706112933), ('ind_dice_liver_0', tensor(0.8252, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1074, dtype=torch.float64)), ('ind_iou_1', 0.7536185564155894), ('ind_dice_liver_1', tensor(0.8332, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1629, dtype=torch.float64)), ('all_iou', 0.750375911310306), ('all_dice_liver', tensor(0.8325, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1575, dtype=torch.float64))]), 5856.556539047509)
[2024-10-01 18:36:33,583][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 18:36:39,090][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 18:36:39,090][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 18:37:07,095][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 18:37:07,096][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 18:37:07,096][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 18:37:07,096][flwr][INFO] - 
[2024-10-01 18:37:07,097][flwr][INFO] - [ROUND 4]
[2024-10-01 18:37:07,097][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 19:00:14,719][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 19:03:05,260][flwr][INFO] - fit progress: (4, 0.05320379530497171, OrderedDict([('ind_iou_0', 0.702088718626981), ('ind_dice_liver_0', tensor(0.7948, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0822, dtype=torch.float64)), ('ind_iou_1', 0.7109896489604368), ('ind_dice_liver_1', tensor(0.7819, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1443, dtype=torch.float64)), ('all_iou', 0.7101236124955591), ('all_dice_liver', tensor(0.7831, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1382, dtype=torch.float64))]), 7448.2374169789255)
[2024-10-01 19:03:05,264][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 19:03:11,089][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:03:11,090][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:03:38,465][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:03:38,465][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:03:38,465][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 19:03:38,466][flwr][INFO] - 
[2024-10-01 19:03:38,466][flwr][INFO] - [ROUND 5]
[2024-10-01 19:03:38,466][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 19:26:41,336][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 19:29:31,661][flwr][INFO] - fit progress: (5, 0.05808854905921646, OrderedDict([('ind_iou_0', 0.7086908545391583), ('ind_dice_liver_0', tensor(0.8147, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0916, dtype=torch.float64)), ('ind_iou_1', 0.7499390610917204), ('ind_dice_liver_1', tensor(0.8275, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1640, dtype=torch.float64)), ('all_iou', 0.7459257220757955), ('all_dice_liver', tensor(0.8262, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1570, dtype=torch.float64))]), 9034.638527344912)
[2024-10-01 19:29:31,665][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 19:29:37,030][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:29:37,030][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:30:05,106][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:30:05,106][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:30:05,107][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 19:30:05,107][flwr][INFO] - 
[2024-10-01 19:30:05,107][flwr][INFO] - [ROUND 6]
[2024-10-01 19:30:05,107][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 19:53:17,211][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 19:56:08,323][flwr][INFO] - fit progress: (6, 0.04382789945195218, OrderedDict([('ind_iou_0', 0.7295476920222131), ('ind_dice_liver_0', tensor(0.8322, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1017, dtype=torch.float64)), ('ind_iou_1', 0.7657804714778068), ('ind_dice_liver_1', tensor(0.8486, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1706, dtype=torch.float64)), ('all_iou', 0.7622551199632069), ('all_dice_liver', tensor(0.8470, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1639, dtype=torch.float64))]), 10631.300798811018)
[2024-10-01 19:56:08,327][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 19:56:13,781][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:56:13,781][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:56:41,923][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 19:56:41,923][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 19:56:41,923][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 19:56:41,924][flwr][INFO] - 
[2024-10-01 19:56:41,924][flwr][INFO] - [ROUND 7]
[2024-10-01 19:56:41,924][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 20:19:52,121][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 20:22:41,882][flwr][INFO] - fit progress: (7, 0.06623282730072624, OrderedDict([('ind_iou_0', 0.6874113329103689), ('ind_dice_liver_0', tensor(0.7871, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0643, dtype=torch.float64)), ('ind_iou_1', 0.7290714126094653), ('ind_dice_liver_1', tensor(0.8068, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1170, dtype=torch.float64)), ('all_iou', 0.7250179994495525), ('all_dice_liver', tensor(0.8048, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1119, dtype=torch.float64))]), 12224.859084805474)
[2024-10-01 20:22:41,886][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 20:22:47,649][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 20:22:47,649][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 20:23:15,668][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 20:23:15,668][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 20:23:15,668][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 20:23:15,668][flwr][INFO] - 
[2024-10-01 20:23:15,668][flwr][INFO] - [ROUND 8]
[2024-10-01 20:23:15,668][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 20:46:26,589][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 20:49:16,870][flwr][INFO] - fit progress: (8, 0.047419719028715765, OrderedDict([('ind_iou_0', 0.7419565516691708), ('ind_dice_liver_0', tensor(0.8385, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0912, dtype=torch.float64)), ('ind_iou_1', 0.7816214702187468), ('ind_dice_liver_1', tensor(0.8590, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1567, dtype=torch.float64)), ('all_iou', 0.7777621808463554), ('all_dice_liver', tensor(0.8570, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1504, dtype=torch.float64))]), 13819.847068939358)
[2024-10-01 20:49:16,873][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 20:49:22,707][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 20:49:22,708][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 20:49:50,564][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 20:49:50,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 20:49:50,565][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 20:49:50,566][flwr][INFO] - 
[2024-10-01 20:49:50,566][flwr][INFO] - [ROUND 9]
[2024-10-01 20:49:50,566][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 21:12:51,475][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 21:15:41,737][flwr][INFO] - fit progress: (9, 0.053640118605411735, OrderedDict([('ind_iou_0', 0.7298288880688908), ('ind_dice_liver_0', tensor(0.8264, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0872, dtype=torch.float64)), ('ind_iou_1', 0.7409323375690139), ('ind_dice_liver_1', tensor(0.8232, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1473, dtype=torch.float64)), ('all_iou', 0.739852001941975), ('all_dice_liver', tensor(0.8235, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1414, dtype=torch.float64))]), 15404.714204318821)
[2024-10-01 21:15:41,740][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 21:15:48,130][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 21:15:48,130][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 21:16:15,883][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 21:16:15,883][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 21:16:15,884][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 21:16:15,884][flwr][INFO] - 
[2024-10-01 21:16:15,884][flwr][INFO] - [ROUND 10]
[2024-10-01 21:16:15,884][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 21:39:16,814][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 21:42:07,859][flwr][INFO] - fit progress: (10, 0.07006037341495404, OrderedDict([('ind_iou_0', 0.7181072732345408), ('ind_dice_liver_0', tensor(0.8178, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0826, dtype=torch.float64)), ('ind_iou_1', 0.7305825545466788), ('ind_dice_liver_1', tensor(0.8078, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1497, dtype=torch.float64)), ('all_iou', 0.7293687433919845), ('all_dice_liver', tensor(0.8088, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1432, dtype=torch.float64))]), 16990.836383217946)
[2024-10-01 21:42:07,863][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 21:42:13,386][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 21:42:13,386][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 21:42:41,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 21:42:41,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 21:42:41,553][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 21:42:41,554][flwr][INFO] - 
[2024-10-01 21:42:41,554][flwr][INFO] - [ROUND 11]
[2024-10-01 21:42:41,554][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 22:05:53,664][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 22:08:43,302][flwr][INFO] - fit progress: (11, 0.06053231140490911, OrderedDict([('ind_iou_0', 0.7262324911951569), ('ind_dice_liver_0', tensor(0.8381, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1120, dtype=torch.float64)), ('ind_iou_1', 0.7721421056446862), ('ind_dice_liver_1', tensor(0.8580, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1903, dtype=torch.float64)), ('all_iou', 0.7676752242387873), ('all_dice_liver', tensor(0.8561, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1827, dtype=torch.float64))]), 18586.27915505506)
[2024-10-01 22:08:43,305][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 22:08:48,489][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 22:08:48,489][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 22:09:17,150][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 22:09:17,151][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 22:09:17,151][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 22:09:17,151][flwr][INFO] - 
[2024-10-01 22:09:17,152][flwr][INFO] - [ROUND 12]
[2024-10-01 22:09:17,152][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 22:32:18,874][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 22:35:08,570][flwr][INFO] - fit progress: (12, 0.0485177695144429, OrderedDict([('ind_iou_0', 0.722632277714634), ('ind_dice_liver_0', tensor(0.8267, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1061, dtype=torch.float64)), ('ind_iou_1', 0.7414589022009384), ('ind_dice_liver_1', tensor(0.8254, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1736, dtype=torch.float64)), ('all_iou', 0.7396271225211897), ('all_dice_liver', tensor(0.8255, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1670, dtype=torch.float64))]), 20171.54733423516)
[2024-10-01 22:35:08,574][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 22:35:14,417][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 22:35:14,417][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 22:35:41,750][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 22:35:41,750][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 22:35:41,751][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 22:35:41,751][flwr][INFO] - 
[2024-10-01 22:35:41,751][flwr][INFO] - [ROUND 13]
[2024-10-01 22:35:41,751][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 22:58:46,831][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 23:01:36,699][flwr][INFO] - fit progress: (13, 0.04948640414657264, OrderedDict([('ind_iou_0', 0.7253599564369341), ('ind_dice_liver_0', tensor(0.8320, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0815, dtype=torch.float64)), ('ind_iou_1', 0.7787140199992983), ('ind_dice_liver_1', tensor(0.8624, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1471, dtype=torch.float64)), ('all_iou', 0.7735228138148507), ('all_dice_liver', tensor(0.8595, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1407, dtype=torch.float64))]), 21759.67607967928)
[2024-10-01 23:01:36,702][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 23:01:42,084][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:01:42,085][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:02:09,883][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:02:09,883][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:02:09,883][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 23:02:09,884][flwr][INFO] - 
[2024-10-01 23:02:09,884][flwr][INFO] - [ROUND 14]
[2024-10-01 23:02:09,884][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 23:25:15,220][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 23:28:06,518][flwr][INFO] - fit progress: (14, 0.06061001649923117, OrderedDict([('ind_iou_0', 0.7264241034411277), ('ind_dice_liver_0', tensor(0.8355, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0887, dtype=torch.float64)), ('ind_iou_1', 0.7450204027481494), ('ind_dice_liver_1', tensor(0.8289, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1618, dtype=torch.float64)), ('all_iou', 0.7432110330858446), ('all_dice_liver', tensor(0.8295, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1547, dtype=torch.float64))]), 23349.495199918747)
[2024-10-01 23:28:06,521][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 23:28:12,090][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:28:12,090][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:28:40,083][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:28:40,083][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:28:40,083][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 23:28:40,084][flwr][INFO] - 
[2024-10-01 23:28:40,084][flwr][INFO] - [ROUND 15]
[2024-10-01 23:28:40,084][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-01 23:51:39,204][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-01 23:54:27,264][flwr][INFO] - fit progress: (15, 0.06227039917818487, OrderedDict([('ind_iou_0', 0.7328815183749002), ('ind_dice_liver_0', tensor(0.8467, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0988, dtype=torch.float64)), ('ind_iou_1', 0.7653846545955229), ('ind_dice_liver_1', tensor(0.8523, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1753, dtype=torch.float64)), ('all_iou', 0.762222187287569), ('all_dice_liver', tensor(0.8518, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1679, dtype=torch.float64))]), 24930.240885458887)
[2024-10-01 23:54:27,267][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-01 23:54:32,544][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:54:32,545][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:55:00,588][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-01 23:55:00,588][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-01 23:55:00,589][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-01 23:55:00,589][flwr][INFO] - 
[2024-10-01 23:55:00,589][flwr][INFO] - [ROUND 16]
[2024-10-01 23:55:00,590][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 00:18:04,454][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 00:20:54,235][flwr][INFO] - fit progress: (16, 0.08107260118816186, OrderedDict([('ind_iou_0', 0.712162441120791), ('ind_dice_liver_0', tensor(0.8208, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0679, dtype=torch.float64)), ('ind_iou_1', 0.7265924582843355), ('ind_dice_liver_1', tensor(0.8098, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1324, dtype=torch.float64)), ('all_iou', 0.725188456614369), ('all_dice_liver', tensor(0.8109, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1261, dtype=torch.float64))]), 26517.21220475994)
[2024-10-02 00:20:54,238][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 00:21:00,014][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 00:21:00,015][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 00:21:27,700][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 00:21:27,700][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 00:21:27,700][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 00:21:27,701][flwr][INFO] - 
[2024-10-02 00:21:27,701][flwr][INFO] - [ROUND 17]
[2024-10-02 00:21:27,701][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 00:44:31,365][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 00:47:21,163][flwr][INFO] - fit progress: (17, 0.07081892566324442, OrderedDict([('ind_iou_0', 0.7263526645561771), ('ind_dice_liver_0', tensor(0.8374, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0915, dtype=torch.float64)), ('ind_iou_1', 0.7657957262428972), ('ind_dice_liver_1', tensor(0.8436, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1685, dtype=torch.float64)), ('all_iou', 0.7619580229436479), ('all_dice_liver', tensor(0.8430, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1610, dtype=torch.float64))]), 28104.139930341393)
[2024-10-02 00:47:21,167][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 00:47:26,732][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 00:47:26,732][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 00:47:54,387][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 00:47:54,387][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 00:47:54,388][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 00:47:54,388][flwr][INFO] - 
[2024-10-02 00:47:54,388][flwr][INFO] - [ROUND 18]
[2024-10-02 00:47:54,388][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 01:10:56,595][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 01:13:46,199][flwr][INFO] - fit progress: (18, 0.06389974578759415, OrderedDict([('ind_iou_0', 0.7318505594979214), ('ind_dice_liver_0', tensor(0.8449, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1203, dtype=torch.float64)), ('ind_iou_1', 0.7789183357561229), ('ind_dice_liver_1', tensor(0.8624, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2021, dtype=torch.float64)), ('all_iou', 0.7743387683364056), ('all_dice_liver', tensor(0.8607, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1942, dtype=torch.float64))]), 29689.17653927952)
[2024-10-02 01:13:46,203][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 01:13:51,792][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 01:13:51,793][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 01:14:19,802][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 01:14:19,802][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 01:14:19,802][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 01:14:19,803][flwr][INFO] - 
[2024-10-02 01:14:19,803][flwr][INFO] - [ROUND 19]
[2024-10-02 01:14:19,803][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 01:37:17,824][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 01:40:05,291][flwr][INFO] - fit progress: (19, 0.06543501009702897, OrderedDict([('ind_iou_0', 0.7380533691089776), ('ind_dice_liver_0', tensor(0.8356, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1100, dtype=torch.float64)), ('ind_iou_1', 0.735415016555912), ('ind_dice_liver_1', tensor(0.8190, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1758, dtype=torch.float64)), ('all_iou', 0.7356717211286433), ('all_dice_liver', tensor(0.8206, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1694, dtype=torch.float64))]), 31268.267856974155)
[2024-10-02 01:40:05,294][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 01:40:11,014][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 01:40:11,014][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 01:40:39,013][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 01:40:39,013][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 01:40:39,014][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 01:40:39,014][flwr][INFO] - 
[2024-10-02 01:40:39,014][flwr][INFO] - [ROUND 20]
[2024-10-02 01:40:39,014][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 02:03:38,079][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 02:06:27,808][flwr][INFO] - fit progress: (20, 0.06952582210435858, OrderedDict([('ind_iou_0', 0.7283642653732584), ('ind_dice_liver_0', tensor(0.8422, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1152, dtype=torch.float64)), ('ind_iou_1', 0.7535769044435836), ('ind_dice_liver_1', tensor(0.8403, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1964, dtype=torch.float64)), ('all_iou', 0.7511237828043094), ('all_dice_liver', tensor(0.8405, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1885, dtype=torch.float64))]), 32850.78484158032)
[2024-10-02 02:06:27,811][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 02:06:33,376][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 02:06:33,376][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 02:07:01,169][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 02:07:01,169][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 02:07:01,170][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 02:07:01,170][flwr][INFO] - 
[2024-10-02 02:07:01,170][flwr][INFO] - [ROUND 21]
[2024-10-02 02:07:01,170][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 02:30:07,026][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 02:32:55,963][flwr][INFO] - fit progress: (21, 0.06467800015689174, OrderedDict([('ind_iou_0', 0.7435689777302551), ('ind_dice_liver_0', tensor(0.8491, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1213, dtype=torch.float64)), ('ind_iou_1', 0.7685517130985413), ('ind_dice_liver_1', tensor(0.8498, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1942, dtype=torch.float64)), ('all_iou', 0.766120960468113), ('all_dice_liver', tensor(0.8497, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1871, dtype=torch.float64))]), 34438.9403672833)
[2024-10-02 02:32:55,967][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 02:33:02,426][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 02:33:02,426][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 02:33:29,819][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 02:33:29,819][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 02:33:29,820][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 02:33:29,820][flwr][INFO] - 
[2024-10-02 02:33:29,820][flwr][INFO] - [ROUND 22]
[2024-10-02 02:33:29,820][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 02:56:37,727][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 02:59:26,535][flwr][INFO] - fit progress: (22, 0.06623744241023448, OrderedDict([('ind_iou_0', 0.7304816358965425), ('ind_dice_liver_0', tensor(0.8260, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0888, dtype=torch.float64)), ('ind_iou_1', 0.7396576843085115), ('ind_dice_liver_1', tensor(0.8129, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1627, dtype=torch.float64)), ('all_iou', 0.738764879598158), ('all_dice_liver', tensor(0.8142, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1555, dtype=torch.float64))]), 36029.51224063523)
[2024-10-02 02:59:26,538][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 02:59:32,283][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 02:59:32,283][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:00:00,165][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 03:00:00,165][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:00:00,166][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 03:00:00,166][flwr][INFO] - 
[2024-10-02 03:00:00,166][flwr][INFO] - [ROUND 23]
[2024-10-02 03:00:00,166][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 03:23:10,563][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 03:26:00,768][flwr][INFO] - fit progress: (23, 0.06635089160328742, OrderedDict([('ind_iou_0', 0.739536588378722), ('ind_dice_liver_0', tensor(0.8512, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1157, dtype=torch.float64)), ('ind_iou_1', 0.7703783061497338), ('ind_dice_liver_1', tensor(0.8583, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1885, dtype=torch.float64)), ('all_iou', 0.7673774903666067), ('all_dice_liver', tensor(0.8576, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1814, dtype=torch.float64))]), 37623.74519071542)
[2024-10-02 03:26:00,771][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 03:26:06,035][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 03:26:06,035][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:26:34,416][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 03:26:34,416][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:26:34,416][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 03:26:34,416][flwr][INFO] - 
[2024-10-02 03:26:34,417][flwr][INFO] - [ROUND 24]
[2024-10-02 03:26:34,417][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 03:49:47,050][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 03:52:36,620][flwr][INFO] - fit progress: (24, 0.07717595568370023, OrderedDict([('ind_iou_0', 0.7168146194072944), ('ind_dice_liver_0', tensor(0.8239, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0845, dtype=torch.float64)), ('ind_iou_1', 0.722058668948723), ('ind_dice_liver_1', tensor(0.8039, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1516, dtype=torch.float64)), ('all_iou', 0.7215484371014494), ('all_dice_liver', tensor(0.8058, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1451, dtype=torch.float64))]), 39219.596924686804)
[2024-10-02 03:52:36,623][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 03:52:42,027][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 03:52:42,027][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:53:10,092][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 03:53:10,092][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 03:53:10,093][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 03:53:10,094][flwr][INFO] - 
[2024-10-02 03:53:10,094][flwr][INFO] - [ROUND 25]
[2024-10-02 03:53:10,094][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 04:16:18,615][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 04:19:08,810][flwr][INFO] - fit progress: (25, 0.08413894713816972, OrderedDict([('ind_iou_0', 0.7336145657142964), ('ind_dice_liver_0', tensor(0.8480, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1061, dtype=torch.float64)), ('ind_iou_1', 0.7661625993835139), ('ind_dice_liver_1', tensor(0.8519, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1801, dtype=torch.float64)), ('all_iou', 0.7629957636751583), ('all_dice_liver', tensor(0.8515, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1729, dtype=torch.float64))]), 40811.78727048822)
[2024-10-02 04:19:08,814][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 04:19:14,227][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 04:19:14,228][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 04:19:42,366][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 04:19:42,366][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 04:19:42,367][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 04:19:42,367][flwr][INFO] - 
[2024-10-02 04:19:42,367][flwr][INFO] - [ROUND 26]
[2024-10-02 04:19:42,367][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 04:42:51,442][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 04:45:40,940][flwr][INFO] - fit progress: (26, 0.08028100128286791, OrderedDict([('ind_iou_0', 0.7232630013770487), ('ind_dice_liver_0', tensor(0.8376, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0827, dtype=torch.float64)), ('ind_iou_1', 0.7757147155370083), ('ind_dice_liver_1', tensor(0.8519, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1608, dtype=torch.float64)), ('all_iou', 0.7706113055106331), ('all_dice_liver', tensor(0.8505, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1532, dtype=torch.float64))]), 42403.91687670909)
[2024-10-02 04:45:40,943][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 04:45:46,085][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 04:45:46,086][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 04:46:15,023][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 04:46:15,023][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 04:46:15,023][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 04:46:15,024][flwr][INFO] - 
[2024-10-02 04:46:15,024][flwr][INFO] - [ROUND 27]
[2024-10-02 04:46:15,024][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 05:09:28,304][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 05:12:17,058][flwr][INFO] - fit progress: (27, 0.07820667590260923, OrderedDict([('ind_iou_0', 0.7388170167488572), ('ind_dice_liver_0', tensor(0.8450, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0991, dtype=torch.float64)), ('ind_iou_1', 0.7405926974156466), ('ind_dice_liver_1', tensor(0.8263, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1694, dtype=torch.float64)), ('all_iou', 0.7404199284859045), ('all_dice_liver', tensor(0.8281, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1625, dtype=torch.float64))]), 44000.03565853089)
[2024-10-02 05:12:17,062][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 05:12:22,980][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 05:12:22,981][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 05:12:50,293][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 05:12:50,293][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 05:12:50,294][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 05:12:50,294][flwr][INFO] - 
[2024-10-02 05:12:50,294][flwr][INFO] - [ROUND 28]
[2024-10-02 05:12:50,294][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 05:36:02,611][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 05:38:51,408][flwr][INFO] - fit progress: (28, 0.07688833680026523, OrderedDict([('ind_iou_0', 0.740315937746812), ('ind_dice_liver_0', tensor(0.8563, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1145, dtype=torch.float64)), ('ind_iou_1', 0.7744801652831559), ('ind_dice_liver_1', tensor(0.8639, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1899, dtype=torch.float64)), ('all_iou', 0.7711560782796206), ('all_dice_liver', tensor(0.8631, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1825, dtype=torch.float64))]), 45594.385707806796)
[2024-10-02 05:38:51,412][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 05:38:56,866][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 05:38:56,866][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 05:39:24,860][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 05:39:24,861][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 05:39:24,861][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 05:39:24,861][flwr][INFO] - 
[2024-10-02 05:39:24,861][flwr][INFO] - [ROUND 29]
[2024-10-02 05:39:24,862][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 06:02:35,390][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 06:05:23,320][flwr][INFO] - fit progress: (29, 0.08265697486968065, OrderedDict([('ind_iou_0', 0.7352135586641019), ('ind_dice_liver_0', tensor(0.8517, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1086, dtype=torch.float64)), ('ind_iou_1', 0.7543050268857481), ('ind_dice_liver_1', tensor(0.8462, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1812, dtype=torch.float64)), ('all_iou', 0.7524474786263453), ('all_dice_liver', tensor(0.8468, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1742, dtype=torch.float64))]), 47186.29768849164)
[2024-10-02 06:05:23,324][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 06:05:29,635][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 06:05:29,635][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 06:05:58,093][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 06:05:58,093][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 06:05:58,094][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 06:05:58,094][flwr][INFO] - 
[2024-10-02 06:05:58,094][flwr][INFO] - [ROUND 30]
[2024-10-02 06:05:58,094][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 06:29:07,873][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 06:31:57,277][flwr][INFO] - fit progress: (30, 0.07581624445535773, OrderedDict([('ind_iou_0', 0.7231025968988466), ('ind_dice_liver_0', tensor(0.8370, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1169, dtype=torch.float64)), ('ind_iou_1', 0.7301182071815904), ('ind_dice_liver_1', tensor(0.8300, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1810, dtype=torch.float64)), ('all_iou', 0.729435607262188), ('all_dice_liver', tensor(0.8307, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1748, dtype=torch.float64))]), 48780.25423233397)
[2024-10-02 06:31:57,281][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 06:32:02,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 06:32:02,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257708, ip=172.18.62.10, actor_id=040d6173246bf9833069068301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146b40bd2340>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 06:32:30,816][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 06:32:30,816][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 294, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3257710, ip=172.18.62.10, actor_id=363464c826391451fe265f1901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b76dc70370>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 06:32:30,816][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 06:32:30,817][flwr][INFO] - 
[2024-10-02 06:32:30,817][flwr][INFO] - [SUMMARY]
[2024-10-02 06:32:30,817][flwr][INFO] - Run finished 30 rounds in 48813.79s
[2024-10-02 06:32:30,913][flwr][INFO] - History (loss, centralized):
[2024-10-02 06:32:30,913][flwr][INFO] - 	('\tround 0: 0.7281117153223757\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 1: 0.03965299664356348\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 2: 0.053943382096825004\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 3: 0.040592302622853044\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 4: 0.05320379530497171\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 5: 0.05808854905921646\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 6: 0.04382789945195218\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 7: 0.06623282730072624\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 8: 0.047419719028715765\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 9: 0.053640118605411735\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 10: 0.07006037341495404\n'
[2024-10-02 06:32:30,913][flwr][INFO] - 	 '\tround 11: 0.06053231140490911\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 12: 0.0485177695144429\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 13: 0.04948640414657264\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 14: 0.06061001649923117\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 15: 0.06227039917818487\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 16: 0.08107260118816186\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 17: 0.07081892566324442\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 18: 0.06389974578759415\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 19: 0.06543501009702897\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 20: 0.06952582210435858\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 21: 0.06467800015689174\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 22: 0.06623744241023448\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 23: 0.06635089160328742\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 24: 0.07717595568370023\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 25: 0.08413894713816972\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 26: 0.08028100128286791\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 27: 0.07820667590260923\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 28: 0.07688833680026523\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 29: 0.08265697486968065\n'
[2024-10-02 06:32:30,914][flwr][INFO] - 	 '\tround 30: 0.07581624445535773\n')History (metrics, centralized):
[2024-10-02 06:32:30,915][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1412, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (1, tensor(0.7916, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (2, tensor(0.7624, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (3, tensor(0.8325, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (4, tensor(0.7831, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (5, tensor(0.8262, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (6, tensor(0.8470, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (7, tensor(0.8048, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (8, tensor(0.8570, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (9, tensor(0.8235, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (10, tensor(0.8088, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (11, tensor(0.8561, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (12, tensor(0.8255, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (13, tensor(0.8595, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (14, tensor(0.8295, dtype=torch.float64)),
[2024-10-02 06:32:30,915][flwr][INFO] - 	                    (15, tensor(0.8518, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (16, tensor(0.8109, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (17, tensor(0.8430, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (18, tensor(0.8607, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (19, tensor(0.8206, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (20, tensor(0.8405, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (21, tensor(0.8497, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (22, tensor(0.8142, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (23, tensor(0.8576, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (24, tensor(0.8058, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (25, tensor(0.8515, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (26, tensor(0.8505, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (27, tensor(0.8281, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (28, tensor(0.8631, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (29, tensor(0.8468, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                    (30, tensor(0.8307, dtype=torch.float64))],
[2024-10-02 06:32:30,916][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                     (1, tensor(0.0818, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                     (2, tensor(0.1233, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                     (3, tensor(0.1575, dtype=torch.float64)),
[2024-10-02 06:32:30,916][flwr][INFO] - 	                     (4, tensor(0.1382, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (5, tensor(0.1570, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (6, tensor(0.1639, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (7, tensor(0.1119, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (8, tensor(0.1504, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (9, tensor(0.1414, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (10, tensor(0.1432, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (11, tensor(0.1827, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (12, tensor(0.1670, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (13, tensor(0.1407, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (14, tensor(0.1547, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (15, tensor(0.1679, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (16, tensor(0.1261, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (17, tensor(0.1610, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (18, tensor(0.1942, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (19, tensor(0.1694, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (20, tensor(0.1885, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (21, tensor(0.1871, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (22, tensor(0.1555, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (23, tensor(0.1814, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (24, tensor(0.1451, dtype=torch.float64)),
[2024-10-02 06:32:30,917][flwr][INFO] - 	                     (25, tensor(0.1729, dtype=torch.float64)),
[2024-10-02 06:32:30,918][flwr][INFO] - 	                     (26, tensor(0.1532, dtype=torch.float64)),
[2024-10-02 06:32:30,918][flwr][INFO] - 	                     (27, tensor(0.1625, dtype=torch.float64)),
[2024-10-02 06:32:30,918][flwr][INFO] - 	                     (28, tensor(0.1825, dtype=torch.float64)),
[2024-10-02 06:32:30,918][flwr][INFO] - 	                     (29, tensor(0.1742, dtype=torch.float64)),
[2024-10-02 06:32:30,918][flwr][INFO] - 	                     (30, tensor(0.1748, dtype=torch.float64))],
[2024-10-02 06:32:30,918][flwr][INFO] - 	 'all_iou': [(0, 0.004123726168775153),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (1, 0.7408308824536591),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (2, 0.6938903238808561),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (3, 0.750375911310306),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (4, 0.7101236124955591),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (5, 0.7459257220757955),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (6, 0.7622551199632069),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (7, 0.7250179994495525),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (8, 0.7777621808463554),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (9, 0.739852001941975),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (10, 0.7293687433919845),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (11, 0.7676752242387873),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (12, 0.7396271225211897),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (13, 0.7735228138148507),
[2024-10-02 06:32:30,918][flwr][INFO] - 	             (14, 0.7432110330858446),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (15, 0.762222187287569),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (16, 0.725188456614369),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (17, 0.7619580229436479),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (18, 0.7743387683364056),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (19, 0.7356717211286433),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (20, 0.7511237828043094),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (21, 0.766120960468113),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (22, 0.738764879598158),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (23, 0.7673774903666067),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (24, 0.7215484371014494),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (25, 0.7629957636751583),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (26, 0.7706113055106331),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (27, 0.7404199284859045),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (28, 0.7711560782796206),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (29, 0.7524474786263453),
[2024-10-02 06:32:30,919][flwr][INFO] - 	             (30, 0.729435607262188)],
[2024-10-02 06:32:30,919][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1429, dtype=torch.float64)),
[2024-10-02 06:32:30,919][flwr][INFO] - 	                      (1, tensor(0.7597, dtype=torch.float64)),
[2024-10-02 06:32:30,919][flwr][INFO] - 	                      (2, tensor(0.7789, dtype=torch.float64)),
[2024-10-02 06:32:30,919][flwr][INFO] - 	                      (3, tensor(0.8252, dtype=torch.float64)),
[2024-10-02 06:32:30,919][flwr][INFO] - 	                      (4, tensor(0.7948, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (5, tensor(0.8147, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (6, tensor(0.8322, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (7, tensor(0.7871, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (8, tensor(0.8385, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (9, tensor(0.8264, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (10, tensor(0.8178, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (11, tensor(0.8381, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (12, tensor(0.8267, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (13, tensor(0.8320, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (14, tensor(0.8355, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (15, tensor(0.8467, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (16, tensor(0.8208, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (17, tensor(0.8374, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (18, tensor(0.8449, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (19, tensor(0.8356, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (20, tensor(0.8422, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (21, tensor(0.8491, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (22, tensor(0.8260, dtype=torch.float64)),
[2024-10-02 06:32:30,920][flwr][INFO] - 	                      (23, tensor(0.8512, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (24, tensor(0.8239, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (25, tensor(0.8480, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (26, tensor(0.8376, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (27, tensor(0.8450, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (28, tensor(0.8563, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (29, tensor(0.8517, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (30, tensor(0.8370, dtype=torch.float64))],
[2024-10-02 06:32:30,921][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1410, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (1, tensor(0.7950, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (2, tensor(0.7606, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (3, tensor(0.8332, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (4, tensor(0.7819, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (5, tensor(0.8275, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (6, tensor(0.8486, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (7, tensor(0.8068, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (8, tensor(0.8590, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (9, tensor(0.8232, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (10, tensor(0.8078, dtype=torch.float64)),
[2024-10-02 06:32:30,921][flwr][INFO] - 	                      (11, tensor(0.8580, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (12, tensor(0.8254, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (13, tensor(0.8624, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (14, tensor(0.8289, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (15, tensor(0.8523, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (16, tensor(0.8098, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (17, tensor(0.8436, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (18, tensor(0.8624, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (19, tensor(0.8190, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (20, tensor(0.8403, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (21, tensor(0.8498, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (22, tensor(0.8129, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (23, tensor(0.8583, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (24, tensor(0.8039, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (25, tensor(0.8519, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (26, tensor(0.8519, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (27, tensor(0.8263, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (28, tensor(0.8639, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (29, tensor(0.8462, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                      (30, tensor(0.8300, dtype=torch.float64))],
[2024-10-02 06:32:30,922][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0075, dtype=torch.float64)),
[2024-10-02 06:32:30,922][flwr][INFO] - 	                       (1, tensor(0.0458, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (2, tensor(0.0763, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (3, tensor(0.1074, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (4, tensor(0.0822, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (5, tensor(0.0916, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (6, tensor(0.1017, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (7, tensor(0.0643, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (8, tensor(0.0912, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (9, tensor(0.0872, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (10, tensor(0.0826, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (11, tensor(0.1120, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (12, tensor(0.1061, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (13, tensor(0.0815, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (14, tensor(0.0887, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (15, tensor(0.0988, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (16, tensor(0.0679, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (17, tensor(0.0915, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (18, tensor(0.1203, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (19, tensor(0.1100, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (20, tensor(0.1152, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (21, tensor(0.1213, dtype=torch.float64)),
[2024-10-02 06:32:30,923][flwr][INFO] - 	                       (22, tensor(0.0888, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (23, tensor(0.1157, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (24, tensor(0.0845, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (25, tensor(0.1061, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (26, tensor(0.0827, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (27, tensor(0.0991, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (28, tensor(0.1145, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (29, tensor(0.1086, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (30, tensor(0.1169, dtype=torch.float64))],
[2024-10-02 06:32:30,924][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0086, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (1, tensor(0.0857, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (2, tensor(0.1283, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (3, tensor(0.1629, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (4, tensor(0.1443, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (5, tensor(0.1640, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (6, tensor(0.1706, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (7, tensor(0.1170, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (8, tensor(0.1567, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (9, tensor(0.1473, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (10, tensor(0.1497, dtype=torch.float64)),
[2024-10-02 06:32:30,924][flwr][INFO] - 	                       (11, tensor(0.1903, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (12, tensor(0.1736, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (13, tensor(0.1471, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (14, tensor(0.1618, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (15, tensor(0.1753, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (16, tensor(0.1324, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (17, tensor(0.1685, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (18, tensor(0.2021, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (19, tensor(0.1758, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (20, tensor(0.1964, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (21, tensor(0.1942, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (22, tensor(0.1627, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (23, tensor(0.1885, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (24, tensor(0.1516, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (25, tensor(0.1801, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (26, tensor(0.1608, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (27, tensor(0.1694, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (28, tensor(0.1899, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (29, tensor(0.1812, dtype=torch.float64)),
[2024-10-02 06:32:30,925][flwr][INFO] - 	                       (30, tensor(0.1810, dtype=torch.float64))],
[2024-10-02 06:32:30,925][flwr][INFO] - 	 'ind_iou_0': [(0, 0.003725915704650801),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (1, 0.6924223443479007),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (2, 0.6924491068627191),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (3, 0.7202913706112933),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (4, 0.702088718626981),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (5, 0.7086908545391583),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (6, 0.7295476920222131),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (7, 0.6874113329103689),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (8, 0.7419565516691708),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (9, 0.7298288880688908),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (10, 0.7181072732345408),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (11, 0.7262324911951569),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (12, 0.722632277714634),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (13, 0.7253599564369341),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (14, 0.7264241034411277),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (15, 0.7328815183749002),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (16, 0.712162441120791),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (17, 0.7263526645561771),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (18, 0.7318505594979214),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (19, 0.7380533691089776),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (20, 0.7283642653732584),
[2024-10-02 06:32:30,926][flwr][INFO] - 	               (21, 0.7435689777302551),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (22, 0.7304816358965425),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (23, 0.739536588378722),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (24, 0.7168146194072944),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (25, 0.7336145657142964),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (26, 0.7232630013770487),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (27, 0.7388170167488572),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (28, 0.740315937746812),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (29, 0.7352135586641019),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (30, 0.7231025968988466)],
[2024-10-02 06:32:30,927][flwr][INFO] - 	 'ind_iou_1': [(0, 0.004166603943351437),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (1, 0.7460485691955977),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (2, 0.6940456646373012),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (3, 0.7536185564155894),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (4, 0.7109896489604368),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (5, 0.7499390610917204),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (6, 0.7657804714778068),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (7, 0.7290714126094653),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (8, 0.7816214702187468),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (9, 0.7409323375690139),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (10, 0.7305825545466788),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (11, 0.7721421056446862),
[2024-10-02 06:32:30,927][flwr][INFO] - 	               (12, 0.7414589022009384),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (13, 0.7787140199992983),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (14, 0.7450204027481494),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (15, 0.7653846545955229),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (16, 0.7265924582843355),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (17, 0.7657957262428972),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (18, 0.7789183357561229),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (19, 0.735415016555912),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (20, 0.7535769044435836),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (21, 0.7685517130985413),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (22, 0.7396576843085115),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (23, 0.7703783061497338),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (24, 0.722058668948723),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (25, 0.7661625993835139),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (26, 0.7757147155370083),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (27, 0.7405926974156466),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (28, 0.7744801652831559),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (29, 0.7543050268857481),
[2024-10-02 06:32:30,928][flwr][INFO] - 	               (30, 0.7301182071815904)]}
[2024-10-02 06:32:30,928][flwr][INFO] - 
