[2024-10-02 17:02:34,316][flwr][INFO] - Starting Flower simulation, config: num_rounds=30, no round_timeout
[2024-10-02 17:02:56,508][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:172.18.62.7': 1.0, 'GPU': 3.0, 'object_store_memory': 200000000000.0, 'memory': 862845082624.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:__internal_head__': 1.0}
[2024-10-02 17:02:56,509][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-10-02 17:02:56,509][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-10-02 17:02:56,519][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-10-02 17:02:56,520][flwr][INFO] - [INIT]
[2024-10-02 17:02:56,520][flwr][INFO] - Requesting initial parameters from one random client
[2024-10-02 17:02:59,756][flwr][INFO] - Received initial parameters from one random client
[2024-10-02 17:02:59,756][flwr][INFO] - Evaluating initial global parameters
[2024-10-02 17:06:40,326][flwr][INFO] - initial parameters (loss, other metrics): 0.7083181132861226, OrderedDict([('ind_iou_0', 0.06779042526483302), ('ind_dice_liver_0', tensor(0.1643, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0080, dtype=torch.float64)), ('ind_iou_1', 0.06658759732699471), ('ind_dice_liver_1', tensor(0.1615, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0092, dtype=torch.float64)), ('all_iou', 0.06670462923446002), ('all_dice_liver', tensor(0.1618, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0091, dtype=torch.float64))])
[2024-10-02 17:06:40,335][flwr][INFO] - 
[2024-10-02 17:06:40,339][flwr][INFO] - [ROUND 1]
[2024-10-02 17:06:40,339][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 17:39:38,223][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 17:39:38,279][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-10-02 17:45:15,920][flwr][INFO] - fit progress: (1, 0.0754784170653508, OrderedDict([('ind_iou_0', 0.5864363818970737), ('ind_dice_liver_0', tensor(0.6983, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0611, dtype=torch.float64)), ('ind_iou_1', 0.6734751418326549), ('ind_dice_liver_1', tensor(0.7519, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1111, dtype=torch.float64)), ('all_iou', 0.6650065057308147), ('all_dice_liver', tensor(0.7467, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1062, dtype=torch.float64))]), 2315.585345443338)
[2024-10-02 17:45:15,951][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 17:45:30,130][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 17:45:30,130][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 17:46:24,445][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 17:46:24,445][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 17:46:24,446][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 17:46:24,446][flwr][INFO] - 
[2024-10-02 17:46:24,446][flwr][INFO] - [ROUND 2]
[2024-10-02 17:46:24,446][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 18:16:07,377][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 18:21:44,147][flwr][INFO] - fit progress: (2, 0.028017306481720437, OrderedDict([('ind_iou_0', 0.7373773828539216), ('ind_dice_liver_0', tensor(0.8299, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0866, dtype=torch.float64)), ('ind_iou_1', 0.76843124179373), ('ind_dice_liver_1', tensor(0.8335, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1456, dtype=torch.float64)), ('all_iou', 0.7654097852482357), ('all_dice_liver', tensor(0.8331, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1399, dtype=torch.float64))]), 4503.8114967904985)
[2024-10-02 18:21:44,155][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 18:21:53,838][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 18:21:53,839][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 18:22:52,213][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 18:22:52,213][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 18:22:52,214][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 18:22:52,214][flwr][INFO] - 
[2024-10-02 18:22:52,214][flwr][INFO] - [ROUND 3]
[2024-10-02 18:22:52,214][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 18:49:04,692][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 18:54:42,293][flwr][INFO] - fit progress: (3, 0.03045905054135113, OrderedDict([('ind_iou_0', 0.7592682188878518), ('ind_dice_liver_0', tensor(0.8574, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0988, dtype=torch.float64)), ('ind_iou_1', 0.777607995542866), ('ind_dice_liver_1', tensor(0.8492, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1695, dtype=torch.float64)), ('all_iou', 0.775823584841298), ('all_dice_liver', tensor(0.8500, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1626, dtype=torch.float64))]), 6481.957999210805)
[2024-10-02 18:54:42,301][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 18:54:51,960][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 18:54:51,961][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 18:55:50,102][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 18:55:50,102][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 18:55:50,103][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 18:55:50,103][flwr][INFO] - 
[2024-10-02 18:55:50,103][flwr][INFO] - [ROUND 4]
[2024-10-02 18:55:50,103][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 19:21:57,212][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 19:27:35,872][flwr][INFO] - fit progress: (4, 0.029563343876088444, OrderedDict([('ind_iou_0', 0.7632656186352433), ('ind_dice_liver_0', tensor(0.8607, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1057, dtype=torch.float64)), ('ind_iou_1', 0.792458449207817), ('ind_dice_liver_1', tensor(0.8609, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1875, dtype=torch.float64)), ('all_iou', 0.7896180656926484), ('all_dice_liver', tensor(0.8609, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1796, dtype=torch.float64))]), 8455.536496646702)
[2024-10-02 19:27:35,880][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 19:27:45,488][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 19:27:45,489][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 19:28:44,090][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 19:28:44,091][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 19:28:44,091][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 19:28:44,091][flwr][INFO] - 
[2024-10-02 19:28:44,091][flwr][INFO] - [ROUND 5]
[2024-10-02 19:28:44,091][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 19:54:42,779][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 20:00:20,738][flwr][INFO] - fit progress: (5, 0.039747040509893944, OrderedDict([('ind_iou_0', 0.7423617474321269), ('ind_dice_liver_0', tensor(0.8511, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1046, dtype=torch.float64)), ('ind_iou_1', 0.8012572595953201), ('ind_dice_liver_1', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1975, dtype=torch.float64)), ('all_iou', 0.7955268854389017), ('all_dice_liver', tensor(0.8660, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1885, dtype=torch.float64))]), 10420.40334013477)
[2024-10-02 20:00:20,747][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 20:00:30,594][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 20:00:30,595][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 20:01:29,015][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 20:01:29,015][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 20:01:29,017][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 20:01:29,017][flwr][INFO] - 
[2024-10-02 20:01:29,017][flwr][INFO] - [ROUND 6]
[2024-10-02 20:01:29,018][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 20:27:37,553][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 20:33:16,322][flwr][INFO] - fit progress: (6, 0.034848944584534615, OrderedDict([('ind_iou_0', 0.7319958154178373), ('ind_dice_liver_0', tensor(0.8256, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0815, dtype=torch.float64)), ('ind_iou_1', 0.7682104377739095), ('ind_dice_liver_1', tensor(0.8330, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1574, dtype=torch.float64)), ('all_iou', 0.7646868528960192), ('all_dice_liver', tensor(0.8322, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1500, dtype=torch.float64))]), 12395.986542250961)
[2024-10-02 20:33:16,330][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 20:33:25,938][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 20:33:25,938][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 20:34:24,265][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 20:34:24,265][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 20:34:24,266][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 20:34:24,266][flwr][INFO] - 
[2024-10-02 20:34:24,266][flwr][INFO] - [ROUND 7]
[2024-10-02 20:34:24,266][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 21:00:25,248][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 21:06:03,918][flwr][INFO] - fit progress: (7, 0.03743397264123094, OrderedDict([('ind_iou_0', 0.7598406122144927), ('ind_dice_liver_0', tensor(0.8693, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1058, dtype=torch.float64)), ('ind_iou_1', 0.8046644866845349), ('ind_dice_liver_1', tensor(0.8758, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2020, dtype=torch.float64)), ('all_iou', 0.8003032448442063), ('all_dice_liver', tensor(0.8751, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1927, dtype=torch.float64))]), 14363.582846730947)
[2024-10-02 21:06:03,926][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 21:06:13,326][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 21:06:13,326][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 21:07:11,725][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 21:07:11,726][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 21:07:11,726][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 21:07:11,726][flwr][INFO] - 
[2024-10-02 21:07:11,726][flwr][INFO] - [ROUND 8]
[2024-10-02 21:07:11,726][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 21:33:16,684][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 21:38:54,863][flwr][INFO] - fit progress: (8, 0.03598673093330745, OrderedDict([('ind_iou_0', 0.7676183122734038), ('ind_dice_liver_0', tensor(0.8761, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1079, dtype=torch.float64)), ('ind_iou_1', 0.7991924076411702), ('ind_dice_liver_1', tensor(0.8780, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2040, dtype=torch.float64)), ('all_iou', 0.7961203334972788), ('all_dice_liver', tensor(0.8778, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1947, dtype=torch.float64))]), 16334.528017427772)
[2024-10-02 21:38:54,871][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 21:39:04,529][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 21:39:04,530][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 21:40:03,703][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 21:40:03,703][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 21:40:03,704][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 21:40:03,704][flwr][INFO] - 
[2024-10-02 21:40:03,704][flwr][INFO] - [ROUND 9]
[2024-10-02 21:40:03,704][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 22:06:08,242][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 22:11:46,739][flwr][INFO] - fit progress: (9, 0.035067493003822316, OrderedDict([('ind_iou_0', 0.7728537786354228), ('ind_dice_liver_0', tensor(0.8724, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1074, dtype=torch.float64)), ('ind_iou_1', 0.8061523173626962), ('ind_dice_liver_1', tensor(0.8720, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2036, dtype=torch.float64)), ('all_iou', 0.8029124595405842), ('all_dice_liver', tensor(0.8721, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1943, dtype=torch.float64))]), 18306.40392705612)
[2024-10-02 22:11:46,747][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 22:11:56,346][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 22:11:56,347][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 22:12:54,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 22:12:54,921][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 22:12:54,922][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 22:12:54,923][flwr][INFO] - 
[2024-10-02 22:12:54,923][flwr][INFO] - [ROUND 10]
[2024-10-02 22:12:54,923][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 22:38:59,523][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 22:44:37,414][flwr][INFO] - fit progress: (10, 0.029701177310724042, OrderedDict([('ind_iou_0', 0.7686752312068342), ('ind_dice_liver_0', tensor(0.8668, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0996, dtype=torch.float64)), ('ind_iou_1', 0.8101798638917735), ('ind_dice_liver_1', tensor(0.8736, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1917, dtype=torch.float64)), ('all_iou', 0.8061415753062118), ('all_dice_liver', tensor(0.8729, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1828, dtype=torch.float64))]), 20277.07882509567)
[2024-10-02 22:44:37,422][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 22:44:47,027][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 22:44:47,028][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 22:45:45,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 22:45:45,624][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 22:45:45,625][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 22:45:45,625][flwr][INFO] - 
[2024-10-02 22:45:45,625][flwr][INFO] - [ROUND 11]
[2024-10-02 22:45:45,625][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 23:11:53,252][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 23:17:33,498][flwr][INFO] - fit progress: (11, 0.032758499148617753, OrderedDict([('ind_iou_0', 0.7813398418106301), ('ind_dice_liver_0', tensor(0.8828, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1042, dtype=torch.float64)), ('ind_iou_1', 0.8270010005446841), ('ind_dice_liver_1', tensor(0.8861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2014, dtype=torch.float64)), ('all_iou', 0.8225582932083976), ('all_dice_liver', tensor(0.8858, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1919, dtype=torch.float64))]), 22253.16270438209)
[2024-10-02 23:17:33,506][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 23:17:43,015][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 23:17:43,015][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 23:18:41,668][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 23:18:41,668][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 23:18:41,668][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 23:18:41,668][flwr][INFO] - 
[2024-10-02 23:18:41,669][flwr][INFO] - [ROUND 12]
[2024-10-02 23:18:41,669][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-02 23:44:40,538][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-02 23:50:20,084][flwr][INFO] - fit progress: (12, 0.03437863191428092, OrderedDict([('ind_iou_0', 0.7578972219830278), ('ind_dice_liver_0', tensor(0.8530, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1020, dtype=torch.float64)), ('ind_iou_1', 0.7855386374437445), ('ind_dice_liver_1', tensor(0.8488, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1866, dtype=torch.float64)), ('all_iou', 0.7828492024259457), ('all_dice_liver', tensor(0.8492, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1783, dtype=torch.float64))]), 24219.749075086787)
[2024-10-02 23:50:20,093][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-02 23:50:30,045][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 23:50:30,046][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 23:51:28,329][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-02 23:51:28,329][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-02 23:51:28,329][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-02 23:51:28,329][flwr][INFO] - 
[2024-10-02 23:51:28,329][flwr][INFO] - [ROUND 13]
[2024-10-02 23:51:28,330][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 00:17:28,866][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 00:23:10,450][flwr][INFO] - fit progress: (13, 0.033865027635789316, OrderedDict([('ind_iou_0', 0.7575468827999478), ('ind_dice_liver_0', tensor(0.8626, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0911, dtype=torch.float64)), ('ind_iou_1', 0.8185584957041661), ('ind_dice_liver_1', tensor(0.8782, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1851, dtype=torch.float64)), ('all_iou', 0.8126222306648354), ('all_dice_liver', tensor(0.8767, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1760, dtype=torch.float64))]), 26190.115073392168)
[2024-10-03 00:23:10,458][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 00:23:20,007][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 00:23:20,016][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 00:24:19,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 00:24:19,605][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 00:24:19,606][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 00:24:19,606][flwr][INFO] - 
[2024-10-03 00:24:19,606][flwr][INFO] - [ROUND 14]
[2024-10-03 00:24:19,606][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 00:50:22,654][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 00:56:04,779][flwr][INFO] - fit progress: (14, 0.03400996497460522, OrderedDict([('ind_iou_0', 0.7782966673369573), ('ind_dice_liver_0', tensor(0.8768, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1101, dtype=torch.float64)), ('ind_iou_1', 0.8299531972170241), ('ind_dice_liver_1', tensor(0.8895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2039, dtype=torch.float64)), ('all_iou', 0.8249271564719355), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1948, dtype=torch.float64))]), 28164.443912366405)
[2024-10-03 00:56:04,787][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 00:56:14,683][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 00:56:14,684][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 00:57:14,942][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 00:57:14,942][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 00:57:14,943][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 00:57:14,943][flwr][INFO] - 
[2024-10-03 00:57:14,943][flwr][INFO] - [ROUND 15]
[2024-10-03 00:57:14,943][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 01:23:41,097][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 01:29:29,159][flwr][INFO] - fit progress: (15, 0.0378299880950499, OrderedDict([('ind_iou_0', 0.7762452514925531), ('ind_dice_liver_0', tensor(0.8749, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1113, dtype=torch.float64)), ('ind_iou_1', 0.8127243090426509), ('ind_dice_liver_1', tensor(0.8826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2068, dtype=torch.float64)), ('all_iou', 0.8091749953350741), ('all_dice_liver', tensor(0.8819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1975, dtype=torch.float64))]), 30168.824040155858)
[2024-10-03 01:29:29,168][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 01:29:39,632][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 01:29:39,632][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 01:30:40,209][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 01:30:40,209][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 01:30:40,210][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 01:30:40,210][flwr][INFO] - 
[2024-10-03 01:30:40,210][flwr][INFO] - [ROUND 16]
[2024-10-03 01:30:40,210][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 01:57:05,812][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 02:02:54,356][flwr][INFO] - fit progress: (16, 0.03842664849426527, OrderedDict([('ind_iou_0', 0.7783810179772063), ('ind_dice_liver_0', tensor(0.8835, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1087, dtype=torch.float64)), ('ind_iou_1', 0.8216287499696897), ('ind_dice_liver_1', tensor(0.8872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2113, dtype=torch.float64)), ('all_iou', 0.8174208625325838), ('all_dice_liver', tensor(0.8868, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2013, dtype=torch.float64))]), 32174.02051444538)
[2024-10-03 02:02:54,364][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 02:03:04,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 02:03:04,390][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 02:04:04,718][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 02:04:04,718][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 02:04:04,719][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 02:04:04,719][flwr][INFO] - 
[2024-10-03 02:04:04,719][flwr][INFO] - [ROUND 17]
[2024-10-03 02:04:04,719][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 02:30:28,220][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 02:36:16,162][flwr][INFO] - fit progress: (17, 0.03611498671268245, OrderedDict([('ind_iou_0', 0.7765162443484952), ('ind_dice_liver_0', tensor(0.8779, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1001, dtype=torch.float64)), ('ind_iou_1', 0.815800984285286), ('ind_dice_liver_1', tensor(0.8784, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1943, dtype=torch.float64)), ('all_iou', 0.8119786852644082), ('all_dice_liver', tensor(0.8783, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1851, dtype=torch.float64))]), 34175.82696644962)
[2024-10-03 02:36:16,171][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 02:36:26,135][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 02:36:26,135][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 02:37:26,177][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 02:37:26,177][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 02:37:26,178][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 02:37:26,178][flwr][INFO] - 
[2024-10-03 02:37:26,178][flwr][INFO] - [ROUND 18]
[2024-10-03 02:37:26,178][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 03:03:54,062][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 03:09:46,912][flwr][INFO] - fit progress: (18, 0.03845586547870631, OrderedDict([('ind_iou_0', 0.7792399342906509), ('ind_dice_liver_0', tensor(0.8834, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1141, dtype=torch.float64)), ('ind_iou_1', 0.8167192502326428), ('ind_dice_liver_1', tensor(0.8821, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2117, dtype=torch.float64)), ('all_iou', 0.813072614086936), ('all_dice_liver', tensor(0.8823, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2022, dtype=torch.float64))]), 36186.57680283114)
[2024-10-03 03:09:46,921][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 03:09:56,974][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 03:09:56,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 03:10:58,052][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 03:10:58,053][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 03:10:58,053][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 03:10:58,053][flwr][INFO] - 
[2024-10-03 03:10:58,053][flwr][INFO] - [ROUND 19]
[2024-10-03 03:10:58,054][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 03:37:26,869][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 03:43:15,806][flwr][INFO] - fit progress: (19, 0.036778306654874804, OrderedDict([('ind_iou_0', 0.7643569459689946), ('ind_dice_liver_0', tensor(0.8660, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1004, dtype=torch.float64)), ('ind_iou_1', 0.8063714204172798), ('ind_dice_liver_1', tensor(0.8717, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1924, dtype=torch.float64)), ('all_iou', 0.802283525606096), ('all_dice_liver', tensor(0.8711, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1835, dtype=torch.float64))]), 38195.47091152705)
[2024-10-03 03:43:15,814][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 03:43:25,675][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 03:43:25,676][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 03:44:25,740][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 03:44:25,740][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 03:44:25,740][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 03:44:25,741][flwr][INFO] - 
[2024-10-03 03:44:25,741][flwr][INFO] - [ROUND 20]
[2024-10-03 03:44:25,741][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 04:10:50,330][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 04:16:38,184][flwr][INFO] - fit progress: (20, 0.04100302660156647, OrderedDict([('ind_iou_0', 0.7739707679410364), ('ind_dice_liver_0', tensor(0.8791, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1008, dtype=torch.float64)), ('ind_iou_1', 0.8171720909474365), ('ind_dice_liver_1', tensor(0.8797, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1972, dtype=torch.float64)), ('all_iou', 0.8129687189792459), ('all_dice_liver', tensor(0.8797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1878, dtype=torch.float64))]), 40197.848558334634)
[2024-10-03 04:16:38,192][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 04:16:47,890][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 04:16:47,891][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 04:17:48,555][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 04:17:48,555][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 04:17:48,556][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 04:17:48,556][flwr][INFO] - 
[2024-10-03 04:17:48,556][flwr][INFO] - [ROUND 21]
[2024-10-03 04:17:48,556][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 04:44:16,655][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 04:50:04,340][flwr][INFO] - fit progress: (21, 0.038595699086706896, OrderedDict([('ind_iou_0', 0.7765529527144016), ('ind_dice_liver_0', tensor(0.8813, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1033, dtype=torch.float64)), ('ind_iou_1', 0.8161181469467682), ('ind_dice_liver_1', tensor(0.8808, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2016, dtype=torch.float64)), ('all_iou', 0.8122685604809157), ('all_dice_liver', tensor(0.8809, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1920, dtype=torch.float64))]), 42204.00466450304)
[2024-10-03 04:50:04,349][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 04:50:14,120][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 04:50:14,121][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 04:51:14,414][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 04:51:14,415][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 04:51:14,416][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 04:51:14,416][flwr][INFO] - 
[2024-10-03 04:51:14,416][flwr][INFO] - [ROUND 22]
[2024-10-03 04:51:14,416][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 05:17:41,844][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 05:23:29,247][flwr][INFO] - fit progress: (22, 0.03910966773207355, OrderedDict([('ind_iou_0', 0.7787487041706005), ('ind_dice_liver_0', tensor(0.8833, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1057, dtype=torch.float64)), ('ind_iou_1', 0.8203395411629595), ('ind_dice_liver_1', tensor(0.8848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2102, dtype=torch.float64)), ('all_iou', 0.8162928651312694), ('all_dice_liver', tensor(0.8846, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2000, dtype=torch.float64))]), 44208.91143621504)
[2024-10-03 05:23:29,256][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 05:23:39,302][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 05:23:39,302][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 05:24:39,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 05:24:39,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 05:24:39,554][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 05:24:39,554][flwr][INFO] - 
[2024-10-03 05:24:39,554][flwr][INFO] - [ROUND 23]
[2024-10-03 05:24:39,554][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 05:51:03,637][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 05:56:49,818][flwr][INFO] - fit progress: (23, 0.041807390631805455, OrderedDict([('ind_iou_0', 0.7680539434148103), ('ind_dice_liver_0', tensor(0.8725, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1083, dtype=torch.float64)), ('ind_iou_1', 0.8129914495293987), ('ind_dice_liver_1', tensor(0.8790, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2088, dtype=torch.float64)), ('all_iou', 0.8086191516371687), ('all_dice_liver', tensor(0.8784, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1991, dtype=torch.float64))]), 46209.48252177052)
[2024-10-03 05:56:49,826][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 05:56:59,931][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 05:56:59,931][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 05:58:00,042][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 05:58:00,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 05:58:00,043][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 05:58:00,043][flwr][INFO] - 
[2024-10-03 05:58:00,043][flwr][INFO] - [ROUND 24]
[2024-10-03 05:58:00,043][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 06:24:20,193][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 06:30:07,208][flwr][INFO] - fit progress: (24, 0.042530977282993467, OrderedDict([('ind_iou_0', 0.7767812793720129), ('ind_dice_liver_0', tensor(0.8818, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1057, dtype=torch.float64)), ('ind_iou_1', 0.8233267115271387), ('ind_dice_liver_1', tensor(0.8860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2111, dtype=torch.float64)), ('all_iou', 0.818797966776909), ('all_dice_liver', tensor(0.8856, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2008, dtype=torch.float64))]), 48206.87256084569)
[2024-10-03 06:30:07,216][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 06:30:17,211][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 06:30:17,212][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 06:31:17,579][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 06:31:17,579][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 06:31:17,580][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 06:31:17,581][flwr][INFO] - 
[2024-10-03 06:31:17,581][flwr][INFO] - [ROUND 25]
[2024-10-03 06:31:17,581][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 06:57:45,411][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 07:03:31,486][flwr][INFO] - fit progress: (25, 0.0454522428926111, OrderedDict([('ind_iou_0', 0.7803224202525152), ('ind_dice_liver_0', tensor(0.8864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1091, dtype=torch.float64)), ('ind_iou_1', 0.8193489860523264), ('ind_dice_liver_1', tensor(0.8857, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2140, dtype=torch.float64)), ('all_iou', 0.8155518066772095), ('all_dice_liver', tensor(0.8857, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2038, dtype=torch.float64))]), 50211.15135643445)
[2024-10-03 07:03:31,495][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 07:03:41,468][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 07:03:41,468][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 07:04:42,035][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 07:04:42,036][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 07:04:42,037][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 07:04:42,037][flwr][INFO] - 
[2024-10-03 07:04:42,037][flwr][INFO] - [ROUND 26]
[2024-10-03 07:04:42,037][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 07:31:02,016][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 07:36:49,581][flwr][INFO] - fit progress: (26, 0.0422206916074822, OrderedDict([('ind_iou_0', 0.76865436805932), ('ind_dice_liver_0', tensor(0.8712, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1152, dtype=torch.float64)), ('ind_iou_1', 0.8004971936498873), ('ind_dice_liver_1', tensor(0.8708, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2145, dtype=torch.float64)), ('all_iou', 0.7973989727816158), ('all_dice_liver', tensor(0.8709, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2049, dtype=torch.float64))]), 52209.24540408142)
[2024-10-03 07:36:49,589][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 07:36:59,593][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 07:36:59,594][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 07:37:59,722][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 07:37:59,723][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 07:37:59,723][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 07:37:59,723][flwr][INFO] - 
[2024-10-03 07:37:59,723][flwr][INFO] - [ROUND 27]
[2024-10-03 07:37:59,723][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 08:04:21,591][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 08:10:09,314][flwr][INFO] - fit progress: (27, 0.04785937852397912, OrderedDict([('ind_iou_0', 0.7656513567386264), ('ind_dice_liver_0', tensor(0.8768, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1120, dtype=torch.float64)), ('ind_iou_1', 0.8092745300798835), ('ind_dice_liver_1', tensor(0.8777, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2128, dtype=torch.float64)), ('all_iou', 0.8050301132142472), ('all_dice_liver', tensor(0.8776, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2030, dtype=torch.float64))]), 54208.979221738875)
[2024-10-03 08:10:09,322][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 08:10:18,930][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 08:10:18,931][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 08:11:19,374][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 08:11:19,374][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 08:11:19,375][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 08:11:19,375][flwr][INFO] - 
[2024-10-03 08:11:19,375][flwr][INFO] - [ROUND 28]
[2024-10-03 08:11:19,375][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 08:37:40,146][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 08:43:27,994][flwr][INFO] - fit progress: (28, 0.040907168668724424, OrderedDict([('ind_iou_0', 0.7818157929102246), ('ind_dice_liver_0', tensor(0.8876, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0967, dtype=torch.float64)), ('ind_iou_1', 0.8317800685574874), ('ind_dice_liver_1', tensor(0.8920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1961, dtype=torch.float64)), ('all_iou', 0.8269186795755905), ('all_dice_liver', tensor(0.8915, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1864, dtype=torch.float64))]), 56207.658948095515)
[2024-10-03 08:43:28,003][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 08:43:38,018][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 08:43:38,019][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 08:44:38,306][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 08:44:38,307][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 08:44:38,307][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 08:44:38,308][flwr][INFO] - 
[2024-10-03 08:44:38,308][flwr][INFO] - [ROUND 29]
[2024-10-03 08:44:38,308][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 09:11:02,510][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 09:16:48,709][flwr][INFO] - fit progress: (29, 0.039822188455471405, OrderedDict([('ind_iou_0', 0.7713050514634922), ('ind_dice_liver_0', tensor(0.8672, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0999, dtype=torch.float64)), ('ind_iou_1', 0.8133800549140343), ('ind_dice_liver_1', tensor(0.8729, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1920, dtype=torch.float64)), ('all_iou', 0.8092862707945201), ('all_dice_liver', tensor(0.8723, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1830, dtype=torch.float64))]), 58208.37427636795)
[2024-10-03 09:16:48,718][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 09:16:58,692][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 09:16:58,692][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 09:17:58,995][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 09:17:58,995][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 09:17:58,996][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 09:17:58,996][flwr][INFO] - 
[2024-10-03 09:17:58,996][flwr][INFO] - [ROUND 30]
[2024-10-03 09:17:58,997][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-10-03 09:44:24,103][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-10-03 09:50:12,654][flwr][INFO] - fit progress: (30, 0.04932425395692543, OrderedDict([('ind_iou_0', 0.7762124457650629), ('ind_dice_liver_0', tensor(0.8891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0975, dtype=torch.float64)), ('ind_iou_1', 0.8318889669765156), ('ind_dice_liver_1', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.1941, dtype=torch.float64)), ('all_iou', 0.8264717919397251), ('all_dice_liver', tensor(0.8959, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1847, dtype=torch.float64))]), 60212.31887036003)
[2024-10-03 09:50:12,663][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-10-03 09:50:22,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 09:50:22,388][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676669, ip=172.18.62.7, actor_id=4afe782f0df1b88e2c6dabc501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14cb1d428a60>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 09:51:22,711][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-10-03 09:51:22,711][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2676670, ip=172.18.62.7, actor_id=c20bdff71d102af29b89153501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14590c020af0>)
  File "/home/sc.uni-leipzig.de/mp096jdyo/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-10-03 09:51:22,711][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-10-03 09:51:22,711][flwr][INFO] - 
[2024-10-03 09:51:22,711][flwr][INFO] - [SUMMARY]
[2024-10-03 09:51:22,712][flwr][INFO] - Run finished 30 round(s) in 60282.38s
[2024-10-03 09:51:22,797][flwr][INFO] - 	History (loss, centralized):
[2024-10-03 09:51:22,797][flwr][INFO] - 		round 0: 0.7083181132861226
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 1: 0.0754784170653508
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 2: 0.028017306481720437
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 3: 0.03045905054135113
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 4: 0.029563343876088444
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 5: 0.039747040509893944
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 6: 0.034848944584534615
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 7: 0.03743397264123094
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 8: 0.03598673093330745
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 9: 0.035067493003822316
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 10: 0.029701177310724042
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 11: 0.032758499148617753
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 12: 0.03437863191428092
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 13: 0.033865027635789316
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 14: 0.03400996497460522
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 15: 0.0378299880950499
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 16: 0.03842664849426527
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 17: 0.03611498671268245
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 18: 0.03845586547870631
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 19: 0.036778306654874804
[2024-10-03 09:51:22,798][flwr][INFO] - 		round 20: 0.04100302660156647
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 21: 0.038595699086706896
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 22: 0.03910966773207355
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 23: 0.041807390631805455
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 24: 0.042530977282993467
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 25: 0.0454522428926111
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 26: 0.0422206916074822
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 27: 0.04785937852397912
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 28: 0.040907168668724424
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 29: 0.039822188455471405
[2024-10-03 09:51:22,799][flwr][INFO] - 		round 30: 0.04932425395692543
[2024-10-03 09:51:22,799][flwr][INFO] - 	History (metrics, centralized):
[2024-10-03 09:51:22,799][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1618, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (1, tensor(0.7467, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (2, tensor(0.8331, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (3, tensor(0.8500, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (4, tensor(0.8609, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (5, tensor(0.8660, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (6, tensor(0.8322, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (7, tensor(0.8751, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (8, tensor(0.8778, dtype=torch.float64)),
[2024-10-03 09:51:22,799][flwr][INFO] - 	                    (9, tensor(0.8721, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (10, tensor(0.8729, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (11, tensor(0.8858, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (12, tensor(0.8492, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (13, tensor(0.8767, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (14, tensor(0.8883, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (15, tensor(0.8819, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (16, tensor(0.8868, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (17, tensor(0.8783, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (18, tensor(0.8823, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (19, tensor(0.8711, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (20, tensor(0.8797, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (21, tensor(0.8809, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (22, tensor(0.8846, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (23, tensor(0.8784, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (24, tensor(0.8856, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (25, tensor(0.8857, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (26, tensor(0.8709, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (27, tensor(0.8776, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (28, tensor(0.8915, dtype=torch.float64)),
[2024-10-03 09:51:22,800][flwr][INFO] - 	                    (29, tensor(0.8723, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                    (30, tensor(0.8959, dtype=torch.float64))],
[2024-10-03 09:51:22,801][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0091, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (1, tensor(0.1062, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (2, tensor(0.1399, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (3, tensor(0.1626, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (4, tensor(0.1796, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (5, tensor(0.1885, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (6, tensor(0.1500, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (7, tensor(0.1927, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (8, tensor(0.1947, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (9, tensor(0.1943, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (10, tensor(0.1828, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (11, tensor(0.1919, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (12, tensor(0.1783, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (13, tensor(0.1760, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (14, tensor(0.1948, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (15, tensor(0.1975, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (16, tensor(0.2013, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (17, tensor(0.1851, dtype=torch.float64)),
[2024-10-03 09:51:22,801][flwr][INFO] - 	                     (18, tensor(0.2022, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (19, tensor(0.1835, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (20, tensor(0.1878, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (21, tensor(0.1920, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (22, tensor(0.2000, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (23, tensor(0.1991, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (24, tensor(0.2008, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (25, tensor(0.2038, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (26, tensor(0.2049, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (27, tensor(0.2030, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (28, tensor(0.1864, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (29, tensor(0.1830, dtype=torch.float64)),
[2024-10-03 09:51:22,802][flwr][INFO] - 	                     (30, tensor(0.1847, dtype=torch.float64))],
[2024-10-03 09:51:22,802][flwr][INFO] - 	 'all_iou': [(0, 0.06670462923446002),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (1, 0.6650065057308147),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (2, 0.7654097852482357),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (3, 0.775823584841298),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (4, 0.7896180656926484),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (5, 0.7955268854389017),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (6, 0.7646868528960192),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (7, 0.8003032448442063),
[2024-10-03 09:51:22,802][flwr][INFO] - 	             (8, 0.7961203334972788),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (9, 0.8029124595405842),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (10, 0.8061415753062118),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (11, 0.8225582932083976),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (12, 0.7828492024259457),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (13, 0.8126222306648354),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (14, 0.8249271564719355),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (15, 0.8091749953350741),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (16, 0.8174208625325838),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (17, 0.8119786852644082),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (18, 0.813072614086936),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (19, 0.802283525606096),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (20, 0.8129687189792459),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (21, 0.8122685604809157),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (22, 0.8162928651312694),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (23, 0.8086191516371687),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (24, 0.818797966776909),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (25, 0.8155518066772095),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (26, 0.7973989727816158),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (27, 0.8050301132142472),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (28, 0.8269186795755905),
[2024-10-03 09:51:22,803][flwr][INFO] - 	             (29, 0.8092862707945201),
[2024-10-03 09:51:22,804][flwr][INFO] - 	             (30, 0.8264717919397251)],
[2024-10-03 09:51:22,804][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1643, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (1, tensor(0.6983, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (2, tensor(0.8299, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (3, tensor(0.8574, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (4, tensor(0.8607, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (5, tensor(0.8511, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (6, tensor(0.8256, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (7, tensor(0.8693, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (8, tensor(0.8761, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (9, tensor(0.8724, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (10, tensor(0.8668, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (11, tensor(0.8828, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (12, tensor(0.8530, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (13, tensor(0.8626, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (14, tensor(0.8768, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (15, tensor(0.8749, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (16, tensor(0.8835, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (17, tensor(0.8779, dtype=torch.float64)),
[2024-10-03 09:51:22,804][flwr][INFO] - 	                      (18, tensor(0.8834, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (19, tensor(0.8660, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (20, tensor(0.8791, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (21, tensor(0.8813, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (22, tensor(0.8833, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (23, tensor(0.8725, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (24, tensor(0.8818, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (25, tensor(0.8864, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (26, tensor(0.8712, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (27, tensor(0.8768, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (28, tensor(0.8876, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (29, tensor(0.8672, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (30, tensor(0.8891, dtype=torch.float64))],
[2024-10-03 09:51:22,805][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1615, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (1, tensor(0.7519, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (2, tensor(0.8335, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (3, tensor(0.8492, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (4, tensor(0.8609, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (5, tensor(0.8676, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (6, tensor(0.8330, dtype=torch.float64)),
[2024-10-03 09:51:22,805][flwr][INFO] - 	                      (7, tensor(0.8758, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (8, tensor(0.8780, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (9, tensor(0.8720, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (10, tensor(0.8736, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (11, tensor(0.8861, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (12, tensor(0.8488, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (13, tensor(0.8782, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (14, tensor(0.8895, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (15, tensor(0.8826, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (16, tensor(0.8872, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (17, tensor(0.8784, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (18, tensor(0.8821, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (19, tensor(0.8717, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (20, tensor(0.8797, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (21, tensor(0.8808, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (22, tensor(0.8848, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (23, tensor(0.8790, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (24, tensor(0.8860, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (25, tensor(0.8857, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (26, tensor(0.8708, dtype=torch.float64)),
[2024-10-03 09:51:22,806][flwr][INFO] - 	                      (27, tensor(0.8777, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                      (28, tensor(0.8920, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                      (29, tensor(0.8729, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                      (30, tensor(0.8966, dtype=torch.float64))],
[2024-10-03 09:51:22,807][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0080, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (1, tensor(0.0611, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (2, tensor(0.0866, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (3, tensor(0.0988, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (4, tensor(0.1057, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (5, tensor(0.1046, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (6, tensor(0.0815, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (7, tensor(0.1058, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (8, tensor(0.1079, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (9, tensor(0.1074, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (10, tensor(0.0996, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (11, tensor(0.1042, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (12, tensor(0.1020, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (13, tensor(0.0911, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (14, tensor(0.1101, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (15, tensor(0.1113, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (16, tensor(0.1087, dtype=torch.float64)),
[2024-10-03 09:51:22,807][flwr][INFO] - 	                       (17, tensor(0.1001, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (18, tensor(0.1141, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (19, tensor(0.1004, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (20, tensor(0.1008, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (21, tensor(0.1033, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (22, tensor(0.1057, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (23, tensor(0.1083, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (24, tensor(0.1057, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (25, tensor(0.1091, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (26, tensor(0.1152, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (27, tensor(0.1120, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (28, tensor(0.0967, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (29, tensor(0.0999, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (30, tensor(0.0975, dtype=torch.float64))],
[2024-10-03 09:51:22,808][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0092, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (1, tensor(0.1111, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (2, tensor(0.1456, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (3, tensor(0.1695, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (4, tensor(0.1875, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (5, tensor(0.1975, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (6, tensor(0.1574, dtype=torch.float64)),
[2024-10-03 09:51:22,808][flwr][INFO] - 	                       (7, tensor(0.2020, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (8, tensor(0.2040, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (9, tensor(0.2036, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (10, tensor(0.1917, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (11, tensor(0.2014, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (12, tensor(0.1866, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (13, tensor(0.1851, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (14, tensor(0.2039, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (15, tensor(0.2068, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (16, tensor(0.2113, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (17, tensor(0.1943, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (18, tensor(0.2117, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (19, tensor(0.1924, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (20, tensor(0.1972, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (21, tensor(0.2016, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (22, tensor(0.2102, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (23, tensor(0.2088, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (24, tensor(0.2111, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (25, tensor(0.2140, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (26, tensor(0.2145, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (27, tensor(0.2128, dtype=torch.float64)),
[2024-10-03 09:51:22,809][flwr][INFO] - 	                       (28, tensor(0.1961, dtype=torch.float64)),
[2024-10-03 09:51:22,810][flwr][INFO] - 	                       (29, tensor(0.1920, dtype=torch.float64)),
[2024-10-03 09:51:22,810][flwr][INFO] - 	                       (30, tensor(0.1941, dtype=torch.float64))],
[2024-10-03 09:51:22,810][flwr][INFO] - 	 'ind_iou_0': [(0, 0.06779042526483302),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (1, 0.5864363818970737),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (2, 0.7373773828539216),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (3, 0.7592682188878518),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (4, 0.7632656186352433),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (5, 0.7423617474321269),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (6, 0.7319958154178373),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (7, 0.7598406122144927),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (8, 0.7676183122734038),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (9, 0.7728537786354228),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (10, 0.7686752312068342),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (11, 0.7813398418106301),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (12, 0.7578972219830278),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (13, 0.7575468827999478),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (14, 0.7782966673369573),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (15, 0.7762452514925531),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (16, 0.7783810179772063),
[2024-10-03 09:51:22,810][flwr][INFO] - 	               (17, 0.7765162443484952),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (18, 0.7792399342906509),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (19, 0.7643569459689946),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (20, 0.7739707679410364),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (21, 0.7765529527144016),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (22, 0.7787487041706005),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (23, 0.7680539434148103),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (24, 0.7767812793720129),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (25, 0.7803224202525152),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (26, 0.76865436805932),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (27, 0.7656513567386264),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (28, 0.7818157929102246),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (29, 0.7713050514634922),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (30, 0.7762124457650629)],
[2024-10-03 09:51:22,811][flwr][INFO] - 	 'ind_iou_1': [(0, 0.06658759732699471),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (1, 0.6734751418326549),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (2, 0.76843124179373),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (3, 0.777607995542866),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (4, 0.792458449207817),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (5, 0.8012572595953201),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (6, 0.7682104377739095),
[2024-10-03 09:51:22,811][flwr][INFO] - 	               (7, 0.8046644866845349),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (8, 0.7991924076411702),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (9, 0.8061523173626962),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (10, 0.8101798638917735),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (11, 0.8270010005446841),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (12, 0.7855386374437445),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (13, 0.8185584957041661),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (14, 0.8299531972170241),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (15, 0.8127243090426509),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (16, 0.8216287499696897),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (17, 0.815800984285286),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (18, 0.8167192502326428),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (19, 0.8063714204172798),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (20, 0.8171720909474365),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (21, 0.8161181469467682),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (22, 0.8203395411629595),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (23, 0.8129914495293987),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (24, 0.8233267115271387),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (25, 0.8193489860523264),
[2024-10-03 09:51:22,812][flwr][INFO] - 	               (26, 0.8004971936498873),
[2024-10-03 09:51:22,813][flwr][INFO] - 	               (27, 0.8092745300798835),
[2024-10-03 09:51:22,813][flwr][INFO] - 	               (28, 0.8317800685574874),
[2024-10-03 09:51:22,813][flwr][INFO] - 	               (29, 0.8133800549140343),
[2024-10-03 09:51:22,813][flwr][INFO] - 	               (30, 0.8318889669765156)]}
[2024-10-03 09:51:22,813][flwr][INFO] - 
