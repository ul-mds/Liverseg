[2024-12-04 12:10:10,405][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-12-04 12:10:49,253][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 832211639296.0, 'GPU': 3.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.1': 1.0, 'object_store_memory': 200000000000.0, 'node:__internal_head__': 1.0}
[2024-12-04 12:10:49,254][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-04 12:10:49,254][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-04 12:10:49,273][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-04 12:10:49,274][flwr][INFO] - [INIT]
[2024-12-04 12:10:49,274][flwr][INFO] - Requesting initial parameters from one random client
[2024-12-04 12:10:54,689][flwr][INFO] - Received initial parameters from one random client
[2024-12-04 12:10:54,692][flwr][INFO] - Evaluating initial global parameters
[2024-12-04 12:16:09,185][flwr][INFO] - initial parameters (loss, other metrics): 0.6361709236673453, OrderedDict([('ind_iou_0', 1.568745675242773e-10), ('ind_dice_liver_0', tensor(0.1504, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 1.5929912288390675e-10), ('ind_dice_liver_1', tensor(0.1487, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 1.57065041257157e-10), ('all_dice_liver', tensor(0.1502, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
[2024-12-04 12:16:09,273][flwr][INFO] - 
[2024-12-04 12:16:09,274][flwr][INFO] - [ROUND 1]
[2024-12-04 12:16:09,275][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 13:07:27,617][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 13:07:27,676][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-12-04 13:11:54,255][flwr][INFO] - fit progress: (1, 0.007309191065810523, OrderedDict([('ind_iou_0', 0.9396470844317266), ('ind_dice_liver_0', tensor(0.9619, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5143, dtype=torch.float64)), ('ind_iou_1', 0.9279683534505377), ('ind_dice_liver_1', tensor(0.9548, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3782, dtype=torch.float64)), ('all_iou', 0.9386167649692311), ('all_dice_liver', tensor(0.9612, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5046, dtype=torch.float64))]), 3344.981040206738)
[2024-12-04 13:11:54,268][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 13:14:08,776][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 13:14:08,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 13:14:08,803][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 13:14:08,803][flwr][INFO] - 
[2024-12-04 13:14:08,804][flwr][INFO] - [ROUND 2]
[2024-12-04 13:14:08,804][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 14:22:44,502][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 14:29:15,148][flwr][INFO] - fit progress: (2, 0.005999681662090397, OrderedDict([('ind_iou_0', 0.948530183129443), ('ind_dice_liver_0', tensor(0.9663, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5766, dtype=torch.float64)), ('ind_iou_1', 0.9422741827408425), ('ind_dice_liver_1', tensor(0.9607, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4817, dtype=torch.float64)), ('all_iou', 0.9480325690091613), ('all_dice_liver', tensor(0.9658, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5706, dtype=torch.float64))]), 7985.874334636144)
[2024-12-04 14:29:15,153][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 14:31:46,576][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 14:31:46,577][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 14:31:46,578][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 14:31:46,579][flwr][INFO] - 
[2024-12-04 14:31:46,579][flwr][INFO] - [ROUND 3]
[2024-12-04 14:31:46,580][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 15:47:12,347][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 15:53:31,398][flwr][INFO] - fit progress: (3, 0.004877382856721721, OrderedDict([('ind_iou_0', 0.9569305898169702), ('ind_dice_liver_0', tensor(0.9725, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6175, dtype=torch.float64)), ('ind_iou_1', 0.9521626762634431), ('ind_dice_liver_1', tensor(0.9682, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5189, dtype=torch.float64)), ('all_iou', 0.9565716408907092), ('all_dice_liver', tensor(0.9721, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6101, dtype=torch.float64))]), 13042.125027588569)
[2024-12-04 15:53:31,403][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 15:58:56,746][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 15:58:56,747][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 15:58:56,748][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 15:58:56,748][flwr][INFO] - 
[2024-12-04 15:58:56,748][flwr][INFO] - [ROUND 4]
[2024-12-04 15:58:56,749][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 17:03:01,770][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 17:08:20,257][flwr][INFO] - fit progress: (4, 0.004114746909442399, OrderedDict([('ind_iou_0', 0.9632444633527052), ('ind_dice_liver_0', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6529, dtype=torch.float64)), ('ind_iou_1', 0.9606060884754033), ('ind_dice_liver_1', tensor(0.9744, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.9630616845607723), ('all_dice_liver', tensor(0.9768, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6456, dtype=torch.float64))]), 17530.98350684438)
[2024-12-04 17:08:20,262][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 17:10:42,235][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 17:10:42,236][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 17:10:42,237][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 17:10:42,238][flwr][INFO] - 
[2024-12-04 17:10:42,239][flwr][INFO] - [ROUND 5]
[2024-12-04 17:10:42,239][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:10:32,952][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 18:15:56,961][flwr][INFO] - fit progress: (5, 0.003674693956337736, OrderedDict([('ind_iou_0', 0.9672453536128813), ('ind_dice_liver_0', tensor(0.9805, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6669, dtype=torch.float64)), ('ind_iou_1', 0.9680131477798649), ('ind_dice_liver_1', tensor(0.9794, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5803, dtype=torch.float64)), ('all_iou', 0.9673490812760697), ('all_dice_liver', tensor(0.9804, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6610, dtype=torch.float64))]), 21587.68735046964)
[2024-12-04 18:15:56,968][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:18:11,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 18:18:11,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 18:18:11,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:18:11,923][flwr][INFO] - 
[2024-12-04 18:18:11,923][flwr][INFO] - [ROUND 6]
[2024-12-04 18:18:11,924][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 19:15:41,489][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 19:20:37,938][flwr][INFO] - fit progress: (6, 0.003343490719314616, OrderedDict([('ind_iou_0', 0.9701311595344998), ('ind_dice_liver_0', tensor(0.9820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6856, dtype=torch.float64)), ('ind_iou_1', 0.9716150863678239), ('ind_dice_liver_1', tensor(0.9812, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5927, dtype=torch.float64)), ('all_iou', 0.9702936864649568), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 25468.66411369387)
[2024-12-04 19:20:37,944][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 19:22:32,085][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 19:22:32,086][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 19:22:32,087][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 19:22:32,088][flwr][INFO] - 
[2024-12-04 19:22:32,088][flwr][INFO] - [ROUND 7]
[2024-12-04 19:22:32,089][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 20:20:42,641][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 20:25:15,045][flwr][INFO] - fit progress: (7, 0.0030828677261232726, OrderedDict([('ind_iou_0', 0.9729366720537237), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6990, dtype=torch.float64)), ('ind_iou_1', 0.9749556336019467), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6094, dtype=torch.float64)), ('all_iou', 0.9731518338974533), ('all_dice_liver', tensor(0.9841, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6929, dtype=torch.float64))]), 29345.771678640507)
[2024-12-04 20:25:15,051][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 20:27:20,152][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 20:27:20,153][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 20:27:20,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 20:27:20,155][flwr][INFO] - 
[2024-12-04 20:27:20,156][flwr][INFO] - [ROUND 8]
[2024-12-04 20:27:20,156][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 21:32:17,280][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 21:36:25,063][flwr][INFO] - fit progress: (8, 0.002961892542494605, OrderedDict([('ind_iou_0', 0.9742213045766417), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7075, dtype=torch.float64)), ('ind_iou_1', 0.9765056482338446), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6083, dtype=torch.float64)), ('all_iou', 0.9744806431261388), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7012, dtype=torch.float64))]), 33615.789484796114)
[2024-12-04 21:36:25,074][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 21:38:14,520][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 21:38:14,521][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 21:38:14,521][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 21:38:14,521][flwr][INFO] - 
[2024-12-04 21:38:14,522][flwr][INFO] - [ROUND 9]
[2024-12-04 21:38:14,522][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 22:44:12,324][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-04 22:50:11,128][flwr][INFO] - fit progress: (9, 0.0029793664326893516, OrderedDict([('ind_iou_0', 0.9749532875956729), ('ind_dice_liver_0', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9773770339658858), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.9752016474715582), ('all_dice_liver', tensor(0.9861, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7100, dtype=torch.float64))]), 38041.8549388228)
[2024-12-04 22:50:11,134][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 22:52:43,756][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-04 22:52:43,756][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 22:52:43,757][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 22:52:43,758][flwr][INFO] - 
[2024-12-04 22:52:43,758][flwr][INFO] - [ROUND 10]
[2024-12-04 22:52:43,760][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 00:03:12,853][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 00:08:51,484][flwr][INFO] - fit progress: (10, 0.002931450000951924, OrderedDict([('ind_iou_0', 0.9755585946503212), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9787096725065478), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6279, dtype=torch.float64)), ('all_iou', 0.9758783590974501), ('all_dice_liver', tensor(0.9866, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7108, dtype=torch.float64))]), 42762.21016470343)
[2024-12-05 00:08:51,490][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 00:11:01,804][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 00:11:01,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 00:11:01,807][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 00:11:01,808][flwr][INFO] - 
[2024-12-05 00:11:01,808][flwr][INFO] - [ROUND 11]
[2024-12-05 00:11:01,808][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 01:15:50,779][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 01:20:55,929][flwr][INFO] - fit progress: (11, 0.002835746582455747, OrderedDict([('ind_iou_0', 0.9771057827067156), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9804931154079066), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6312, dtype=torch.float64)), ('all_iou', 0.9774528064246356), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7151, dtype=torch.float64))]), 47086.6556754522)
[2024-12-05 01:20:55,934][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 01:23:02,751][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 01:23:02,752][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 01:23:02,753][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 01:23:02,754][flwr][INFO] - 
[2024-12-05 01:23:02,754][flwr][INFO] - [ROUND 12]
[2024-12-05 01:23:02,755][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 02:22:56,703][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 02:28:30,428][flwr][INFO] - fit progress: (12, 0.002819015741277393, OrderedDict([('ind_iou_0', 0.9775585144507694), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7246, dtype=torch.float64)), ('ind_iou_1', 0.9810897637723638), ('ind_dice_liver_1', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9779222352364113), ('all_dice_liver', tensor(0.9880, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7189, dtype=torch.float64))]), 51141.1536735408)
[2024-12-05 02:28:30,435][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 02:31:45,936][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 02:31:45,937][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 02:31:45,938][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 02:31:45,939][flwr][INFO] - 
[2024-12-05 02:31:45,939][flwr][INFO] - [ROUND 13]
[2024-12-05 02:31:45,940][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 03:31:32,154][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 03:36:58,486][flwr][INFO] - fit progress: (13, 0.0028225321303853735, OrderedDict([('ind_iou_0', 0.9780513997752021), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7294, dtype=torch.float64)), ('ind_iou_1', 0.9817646682916628), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6353, dtype=torch.float64)), ('all_iou', 0.9784281164065824), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7240, dtype=torch.float64))]), 55249.21291993465)
[2024-12-05 03:36:58,491][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 03:39:06,946][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 03:39:06,947][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 03:39:06,948][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 03:39:06,949][flwr][INFO] - 
[2024-12-05 03:39:06,950][flwr][INFO] - [ROUND 14]
[2024-12-05 03:39:06,951][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 04:44:40,763][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 04:50:01,087][flwr][INFO] - fit progress: (14, 0.002945382673931214, OrderedDict([('ind_iou_0', 0.9774996637046156), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9817258819590473), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6374, dtype=torch.float64)), ('all_iou', 0.9779347654689567), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7231, dtype=torch.float64))]), 59631.813534174114)
[2024-12-05 04:50:01,098][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 04:52:05,407][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 04:52:05,408][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 04:52:05,410][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 04:52:05,410][flwr][INFO] - 
[2024-12-05 04:52:05,410][flwr][INFO] - [ROUND 15]
[2024-12-05 04:52:05,411][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 05:59:41,004][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 06:04:40,101][flwr][INFO] - fit progress: (15, 0.002851507365681435, OrderedDict([('ind_iou_0', 0.9787129697883933), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9827936456618482), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6421, dtype=torch.float64)), ('all_iou', 0.9791353131550928), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 64110.82740444038)
[2024-12-05 06:04:40,107][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 06:06:57,625][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 06:06:57,626][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 06:06:57,626][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 06:06:57,627][flwr][INFO] - 
[2024-12-05 06:06:57,627][flwr][INFO] - [ROUND 16]
[2024-12-05 06:06:57,628][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 07:07:42,453][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 07:12:58,871][flwr][INFO] - fit progress: (16, 0.0028903455226255777, OrderedDict([('ind_iou_0', 0.9790258688006265), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7316, dtype=torch.float64)), ('ind_iou_1', 0.983699885432905), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6465, dtype=torch.float64)), ('all_iou', 0.979506409420907), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7272, dtype=torch.float64))]), 68209.59765859507)
[2024-12-05 07:12:58,875][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 07:15:05,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 07:15:05,868][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 07:15:05,869][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 07:15:05,870][flwr][INFO] - 
[2024-12-05 07:15:05,870][flwr][INFO] - [ROUND 17]
[2024-12-05 07:15:05,871][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 08:18:25,719][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 08:23:47,265][flwr][INFO] - fit progress: (17, 0.002981101287563202, OrderedDict([('ind_iou_0', 0.9790783668283077), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7338, dtype=torch.float64)), ('ind_iou_1', 0.9836633101950607), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6489, dtype=torch.float64)), ('all_iou', 0.9795542152565662), ('all_dice_liver', tensor(0.9895, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7291, dtype=torch.float64))]), 72457.99179929122)
[2024-12-05 08:23:47,271][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 08:26:21,206][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 08:26:21,207][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 08:26:21,208][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 08:26:21,209][flwr][INFO] - 
[2024-12-05 08:26:21,209][flwr][INFO] - [ROUND 18]
[2024-12-05 08:26:21,209][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 09:28:29,909][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 09:33:38,210][flwr][INFO] - fit progress: (18, 0.0029185861430222814, OrderedDict([('ind_iou_0', 0.9795632566208574), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7371, dtype=torch.float64)), ('ind_iou_1', 0.9847325019454835), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6521, dtype=torch.float64)), ('all_iou', 0.9800859255290736), ('all_dice_liver', tensor(0.9897, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 76648.9366113767)
[2024-12-05 09:33:38,218][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 09:36:02,100][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 09:36:02,101][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 09:36:02,102][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 09:36:02,103][flwr][INFO] - 
[2024-12-05 09:36:02,103][flwr][INFO] - [ROUND 19]
[2024-12-05 09:36:02,103][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 10:32:54,946][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 10:37:36,591][flwr][INFO] - fit progress: (19, 0.0029778361188715122, OrderedDict([('ind_iou_0', 0.9795482438629819), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.9845212804209821), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6530, dtype=torch.float64)), ('all_iou', 0.9800570414927205), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7327, dtype=torch.float64))]), 80487.31750693265)
[2024-12-05 10:37:36,597][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 10:39:19,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 10:39:19,918][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 10:39:19,919][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 10:39:19,920][flwr][INFO] - 
[2024-12-05 10:39:19,920][flwr][INFO] - [ROUND 20]
[2024-12-05 10:39:19,920][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 11:35:23,715][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 11:39:44,205][flwr][INFO] - fit progress: (20, 0.003069441032116429, OrderedDict([('ind_iou_0', 0.9794188233331589), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7366, dtype=torch.float64)), ('ind_iou_1', 0.9845431555152111), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9799466230551032), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7322, dtype=torch.float64))]), 84214.93178351317)
[2024-12-05 11:39:44,209][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 11:41:39,076][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 11:41:39,077][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 11:41:39,078][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 11:41:39,079][flwr][INFO] - 
[2024-12-05 11:41:39,079][flwr][INFO] - [ROUND 21]
[2024-12-05 11:41:39,080][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 12:36:21,989][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 12:41:48,179][flwr][INFO] - fit progress: (21, 0.0030454325812229806, OrderedDict([('ind_iou_0', 0.9798966802547555), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7403, dtype=torch.float64)), ('ind_iou_1', 0.9854512857308466), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6551, dtype=torch.float64)), ('all_iou', 0.9804645655732592), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7357, dtype=torch.float64))]), 87938.9059287943)
[2024-12-05 12:41:48,185][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 12:43:51,096][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 12:43:51,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 12:43:51,099][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 12:43:51,099][flwr][INFO] - 
[2024-12-05 12:43:51,099][flwr][INFO] - [ROUND 22]
[2024-12-05 12:43:51,100][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 13:39:51,574][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 13:45:07,790][flwr][INFO] - fit progress: (22, 0.003151106251172243, OrderedDict([('ind_iou_0', 0.9798619112384731), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7417, dtype=torch.float64)), ('ind_iou_1', 0.9854489062436487), ('ind_dice_liver_1', tensor(0.9921, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6549, dtype=torch.float64)), ('all_iou', 0.9804260694351024), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 91738.5163835967)
[2024-12-05 13:45:07,796][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 13:47:05,692][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 13:47:05,695][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 13:47:05,697][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 13:47:05,698][flwr][INFO] - 
[2024-12-05 13:47:05,700][flwr][INFO] - [ROUND 23]
[2024-12-05 13:47:05,701][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 14:44:32,446][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 14:49:23,310][flwr][INFO] - fit progress: (23, 0.003194383338180135, OrderedDict([('ind_iou_0', 0.9798777448117227), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7410, dtype=torch.float64)), ('ind_iou_1', 0.9855275710310719), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6567, dtype=torch.float64)), ('all_iou', 0.980452015392803), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7363, dtype=torch.float64))]), 95594.03605693206)
[2024-12-05 14:49:23,315][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 14:51:22,475][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 14:51:22,476][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 14:51:22,477][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 14:51:22,478][flwr][INFO] - 
[2024-12-05 14:51:22,478][flwr][INFO] - [ROUND 24]
[2024-12-05 14:51:22,478][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 15:49:52,693][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 15:55:16,955][flwr][INFO] - fit progress: (24, 0.003201173000701002, OrderedDict([('ind_iou_0', 0.9800730770939928), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7423, dtype=torch.float64)), ('ind_iou_1', 0.9861303660393511), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6564, dtype=torch.float64)), ('all_iou', 0.9806770163719891), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 99547.68167318217)
[2024-12-05 15:55:16,960][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 15:57:28,723][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 15:57:28,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 15:57:28,729][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 15:57:28,729][flwr][INFO] - 
[2024-12-05 15:57:28,730][flwr][INFO] - [ROUND 25]
[2024-12-05 15:57:28,730][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 16:56:33,455][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 17:01:33,929][flwr][INFO] - fit progress: (25, 0.0032329137489647028, OrderedDict([('ind_iou_0', 0.9801961712750589), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7430, dtype=torch.float64)), ('ind_iou_1', 0.9863405139579186), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9808191685690155), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7383, dtype=torch.float64))]), 103524.65561342053)
[2024-12-05 17:01:33,938][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 17:03:46,403][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 17:03:46,404][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 17:03:46,405][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 17:03:46,405][flwr][INFO] - 
[2024-12-05 17:03:46,405][flwr][INFO] - [ROUND 26]
[2024-12-05 17:03:46,405][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 18:04:14,175][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 18:08:48,756][flwr][INFO] - fit progress: (26, 0.003236916543988956, OrderedDict([('ind_iou_0', 0.9801720946479946), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7428, dtype=torch.float64)), ('ind_iou_1', 0.986488093000365), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6606, dtype=torch.float64)), ('all_iou', 0.9808140816480584), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7387, dtype=torch.float64))]), 107559.48269970808)
[2024-12-05 18:08:48,762][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 18:11:06,346][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 18:11:06,347][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 18:11:06,349][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 18:11:06,349][flwr][INFO] - 
[2024-12-05 18:11:06,349][flwr][INFO] - [ROUND 27]
[2024-12-05 18:11:06,350][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 19:07:59,891][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 19:12:50,002][flwr][INFO] - fit progress: (27, 0.0032611715839898896, OrderedDict([('ind_iou_0', 0.9801539728370199), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.98652969026575), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6595, dtype=torch.float64)), ('all_iou', 0.9807965655534554), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7385, dtype=torch.float64))]), 111400.7285606591)
[2024-12-05 19:12:50,008][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 19:14:30,008][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 19:14:30,009][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 19:14:30,010][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 19:14:30,011][flwr][INFO] - 
[2024-12-05 19:14:30,011][flwr][INFO] - [ROUND 28]
[2024-12-05 19:14:30,011][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 20:09:51,068][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 20:14:32,225][flwr][INFO] - fit progress: (28, 0.0033295927750053023, OrderedDict([('ind_iou_0', 0.9803204932551977), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7448, dtype=torch.float64)), ('ind_iou_1', 0.9866649780647514), ('ind_dice_liver_1', tensor(0.9929, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6611, dtype=torch.float64)), ('all_iou', 0.98096153193942), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7408, dtype=torch.float64))]), 115102.95193178486)
[2024-12-05 20:14:32,229][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 20:16:16,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 20:16:16,518][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 20:16:16,519][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 20:16:16,520][flwr][INFO] - 
[2024-12-05 20:16:16,520][flwr][INFO] - [ROUND 29]
[2024-12-05 20:16:16,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 21:12:35,797][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 21:18:00,268][flwr][INFO] - fit progress: (29, 0.003369556012365183, OrderedDict([('ind_iou_0', 0.9803765020449099), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7459, dtype=torch.float64)), ('ind_iou_1', 0.9871253303445999), ('ind_dice_liver_1', tensor(0.9931, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6613, dtype=torch.float64)), ('all_iou', 0.9810556426580472), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7416, dtype=torch.float64))]), 118910.9947921997)
[2024-12-05 21:18:00,275][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 21:20:26,376][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 21:20:26,377][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 21:20:26,378][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 21:20:26,379][flwr][INFO] - 
[2024-12-05 21:20:26,379][flwr][INFO] - [ROUND 30]
[2024-12-05 21:20:26,379][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 22:21:27,823][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 22:26:08,909][flwr][INFO] - fit progress: (30, 0.003443805533228719, OrderedDict([('ind_iou_0', 0.9803805257702991), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7456, dtype=torch.float64)), ('ind_iou_1', 0.9871052817041691), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6636, dtype=torch.float64)), ('all_iou', 0.9810619462591109), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7413, dtype=torch.float64))]), 122999.63548722211)
[2024-12-05 22:26:08,916][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 22:28:18,008][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 22:28:18,009][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 22:28:18,013][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 22:28:18,013][flwr][INFO] - 
[2024-12-05 22:28:18,013][flwr][INFO] - [ROUND 31]
[2024-12-05 22:28:18,013][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 23:31:48,438][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-05 23:36:14,214][flwr][INFO] - fit progress: (31, 0.003432301622809893, OrderedDict([('ind_iou_0', 0.9804924413128645), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7482, dtype=torch.float64)), ('ind_iou_1', 0.9875455921584697), ('ind_dice_liver_1', tensor(0.9934, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6644, dtype=torch.float64)), ('all_iou', 0.9811969110940825), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7442, dtype=torch.float64))]), 127204.94067054521)
[2024-12-05 23:36:14,220][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 23:38:05,020][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-05 23:38:05,021][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 23:38:05,022][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 23:38:05,022][flwr][INFO] - 
[2024-12-05 23:38:05,023][flwr][INFO] - [ROUND 32]
[2024-12-05 23:38:05,023][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 00:37:51,149][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 00:42:47,880][flwr][INFO] - fit progress: (32, 0.0035083443612994253, OrderedDict([('ind_iou_0', 0.98022160733947), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7452, dtype=torch.float64)), ('ind_iou_1', 0.9869060371067591), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6627, dtype=torch.float64)), ('all_iou', 0.980902278562422), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7410, dtype=torch.float64))]), 131198.60635207966)
[2024-12-06 00:42:47,885][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 00:45:02,049][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 00:45:02,050][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 00:45:02,051][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 00:45:02,051][flwr][INFO] - 
[2024-12-06 00:45:02,051][flwr][INFO] - [ROUND 33]
[2024-12-06 00:45:02,052][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 01:40:25,178][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 01:45:19,064][flwr][INFO] - fit progress: (33, 0.003603306511366091, OrderedDict([('ind_iou_0', 0.9804865805125786), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7458, dtype=torch.float64)), ('ind_iou_1', 0.9874911892158853), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6642, dtype=torch.float64)), ('all_iou', 0.9811998316656121), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7415, dtype=torch.float64))]), 134949.79011438228)
[2024-12-06 01:45:19,073][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 01:47:06,411][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 01:47:06,412][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 01:47:06,412][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 01:47:06,413][flwr][INFO] - 
[2024-12-06 01:47:06,413][flwr][INFO] - [ROUND 34]
[2024-12-06 01:47:06,414][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 02:42:55,100][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 02:47:52,429][flwr][INFO] - fit progress: (34, 0.0035635193101131533, OrderedDict([('ind_iou_0', 0.9805559863736416), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7478, dtype=torch.float64)), ('ind_iou_1', 0.9876445598789428), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6638, dtype=torch.float64)), ('all_iou', 0.9812755557592018), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7439, dtype=torch.float64))]), 138703.15580374468)
[2024-12-06 02:47:52,434][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 02:49:28,153][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 02:49:28,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 02:49:28,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 02:49:28,156][flwr][INFO] - 
[2024-12-06 02:49:28,156][flwr][INFO] - [ROUND 35]
[2024-12-06 02:49:28,157][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 03:47:15,048][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 03:52:30,567][flwr][INFO] - fit progress: (35, 0.003682387338529865, OrderedDict([('ind_iou_0', 0.9805355426726553), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7470, dtype=torch.float64)), ('ind_iou_1', 0.9877338973058879), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812670386956065), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7434, dtype=torch.float64))]), 142581.2935127318)
[2024-12-06 03:52:30,573][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 03:54:27,403][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 03:54:27,404][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 03:54:27,405][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 03:54:27,406][flwr][INFO] - 
[2024-12-06 03:54:27,406][flwr][INFO] - [ROUND 36]
[2024-12-06 03:54:27,406][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 04:52:21,424][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 04:57:10,065][flwr][INFO] - fit progress: (36, 0.00372388794476678, OrderedDict([('ind_iou_0', 0.9805378548410408), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9877982194665248), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812755504497777), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7441, dtype=torch.float64))]), 146460.79117257148)
[2024-12-06 04:57:10,070][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 04:59:19,383][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 04:59:19,383][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 04:59:19,383][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 04:59:19,384][flwr][INFO] - 
[2024-12-06 04:59:19,386][flwr][INFO] - [ROUND 37]
[2024-12-06 04:59:19,387][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 05:53:42,011][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 05:58:14,562][flwr][INFO] - fit progress: (37, 0.0037690799932497223, OrderedDict([('ind_iou_0', 0.9805272608774467), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9880771920950169), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6655, dtype=torch.float64)), ('all_iou', 0.9812902741551258), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7448, dtype=torch.float64))]), 150125.28822886106)
[2024-12-06 05:58:14,569][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 06:00:20,798][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 06:00:20,799][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 06:00:20,800][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 06:00:20,801][flwr][INFO] - 
[2024-12-06 06:00:20,801][flwr][INFO] - [ROUND 38]
[2024-12-06 06:00:20,802][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 06:57:18,732][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 07:02:18,311][flwr][INFO] - fit progress: (38, 0.003833987507661838, OrderedDict([('ind_iou_0', 0.980554560325031), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9882166508655339), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6665, dtype=torch.float64)), ('all_iou', 0.9813244425761467), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7444, dtype=torch.float64))]), 153969.0379202636)
[2024-12-06 07:02:18,319][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 07:04:11,638][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 07:04:11,639][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 07:04:11,640][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 07:04:11,641][flwr][INFO] - 
[2024-12-06 07:04:11,641][flwr][INFO] - [ROUND 39]
[2024-12-06 07:04:11,642][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 08:04:07,343][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 08:09:18,404][flwr][INFO] - fit progress: (39, 0.003919898209025847, OrderedDict([('ind_iou_0', 0.9805101146633938), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7490, dtype=torch.float64)), ('ind_iou_1', 0.9881835686430218), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6652, dtype=torch.float64)), ('all_iou', 0.9812834626796675), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7456, dtype=torch.float64))]), 157989.13017500285)
[2024-12-06 08:09:18,409][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 08:10:55,699][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 08:10:55,701][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 08:10:55,703][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 08:10:55,703][flwr][INFO] - 
[2024-12-06 08:10:55,703][flwr][INFO] - [ROUND 40]
[2024-12-06 08:10:55,704][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 09:13:44,925][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 09:18:02,659][flwr][INFO] - fit progress: (40, 0.003916043597085271, OrderedDict([('ind_iou_0', 0.9804012946094569), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9881644289529422), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6663, dtype=torch.float64)), ('all_iou', 0.981189859926939), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7446, dtype=torch.float64))]), 162113.38599647302)
[2024-12-06 09:18:02,665][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 09:19:40,742][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 09:19:40,743][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 09:19:40,744][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 09:19:40,745][flwr][INFO] - 
[2024-12-06 09:19:40,746][flwr][INFO] - [SUMMARY]
[2024-12-06 09:19:40,746][flwr][INFO] - Run finished 40 round(s) in 162211.47s
[2024-12-06 09:19:40,960][flwr][INFO] - 	History (loss, centralized):
[2024-12-06 09:19:40,961][flwr][INFO] - 		round 0: 0.6361709236673453
[2024-12-06 09:19:40,961][flwr][INFO] - 		round 1: 0.007309191065810523
[2024-12-06 09:19:40,962][flwr][INFO] - 		round 2: 0.005999681662090397
[2024-12-06 09:19:40,962][flwr][INFO] - 		round 3: 0.004877382856721721
[2024-12-06 09:19:40,963][flwr][INFO] - 		round 4: 0.004114746909442399
[2024-12-06 09:19:40,963][flwr][INFO] - 		round 5: 0.003674693956337736
[2024-12-06 09:19:40,964][flwr][INFO] - 		round 6: 0.003343490719314616
[2024-12-06 09:19:40,964][flwr][INFO] - 		round 7: 0.0030828677261232726
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 8: 0.002961892542494605
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 9: 0.0029793664326893516
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 10: 0.002931450000951924
[2024-12-06 09:19:40,966][flwr][INFO] - 		round 11: 0.002835746582455747
[2024-12-06 09:19:40,967][flwr][INFO] - 		round 12: 0.002819015741277393
[2024-12-06 09:19:40,967][flwr][INFO] - 		round 13: 0.0028225321303853735
[2024-12-06 09:19:40,968][flwr][INFO] - 		round 14: 0.002945382673931214
[2024-12-06 09:19:40,968][flwr][INFO] - 		round 15: 0.002851507365681435
[2024-12-06 09:19:40,969][flwr][INFO] - 		round 16: 0.0028903455226255777
[2024-12-06 09:19:40,970][flwr][INFO] - 		round 17: 0.002981101287563202
[2024-12-06 09:19:40,970][flwr][INFO] - 		round 18: 0.0029185861430222814
[2024-12-06 09:19:40,971][flwr][INFO] - 		round 19: 0.0029778361188715122
[2024-12-06 09:19:40,971][flwr][INFO] - 		round 20: 0.003069441032116429
[2024-12-06 09:19:40,972][flwr][INFO] - 		round 21: 0.0030454325812229806
[2024-12-06 09:19:40,972][flwr][INFO] - 		round 22: 0.003151106251172243
[2024-12-06 09:19:40,973][flwr][INFO] - 		round 23: 0.003194383338180135
[2024-12-06 09:19:40,973][flwr][INFO] - 		round 24: 0.003201173000701002
[2024-12-06 09:19:40,974][flwr][INFO] - 		round 25: 0.0032329137489647028
[2024-12-06 09:19:40,974][flwr][INFO] - 		round 26: 0.003236916543988956
[2024-12-06 09:19:40,975][flwr][INFO] - 		round 27: 0.0032611715839898896
[2024-12-06 09:19:40,975][flwr][INFO] - 		round 28: 0.0033295927750053023
[2024-12-06 09:19:40,976][flwr][INFO] - 		round 29: 0.003369556012365183
[2024-12-06 09:19:40,977][flwr][INFO] - 		round 30: 0.003443805533228719
[2024-12-06 09:19:40,977][flwr][INFO] - 		round 31: 0.003432301622809893
[2024-12-06 09:19:40,980][flwr][INFO] - 		round 32: 0.0035083443612994253
[2024-12-06 09:19:40,980][flwr][INFO] - 		round 33: 0.003603306511366091
[2024-12-06 09:19:40,981][flwr][INFO] - 		round 34: 0.0035635193101131533
[2024-12-06 09:19:40,982][flwr][INFO] - 		round 35: 0.003682387338529865
[2024-12-06 09:19:40,983][flwr][INFO] - 		round 36: 0.00372388794476678
[2024-12-06 09:19:40,983][flwr][INFO] - 		round 37: 0.0037690799932497223
[2024-12-06 09:19:40,984][flwr][INFO] - 		round 38: 0.003833987507661838
[2024-12-06 09:19:40,984][flwr][INFO] - 		round 39: 0.003919898209025847
[2024-12-06 09:19:40,985][flwr][INFO] - 		round 40: 0.003916043597085271
[2024-12-06 09:19:40,985][flwr][INFO] - 	History (metrics, centralized):
[2024-12-06 09:19:40,986][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1502, dtype=torch.float64)),
[2024-12-06 09:19:40,986][flwr][INFO] - 	                    (1, tensor(0.9612, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (2, tensor(0.9658, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (3, tensor(0.9721, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (4, tensor(0.9768, dtype=torch.float64)),
[2024-12-06 09:19:40,988][flwr][INFO] - 	                    (5, tensor(0.9804, dtype=torch.float64)),
[2024-12-06 09:19:40,988][flwr][INFO] - 	                    (6, tensor(0.9819, dtype=torch.float64)),
[2024-12-06 09:19:40,989][flwr][INFO] - 	                    (7, tensor(0.9841, dtype=torch.float64)),
[2024-12-06 09:19:40,989][flwr][INFO] - 	                    (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:40,990][flwr][INFO] - 	                    (9, tensor(0.9861, dtype=torch.float64)),
[2024-12-06 09:19:40,990][flwr][INFO] - 	                    (10, tensor(0.9866, dtype=torch.float64)),
[2024-12-06 09:19:40,991][flwr][INFO] - 	                    (11, tensor(0.9878, dtype=torch.float64)),
[2024-12-06 09:19:40,991][flwr][INFO] - 	                    (12, tensor(0.9880, dtype=torch.float64)),
[2024-12-06 09:19:40,992][flwr][INFO] - 	                    (13, tensor(0.9884, dtype=torch.float64)),
[2024-12-06 09:19:40,992][flwr][INFO] - 	                    (14, tensor(0.9883, dtype=torch.float64)),
[2024-12-06 09:19:40,993][flwr][INFO] - 	                    (15, tensor(0.9890, dtype=torch.float64)),
[2024-12-06 09:19:40,994][flwr][INFO] - 	                    (16, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:40,994][flwr][INFO] - 	                    (17, tensor(0.9895, dtype=torch.float64)),
[2024-12-06 09:19:40,997][flwr][INFO] - 	                    (18, tensor(0.9897, dtype=torch.float64)),
[2024-12-06 09:19:40,997][flwr][INFO] - 	                    (19, tensor(0.9898, dtype=torch.float64)),
[2024-12-06 09:19:40,998][flwr][INFO] - 	                    (20, tensor(0.9898, dtype=torch.float64)),
[2024-12-06 09:19:40,998][flwr][INFO] - 	                    (21, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:40,999][flwr][INFO] - 	                    (22, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,000][flwr][INFO] - 	                    (23, tensor(0.9904, dtype=torch.float64)),
[2024-12-06 09:19:41,000][flwr][INFO] - 	                    (24, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,001][flwr][INFO] - 	                    (25, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,001][flwr][INFO] - 	                    (26, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,002][flwr][INFO] - 	                    (27, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,002][flwr][INFO] - 	                    (28, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,003][flwr][INFO] - 	                    (29, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,003][flwr][INFO] - 	                    (30, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,004][flwr][INFO] - 	                    (31, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,004][flwr][INFO] - 	                    (32, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,005][flwr][INFO] - 	                    (33, tensor(0.9910, dtype=torch.float64)),
[2024-12-06 09:19:41,005][flwr][INFO] - 	                    (34, tensor(0.9910, dtype=torch.float64)),
[2024-12-06 09:19:41,006][flwr][INFO] - 	                    (35, tensor(0.9911, dtype=torch.float64)),
[2024-12-06 09:19:41,006][flwr][INFO] - 	                    (36, tensor(0.9911, dtype=torch.float64)),
[2024-12-06 09:19:41,007][flwr][INFO] - 	                    (37, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,008][flwr][INFO] - 	                    (38, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,009][flwr][INFO] - 	                    (39, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,010][flwr][INFO] - 	                    (40, tensor(0.9912, dtype=torch.float64))],
[2024-12-06 09:19:41,010][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-12-06 09:19:41,011][flwr][INFO] - 	                     (1, tensor(0.5046, dtype=torch.float64)),
[2024-12-06 09:19:41,011][flwr][INFO] - 	                     (2, tensor(0.5706, dtype=torch.float64)),
[2024-12-06 09:19:41,012][flwr][INFO] - 	                     (3, tensor(0.6101, dtype=torch.float64)),
[2024-12-06 09:19:41,012][flwr][INFO] - 	                     (4, tensor(0.6456, dtype=torch.float64)),
[2024-12-06 09:19:41,013][flwr][INFO] - 	                     (5, tensor(0.6610, dtype=torch.float64)),
[2024-12-06 09:19:41,013][flwr][INFO] - 	                     (6, tensor(0.6793, dtype=torch.float64)),
[2024-12-06 09:19:41,014][flwr][INFO] - 	                     (7, tensor(0.6929, dtype=torch.float64)),
[2024-12-06 09:19:41,015][flwr][INFO] - 	                     (8, tensor(0.7012, dtype=torch.float64)),
[2024-12-06 09:19:41,015][flwr][INFO] - 	                     (9, tensor(0.7100, dtype=torch.float64)),
[2024-12-06 09:19:41,016][flwr][INFO] - 	                     (10, tensor(0.7108, dtype=torch.float64)),
[2024-12-06 09:19:41,016][flwr][INFO] - 	                     (11, tensor(0.7151, dtype=torch.float64)),
[2024-12-06 09:19:41,017][flwr][INFO] - 	                     (12, tensor(0.7189, dtype=torch.float64)),
[2024-12-06 09:19:41,017][flwr][INFO] - 	                     (13, tensor(0.7240, dtype=torch.float64)),
[2024-12-06 09:19:41,018][flwr][INFO] - 	                     (14, tensor(0.7231, dtype=torch.float64)),
[2024-12-06 09:19:41,018][flwr][INFO] - 	                     (15, tensor(0.7237, dtype=torch.float64)),
[2024-12-06 09:19:41,019][flwr][INFO] - 	                     (16, tensor(0.7272, dtype=torch.float64)),
[2024-12-06 09:19:41,019][flwr][INFO] - 	                     (17, tensor(0.7291, dtype=torch.float64)),
[2024-12-06 09:19:41,020][flwr][INFO] - 	                     (18, tensor(0.7325, dtype=torch.float64)),
[2024-12-06 09:19:41,020][flwr][INFO] - 	                     (19, tensor(0.7327, dtype=torch.float64)),
[2024-12-06 09:19:41,021][flwr][INFO] - 	                     (20, tensor(0.7322, dtype=torch.float64)),
[2024-12-06 09:19:41,022][flwr][INFO] - 	                     (21, tensor(0.7357, dtype=torch.float64)),
[2024-12-06 09:19:41,022][flwr][INFO] - 	                     (22, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,023][flwr][INFO] - 	                     (23, tensor(0.7363, dtype=torch.float64)),
[2024-12-06 09:19:41,024][flwr][INFO] - 	                     (24, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,024][flwr][INFO] - 	                     (25, tensor(0.7383, dtype=torch.float64)),
[2024-12-06 09:19:41,025][flwr][INFO] - 	                     (26, tensor(0.7387, dtype=torch.float64)),
[2024-12-06 09:19:41,025][flwr][INFO] - 	                     (27, tensor(0.7385, dtype=torch.float64)),
[2024-12-06 09:19:41,026][flwr][INFO] - 	                     (28, tensor(0.7408, dtype=torch.float64)),
[2024-12-06 09:19:41,026][flwr][INFO] - 	                     (29, tensor(0.7416, dtype=torch.float64)),
[2024-12-06 09:19:41,027][flwr][INFO] - 	                     (30, tensor(0.7413, dtype=torch.float64)),
[2024-12-06 09:19:41,027][flwr][INFO] - 	                     (31, tensor(0.7442, dtype=torch.float64)),
[2024-12-06 09:19:41,028][flwr][INFO] - 	                     (32, tensor(0.7410, dtype=torch.float64)),
[2024-12-06 09:19:41,028][flwr][INFO] - 	                     (33, tensor(0.7415, dtype=torch.float64)),
[2024-12-06 09:19:41,029][flwr][INFO] - 	                     (34, tensor(0.7439, dtype=torch.float64)),
[2024-12-06 09:19:41,029][flwr][INFO] - 	                     (35, tensor(0.7434, dtype=torch.float64)),
[2024-12-06 09:19:41,030][flwr][INFO] - 	                     (36, tensor(0.7441, dtype=torch.float64)),
[2024-12-06 09:19:41,031][flwr][INFO] - 	                     (37, tensor(0.7448, dtype=torch.float64)),
[2024-12-06 09:19:41,032][flwr][INFO] - 	                     (38, tensor(0.7444, dtype=torch.float64)),
[2024-12-06 09:19:41,032][flwr][INFO] - 	                     (39, tensor(0.7456, dtype=torch.float64)),
[2024-12-06 09:19:41,033][flwr][INFO] - 	                     (40, tensor(0.7446, dtype=torch.float64))],
[2024-12-06 09:19:41,034][flwr][INFO] - 	 'all_iou': [(0, 1.57065041257157e-10),
[2024-12-06 09:19:41,034][flwr][INFO] - 	             (1, 0.9386167649692311),
[2024-12-06 09:19:41,035][flwr][INFO] - 	             (2, 0.9480325690091613),
[2024-12-06 09:19:41,035][flwr][INFO] - 	             (3, 0.9565716408907092),
[2024-12-06 09:19:41,036][flwr][INFO] - 	             (4, 0.9630616845607723),
[2024-12-06 09:19:41,036][flwr][INFO] - 	             (5, 0.9673490812760697),
[2024-12-06 09:19:41,037][flwr][INFO] - 	             (6, 0.9702936864649568),
[2024-12-06 09:19:41,037][flwr][INFO] - 	             (7, 0.9731518338974533),
[2024-12-06 09:19:41,039][flwr][INFO] - 	             (8, 0.9744806431261388),
[2024-12-06 09:19:41,041][flwr][INFO] - 	             (9, 0.9752016474715582),
[2024-12-06 09:19:41,041][flwr][INFO] - 	             (10, 0.9758783590974501),
[2024-12-06 09:19:41,042][flwr][INFO] - 	             (11, 0.9774528064246356),
[2024-12-06 09:19:41,042][flwr][INFO] - 	             (12, 0.9779222352364113),
[2024-12-06 09:19:41,043][flwr][INFO] - 	             (13, 0.9784281164065824),
[2024-12-06 09:19:41,044][flwr][INFO] - 	             (14, 0.9779347654689567),
[2024-12-06 09:19:41,045][flwr][INFO] - 	             (15, 0.9791353131550928),
[2024-12-06 09:19:41,045][flwr][INFO] - 	             (16, 0.979506409420907),
[2024-12-06 09:19:41,046][flwr][INFO] - 	             (17, 0.9795542152565662),
[2024-12-06 09:19:41,046][flwr][INFO] - 	             (18, 0.9800859255290736),
[2024-12-06 09:19:41,047][flwr][INFO] - 	             (19, 0.9800570414927205),
[2024-12-06 09:19:41,047][flwr][INFO] - 	             (20, 0.9799466230551032),
[2024-12-06 09:19:41,048][flwr][INFO] - 	             (21, 0.9804645655732592),
[2024-12-06 09:19:41,048][flwr][INFO] - 	             (22, 0.9804260694351024),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (23, 0.980452015392803),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (24, 0.9806770163719891),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (25, 0.9808191685690155),
[2024-12-06 09:19:41,050][flwr][INFO] - 	             (26, 0.9808140816480584),
[2024-12-06 09:19:41,050][flwr][INFO] - 	             (27, 0.9807965655534554),
[2024-12-06 09:19:41,051][flwr][INFO] - 	             (28, 0.98096153193942),
[2024-12-06 09:19:41,051][flwr][INFO] - 	             (29, 0.9810556426580472),
[2024-12-06 09:19:41,052][flwr][INFO] - 	             (30, 0.9810619462591109),
[2024-12-06 09:19:41,052][flwr][INFO] - 	             (31, 0.9811969110940825),
[2024-12-06 09:19:41,053][flwr][INFO] - 	             (32, 0.980902278562422),
[2024-12-06 09:19:41,053][flwr][INFO] - 	             (33, 0.9811998316656121),
[2024-12-06 09:19:41,054][flwr][INFO] - 	             (34, 0.9812755557592018),
[2024-12-06 09:19:41,055][flwr][INFO] - 	             (35, 0.9812670386956065),
[2024-12-06 09:19:41,055][flwr][INFO] - 	             (36, 0.9812755504497777),
[2024-12-06 09:19:41,056][flwr][INFO] - 	             (37, 0.9812902741551258),
[2024-12-06 09:19:41,056][flwr][INFO] - 	             (38, 0.9813244425761467),
[2024-12-06 09:19:41,057][flwr][INFO] - 	             (39, 0.9812834626796675),
[2024-12-06 09:19:41,057][flwr][INFO] - 	             (40, 0.981189859926939)],
[2024-12-06 09:19:41,057][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1504, dtype=torch.float64)),
[2024-12-06 09:19:41,058][flwr][INFO] - 	                      (1, tensor(0.9619, dtype=torch.float64)),
[2024-12-06 09:19:41,058][flwr][INFO] - 	                      (2, tensor(0.9663, dtype=torch.float64)),
[2024-12-06 09:19:41,059][flwr][INFO] - 	                      (3, tensor(0.9725, dtype=torch.float64)),
[2024-12-06 09:19:41,059][flwr][INFO] - 	                      (4, tensor(0.9771, dtype=torch.float64)),
[2024-12-06 09:19:41,060][flwr][INFO] - 	                      (5, tensor(0.9805, dtype=torch.float64)),
[2024-12-06 09:19:41,060][flwr][INFO] - 	                      (6, tensor(0.9820, dtype=torch.float64)),
[2024-12-06 09:19:41,061][flwr][INFO] - 	                      (7, tensor(0.9841, dtype=torch.float64)),
[2024-12-06 09:19:41,061][flwr][INFO] - 	                      (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:41,062][flwr][INFO] - 	                      (9, tensor(0.9861, dtype=torch.float64)),
[2024-12-06 09:19:41,062][flwr][INFO] - 	                      (10, tensor(0.9865, dtype=torch.float64)),
[2024-12-06 09:19:41,063][flwr][INFO] - 	                      (11, tensor(0.9877, dtype=torch.float64)),
[2024-12-06 09:19:41,063][flwr][INFO] - 	                      (12, tensor(0.9879, dtype=torch.float64)),
[2024-12-06 09:19:41,064][flwr][INFO] - 	                      (13, tensor(0.9883, dtype=torch.float64)),
[2024-12-06 09:19:41,064][flwr][INFO] - 	                      (14, tensor(0.9882, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (15, tensor(0.9889, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (16, tensor(0.9891, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (17, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:41,066][flwr][INFO] - 	                      (18, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,066][flwr][INFO] - 	                      (19, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,067][flwr][INFO] - 	                      (20, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,067][flwr][INFO] - 	                      (21, tensor(0.9900, dtype=torch.float64)),
[2024-12-06 09:19:41,068][flwr][INFO] - 	                      (22, tensor(0.9901, dtype=torch.float64)),
[2024-12-06 09:19:41,068][flwr][INFO] - 	                      (23, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,069][flwr][INFO] - 	                      (24, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,069][flwr][INFO] - 	                      (25, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,070][flwr][INFO] - 	                      (26, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,070][flwr][INFO] - 	                      (27, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,071][flwr][INFO] - 	                      (28, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,071][flwr][INFO] - 	                      (29, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,072][flwr][INFO] - 	                      (30, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,073][flwr][INFO] - 	                      (31, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,074][flwr][INFO] - 	                      (32, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,074][flwr][INFO] - 	                      (33, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,075][flwr][INFO] - 	                      (34, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,075][flwr][INFO] - 	                      (35, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,076][flwr][INFO] - 	                      (36, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,076][flwr][INFO] - 	                      (37, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,077][flwr][INFO] - 	                      (38, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,077][flwr][INFO] - 	                      (39, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,078][flwr][INFO] - 	                      (40, tensor(0.9908, dtype=torch.float64))],
[2024-12-06 09:19:41,078][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1487, dtype=torch.float64)),
[2024-12-06 09:19:41,079][flwr][INFO] - 	                      (1, tensor(0.9548, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (2, tensor(0.9607, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (3, tensor(0.9682, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (4, tensor(0.9744, dtype=torch.float64)),
[2024-12-06 09:19:41,081][flwr][INFO] - 	                      (5, tensor(0.9794, dtype=torch.float64)),
[2024-12-06 09:19:41,082][flwr][INFO] - 	                      (6, tensor(0.9812, dtype=torch.float64)),
[2024-12-06 09:19:41,083][flwr][INFO] - 	                      (7, tensor(0.9839, dtype=torch.float64)),
[2024-12-06 09:19:41,083][flwr][INFO] - 	                      (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:41,084][flwr][INFO] - 	                      (9, tensor(0.9864, dtype=torch.float64)),
[2024-12-06 09:19:41,084][flwr][INFO] - 	                      (10, tensor(0.9870, dtype=torch.float64)),
[2024-12-06 09:19:41,085][flwr][INFO] - 	                      (11, tensor(0.9885, dtype=torch.float64)),
[2024-12-06 09:19:41,085][flwr][INFO] - 	                      (12, tensor(0.9888, dtype=torch.float64)),
[2024-12-06 09:19:41,086][flwr][INFO] - 	                      (13, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:41,086][flwr][INFO] - 	                      (14, tensor(0.9895, dtype=torch.float64)),
[2024-12-06 09:19:41,087][flwr][INFO] - 	                      (15, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,087][flwr][INFO] - 	                      (16, tensor(0.9907, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (17, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (18, tensor(0.9913, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (19, tensor(0.9913, dtype=torch.float64)),
[2024-12-06 09:19:41,089][flwr][INFO] - 	                      (20, tensor(0.9915, dtype=torch.float64)),
[2024-12-06 09:19:41,089][flwr][INFO] - 	                      (21, tensor(0.9920, dtype=torch.float64)),
[2024-12-06 09:19:41,090][flwr][INFO] - 	                      (22, tensor(0.9921, dtype=torch.float64)),
[2024-12-06 09:19:41,090][flwr][INFO] - 	                      (23, tensor(0.9922, dtype=torch.float64)),
[2024-12-06 09:19:41,091][flwr][INFO] - 	                      (24, tensor(0.9925, dtype=torch.float64)),
[2024-12-06 09:19:41,091][flwr][INFO] - 	                      (25, tensor(0.9926, dtype=torch.float64)),
[2024-12-06 09:19:41,092][flwr][INFO] - 	                      (26, tensor(0.9927, dtype=torch.float64)),
[2024-12-06 09:19:41,092][flwr][INFO] - 	                      (27, tensor(0.9927, dtype=torch.float64)),
[2024-12-06 09:19:41,093][flwr][INFO] - 	                      (28, tensor(0.9929, dtype=torch.float64)),
[2024-12-06 09:19:41,093][flwr][INFO] - 	                      (29, tensor(0.9931, dtype=torch.float64)),
[2024-12-06 09:19:41,094][flwr][INFO] - 	                      (30, tensor(0.9932, dtype=torch.float64)),
[2024-12-06 09:19:41,094][flwr][INFO] - 	                      (31, tensor(0.9934, dtype=torch.float64)),
[2024-12-06 09:19:41,095][flwr][INFO] - 	                      (32, tensor(0.9932, dtype=torch.float64)),
[2024-12-06 09:19:41,095][flwr][INFO] - 	                      (33, tensor(0.9935, dtype=torch.float64)),
[2024-12-06 09:19:41,096][flwr][INFO] - 	                      (34, tensor(0.9935, dtype=torch.float64)),
[2024-12-06 09:19:41,097][flwr][INFO] - 	                      (35, tensor(0.9937, dtype=torch.float64)),
[2024-12-06 09:19:41,097][flwr][INFO] - 	                      (36, tensor(0.9937, dtype=torch.float64)),
[2024-12-06 09:19:41,098][flwr][INFO] - 	                      (37, tensor(0.9939, dtype=torch.float64)),
[2024-12-06 09:19:41,099][flwr][INFO] - 	                      (38, tensor(0.9939, dtype=torch.float64)),
[2024-12-06 09:19:41,099][flwr][INFO] - 	                      (39, tensor(0.9940, dtype=torch.float64)),
[2024-12-06 09:19:41,100][flwr][INFO] - 	                      (40, tensor(0.9940, dtype=torch.float64))],
[2024-12-06 09:19:41,101][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-12-06 09:19:41,101][flwr][INFO] - 	                       (1, tensor(0.5143, dtype=torch.float64)),
[2024-12-06 09:19:41,102][flwr][INFO] - 	                       (2, tensor(0.5766, dtype=torch.float64)),
[2024-12-06 09:19:41,103][flwr][INFO] - 	                       (3, tensor(0.6175, dtype=torch.float64)),
[2024-12-06 09:19:41,103][flwr][INFO] - 	                       (4, tensor(0.6529, dtype=torch.float64)),
[2024-12-06 09:19:41,104][flwr][INFO] - 	                       (5, tensor(0.6669, dtype=torch.float64)),
[2024-12-06 09:19:41,105][flwr][INFO] - 	                       (6, tensor(0.6856, dtype=torch.float64)),
[2024-12-06 09:19:41,105][flwr][INFO] - 	                       (7, tensor(0.6990, dtype=torch.float64)),
[2024-12-06 09:19:41,106][flwr][INFO] - 	                       (8, tensor(0.7075, dtype=torch.float64)),
[2024-12-06 09:19:41,106][flwr][INFO] - 	                       (9, tensor(0.7158, dtype=torch.float64)),
[2024-12-06 09:19:41,107][flwr][INFO] - 	                       (10, tensor(0.7158, dtype=torch.float64)),
[2024-12-06 09:19:41,107][flwr][INFO] - 	                       (11, tensor(0.7204, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (12, tensor(0.7246, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (13, tensor(0.7294, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (14, tensor(0.7286, dtype=torch.float64)),
[2024-12-06 09:19:41,109][flwr][INFO] - 	                       (15, tensor(0.7286, dtype=torch.float64)),
[2024-12-06 09:19:41,109][flwr][INFO] - 	                       (16, tensor(0.7316, dtype=torch.float64)),
[2024-12-06 09:19:41,110][flwr][INFO] - 	                       (17, tensor(0.7338, dtype=torch.float64)),
[2024-12-06 09:19:41,110][flwr][INFO] - 	                       (18, tensor(0.7371, dtype=torch.float64)),
[2024-12-06 09:19:41,111][flwr][INFO] - 	                       (19, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,111][flwr][INFO] - 	                       (20, tensor(0.7366, dtype=torch.float64)),
[2024-12-06 09:19:41,112][flwr][INFO] - 	                       (21, tensor(0.7403, dtype=torch.float64)),
[2024-12-06 09:19:41,112][flwr][INFO] - 	                       (22, tensor(0.7417, dtype=torch.float64)),
[2024-12-06 09:19:41,113][flwr][INFO] - 	                       (23, tensor(0.7410, dtype=torch.float64)),
[2024-12-06 09:19:41,113][flwr][INFO] - 	                       (24, tensor(0.7423, dtype=torch.float64)),
[2024-12-06 09:19:41,114][flwr][INFO] - 	                       (25, tensor(0.7430, dtype=torch.float64)),
[2024-12-06 09:19:41,114][flwr][INFO] - 	                       (26, tensor(0.7428, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (27, tensor(0.7425, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (28, tensor(0.7448, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (29, tensor(0.7459, dtype=torch.float64)),
[2024-12-06 09:19:41,116][flwr][INFO] - 	                       (30, tensor(0.7456, dtype=torch.float64)),
[2024-12-06 09:19:41,116][flwr][INFO] - 	                       (31, tensor(0.7482, dtype=torch.float64)),
[2024-12-06 09:19:41,117][flwr][INFO] - 	                       (32, tensor(0.7452, dtype=torch.float64)),
[2024-12-06 09:19:41,118][flwr][INFO] - 	                       (33, tensor(0.7458, dtype=torch.float64)),
[2024-12-06 09:19:41,118][flwr][INFO] - 	                       (34, tensor(0.7478, dtype=torch.float64)),
[2024-12-06 09:19:41,119][flwr][INFO] - 	                       (35, tensor(0.7470, dtype=torch.float64)),
[2024-12-06 09:19:41,119][flwr][INFO] - 	                       (36, tensor(0.7477, dtype=torch.float64)),
[2024-12-06 09:19:41,120][flwr][INFO] - 	                       (37, tensor(0.7485, dtype=torch.float64)),
[2024-12-06 09:19:41,120][flwr][INFO] - 	                       (38, tensor(0.7477, dtype=torch.float64)),
[2024-12-06 09:19:41,121][flwr][INFO] - 	                       (39, tensor(0.7490, dtype=torch.float64)),
[2024-12-06 09:19:41,121][flwr][INFO] - 	                       (40, tensor(0.7485, dtype=torch.float64))],
[2024-12-06 09:19:41,122][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-12-06 09:19:41,122][flwr][INFO] - 	                       (1, tensor(0.3782, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (2, tensor(0.4817, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (3, tensor(0.5189, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (4, tensor(0.5497, dtype=torch.float64)),
[2024-12-06 09:19:41,124][flwr][INFO] - 	                       (5, tensor(0.5803, dtype=torch.float64)),
[2024-12-06 09:19:41,124][flwr][INFO] - 	                       (6, tensor(0.5927, dtype=torch.float64)),
[2024-12-06 09:19:41,125][flwr][INFO] - 	                       (7, tensor(0.6094, dtype=torch.float64)),
[2024-12-06 09:19:41,125][flwr][INFO] - 	                       (8, tensor(0.6083, dtype=torch.float64)),
[2024-12-06 09:19:41,126][flwr][INFO] - 	                       (9, tensor(0.6222, dtype=torch.float64)),
[2024-12-06 09:19:41,126][flwr][INFO] - 	                       (10, tensor(0.6279, dtype=torch.float64)),
[2024-12-06 09:19:41,127][flwr][INFO] - 	                       (11, tensor(0.6312, dtype=torch.float64)),
[2024-12-06 09:19:41,127][flwr][INFO] - 	                       (12, tensor(0.6339, dtype=torch.float64)),
[2024-12-06 09:19:41,128][flwr][INFO] - 	                       (13, tensor(0.6353, dtype=torch.float64)),
[2024-12-06 09:19:41,128][flwr][INFO] - 	                       (14, tensor(0.6374, dtype=torch.float64)),
[2024-12-06 09:19:41,129][flwr][INFO] - 	                       (15, tensor(0.6421, dtype=torch.float64)),
[2024-12-06 09:19:41,129][flwr][INFO] - 	                       (16, tensor(0.6465, dtype=torch.float64)),
[2024-12-06 09:19:41,130][flwr][INFO] - 	                       (17, tensor(0.6489, dtype=torch.float64)),
[2024-12-06 09:19:41,130][flwr][INFO] - 	                       (18, tensor(0.6521, dtype=torch.float64)),
[2024-12-06 09:19:41,131][flwr][INFO] - 	                       (19, tensor(0.6530, dtype=torch.float64)),
[2024-12-06 09:19:41,131][flwr][INFO] - 	                       (20, tensor(0.6540, dtype=torch.float64)),
[2024-12-06 09:19:41,132][flwr][INFO] - 	                       (21, tensor(0.6551, dtype=torch.float64)),
[2024-12-06 09:19:41,132][flwr][INFO] - 	                       (22, tensor(0.6549, dtype=torch.float64)),
[2024-12-06 09:19:41,133][flwr][INFO] - 	                       (23, tensor(0.6567, dtype=torch.float64)),
[2024-12-06 09:19:41,133][flwr][INFO] - 	                       (24, tensor(0.6564, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (25, tensor(0.6579, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (26, tensor(0.6606, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (27, tensor(0.6595, dtype=torch.float64)),
[2024-12-06 09:19:41,135][flwr][INFO] - 	                       (28, tensor(0.6611, dtype=torch.float64)),
[2024-12-06 09:19:41,136][flwr][INFO] - 	                       (29, tensor(0.6613, dtype=torch.float64)),
[2024-12-06 09:19:41,136][flwr][INFO] - 	                       (30, tensor(0.6636, dtype=torch.float64)),
[2024-12-06 09:19:41,137][flwr][INFO] - 	                       (31, tensor(0.6644, dtype=torch.float64)),
[2024-12-06 09:19:41,137][flwr][INFO] - 	                       (32, tensor(0.6627, dtype=torch.float64)),
[2024-12-06 09:19:41,138][flwr][INFO] - 	                       (33, tensor(0.6642, dtype=torch.float64)),
[2024-12-06 09:19:41,138][flwr][INFO] - 	                       (34, tensor(0.6638, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (35, tensor(0.6640, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (36, tensor(0.6640, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (37, tensor(0.6655, dtype=torch.float64)),
[2024-12-06 09:19:41,140][flwr][INFO] - 	                       (38, tensor(0.6665, dtype=torch.float64)),
[2024-12-06 09:19:41,140][flwr][INFO] - 	                       (39, tensor(0.6652, dtype=torch.float64)),
[2024-12-06 09:19:41,141][flwr][INFO] - 	                       (40, tensor(0.6663, dtype=torch.float64))],
[2024-12-06 09:19:41,141][flwr][INFO] - 	 'ind_iou_0': [(0, 1.568745675242773e-10),
[2024-12-06 09:19:41,142][flwr][INFO] - 	               (1, 0.9396470844317266),
[2024-12-06 09:19:41,142][flwr][INFO] - 	               (2, 0.948530183129443),
[2024-12-06 09:19:41,143][flwr][INFO] - 	               (3, 0.9569305898169702),
[2024-12-06 09:19:41,143][flwr][INFO] - 	               (4, 0.9632444633527052),
[2024-12-06 09:19:41,144][flwr][INFO] - 	               (5, 0.9672453536128813),
[2024-12-06 09:19:41,144][flwr][INFO] - 	               (6, 0.9701311595344998),
[2024-12-06 09:19:41,145][flwr][INFO] - 	               (7, 0.9729366720537237),
[2024-12-06 09:19:41,145][flwr][INFO] - 	               (8, 0.9742213045766417),
[2024-12-06 09:19:41,146][flwr][INFO] - 	               (9, 0.9749532875956729),
[2024-12-06 09:19:41,146][flwr][INFO] - 	               (10, 0.9755585946503212),
[2024-12-06 09:19:41,147][flwr][INFO] - 	               (11, 0.9771057827067156),
[2024-12-06 09:19:41,147][flwr][INFO] - 	               (12, 0.9775585144507694),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (13, 0.9780513997752021),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (14, 0.9774996637046156),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (15, 0.9787129697883933),
[2024-12-06 09:19:41,149][flwr][INFO] - 	               (16, 0.9790258688006265),
[2024-12-06 09:19:41,149][flwr][INFO] - 	               (17, 0.9790783668283077),
[2024-12-06 09:19:41,150][flwr][INFO] - 	               (18, 0.9795632566208574),
[2024-12-06 09:19:41,150][flwr][INFO] - 	               (19, 0.9795482438629819),
[2024-12-06 09:19:41,152][flwr][INFO] - 	               (20, 0.9794188233331589),
[2024-12-06 09:19:41,153][flwr][INFO] - 	               (21, 0.9798966802547555),
[2024-12-06 09:19:41,154][flwr][INFO] - 	               (22, 0.9798619112384731),
[2024-12-06 09:19:41,154][flwr][INFO] - 	               (23, 0.9798777448117227),
[2024-12-06 09:19:41,155][flwr][INFO] - 	               (24, 0.9800730770939928),
[2024-12-06 09:19:41,155][flwr][INFO] - 	               (25, 0.9801961712750589),
[2024-12-06 09:19:41,156][flwr][INFO] - 	               (26, 0.9801720946479946),
[2024-12-06 09:19:41,156][flwr][INFO] - 	               (27, 0.9801539728370199),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (28, 0.9803204932551977),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (29, 0.9803765020449099),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (30, 0.9803805257702991),
[2024-12-06 09:19:41,158][flwr][INFO] - 	               (31, 0.9804924413128645),
[2024-12-06 09:19:41,158][flwr][INFO] - 	               (32, 0.98022160733947),
[2024-12-06 09:19:41,159][flwr][INFO] - 	               (33, 0.9804865805125786),
[2024-12-06 09:19:41,161][flwr][INFO] - 	               (34, 0.9805559863736416),
[2024-12-06 09:19:41,162][flwr][INFO] - 	               (35, 0.9805355426726553),
[2024-12-06 09:19:41,162][flwr][INFO] - 	               (36, 0.9805378548410408),
[2024-12-06 09:19:41,163][flwr][INFO] - 	               (37, 0.9805272608774467),
[2024-12-06 09:19:41,163][flwr][INFO] - 	               (38, 0.980554560325031),
[2024-12-06 09:19:41,164][flwr][INFO] - 	               (39, 0.9805101146633938),
[2024-12-06 09:19:41,164][flwr][INFO] - 	               (40, 0.9804012946094569)],
[2024-12-06 09:19:41,165][flwr][INFO] - 	 'ind_iou_1': [(0, 1.5929912288390675e-10),
[2024-12-06 09:19:41,165][flwr][INFO] - 	               (1, 0.9279683534505377),
[2024-12-06 09:19:41,165][flwr][INFO] - 	               (2, 0.9422741827408425),
[2024-12-06 09:19:41,166][flwr][INFO] - 	               (3, 0.9521626762634431),
[2024-12-06 09:19:41,166][flwr][INFO] - 	               (4, 0.9606060884754033),
[2024-12-06 09:19:41,167][flwr][INFO] - 	               (5, 0.9680131477798649),
[2024-12-06 09:19:41,167][flwr][INFO] - 	               (6, 0.9716150863678239),
[2024-12-06 09:19:41,168][flwr][INFO] - 	               (7, 0.9749556336019467),
[2024-12-06 09:19:41,168][flwr][INFO] - 	               (8, 0.9765056482338446),
[2024-12-06 09:19:41,169][flwr][INFO] - 	               (9, 0.9773770339658858),
[2024-12-06 09:19:41,169][flwr][INFO] - 	               (10, 0.9787096725065478),
[2024-12-06 09:19:41,170][flwr][INFO] - 	               (11, 0.9804931154079066),
[2024-12-06 09:19:41,170][flwr][INFO] - 	               (12, 0.9810897637723638),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (13, 0.9817646682916628),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (14, 0.9817258819590473),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (15, 0.9827936456618482),
[2024-12-06 09:19:41,172][flwr][INFO] - 	               (16, 0.983699885432905),
[2024-12-06 09:19:41,172][flwr][INFO] - 	               (17, 0.9836633101950607),
[2024-12-06 09:19:41,173][flwr][INFO] - 	               (18, 0.9847325019454835),
[2024-12-06 09:19:41,173][flwr][INFO] - 	               (19, 0.9845212804209821),
[2024-12-06 09:19:41,174][flwr][INFO] - 	               (20, 0.9845431555152111),
[2024-12-06 09:19:41,174][flwr][INFO] - 	               (21, 0.9854512857308466),
[2024-12-06 09:19:41,175][flwr][INFO] - 	               (22, 0.9854489062436487),
[2024-12-06 09:19:41,175][flwr][INFO] - 	               (23, 0.9855275710310719),
[2024-12-06 09:19:41,177][flwr][INFO] - 	               (24, 0.9861303660393511),
[2024-12-06 09:19:41,178][flwr][INFO] - 	               (25, 0.9863405139579186),
[2024-12-06 09:19:41,178][flwr][INFO] - 	               (26, 0.986488093000365),
[2024-12-06 09:19:41,179][flwr][INFO] - 	               (27, 0.98652969026575),
[2024-12-06 09:19:41,179][flwr][INFO] - 	               (28, 0.9866649780647514),
[2024-12-06 09:19:41,180][flwr][INFO] - 	               (29, 0.9871253303445999),
[2024-12-06 09:19:41,181][flwr][INFO] - 	               (30, 0.9871052817041691),
[2024-12-06 09:19:41,181][flwr][INFO] - 	               (31, 0.9875455921584697),
[2024-12-06 09:19:41,182][flwr][INFO] - 	               (32, 0.9869060371067591),
[2024-12-06 09:19:41,182][flwr][INFO] - 	               (33, 0.9874911892158853),
[2024-12-06 09:19:41,183][flwr][INFO] - 	               (34, 0.9876445598789428),
[2024-12-06 09:19:41,183][flwr][INFO] - 	               (35, 0.9877338973058879),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (36, 0.9877982194665248),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (37, 0.9880771920950169),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (38, 0.9882166508655339),
[2024-12-06 09:19:41,185][flwr][INFO] - 	               (39, 0.9881835686430218),
[2024-12-06 09:19:41,185][flwr][INFO] - 	               (40, 0.9881644289529422)]}
[2024-12-06 09:19:41,186][flwr][INFO] - 
