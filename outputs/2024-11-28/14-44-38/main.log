[2024-11-28 14:44:38,951][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-11-28 14:45:03,038][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'memory': 851385838592.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.11': 1.0, 'object_store_memory': 200000000000.0}
[2024-11-28 14:45:03,038][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-28 14:45:03,038][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-28 14:45:03,067][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-28 14:45:03,068][flwr][INFO] - [INIT]
[2024-11-28 14:45:03,068][flwr][INFO] - Requesting initial parameters from one random client
[2024-11-28 14:45:06,534][flwr][INFO] - Received initial parameters from one random client
[2024-11-28 14:45:06,534][flwr][INFO] - Evaluating initial global parameters
[2024-11-28 14:50:50,900][flwr][INFO] - initial parameters (loss, other metrics): 0.715662351530599, OrderedDict([('ind_iou_0', 0.055350935347940645), ('ind_dice_liver_0', tensor(0.1616, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0084, dtype=torch.float64)), ('ind_iou_1', 0.0544219739757796), ('ind_dice_liver_1', tensor(0.1601, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0075, dtype=torch.float64)), ('all_iou', 0.0552537034326727), ('all_dice_liver', tensor(0.1615, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0083, dtype=torch.float64))])
[2024-11-28 14:50:51,014][flwr][INFO] - 
[2024-11-28 14:50:51,014][flwr][INFO] - [ROUND 1]
[2024-11-28 14:50:51,014][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:00:58,339][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 15:00:58,360][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-11-28 15:03:34,927][flwr][INFO] - fit progress: (1, 0.07443603277527566, OrderedDict([('ind_iou_0', 0.712552454365834), ('ind_dice_liver_0', tensor(0.8323, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1462, dtype=torch.float64)), ('ind_iou_1', 0.9363470532395185), ('ind_dice_liver_1', tensor(0.9629, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4041, dtype=torch.float64)), ('all_iou', 0.7347268002805437), ('all_dice_liver', tensor(0.8452, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1745, dtype=torch.float64))]), 763.9130717804655)
[2024-11-28 15:03:34,930][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:04:48,802][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 15:04:48,802][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:04:48,803][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:04:48,803][flwr][INFO] - 
[2024-11-28 15:04:48,803][flwr][INFO] - [ROUND 2]
[2024-11-28 15:04:48,803][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:14:47,723][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 15:17:25,939][flwr][INFO] - fit progress: (2, 0.06621678943594078, OrderedDict([('ind_iou_0', 0.7579797242080624), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1842, dtype=torch.float64)), ('ind_iou_1', 0.9558406180921017), ('ind_dice_liver_1', tensor(0.9741, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4880, dtype=torch.float64)), ('all_iou', 0.7774996329864332), ('all_dice_liver', tensor(0.8781, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2180, dtype=torch.float64))]), 1594.9255293365568)
[2024-11-28 15:17:25,943][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:18:40,218][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 15:18:40,219][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:18:40,219][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:18:40,219][flwr][INFO] - 
[2024-11-28 15:18:40,219][flwr][INFO] - [ROUND 3]
[2024-11-28 15:18:40,219][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:28:40,483][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 15:31:16,121][flwr][INFO] - fit progress: (3, 0.06865566397245251, OrderedDict([('ind_iou_0', 0.7643732397895705), ('ind_dice_liver_0', tensor(0.8726, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2168, dtype=torch.float64)), ('ind_iou_1', 0.962627727510885), ('ind_dice_liver_1', tensor(0.9776, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5402, dtype=torch.float64)), ('all_iou', 0.7839677781051207), ('all_dice_liver', tensor(0.8830, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2521, dtype=torch.float64))]), 2425.107115917839)
[2024-11-28 15:31:16,125][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:32:29,158][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 15:32:29,158][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:32:29,159][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:32:29,159][flwr][INFO] - 
[2024-11-28 15:32:29,159][flwr][INFO] - [ROUND 4]
[2024-11-28 15:32:29,159][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:42:30,679][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 15:45:06,876][flwr][INFO] - fit progress: (4, 0.07220220158848907, OrderedDict([('ind_iou_0', 0.7637307008884832), ('ind_dice_liver_0', tensor(0.8717, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2065, dtype=torch.float64)), ('ind_iou_1', 0.9638895096143001), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5430, dtype=torch.float64)), ('all_iou', 0.7835131862503123), ('all_dice_liver', tensor(0.8823, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2431, dtype=torch.float64))]), 3255.861802579835)
[2024-11-28 15:45:06,879][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:46:22,379][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 15:46:22,379][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:46:22,379][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:46:22,379][flwr][INFO] - 
[2024-11-28 15:46:22,379][flwr][INFO] - [ROUND 5]
[2024-11-28 15:46:22,380][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:56:20,050][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 15:58:57,607][flwr][INFO] - fit progress: (5, 0.07423258427094212, OrderedDict([('ind_iou_0', 0.758287771922533), ('ind_dice_liver_0', tensor(0.8685, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2155, dtype=torch.float64)), ('ind_iou_1', 0.9642580501099705), ('ind_dice_liver_1', tensor(0.9792, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5488, dtype=torch.float64)), ('all_iou', 0.7786731242725865), ('all_dice_liver', tensor(0.8795, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2516, dtype=torch.float64))]), 4086.59319454059)
[2024-11-28 15:58:57,611][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:00:11,649][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:00:11,649][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:00:11,649][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:00:11,650][flwr][INFO] - 
[2024-11-28 16:00:11,650][flwr][INFO] - [ROUND 6]
[2024-11-28 16:00:11,650][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:10:11,694][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 16:12:49,870][flwr][INFO] - fit progress: (6, 0.08224540647948725, OrderedDict([('ind_iou_0', 0.7662208933661147), ('ind_dice_liver_0', tensor(0.8750, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2234, dtype=torch.float64)), ('ind_iou_1', 0.9664889241229515), ('ind_dice_liver_1', tensor(0.9815, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5675, dtype=torch.float64)), ('all_iou', 0.7860492738157198), ('all_dice_liver', tensor(0.8855, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2607, dtype=torch.float64))]), 4918.856065923348)
[2024-11-28 16:12:49,873][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:14:03,067][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:14:03,067][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:14:03,068][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:14:03,068][flwr][INFO] - 
[2024-11-28 16:14:03,068][flwr][INFO] - [ROUND 7]
[2024-11-28 16:14:03,068][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:24:06,485][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 16:26:42,684][flwr][INFO] - fit progress: (7, 0.0923315126133261, OrderedDict([('ind_iou_0', 0.6996046718008183), ('ind_dice_liver_0', tensor(0.8284, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1512, dtype=torch.float64)), ('ind_iou_1', 0.9415039251310271), ('ind_dice_liver_1', tensor(0.9648, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5380, dtype=torch.float64)), ('all_iou', 0.7236299974434878), ('all_dice_liver', tensor(0.8419, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1928, dtype=torch.float64))]), 5751.669715480879)
[2024-11-28 16:26:42,687][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:27:56,521][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:27:56,521][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:27:56,522][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:27:56,522][flwr][INFO] - 
[2024-11-28 16:27:56,522][flwr][INFO] - [ROUND 8]
[2024-11-28 16:27:56,522][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:37:57,956][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 16:40:35,023][flwr][INFO] - fit progress: (8, 0.0907434412464278, OrderedDict([('ind_iou_0', 0.7613247276423324), ('ind_dice_liver_0', tensor(0.8729, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2251, dtype=torch.float64)), ('ind_iou_1', 0.9677161197452596), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5615, dtype=torch.float64)), ('all_iou', 0.7817302678896291), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2617, dtype=torch.float64))]), 6584.009546761401)
[2024-11-28 16:40:35,027][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:41:47,690][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:41:47,691][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:41:47,691][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:41:47,691][flwr][INFO] - 
[2024-11-28 16:41:47,691][flwr][INFO] - [ROUND 9]
[2024-11-28 16:41:47,691][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:51:47,220][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 16:54:24,536][flwr][INFO] - fit progress: (9, 0.07856722062472453, OrderedDict([('ind_iou_0', 0.7732596355094269), ('ind_dice_liver_0', tensor(0.8812, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2463, dtype=torch.float64)), ('ind_iou_1', 0.9685413997652824), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5695, dtype=torch.float64)), ('all_iou', 0.7925540655485465), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2813, dtype=torch.float64))]), 7413.522378798574)
[2024-11-28 16:54:24,540][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:55:38,519][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:55:38,519][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:55:38,519][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:55:38,520][flwr][INFO] - 
[2024-11-28 16:55:38,520][flwr][INFO] - [ROUND 10]
[2024-11-28 16:55:38,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:05:41,219][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 17:08:17,006][flwr][INFO] - fit progress: (10, 0.07680942672387864, OrderedDict([('ind_iou_0', 0.7564357428331301), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2210, dtype=torch.float64)), ('ind_iou_1', 0.9636035958188761), ('ind_dice_liver_1', tensor(0.9803, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5423, dtype=torch.float64)), ('all_iou', 0.7769691511570678), ('all_dice_liver', tensor(0.8788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2568, dtype=torch.float64))]), 8245.991883210838)
[2024-11-28 17:08:17,009][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:09:30,744][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 17:09:30,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:09:30,745][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:09:30,745][flwr][INFO] - 
[2024-11-28 17:09:30,745][flwr][INFO] - [ROUND 11]
[2024-11-28 17:09:30,745][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:19:32,020][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 17:22:08,074][flwr][INFO] - fit progress: (11, 0.09875393717690381, OrderedDict([('ind_iou_0', 0.7571424297913529), ('ind_dice_liver_0', tensor(0.8703, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2043, dtype=torch.float64)), ('ind_iou_1', 0.968959024391846), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.7780622947412319), ('all_dice_liver', tensor(0.8815, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2446, dtype=torch.float64))]), 9077.059656611644)
[2024-11-28 17:22:08,077][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:23:22,336][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 17:23:22,336][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:23:22,336][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:23:22,336][flwr][INFO] - 
[2024-11-28 17:23:22,336][flwr][INFO] - [ROUND 12]
[2024-11-28 17:23:22,336][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:33:20,853][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 17:35:57,868][flwr][INFO] - fit progress: (12, 0.09895184948601883, OrderedDict([('ind_iou_0', 0.7605632316312407), ('ind_dice_liver_0', tensor(0.8727, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2069, dtype=torch.float64)), ('ind_iou_1', 0.968552975884231), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5614, dtype=torch.float64)), ('all_iou', 0.7811500604052574), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2455, dtype=torch.float64))]), 9906.853962482885)
[2024-11-28 17:35:57,871][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:37:10,549][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 17:37:10,549][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:37:10,549][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:37:10,550][flwr][INFO] - 
[2024-11-28 17:37:10,550][flwr][INFO] - [ROUND 13]
[2024-11-28 17:37:10,550][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:47:11,551][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 17:49:47,162][flwr][INFO] - fit progress: (13, 0.0916708467039861, OrderedDict([('ind_iou_0', 0.7744203668029485), ('ind_dice_liver_0', tensor(0.8820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2102, dtype=torch.float64)), ('ind_iou_1', 0.9693645472229383), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5794, dtype=torch.float64)), ('all_iou', 0.7937431357837128), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2503, dtype=torch.float64))]), 10736.148427525535)
[2024-11-28 17:49:47,166][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:51:00,565][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 17:51:00,566][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:51:00,566][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:51:00,566][flwr][INFO] - 
[2024-11-28 17:51:00,566][flwr][INFO] - [ROUND 14]
[2024-11-28 17:51:00,566][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:01:00,232][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 18:03:35,547][flwr][INFO] - fit progress: (14, 0.09412276032425056, OrderedDict([('ind_iou_0', 0.7565210455645685), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2326, dtype=torch.float64)), ('ind_iou_1', 0.9676086916927787), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5833, dtype=torch.float64)), ('all_iou', 0.777421477216883), ('all_dice_liver', tensor(0.8797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2708, dtype=torch.float64))]), 11564.533236309886)
[2024-11-28 18:03:35,551][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:04:48,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 18:04:48,517][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:04:48,518][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:04:48,518][flwr][INFO] - 
[2024-11-28 18:04:48,518][flwr][INFO] - [ROUND 15]
[2024-11-28 18:04:48,518][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:14:47,982][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 18:17:23,456][flwr][INFO] - fit progress: (15, 0.0956628250950387, OrderedDict([('ind_iou_0', 0.770708533190624), ('ind_dice_liver_0', tensor(0.8792, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2278, dtype=torch.float64)), ('ind_iou_1', 0.9694128355500067), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5881, dtype=torch.float64)), ('all_iou', 0.790384034811225), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 12392.442374197766)
[2024-11-28 18:17:23,460][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:18:36,534][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 18:18:36,534][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:18:36,534][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:18:36,535][flwr][INFO] - 
[2024-11-28 18:18:36,535][flwr][INFO] - [ROUND 16]
[2024-11-28 18:18:36,535][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:28:38,398][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 18:31:13,524][flwr][INFO] - fit progress: (16, 0.1082670263277741, OrderedDict([('ind_iou_0', 0.7684722004336086), ('ind_dice_liver_0', tensor(0.8787, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2075, dtype=torch.float64)), ('ind_iou_1', 0.9698940083572806), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5697, dtype=torch.float64)), ('all_iou', 0.7883912432417878), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2470, dtype=torch.float64))]), 13222.509861147031)
[2024-11-28 18:31:13,528][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:32:26,332][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 18:32:26,332][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:32:26,332][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:32:26,333][flwr][INFO] - 
[2024-11-28 18:32:26,333][flwr][INFO] - [ROUND 17]
[2024-11-28 18:32:26,333][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:42:26,555][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 18:45:02,163][flwr][INFO] - fit progress: (17, 0.1055956416061828, OrderedDict([('ind_iou_0', 0.7771052388513635), ('ind_dice_liver_0', tensor(0.8843, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2236, dtype=torch.float64)), ('ind_iou_1', 0.9708628761125967), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5834, dtype=torch.float64)), ('all_iou', 0.7962606165871388), ('all_dice_liver', tensor(0.8943, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2631, dtype=torch.float64))]), 14051.14952831529)
[2024-11-28 18:45:02,167][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:46:15,471][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 18:46:15,471][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:46:15,472][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:46:15,472][flwr][INFO] - 
[2024-11-28 18:46:15,472][flwr][INFO] - [ROUND 18]
[2024-11-28 18:46:15,472][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:56:13,776][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 18:58:49,373][flwr][INFO] - fit progress: (18, 0.11536282600101867, OrderedDict([('ind_iou_0', 0.7522642680075069), ('ind_dice_liver_0', tensor(0.8678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1806, dtype=torch.float64)), ('ind_iou_1', 0.9695829823694017), ('ind_dice_liver_1', tensor(0.9849, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5710, dtype=torch.float64)), ('all_iou', 0.7737839785962827), ('all_dice_liver', tensor(0.8794, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2232, dtype=torch.float64))]), 14878.358792735264)
[2024-11-28 18:58:49,376][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:00:02,819][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 19:00:02,820][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:00:02,822][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:00:02,823][flwr][INFO] - 
[2024-11-28 19:00:02,823][flwr][INFO] - [ROUND 19]
[2024-11-28 19:00:02,824][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:10:04,396][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 19:12:40,337][flwr][INFO] - fit progress: (19, 0.11725688536256092, OrderedDict([('ind_iou_0', 0.7654243613263407), ('ind_dice_liver_0', tensor(0.8766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2004, dtype=torch.float64)), ('ind_iou_1', 0.9704836987993137), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5809, dtype=torch.float64)), ('all_iou', 0.7857084723258861), ('all_dice_liver', tensor(0.8874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 15709.32337746676)
[2024-11-28 19:12:40,341][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:13:53,893][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 19:13:53,893][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:13:53,894][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:13:53,894][flwr][INFO] - 
[2024-11-28 19:13:53,894][flwr][INFO] - [ROUND 20]
[2024-11-28 19:13:53,894][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:23:55,631][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 19:26:31,696][flwr][INFO] - fit progress: (20, 0.10818198132323152, OrderedDict([('ind_iou_0', 0.7670865709172475), ('ind_dice_liver_0', tensor(0.8779, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2030, dtype=torch.float64)), ('ind_iou_1', 0.9702928639021118), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5904, dtype=torch.float64)), ('all_iou', 0.7871855795761015), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2449, dtype=torch.float64))]), 16540.682569286786)
[2024-11-28 19:26:31,700][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:27:44,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 19:27:44,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:27:44,553][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:27:44,553][flwr][INFO] - 
[2024-11-28 19:27:44,553][flwr][INFO] - [ROUND 21]
[2024-11-28 19:27:44,554][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:37:44,170][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 19:40:20,248][flwr][INFO] - fit progress: (21, 0.09548499851092236, OrderedDict([('ind_iou_0', 0.7463972191302203), ('ind_dice_liver_0', tensor(0.8623, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1907, dtype=torch.float64)), ('ind_iou_1', 0.9699164123215347), ('ind_dice_liver_1', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5689, dtype=torch.float64)), ('all_iou', 0.7684518888134513), ('all_dice_liver', tensor(0.8743, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2317, dtype=torch.float64))]), 17369.2336540604)
[2024-11-28 19:40:20,251][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:41:33,639][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 19:41:33,640][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:41:33,640][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:41:33,640][flwr][INFO] - 
[2024-11-28 19:41:33,640][flwr][INFO] - [ROUND 22]
[2024-11-28 19:41:33,640][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:51:34,802][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 19:54:11,050][flwr][INFO] - fit progress: (22, 0.11363655565966554, OrderedDict([('ind_iou_0', 0.769198741560112), ('ind_dice_liver_0', tensor(0.8791, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2152, dtype=torch.float64)), ('ind_iou_1', 0.9710813877522105), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5847, dtype=torch.float64)), ('all_iou', 0.789136069427251), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2553, dtype=torch.float64))]), 18200.036591612734)
[2024-11-28 19:54:11,055][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:55:25,770][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 19:55:25,770][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:55:25,770][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:55:25,770][flwr][INFO] - 
[2024-11-28 19:55:25,770][flwr][INFO] - [ROUND 23]
[2024-11-28 19:55:25,771][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:05:28,247][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 20:08:05,557][flwr][INFO] - fit progress: (23, 0.11046344046375751, OrderedDict([('ind_iou_0', 0.7715669423305815), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2220, dtype=torch.float64)), ('ind_iou_1', 0.970867874093388), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.7912430017422938), ('all_dice_liver', tensor(0.8912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2616, dtype=torch.float64))]), 19034.543136804365)
[2024-11-28 20:08:05,561][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:09:19,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 20:09:19,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:09:19,917][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:09:19,918][flwr][INFO] - 
[2024-11-28 20:09:19,918][flwr][INFO] - [ROUND 24]
[2024-11-28 20:09:19,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:19:21,884][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 20:21:58,914][flwr][INFO] - fit progress: (24, 0.10772077271185469, OrderedDict([('ind_iou_0', 0.7742741367330938), ('ind_dice_liver_0', tensor(0.8822, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2339, dtype=torch.float64)), ('ind_iou_1', 0.9708346582909262), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5830, dtype=torch.float64)), ('all_iou', 0.7936848174378953), ('all_dice_liver', tensor(0.8925, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2722, dtype=torch.float64))]), 19867.900271561928)
[2024-11-28 20:21:58,918][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:23:11,612][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 20:23:11,612][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:23:11,613][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:23:11,613][flwr][INFO] - 
[2024-11-28 20:23:11,613][flwr][INFO] - [ROUND 25]
[2024-11-28 20:23:11,613][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:33:11,292][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 20:35:48,304][flwr][INFO] - fit progress: (25, 0.11614256223262809, OrderedDict([('ind_iou_0', 0.7726833734040778), ('ind_dice_liver_0', tensor(0.8818, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2145, dtype=torch.float64)), ('ind_iou_1', 0.9709504306561927), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7922776095026193), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2550, dtype=torch.float64))]), 20697.290118445642)
[2024-11-28 20:35:48,307][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:37:02,500][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 20:37:02,500][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:37:02,500][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:37:02,500][flwr][INFO] - 
[2024-11-28 20:37:02,501][flwr][INFO] - [ROUND 26]
[2024-11-28 20:37:02,501][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:47:05,995][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 20:49:41,872][flwr][INFO] - fit progress: (26, 0.12841296592875695, OrderedDict([('ind_iou_0', 0.771086743552114), ('ind_dice_liver_0', tensor(0.8810, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2003, dtype=torch.float64)), ('ind_iou_1', 0.9706609580223797), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.7907984205515001), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 21530.857695921324)
[2024-11-28 20:49:41,875][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:50:55,273][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 20:50:55,273][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:50:55,278][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:50:55,278][flwr][INFO] - 
[2024-11-28 20:50:55,278][flwr][INFO] - [ROUND 27]
[2024-11-28 20:50:55,279][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:00:58,996][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 21:03:35,146][flwr][INFO] - fit progress: (27, 0.13277795339749593, OrderedDict([('ind_iou_0', 0.7669883314203613), ('ind_dice_liver_0', tensor(0.8777, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2276, dtype=torch.float64)), ('ind_iou_1', 0.9709532617555235), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5939, dtype=torch.float64)), ('all_iou', 0.787135171253952), ('all_dice_liver', tensor(0.8884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2675, dtype=torch.float64))]), 22364.131741349585)
[2024-11-28 21:03:35,149][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:04:48,042][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 21:04:48,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:04:48,042][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:04:48,042][flwr][INFO] - 
[2024-11-28 21:04:48,043][flwr][INFO] - [ROUND 28]
[2024-11-28 21:04:48,043][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:14:47,614][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 21:17:24,065][flwr][INFO] - fit progress: (28, 0.1332433878505042, OrderedDict([('ind_iou_0', 0.7720390323189054), ('ind_dice_liver_0', tensor(0.8819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2189, dtype=torch.float64)), ('ind_iou_1', 0.9706655447215863), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5924, dtype=torch.float64)), ('all_iou', 0.7916867519343511), ('all_dice_liver', tensor(0.8922, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2594, dtype=torch.float64))]), 23193.05067597609)
[2024-11-28 21:17:24,068][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:18:37,497][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 21:18:37,497][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:18:37,497][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:18:37,498][flwr][INFO] - 
[2024-11-28 21:18:37,498][flwr][INFO] - [ROUND 29]
[2024-11-28 21:18:37,498][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:28:38,184][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 21:31:15,072][flwr][INFO] - fit progress: (29, 0.14011135144972028, OrderedDict([('ind_iou_0', 0.765970638461008), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2070, dtype=torch.float64)), ('ind_iou_1', 0.9700831757658472), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5776, dtype=torch.float64)), ('all_iou', 0.78616398340562), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2478, dtype=torch.float64))]), 24024.058558891527)
[2024-11-28 21:31:15,076][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:32:28,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 21:32:28,605][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:32:28,608][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:32:28,608][flwr][INFO] - 
[2024-11-28 21:32:28,609][flwr][INFO] - [ROUND 30]
[2024-11-28 21:32:28,609][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:42:29,675][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 21:45:05,614][flwr][INFO] - fit progress: (30, 0.13483934702349473, OrderedDict([('ind_iou_0', 0.7700878354963548), ('ind_dice_liver_0', tensor(0.8797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2285, dtype=torch.float64)), ('ind_iou_1', 0.9703503673549448), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5758, dtype=torch.float64)), ('all_iou', 0.7899095518702021), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 24854.599972893484)
[2024-11-28 21:45:05,618][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:46:19,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 21:46:19,388][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:46:19,389][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:46:19,389][flwr][INFO] - 
[2024-11-28 21:46:19,389][flwr][INFO] - [ROUND 31]
[2024-11-28 21:46:19,389][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:56:17,335][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 21:58:54,485][flwr][INFO] - fit progress: (31, 0.13663863938248647, OrderedDict([('ind_iou_0', 0.7681046176590351), ('ind_dice_liver_0', tensor(0.8785, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2378, dtype=torch.float64)), ('ind_iou_1', 0.9703306016666302), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7880993554804232), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2761, dtype=torch.float64))]), 25683.47064110916)
[2024-11-28 21:58:54,488][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:00:07,655][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 22:00:07,656][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:00:07,656][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:00:07,657][flwr][INFO] - 
[2024-11-28 22:00:07,657][flwr][INFO] - [ROUND 32]
[2024-11-28 22:00:07,657][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:10:07,504][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 22:12:42,859][flwr][INFO] - fit progress: (32, 0.14786821875143155, OrderedDict([('ind_iou_0', 0.7687338322864983), ('ind_dice_liver_0', tensor(0.8796, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2117, dtype=torch.float64)), ('ind_iou_1', 0.9703174980328881), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5885, dtype=torch.float64)), ('all_iou', 0.7886923548737353), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2526, dtype=torch.float64))]), 26511.845588230528)
[2024-11-28 22:12:42,863][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:13:56,285][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 22:13:56,285][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:13:56,286][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:13:56,286][flwr][INFO] - 
[2024-11-28 22:13:56,286][flwr][INFO] - [ROUND 33]
[2024-11-28 22:13:56,286][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:23:57,780][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 22:26:34,792][flwr][INFO] - fit progress: (33, 0.14874713046345572, OrderedDict([('ind_iou_0', 0.7707304914837289), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2193, dtype=torch.float64)), ('ind_iou_1', 0.9705246390896934), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5790, dtype=torch.float64)), ('all_iou', 0.7904772705042659), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2592, dtype=torch.float64))]), 27343.77785969246)
[2024-11-28 22:26:34,795][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:27:48,596][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 22:27:48,596][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:27:48,596][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:27:48,597][flwr][INFO] - 
[2024-11-28 22:27:48,597][flwr][INFO] - [ROUND 34]
[2024-11-28 22:27:48,597][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:37:48,166][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 22:40:25,471][flwr][INFO] - fit progress: (34, 0.15816043266621235, OrderedDict([('ind_iou_0', 0.7675377406205277), ('ind_dice_liver_0', tensor(0.8790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1976, dtype=torch.float64)), ('ind_iou_1', 0.9697600748511228), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5838, dtype=torch.float64)), ('all_iou', 0.7875382294160379), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2399, dtype=torch.float64))]), 28174.457255250774)
[2024-11-28 22:40:25,475][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:41:38,716][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 22:41:38,717][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:41:38,717][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:41:38,717][flwr][INFO] - 
[2024-11-28 22:41:38,717][flwr][INFO] - [ROUND 35]
[2024-11-28 22:41:38,717][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:51:38,566][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 22:54:16,007][flwr][INFO] - fit progress: (35, 0.2012213706260372, OrderedDict([('ind_iou_0', 0.771242961908685), ('ind_dice_liver_0', tensor(0.8816, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2158, dtype=torch.float64)), ('ind_iou_1', 0.9707749966443409), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5936, dtype=torch.float64)), ('all_iou', 0.7909655883623893), ('all_dice_liver', tensor(0.8920, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2567, dtype=torch.float64))]), 29004.992661375552)
[2024-11-28 22:54:16,010][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:55:29,392][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 22:55:29,392][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:55:29,393][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:55:29,393][flwr][INFO] - 
[2024-11-28 22:55:29,393][flwr][INFO] - [ROUND 36]
[2024-11-28 22:55:29,393][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:05:31,629][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 23:08:08,584][flwr][INFO] - fit progress: (36, 0.16302331476134563, OrderedDict([('ind_iou_0', 0.7656138182430955), ('ind_dice_liver_0', tensor(0.8778, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1935, dtype=torch.float64)), ('ind_iou_1', 0.9698532945503832), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5770, dtype=torch.float64)), ('all_iou', 0.7858185503568491), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2357, dtype=torch.float64))]), 29837.569651234895)
[2024-11-28 23:08:08,587][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:09:21,565][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 23:09:21,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:09:21,565][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:09:21,566][flwr][INFO] - 
[2024-11-28 23:09:21,566][flwr][INFO] - [ROUND 37]
[2024-11-28 23:09:21,566][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:19:22,189][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 23:21:58,541][flwr][INFO] - fit progress: (37, 0.1683240080846963, OrderedDict([('ind_iou_0', 0.7706449587034582), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2225, dtype=torch.float64)), ('ind_iou_1', 0.9695113228799984), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7903434077975025), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2624, dtype=torch.float64))]), 30667.527550118975)
[2024-11-28 23:21:58,545][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:23:11,858][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 23:23:11,858][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:23:11,858][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:23:11,858][flwr][INFO] - 
[2024-11-28 23:23:11,858][flwr][INFO] - [ROUND 38]
[2024-11-28 23:23:11,859][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:33:10,237][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 23:35:46,153][flwr][INFO] - fit progress: (38, 0.11067783057359662, OrderedDict([('ind_iou_0', 0.769737898766734), ('ind_dice_liver_0', tensor(0.8800, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2011, dtype=torch.float64)), ('ind_iou_1', 0.9688456325633542), ('ind_dice_liver_1', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.789450559846316), ('all_dice_liver', tensor(0.8904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2427, dtype=torch.float64))]), 31495.13896583114)
[2024-11-28 23:35:46,156][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:36:59,644][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 23:36:59,644][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:36:59,644][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:36:59,644][flwr][INFO] - 
[2024-11-28 23:36:59,644][flwr][INFO] - [ROUND 39]
[2024-11-28 23:36:59,645][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:47:03,932][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-28 23:49:39,470][flwr][INFO] - fit progress: (39, 0.11020690067427612, OrderedDict([('ind_iou_0', 0.7533686612691947), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1940, dtype=torch.float64)), ('ind_iou_1', 0.9672903772408662), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5561, dtype=torch.float64)), ('all_iou', 0.7745300620876229), ('all_dice_liver', tensor(0.8798, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2344, dtype=torch.float64))]), 32328.45601093024)
[2024-11-28 23:49:39,474][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:50:52,892][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 23:50:52,892][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:50:52,892][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:50:52,892][flwr][INFO] - 
[2024-11-28 23:50:52,893][flwr][INFO] - [ROUND 40]
[2024-11-28 23:50:52,893][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 00:00:54,669][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-29 00:03:31,043][flwr][INFO] - fit progress: (40, 0.1870419427602996, OrderedDict([('ind_iou_0', 0.7659960521039098), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2218, dtype=torch.float64)), ('ind_iou_1', 0.9705781890043212), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7861858678207541), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2621, dtype=torch.float64))]), 33160.02879369538)
[2024-11-29 00:03:31,046][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 00:04:43,936][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-29 00:04:43,936][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 00:04:43,937][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 00:04:43,937][flwr][INFO] - 
[2024-11-29 00:04:43,937][flwr][INFO] - [SUMMARY]
[2024-11-29 00:04:43,937][flwr][INFO] - Run finished 40 round(s) in 33232.92s
[2024-11-29 00:04:44,056][flwr][INFO] - 	History (loss, centralized):
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 0: 0.715662351530599
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 1: 0.07443603277527566
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 2: 0.06621678943594078
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 3: 0.06865566397245251
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 4: 0.07220220158848907
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 5: 0.07423258427094212
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 6: 0.08224540647948725
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 7: 0.0923315126133261
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 8: 0.0907434412464278
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 9: 0.07856722062472453
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 10: 0.07680942672387864
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 11: 0.09875393717690381
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 12: 0.09895184948601883
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 13: 0.0916708467039861
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 14: 0.09412276032425056
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 15: 0.0956628250950387
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 16: 0.1082670263277741
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 17: 0.1055956416061828
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 18: 0.11536282600101867
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 19: 0.11725688536256092
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 20: 0.10818198132323152
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 21: 0.09548499851092236
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 22: 0.11363655565966554
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 23: 0.11046344046375751
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 24: 0.10772077271185469
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 25: 0.11614256223262809
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 26: 0.12841296592875695
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 27: 0.13277795339749593
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 28: 0.1332433878505042
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 29: 0.14011135144972028
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 30: 0.13483934702349473
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 31: 0.13663863938248647
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 32: 0.14786821875143155
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 33: 0.14874713046345572
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 34: 0.15816043266621235
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 35: 0.2012213706260372
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 36: 0.16302331476134563
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 37: 0.1683240080846963
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 38: 0.11067783057359662
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 39: 0.11020690067427612
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 40: 0.1870419427602996
[2024-11-29 00:04:44,058][flwr][INFO] - 	History (metrics, centralized):
[2024-11-29 00:04:44,058][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1615, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (1, tensor(0.8452, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (2, tensor(0.8781, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (3, tensor(0.8830, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (4, tensor(0.8823, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (5, tensor(0.8795, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (6, tensor(0.8855, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (7, tensor(0.8419, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (8, tensor(0.8837, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (9, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (10, tensor(0.8788, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (11, tensor(0.8815, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (12, tensor(0.8837, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (13, tensor(0.8921, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (14, tensor(0.8797, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (15, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (16, tensor(0.8892, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (17, tensor(0.8943, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (18, tensor(0.8794, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (19, tensor(0.8874, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (20, tensor(0.8885, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (21, tensor(0.8743, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (22, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (23, tensor(0.8912, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (24, tensor(0.8925, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (25, tensor(0.8921, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (26, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (27, tensor(0.8884, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (28, tensor(0.8922, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (29, tensor(0.8883, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (30, tensor(0.8902, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (31, tensor(0.8892, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (32, tensor(0.8902, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (33, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (34, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (35, tensor(0.8920, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (36, tensor(0.8885, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (37, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (38, tensor(0.8904, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (39, tensor(0.8798, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (40, tensor(0.8883, dtype=torch.float64))],
[2024-11-29 00:04:44,061][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0083, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (1, tensor(0.1745, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (2, tensor(0.2180, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (3, tensor(0.2521, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (4, tensor(0.2431, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (5, tensor(0.2516, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (6, tensor(0.2607, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (7, tensor(0.1928, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (8, tensor(0.2617, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (9, tensor(0.2813, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (10, tensor(0.2568, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (11, tensor(0.2446, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (12, tensor(0.2455, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (13, tensor(0.2503, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (14, tensor(0.2708, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (15, tensor(0.2670, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (16, tensor(0.2470, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (17, tensor(0.2631, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (18, tensor(0.2232, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (19, tensor(0.2416, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (20, tensor(0.2449, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (21, tensor(0.2317, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (22, tensor(0.2553, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (23, tensor(0.2616, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (24, tensor(0.2722, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (25, tensor(0.2550, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (26, tensor(0.2416, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (27, tensor(0.2675, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (28, tensor(0.2594, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (29, tensor(0.2478, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (30, tensor(0.2670, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (31, tensor(0.2761, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (32, tensor(0.2526, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (33, tensor(0.2592, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (34, tensor(0.2399, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (35, tensor(0.2567, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (36, tensor(0.2357, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (37, tensor(0.2624, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (38, tensor(0.2427, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (39, tensor(0.2344, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (40, tensor(0.2621, dtype=torch.float64))],
[2024-11-29 00:04:44,063][flwr][INFO] - 	 'all_iou': [(0, 0.0552537034326727),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (1, 0.7347268002805437),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (2, 0.7774996329864332),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (3, 0.7839677781051207),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (4, 0.7835131862503123),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (5, 0.7786731242725865),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (6, 0.7860492738157198),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (7, 0.7236299974434878),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (8, 0.7817302678896291),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (9, 0.7925540655485465),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (10, 0.7769691511570678),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (11, 0.7780622947412319),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (12, 0.7811500604052574),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (13, 0.7937431357837128),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (14, 0.777421477216883),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (15, 0.790384034811225),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (16, 0.7883912432417878),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (17, 0.7962606165871388),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (18, 0.7737839785962827),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (19, 0.7857084723258861),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (20, 0.7871855795761015),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (21, 0.7684518888134513),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (22, 0.789136069427251),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (23, 0.7912430017422938),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (24, 0.7936848174378953),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (25, 0.7922776095026193),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (26, 0.7907984205515001),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (27, 0.787135171253952),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (28, 0.7916867519343511),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (29, 0.78616398340562),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (30, 0.7899095518702021),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (31, 0.7880993554804232),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (32, 0.7886923548737353),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (33, 0.7904772705042659),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (34, 0.7875382294160379),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (35, 0.7909655883623893),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (36, 0.7858185503568491),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (37, 0.7903434077975025),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (38, 0.789450559846316),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (39, 0.7745300620876229),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (40, 0.7861858678207541)],
[2024-11-29 00:04:44,065][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1616, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (1, tensor(0.8323, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (2, tensor(0.8676, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (3, tensor(0.8726, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (4, tensor(0.8717, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (5, tensor(0.8685, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (6, tensor(0.8750, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (7, tensor(0.8284, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (8, tensor(0.8729, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (9, tensor(0.8812, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (10, tensor(0.8676, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (11, tensor(0.8703, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (12, tensor(0.8727, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (13, tensor(0.8820, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (14, tensor(0.8684, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (15, tensor(0.8792, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (16, tensor(0.8787, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (17, tensor(0.8843, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (18, tensor(0.8678, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (19, tensor(0.8766, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (20, tensor(0.8779, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (21, tensor(0.8623, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (22, tensor(0.8791, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (23, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (24, tensor(0.8822, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (25, tensor(0.8818, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (26, tensor(0.8810, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (27, tensor(0.8777, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (28, tensor(0.8819, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (29, tensor(0.8776, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (30, tensor(0.8797, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (31, tensor(0.8785, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (32, tensor(0.8796, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (33, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (34, tensor(0.8790, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (35, tensor(0.8816, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (36, tensor(0.8778, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (37, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (38, tensor(0.8800, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (39, tensor(0.8684, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (40, tensor(0.8776, dtype=torch.float64))],
[2024-11-29 00:04:44,067][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1601, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (1, tensor(0.9629, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (2, tensor(0.9741, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (3, tensor(0.9776, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (4, tensor(0.9791, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (5, tensor(0.9792, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (6, tensor(0.9815, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (7, tensor(0.9648, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (8, tensor(0.9829, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (9, tensor(0.9832, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (10, tensor(0.9803, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (11, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (12, tensor(0.9838, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (13, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (14, tensor(0.9829, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (15, tensor(0.9843, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (16, tensor(0.9851, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (17, tensor(0.9856, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (18, tensor(0.9849, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (19, tensor(0.9856, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (20, tensor(0.9853, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (21, tensor(0.9845, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (22, tensor(0.9859, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (23, tensor(0.9859, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (24, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (25, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (26, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (27, tensor(0.9862, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (28, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (29, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (30, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (31, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (32, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (33, tensor(0.9863, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (34, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (35, tensor(0.9866, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (36, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (37, tensor(0.9858, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (38, tensor(0.9848, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (39, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (40, tensor(0.9865, dtype=torch.float64))],
[2024-11-29 00:04:44,069][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (1, tensor(0.1462, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (2, tensor(0.1842, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (3, tensor(0.2168, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (4, tensor(0.2065, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (5, tensor(0.2155, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (6, tensor(0.2234, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (7, tensor(0.1512, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (8, tensor(0.2251, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (9, tensor(0.2463, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (10, tensor(0.2210, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (11, tensor(0.2043, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (12, tensor(0.2069, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (13, tensor(0.2102, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (14, tensor(0.2326, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (15, tensor(0.2278, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (16, tensor(0.2075, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (17, tensor(0.2236, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (18, tensor(0.1806, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (19, tensor(0.2004, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (20, tensor(0.2030, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (21, tensor(0.1907, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (22, tensor(0.2152, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (23, tensor(0.2220, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (24, tensor(0.2339, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (25, tensor(0.2145, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (26, tensor(0.2003, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (27, tensor(0.2276, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (28, tensor(0.2189, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (29, tensor(0.2070, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (30, tensor(0.2285, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (31, tensor(0.2378, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (32, tensor(0.2117, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (33, tensor(0.2193, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (34, tensor(0.1976, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (35, tensor(0.2158, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (36, tensor(0.1935, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (37, tensor(0.2225, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (38, tensor(0.2011, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (39, tensor(0.1940, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (40, tensor(0.2218, dtype=torch.float64))],
[2024-11-29 00:04:44,071][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0075, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (1, tensor(0.4041, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (2, tensor(0.4880, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (3, tensor(0.5402, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (4, tensor(0.5430, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (5, tensor(0.5488, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (6, tensor(0.5675, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (7, tensor(0.5380, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (8, tensor(0.5615, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (9, tensor(0.5695, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (10, tensor(0.5423, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (11, tensor(0.5759, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (12, tensor(0.5614, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (13, tensor(0.5794, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (14, tensor(0.5833, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (15, tensor(0.5881, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (16, tensor(0.5697, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (17, tensor(0.5834, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (18, tensor(0.5710, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (19, tensor(0.5809, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (20, tensor(0.5904, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (21, tensor(0.5689, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (22, tensor(0.5847, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (23, tensor(0.5850, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (24, tensor(0.5830, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (25, tensor(0.5897, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (26, tensor(0.5806, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (27, tensor(0.5939, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (28, tensor(0.5924, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (29, tensor(0.5776, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (30, tensor(0.5758, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (31, tensor(0.5866, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (32, tensor(0.5885, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (33, tensor(0.5790, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (34, tensor(0.5838, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (35, tensor(0.5936, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (36, tensor(0.5770, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (37, tensor(0.5897, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (38, tensor(0.5901, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (39, tensor(0.5561, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (40, tensor(0.5866, dtype=torch.float64))],
[2024-11-29 00:04:44,073][flwr][INFO] - 	 'ind_iou_0': [(0, 0.055350935347940645),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (1, 0.712552454365834),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (2, 0.7579797242080624),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (3, 0.7643732397895705),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (4, 0.7637307008884832),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (5, 0.758287771922533),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (6, 0.7662208933661147),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (7, 0.6996046718008183),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (8, 0.7613247276423324),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (9, 0.7732596355094269),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (10, 0.7564357428331301),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (11, 0.7571424297913529),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (12, 0.7605632316312407),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (13, 0.7744203668029485),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (14, 0.7565210455645685),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (15, 0.770708533190624),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (16, 0.7684722004336086),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (17, 0.7771052388513635),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (18, 0.7522642680075069),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (19, 0.7654243613263407),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (20, 0.7670865709172475),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (21, 0.7463972191302203),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (22, 0.769198741560112),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (23, 0.7715669423305815),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (24, 0.7742741367330938),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (25, 0.7726833734040778),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (26, 0.771086743552114),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (27, 0.7669883314203613),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (28, 0.7720390323189054),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (29, 0.765970638461008),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (30, 0.7700878354963548),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (31, 0.7681046176590351),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (32, 0.7687338322864983),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (33, 0.7707304914837289),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (34, 0.7675377406205277),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (35, 0.771242961908685),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (36, 0.7656138182430955),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (37, 0.7706449587034582),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (38, 0.769737898766734),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (39, 0.7533686612691947),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (40, 0.7659960521039098)],
[2024-11-29 00:04:44,076][flwr][INFO] - 	 'ind_iou_1': [(0, 0.0544219739757796),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (1, 0.9363470532395185),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (2, 0.9558406180921017),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (3, 0.962627727510885),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (4, 0.9638895096143001),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (5, 0.9642580501099705),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (6, 0.9664889241229515),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (7, 0.9415039251310271),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (8, 0.9677161197452596),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (9, 0.9685413997652824),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (10, 0.9636035958188761),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (11, 0.968959024391846),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (12, 0.968552975884231),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (13, 0.9693645472229383),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (14, 0.9676086916927787),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (15, 0.9694128355500067),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (16, 0.9698940083572806),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (17, 0.9708628761125967),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (18, 0.9695829823694017),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (19, 0.9704836987993137),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (20, 0.9702928639021118),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (21, 0.9699164123215347),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (22, 0.9710813877522105),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (23, 0.970867874093388),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (24, 0.9708346582909262),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (25, 0.9709504306561927),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (26, 0.9706609580223797),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (27, 0.9709532617555235),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (28, 0.9706655447215863),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (29, 0.9700831757658472),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (30, 0.9703503673549448),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (31, 0.9703306016666302),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (32, 0.9703174980328881),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (33, 0.9705246390896934),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (34, 0.9697600748511228),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (35, 0.9707749966443409),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (36, 0.9698532945503832),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (37, 0.9695113228799984),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (38, 0.9688456325633542),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (39, 0.9672903772408662),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (40, 0.9705781890043212)]}
[2024-11-29 00:04:44,078][flwr][INFO] - 
