[2024-08-06 14:59:34,524][flwr][INFO] - Starting Flower simulation, config: num_rounds=15, no round_timeout
[2024-08-06 14:59:37,160][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 72217920512.0, 'GPU': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'accelerator_type:T4': 1.0, 'node:10.50.9.88': 1.0, 'object_store_memory': 35236251648.0}
[2024-08-06 14:59:37,160][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-08-06 14:59:37,161][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-08-06 14:59:37,173][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
[2024-08-06 14:59:37,174][flwr][INFO] - [INIT]
[2024-08-06 14:59:37,174][flwr][INFO] - Requesting initial parameters from one random client
[2024-08-06 14:59:40,419][flwr][INFO] - Received initial parameters from one random client
[2024-08-06 14:59:40,420][flwr][INFO] - Evaluating initial global parameters
[2024-08-06 14:59:48,265][flwr][INFO] - initial parameters (loss, other metrics): 0.6928808664282163, OrderedDict([('ind_iou_0', 0.000250021394666222), ('ind_dice_liver_0', tensor(0.1239, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0005, dtype=torch.float64)), ('ind_iou_1', 0.006951623040274674), ('ind_dice_liver_1', tensor(0.1538, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0150, dtype=torch.float64)), ('all_iou', 0.003622812419953665), ('all_dice_liver', tensor(0.1369, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0079, dtype=torch.float64))])
[2024-08-06 14:59:48,270][flwr][INFO] - 
[2024-08-06 14:59:48,270][flwr][INFO] - [ROUND 1]
[2024-08-06 14:59:48,271][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:01:01,243][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:01:01,385][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-08-06 15:01:05,241][flwr][INFO] - fit progress: (1, 0.009348516730824485, OrderedDict([('ind_iou_0', 0.9283213539976254), ('ind_dice_liver_0', tensor(0.9363, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0497, dtype=torch.float64)), ('ind_iou_1', 0.9039622255776273), ('ind_dice_liver_1', tensor(0.9384, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4309, dtype=torch.float64)), ('all_iou', 0.8930333063208561), ('all_dice_liver', tensor(0.9216, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2729, dtype=torch.float64))]), 76.97023814404383)
[2024-08-06 15:01:05,245][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:01:05,989][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:01:05,989][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:01:06,509][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:01:06,509][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:01:06,509][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:01:06,510][flwr][INFO] - 
[2024-08-06 15:01:06,510][flwr][INFO] - [ROUND 2]
[2024-08-06 15:01:06,510][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:02:19,170][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:02:23,257][flwr][INFO] - fit progress: (2, 0.009348516934551299, OrderedDict([('ind_iou_0', 0.8962960414545158), ('ind_dice_liver_0', tensor(0.9037, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0386, dtype=torch.float64)), ('ind_iou_1', 0.8917638484242209), ('ind_dice_liver_1', tensor(0.9362, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4924, dtype=torch.float64)), ('all_iou', 0.8951827156346814), ('all_dice_liver', tensor(0.9228, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3056, dtype=torch.float64))]), 154.9870465369895)
[2024-08-06 15:02:23,263][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:02:23,897][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:02:23,897][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:02:24,424][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:02:24,424][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:02:24,425][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:02:24,425][flwr][INFO] - 
[2024-08-06 15:02:24,425][flwr][INFO] - [ROUND 3]
[2024-08-06 15:02:24,425][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:03:38,923][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:03:43,102][flwr][INFO] - fit progress: (3, 0.009348516953953853, OrderedDict([('ind_iou_0', 0.9259582049227069), ('ind_dice_liver_0', tensor(0.9359, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0387, dtype=torch.float64)), ('ind_iou_1', 0.9102367396998954), ('ind_dice_liver_1', tensor(0.9412, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4794, dtype=torch.float64)), ('all_iou', 0.905394240836425), ('all_dice_liver', tensor(0.9285, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3046, dtype=torch.float64))]), 234.8318852041848)
[2024-08-06 15:03:43,107][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:03:43,712][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:03:43,712][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:03:44,232][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:03:44,232][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:03:44,233][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:03:44,233][flwr][INFO] - 
[2024-08-06 15:03:44,234][flwr][INFO] - [ROUND 4]
[2024-08-06 15:03:44,234][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:04:58,584][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:05:02,679][flwr][INFO] - fit progress: (4, 0.009348516740525762, OrderedDict([('ind_iou_0', 0.922786527420528), ('ind_dice_liver_0', tensor(0.9308, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0523, dtype=torch.float64)), ('ind_iou_1', 0.8882225642918599), ('ind_dice_liver_1', tensor(0.9353, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5142, dtype=torch.float64)), ('all_iou', 0.913328279622001), ('all_dice_liver', tensor(0.9390, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2924, dtype=torch.float64))]), 314.40893963491544)
[2024-08-06 15:05:02,685][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:05:03,303][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:05:03,303][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:05:03,817][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:05:03,817][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:05:03,817][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:05:03,817][flwr][INFO] - 
[2024-08-06 15:05:03,818][flwr][INFO] - [ROUND 5]
[2024-08-06 15:05:03,818][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:06:18,280][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:06:22,491][flwr][INFO] - fit progress: (5, 0.009348516818135977, OrderedDict([('ind_iou_0', 0.930386507245105), ('ind_dice_liver_0', tensor(0.9364, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0388, dtype=torch.float64)), ('ind_iou_1', 0.8969870707551905), ('ind_dice_liver_1', tensor(0.9390, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5536, dtype=torch.float64)), ('all_iou', 0.9127843544868949), ('all_dice_liver', tensor(0.9357, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2532, dtype=torch.float64))]), 394.2205208260566)
[2024-08-06 15:06:22,496][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:06:23,123][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:06:23,124][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:06:23,641][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:06:23,641][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:06:23,642][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:06:23,642][flwr][INFO] - 
[2024-08-06 15:06:23,642][flwr][INFO] - [ROUND 6]
[2024-08-06 15:06:23,642][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:07:38,181][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:07:42,511][flwr][INFO] - fit progress: (6, 0.009348516890895553, OrderedDict([('ind_iou_0', 0.893025240827824), ('ind_dice_liver_0', tensor(0.9032, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0436, dtype=torch.float64)), ('ind_iou_1', 0.9029295225267756), ('ind_dice_liver_1', tensor(0.9412, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4996, dtype=torch.float64)), ('all_iou', 0.8977136990371424), ('all_dice_liver', tensor(0.9240, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3210, dtype=torch.float64))]), 474.2406570040621)
[2024-08-06 15:07:42,516][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:07:43,151][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:07:43,151][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:07:43,675][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:07:43,675][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:07:43,675][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:07:43,675][flwr][INFO] - 
[2024-08-06 15:07:43,676][flwr][INFO] - [ROUND 7]
[2024-08-06 15:07:43,676][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:08:58,167][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:09:02,271][flwr][INFO] - fit progress: (7, 0.009348516575604057, OrderedDict([('ind_iou_0', 0.9195155181345341), ('ind_dice_liver_0', tensor(0.9268, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0442, dtype=torch.float64)), ('ind_iou_1', 0.8955733117070753), ('ind_dice_liver_1', tensor(0.9387, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4995, dtype=torch.float64)), ('all_iou', 0.8990574045170975), ('all_dice_liver', tensor(0.9225, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2524, dtype=torch.float64))]), 554.0004615797661)
[2024-08-06 15:09:02,276][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:09:02,913][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:09:02,913][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:09:03,437][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:09:03,438][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:09:03,438][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:09:03,438][flwr][INFO] - 
[2024-08-06 15:09:03,439][flwr][INFO] - [ROUND 8]
[2024-08-06 15:09:03,439][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:10:17,894][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:10:21,974][flwr][INFO] - fit progress: (8, 0.009348516813285338, OrderedDict([('ind_iou_0', 0.9165607718481543), ('ind_dice_liver_0', tensor(0.9214, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0539, dtype=torch.float64)), ('ind_iou_1', 0.8910641945648642), ('ind_dice_liver_1', tensor(0.9368, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5123, dtype=torch.float64)), ('all_iou', 0.9040786238772324), ('all_dice_liver', tensor(0.9311, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3106, dtype=torch.float64))]), 633.7037089588121)
[2024-08-06 15:10:21,979][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:10:22,610][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:10:22,610][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:10:23,127][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:10:23,128][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:10:23,128][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:10:23,128][flwr][INFO] - 
[2024-08-06 15:10:23,128][flwr][INFO] - [ROUND 9]
[2024-08-06 15:10:23,129][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:11:37,522][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:11:41,676][flwr][INFO] - fit progress: (9, 0.009348516604707887, OrderedDict([('ind_iou_0', 0.9067058917831331), ('ind_dice_liver_0', tensor(0.9179, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0479, dtype=torch.float64)), ('ind_iou_1', 0.9019075040120837), ('ind_dice_liver_1', tensor(0.9415, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4932, dtype=torch.float64)), ('all_iou', 0.8912585857456946), ('all_dice_liver', tensor(0.9171, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3065, dtype=torch.float64))]), 713.4051969749853)
[2024-08-06 15:11:41,681][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:11:42,291][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:11:42,291][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:11:42,814][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:11:42,814][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:11:42,815][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:11:42,815][flwr][INFO] - 
[2024-08-06 15:11:42,815][flwr][INFO] - [ROUND 10]
[2024-08-06 15:11:42,815][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:12:57,213][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:13:01,501][flwr][INFO] - fit progress: (10, 0.009348516757502997, OrderedDict([('ind_iou_0', 0.9078019428558223), ('ind_dice_liver_0', tensor(0.9125, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0542, dtype=torch.float64)), ('ind_iou_1', 0.904560628392503), ('ind_dice_liver_1', tensor(0.9399, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4742, dtype=torch.float64)), ('all_iou', 0.8959177464462368), ('all_dice_liver', tensor(0.9195, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2901, dtype=torch.float64))]), 793.230975065846)
[2024-08-06 15:13:01,506][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:13:02,131][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:13:02,131][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:13:02,646][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:13:02,647][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:13:02,647][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:13:02,647][flwr][INFO] - 
[2024-08-06 15:13:02,648][flwr][INFO] - [ROUND 11]
[2024-08-06 15:13:02,648][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:14:16,838][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:14:20,897][flwr][INFO] - fit progress: (11, 0.009348516769629592, OrderedDict([('ind_iou_0', 0.9195711065885809), ('ind_dice_liver_0', tensor(0.9290, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0506, dtype=torch.float64)), ('ind_iou_1', 0.902555575415055), ('ind_dice_liver_1', tensor(0.9420, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5086, dtype=torch.float64)), ('all_iou', 0.9056279715838479), ('all_dice_liver', tensor(0.9310, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3149, dtype=torch.float64))]), 872.626444562804)
[2024-08-06 15:14:20,905][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:14:21,534][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:14:21,534][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:14:22,049][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:14:22,049][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:14:22,050][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:14:22,050][flwr][INFO] - 
[2024-08-06 15:14:22,050][flwr][INFO] - [ROUND 12]
[2024-08-06 15:14:22,050][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:15:36,258][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:15:40,444][flwr][INFO] - fit progress: (12, 0.00934851702186279, OrderedDict([('ind_iou_0', 0.9275801806506091), ('ind_dice_liver_0', tensor(0.9359, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0471, dtype=torch.float64)), ('ind_iou_1', 0.8870279636387893), ('ind_dice_liver_1', tensor(0.9255, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4731, dtype=torch.float64)), ('all_iou', 0.9128710413063884), ('all_dice_liver', tensor(0.9358, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3096, dtype=torch.float64))]), 952.1732274070382)
[2024-08-06 15:15:40,448][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:15:41,077][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:15:41,077][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:15:41,591][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:15:41,592][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:15:41,592][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:15:41,592][flwr][INFO] - 
[2024-08-06 15:15:41,592][flwr][INFO] - [ROUND 13]
[2024-08-06 15:15:41,593][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:16:55,932][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:17:00,296][flwr][INFO] - fit progress: (13, 0.009348516755077677, OrderedDict([('ind_iou_0', 0.9211504076590061), ('ind_dice_liver_0', tensor(0.9271, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0552, dtype=torch.float64)), ('ind_iou_1', 0.8958702083281738), ('ind_dice_liver_1', tensor(0.9340, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4837, dtype=torch.float64)), ('all_iou', 0.9124075114888054), ('all_dice_liver', tensor(0.9349, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2982, dtype=torch.float64))]), 1032.0258164880797)
[2024-08-06 15:17:00,301][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:17:00,915][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:17:00,915][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:17:01,438][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:17:01,438][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:17:01,439][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:17:01,439][flwr][INFO] - 
[2024-08-06 15:17:01,439][flwr][INFO] - [ROUND 14]
[2024-08-06 15:17:01,439][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:18:15,644][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:18:19,740][flwr][INFO] - fit progress: (14, 0.009348516759928316, OrderedDict([('ind_iou_0', 0.9249940020252457), ('ind_dice_liver_0', tensor(0.9305, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0589, dtype=torch.float64)), ('ind_iou_1', 0.9036533925238466), ('ind_dice_liver_1', tensor(0.9429, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4997, dtype=torch.float64)), ('all_iou', 0.9077563897882173), ('all_dice_liver', tensor(0.9350, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3159, dtype=torch.float64))]), 1111.4692013901658)
[2024-08-06 15:18:19,745][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:18:20,358][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:18:20,358][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:18:20,868][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:18:20,868][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:18:20,869][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:18:20,869][flwr][INFO] - 
[2024-08-06 15:18:20,869][flwr][INFO] - [ROUND 15]
[2024-08-06 15:18:20,869][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[2024-08-06 15:19:35,097][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[2024-08-06 15:19:39,166][flwr][INFO] - fit progress: (15, 0.00934851659500661, OrderedDict([('ind_iou_0', 0.909286384041348), ('ind_dice_liver_0', tensor(0.9142, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0489, dtype=torch.float64)), ('ind_iou_1', 0.9089266423724127), ('ind_dice_liver_1', tensor(0.9438, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5171, dtype=torch.float64)), ('all_iou', 0.9104006775169219), ('all_dice_liver', tensor(0.9331, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3173, dtype=torch.float64))]), 1190.896117594093)
[2024-08-06 15:19:39,171][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-08-06 15:19:39,785][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:19:39,786][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:19:40,293][flwr][ERROR] - Traceback (most recent call last):
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-08-06 15:19:40,293][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=788834, ip=10.50.9.88, actor_id=8e61442d57a31cb5e6e97f7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f06f0634520>)
  File "/home/mmaia/my_envs/liver_torch/lib/python3.8/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-08-06 15:19:40,294][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2024-08-06 15:19:40,294][flwr][INFO] - 
[2024-08-06 15:19:40,294][flwr][INFO] - [SUMMARY]
[2024-08-06 15:19:40,295][flwr][INFO] - Run finished 15 round(s) in 1192.02s
[2024-08-06 15:19:40,394][flwr][INFO] - 	History (loss, centralized):
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 0: 0.6928808664282163
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 1: 0.009348516730824485
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 2: 0.009348516934551299
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 3: 0.009348516953953853
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 4: 0.009348516740525762
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 5: 0.009348516818135977
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 6: 0.009348516890895553
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 7: 0.009348516575604057
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 8: 0.009348516813285338
[2024-08-06 15:19:40,395][flwr][INFO] - 		round 9: 0.009348516604707887
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 10: 0.009348516757502997
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 11: 0.009348516769629592
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 12: 0.00934851702186279
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 13: 0.009348516755077677
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 14: 0.009348516759928316
[2024-08-06 15:19:40,396][flwr][INFO] - 		round 15: 0.00934851659500661
[2024-08-06 15:19:40,396][flwr][INFO] - 	History (metrics, centralized):
[2024-08-06 15:19:40,396][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1369, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (1, tensor(0.9216, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (2, tensor(0.9228, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (3, tensor(0.9285, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (4, tensor(0.9390, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (5, tensor(0.9357, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (6, tensor(0.9240, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (7, tensor(0.9225, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (8, tensor(0.9311, dtype=torch.float64)),
[2024-08-06 15:19:40,396][flwr][INFO] - 	                    (9, tensor(0.9171, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (10, tensor(0.9195, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (11, tensor(0.9310, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (12, tensor(0.9358, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (13, tensor(0.9349, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (14, tensor(0.9350, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                    (15, tensor(0.9331, dtype=torch.float64))],
[2024-08-06 15:19:40,397][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0079, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (1, tensor(0.2729, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (2, tensor(0.3056, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (3, tensor(0.3046, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (4, tensor(0.2924, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (5, tensor(0.2532, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (6, tensor(0.3210, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (7, tensor(0.2524, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (8, tensor(0.3106, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (9, tensor(0.3065, dtype=torch.float64)),
[2024-08-06 15:19:40,397][flwr][INFO] - 	                     (10, tensor(0.2901, dtype=torch.float64)),
[2024-08-06 15:19:40,398][flwr][INFO] - 	                     (11, tensor(0.3149, dtype=torch.float64)),
[2024-08-06 15:19:40,398][flwr][INFO] - 	                     (12, tensor(0.3096, dtype=torch.float64)),
[2024-08-06 15:19:40,398][flwr][INFO] - 	                     (13, tensor(0.2982, dtype=torch.float64)),
[2024-08-06 15:19:40,398][flwr][INFO] - 	                     (14, tensor(0.3159, dtype=torch.float64)),
[2024-08-06 15:19:40,398][flwr][INFO] - 	                     (15, tensor(0.3173, dtype=torch.float64))],
[2024-08-06 15:19:40,398][flwr][INFO] - 	 'all_iou': [(0, 0.003622812419953665),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (1, 0.8930333063208561),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (2, 0.8951827156346814),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (3, 0.905394240836425),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (4, 0.913328279622001),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (5, 0.9127843544868949),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (6, 0.8977136990371424),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (7, 0.8990574045170975),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (8, 0.9040786238772324),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (9, 0.8912585857456946),
[2024-08-06 15:19:40,398][flwr][INFO] - 	             (10, 0.8959177464462368),
[2024-08-06 15:19:40,399][flwr][INFO] - 	             (11, 0.9056279715838479),
[2024-08-06 15:19:40,399][flwr][INFO] - 	             (12, 0.9128710413063884),
[2024-08-06 15:19:40,399][flwr][INFO] - 	             (13, 0.9124075114888054),
[2024-08-06 15:19:40,399][flwr][INFO] - 	             (14, 0.9077563897882173),
[2024-08-06 15:19:40,399][flwr][INFO] - 	             (15, 0.9104006775169219)],
[2024-08-06 15:19:40,399][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1239, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (1, tensor(0.9363, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (2, tensor(0.9037, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (3, tensor(0.9359, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (4, tensor(0.9308, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (5, tensor(0.9364, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (6, tensor(0.9032, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (7, tensor(0.9268, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (8, tensor(0.9214, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (9, tensor(0.9179, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (10, tensor(0.9125, dtype=torch.float64)),
[2024-08-06 15:19:40,399][flwr][INFO] - 	                      (11, tensor(0.9290, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (12, tensor(0.9359, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (13, tensor(0.9271, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (14, tensor(0.9305, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (15, tensor(0.9142, dtype=torch.float64))],
[2024-08-06 15:19:40,400][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1538, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (1, tensor(0.9384, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (2, tensor(0.9362, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (3, tensor(0.9412, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (4, tensor(0.9353, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (5, tensor(0.9390, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (6, tensor(0.9412, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (7, tensor(0.9387, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (8, tensor(0.9368, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (9, tensor(0.9415, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (10, tensor(0.9399, dtype=torch.float64)),
[2024-08-06 15:19:40,400][flwr][INFO] - 	                      (11, tensor(0.9420, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                      (12, tensor(0.9255, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                      (13, tensor(0.9340, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                      (14, tensor(0.9429, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                      (15, tensor(0.9438, dtype=torch.float64))],
[2024-08-06 15:19:40,401][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0005, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (1, tensor(0.0497, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (2, tensor(0.0386, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (3, tensor(0.0387, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (4, tensor(0.0523, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (5, tensor(0.0388, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (6, tensor(0.0436, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (7, tensor(0.0442, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (8, tensor(0.0539, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (9, tensor(0.0479, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (10, tensor(0.0542, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (11, tensor(0.0506, dtype=torch.float64)),
[2024-08-06 15:19:40,401][flwr][INFO] - 	                       (12, tensor(0.0471, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (13, tensor(0.0552, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (14, tensor(0.0589, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (15, tensor(0.0489, dtype=torch.float64))],
[2024-08-06 15:19:40,402][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0150, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (1, tensor(0.4309, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (2, tensor(0.4924, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (3, tensor(0.4794, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (4, tensor(0.5142, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (5, tensor(0.5536, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (6, tensor(0.4996, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (7, tensor(0.4995, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (8, tensor(0.5123, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (9, tensor(0.4932, dtype=torch.float64)),
[2024-08-06 15:19:40,402][flwr][INFO] - 	                       (10, tensor(0.4742, dtype=torch.float64)),
[2024-08-06 15:19:40,403][flwr][INFO] - 	                       (11, tensor(0.5086, dtype=torch.float64)),
[2024-08-06 15:19:40,403][flwr][INFO] - 	                       (12, tensor(0.4731, dtype=torch.float64)),
[2024-08-06 15:19:40,403][flwr][INFO] - 	                       (13, tensor(0.4837, dtype=torch.float64)),
[2024-08-06 15:19:40,403][flwr][INFO] - 	                       (14, tensor(0.4997, dtype=torch.float64)),
[2024-08-06 15:19:40,403][flwr][INFO] - 	                       (15, tensor(0.5171, dtype=torch.float64))],
[2024-08-06 15:19:40,403][flwr][INFO] - 	 'ind_iou_0': [(0, 0.000250021394666222),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (1, 0.9283213539976254),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (2, 0.8962960414545158),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (3, 0.9259582049227069),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (4, 0.922786527420528),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (5, 0.930386507245105),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (6, 0.893025240827824),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (7, 0.9195155181345341),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (8, 0.9165607718481543),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (9, 0.9067058917831331),
[2024-08-06 15:19:40,403][flwr][INFO] - 	               (10, 0.9078019428558223),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (11, 0.9195711065885809),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (12, 0.9275801806506091),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (13, 0.9211504076590061),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (14, 0.9249940020252457),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (15, 0.909286384041348)],
[2024-08-06 15:19:40,404][flwr][INFO] - 	 'ind_iou_1': [(0, 0.006951623040274674),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (1, 0.9039622255776273),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (2, 0.8917638484242209),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (3, 0.9102367396998954),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (4, 0.8882225642918599),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (5, 0.8969870707551905),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (6, 0.9029295225267756),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (7, 0.8955733117070753),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (8, 0.8910641945648642),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (9, 0.9019075040120837),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (10, 0.904560628392503),
[2024-08-06 15:19:40,404][flwr][INFO] - 	               (11, 0.902555575415055),
[2024-08-06 15:19:40,405][flwr][INFO] - 	               (12, 0.8870279636387893),
[2024-08-06 15:19:40,405][flwr][INFO] - 	               (13, 0.8958702083281738),
[2024-08-06 15:19:40,405][flwr][INFO] - 	               (14, 0.9036533925238466),
[2024-08-06 15:19:40,405][flwr][INFO] - 	               (15, 0.9089266423724127)]}
[2024-08-06 15:19:40,405][flwr][INFO] - 
