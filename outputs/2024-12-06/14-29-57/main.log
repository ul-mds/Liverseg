[2024-12-06 14:29:57,802][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-12-06 14:30:20,265][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0, 'memory': 859521694720.0, 'node:172.18.62.8': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[2024-12-06 14:30:20,265][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-06 14:30:20,265][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-06 14:30:20,278][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-06 14:30:20,279][flwr][INFO] - [INIT]
[2024-12-06 14:30:20,280][flwr][INFO] - Requesting initial parameters from one random client
[2024-12-06 14:30:23,449][flwr][INFO] - Received initial parameters from one random client
[2024-12-06 14:30:23,449][flwr][INFO] - Evaluating initial global parameters
[2024-12-06 14:34:29,849][flwr][INFO] - initial parameters (loss, other metrics): 0.5985886103899952, OrderedDict([('ind_iou_0', 2.4740422930434125e-06), ('ind_dice_liver_0', tensor(0.1485, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0082, dtype=torch.float64)), ('ind_iou_1', 1.365228672907438e-05), ('ind_dice_liver_1', tensor(0.1468, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0074, dtype=torch.float64)), ('all_iou', 3.5429014830725577e-06), ('all_dice_liver', tensor(0.1483, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0081, dtype=torch.float64))])
[2024-12-06 14:34:29,931][flwr][INFO] - 
[2024-12-06 14:34:29,932][flwr][INFO] - [ROUND 1]
[2024-12-06 14:34:29,932][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 15:41:47,849][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 15:41:47,891][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-12-06 15:45:44,103][flwr][INFO] - fit progress: (1, 0.006515936818700306, OrderedDict([('ind_iou_0', 0.9454902448352747), ('ind_dice_liver_0', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5483, dtype=torch.float64)), ('ind_iou_1', 0.9364330953567215), ('ind_dice_liver_1', tensor(0.9583, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4506, dtype=torch.float64)), ('all_iou', 0.9447089926663125), ('all_dice_liver', tensor(0.9636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5416, dtype=torch.float64))]), 4274.1716615715995)
[2024-12-06 15:45:44,113][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 15:46:52,056][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 15:46:52,057][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 15:46:52,057][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 15:46:52,057][flwr][INFO] - 
[2024-12-06 15:46:52,057][flwr][INFO] - [ROUND 2]
[2024-12-06 15:46:52,058][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 16:38:35,680][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 16:41:13,428][flwr][INFO] - fit progress: (2, 0.004542783957847375, OrderedDict([('ind_iou_0', 0.95992076545512), ('ind_dice_liver_0', tensor(0.9738, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6324, dtype=torch.float64)), ('ind_iou_1', 0.9570659249348098), ('ind_dice_liver_1', tensor(0.9697, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5436, dtype=torch.float64)), ('all_iou', 0.9596553870736655), ('all_dice_liver', tensor(0.9734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6260, dtype=torch.float64))]), 7603.496656024829)
[2024-12-06 16:41:13,431][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 16:42:22,330][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 16:42:22,330][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 16:42:22,331][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 16:42:22,331][flwr][INFO] - 
[2024-12-06 16:42:22,331][flwr][INFO] - [ROUND 3]
[2024-12-06 16:42:22,331][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 17:31:07,963][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 17:33:40,682][flwr][INFO] - fit progress: (3, 0.0038253379100324602, OrderedDict([('ind_iou_0', 0.9660292266965136), ('ind_dice_liver_0', tensor(0.9790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6580, dtype=torch.float64)), ('ind_iou_1', 0.9644579211706455), ('ind_dice_liver_1', tensor(0.9767, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5628, dtype=torch.float64)), ('all_iou', 0.9659072714310327), ('all_dice_liver', tensor(0.9788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6512, dtype=torch.float64))]), 10750.750456212088)
[2024-12-06 17:33:40,685][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 17:34:48,238][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 17:34:48,238][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 17:34:48,239][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 17:34:48,239][flwr][INFO] - 
[2024-12-06 17:34:48,239][flwr][INFO] - [ROUND 4]
[2024-12-06 17:34:48,239][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 18:23:34,264][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 18:26:09,050][flwr][INFO] - fit progress: (4, 0.003386278392848925, OrderedDict([('ind_iou_0', 0.9695533655348568), ('ind_dice_liver_0', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6779, dtype=torch.float64)), ('ind_iou_1', 0.9696835670861041), ('ind_dice_liver_1', tensor(0.9800, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5855, dtype=torch.float64)), ('all_iou', 0.9695892983599778), ('all_dice_liver', tensor(0.9812, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6713, dtype=torch.float64))]), 13899.118824236095)
[2024-12-06 18:26:09,054][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 18:27:17,164][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 18:27:17,164][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 18:27:17,165][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 18:27:17,165][flwr][INFO] - 
[2024-12-06 18:27:17,165][flwr][INFO] - [ROUND 5]
[2024-12-06 18:27:17,166][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 19:16:06,168][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 19:18:39,779][flwr][INFO] - fit progress: (5, 0.00328210132444603, OrderedDict([('ind_iou_0', 0.9706108669626013), ('ind_dice_liver_0', tensor(0.9823, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6799, dtype=torch.float64)), ('ind_iou_1', 0.9719631157032752), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5871, dtype=torch.float64)), ('all_iou', 0.9707688675862118), ('all_dice_liver', tensor(0.9822, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6738, dtype=torch.float64))]), 17049.847650198266)
[2024-12-06 19:18:39,783][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 19:19:46,694][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 19:19:46,694][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 19:19:46,695][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 19:19:46,695][flwr][INFO] - 
[2024-12-06 19:19:46,695][flwr][INFO] - [ROUND 6]
[2024-12-06 19:19:46,695][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 20:08:33,602][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 20:11:08,239][flwr][INFO] - fit progress: (6, 0.003092431255442386, OrderedDict([('ind_iou_0', 0.9727171410860056), ('ind_dice_liver_0', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6955, dtype=torch.float64)), ('ind_iou_1', 0.9726723388748973), ('ind_dice_liver_1', tensor(0.9826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5990, dtype=torch.float64)), ('all_iou', 0.9727340808641882), ('all_dice_liver', tensor(0.9837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6885, dtype=torch.float64))]), 20198.30798675213)
[2024-12-06 20:11:08,243][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 20:12:17,040][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 20:12:17,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 20:12:17,042][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 20:12:17,042][flwr][INFO] - 
[2024-12-06 20:12:17,042][flwr][INFO] - [ROUND 7]
[2024-12-06 20:12:17,043][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 21:00:58,033][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 21:03:31,101][flwr][INFO] - fit progress: (7, 0.0029623138369476326, OrderedDict([('ind_iou_0', 0.9743037021487023), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7058, dtype=torch.float64)), ('ind_iou_1', 0.9761668574626706), ('ind_dice_liver_1', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6167, dtype=torch.float64)), ('all_iou', 0.9745154583346163), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7001, dtype=torch.float64))]), 23341.169243730605)
[2024-12-06 21:03:31,104][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 21:04:38,305][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 21:04:38,306][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 21:04:38,306][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 21:04:38,306][flwr][INFO] - 
[2024-12-06 21:04:38,306][flwr][INFO] - [ROUND 8]
[2024-12-06 21:04:38,306][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 21:53:07,463][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 21:55:40,295][flwr][INFO] - fit progress: (8, 0.003743882500372747, OrderedDict([('ind_iou_0', 0.9755247023773171), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7099, dtype=torch.float64)), ('ind_iou_1', 0.9774988066479126), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6200, dtype=torch.float64)), ('all_iou', 0.9757239311601605), ('all_dice_liver', tensor(0.9860, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7039, dtype=torch.float64))]), 26470.364127457142)
[2024-12-06 21:55:40,299][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 21:56:48,154][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 21:56:48,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 21:56:48,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 21:56:48,155][flwr][INFO] - 
[2024-12-06 21:56:48,155][flwr][INFO] - [ROUND 9]
[2024-12-06 21:56:48,155][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 22:45:27,390][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 22:47:59,495][flwr][INFO] - fit progress: (9, 0.0027589487033706783, OrderedDict([('ind_iou_0', 0.9759608166970313), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7142, dtype=torch.float64)), ('ind_iou_1', 0.9784240195732182), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6229, dtype=torch.float64)), ('all_iou', 0.9762132838668383), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7085, dtype=torch.float64))]), 29609.564025849104)
[2024-12-06 22:47:59,499][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 22:49:08,214][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 22:49:08,214][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 22:49:08,215][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 22:49:08,215][flwr][INFO] - 
[2024-12-06 22:49:08,215][flwr][INFO] - [ROUND 10]
[2024-12-06 22:49:08,216][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 23:37:49,413][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-06 23:40:22,899][flwr][INFO] - fit progress: (10, 0.0027761022886981152, OrderedDict([('ind_iou_0', 0.9757961870136389), ('ind_dice_liver_0', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7121, dtype=torch.float64)), ('ind_iou_1', 0.9784249133721511), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6230, dtype=torch.float64)), ('all_iou', 0.9760647841186957), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7065, dtype=torch.float64))]), 32752.96811099723)
[2024-12-06 23:40:22,903][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 23:41:31,032][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 23:41:31,032][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 23:41:31,032][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 23:41:31,033][flwr][INFO] - 
[2024-12-06 23:41:31,033][flwr][INFO] - [ROUND 11]
[2024-12-06 23:41:31,033][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 00:30:13,821][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 00:32:47,234][flwr][INFO] - fit progress: (11, 0.0027208725230792687, OrderedDict([('ind_iou_0', 0.9765727632331487), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7181, dtype=torch.float64)), ('ind_iou_1', 0.97917922335383), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6306, dtype=torch.float64)), ('all_iou', 0.9768700987301548), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7129, dtype=torch.float64))]), 35897.30215529539)
[2024-12-07 00:32:47,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 00:33:56,274][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 00:33:56,274][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 00:33:56,274][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 00:33:56,274][flwr][INFO] - 
[2024-12-07 00:33:56,274][flwr][INFO] - [ROUND 12]
[2024-12-07 00:33:56,274][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 01:55:09,102][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 01:58:13,357][flwr][INFO] - fit progress: (12, 0.0026659904490806403, OrderedDict([('ind_iou_0', 0.9772283303190545), ('ind_dice_liver_0', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7202, dtype=torch.float64)), ('ind_iou_1', 0.9802178397265098), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6268, dtype=torch.float64)), ('all_iou', 0.9775351606448185), ('all_dice_liver', tensor(0.9873, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 41023.42520035524)
[2024-12-07 01:58:13,360][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 01:59:21,666][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 01:59:21,666][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 01:59:21,667][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 01:59:21,667][flwr][INFO] - 
[2024-12-07 01:59:21,667][flwr][INFO] - [ROUND 13]
[2024-12-07 01:59:21,667][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 03:42:52,659][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 03:45:40,727][flwr][INFO] - fit progress: (13, 0.002692050085094061, OrderedDict([('ind_iou_0', 0.9775635246919407), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7239, dtype=torch.float64)), ('ind_iou_1', 0.9808919068721229), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6281, dtype=torch.float64)), ('all_iou', 0.9779167073957651), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7181, dtype=torch.float64))]), 47470.795742058195)
[2024-12-07 03:45:40,731][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 03:46:48,183][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 03:46:48,183][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 03:46:48,184][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 03:46:48,184][flwr][INFO] - 
[2024-12-07 03:46:48,184][flwr][INFO] - [ROUND 14]
[2024-12-07 03:46:48,184][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 05:49:46,804][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 05:52:52,246][flwr][INFO] - fit progress: (14, 0.002670248093661563, OrderedDict([('ind_iou_0', 0.977727889992489), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7237, dtype=torch.float64)), ('ind_iou_1', 0.981350302711466), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6342, dtype=torch.float64)), ('all_iou', 0.9780978023952315), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7180, dtype=torch.float64))]), 55102.31454323698)
[2024-12-07 05:52:52,249][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 05:54:00,832][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 05:54:00,832][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 05:54:00,833][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 05:54:00,833][flwr][INFO] - 
[2024-12-07 05:54:00,833][flwr][INFO] - [ROUND 15]
[2024-12-07 05:54:00,833][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 07:41:09,496][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 07:44:05,554][flwr][INFO] - fit progress: (15, 0.0026509145685603376, OrderedDict([('ind_iou_0', 0.9781627865393916), ('ind_dice_liver_0', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7290, dtype=torch.float64)), ('ind_iou_1', 0.9820824311422482), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6418, dtype=torch.float64)), ('all_iou', 0.9785602852185126), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 61775.62238966301)
[2024-12-07 07:44:05,557][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 07:45:14,125][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 07:45:14,125][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 07:45:14,126][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 07:45:14,126][flwr][INFO] - 
[2024-12-07 07:45:14,126][flwr][INFO] - [ROUND 16]
[2024-12-07 07:45:14,126][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 08:57:05,208][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 09:00:14,661][flwr][INFO] - fit progress: (16, 0.0027665300903549498, OrderedDict([('ind_iou_0', 0.9778573106078782), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7309, dtype=torch.float64)), ('ind_iou_1', 0.9816082032900846), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6436, dtype=torch.float64)), ('all_iou', 0.9782469663226757), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7253, dtype=torch.float64))]), 66344.72983278893)
[2024-12-07 09:00:14,665][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 09:01:22,155][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 09:01:22,155][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 09:01:22,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 09:01:22,155][flwr][INFO] - 
[2024-12-07 09:01:22,155][flwr][INFO] - [ROUND 17]
[2024-12-07 09:01:22,156][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 10:25:56,776][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 10:28:51,477][flwr][INFO] - fit progress: (17, 0.002657527722059511, OrderedDict([('ind_iou_0', 0.9786050378058706), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7285, dtype=torch.float64)), ('ind_iou_1', 0.982670458207204), ('ind_dice_liver_1', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6405, dtype=torch.float64)), ('all_iou', 0.9790202192190148), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7228, dtype=torch.float64))]), 71661.54598313477)
[2024-12-07 10:28:51,481][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 10:29:59,980][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 10:29:59,980][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 10:29:59,981][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 10:29:59,981][flwr][INFO] - 
[2024-12-07 10:29:59,981][flwr][INFO] - [ROUND 18]
[2024-12-07 10:29:59,981][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 11:26:09,293][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 11:29:08,062][flwr][INFO] - fit progress: (18, 0.002664060774314639, OrderedDict([('ind_iou_0', 0.9784739443537188), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7327, dtype=torch.float64)), ('ind_iou_1', 0.9827090311587), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6432, dtype=torch.float64)), ('all_iou', 0.9789001887134726), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7269, dtype=torch.float64))]), 75278.13102878164)
[2024-12-07 11:29:08,066][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 11:30:17,176][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 11:30:17,176][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 11:30:17,176][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 11:30:17,177][flwr][INFO] - 
[2024-12-07 11:30:17,177][flwr][INFO] - [ROUND 19]
[2024-12-07 11:30:17,177][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 12:50:13,044][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 12:53:10,114][flwr][INFO] - fit progress: (19, 0.002807504808426116, OrderedDict([('ind_iou_0', 0.97844934473799), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7320, dtype=torch.float64)), ('ind_iou_1', 0.9825954428977627), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9788785868476619), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7273, dtype=torch.float64))]), 80320.18296504859)
[2024-12-07 12:53:10,118][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 12:54:18,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 12:54:18,140][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 12:54:18,141][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 12:54:18,141][flwr][INFO] - 
[2024-12-07 12:54:18,141][flwr][INFO] - [ROUND 20]
[2024-12-07 12:54:18,141][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 14:16:39,270][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 14:19:47,457][flwr][INFO] - fit progress: (20, 0.002668962113345518, OrderedDict([('ind_iou_0', 0.9789663994278827), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7354, dtype=torch.float64)), ('ind_iou_1', 0.98351758765733), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9794348383022707), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7303, dtype=torch.float64))]), 85517.52526586782)
[2024-12-07 14:19:47,460][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 14:20:55,408][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 14:20:55,408][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 14:20:55,408][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 14:20:55,409][flwr][INFO] - 
[2024-12-07 14:20:55,409][flwr][INFO] - [ROUND 21]
[2024-12-07 14:20:55,409][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 15:48:54,683][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 15:51:51,450][flwr][INFO] - fit progress: (21, 0.0027130042467715925, OrderedDict([('ind_iou_0', 0.9790453675322541), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7350, dtype=torch.float64)), ('ind_iou_1', 0.9838142078614804), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9795267290080488), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7299, dtype=torch.float64))]), 91041.51878316235)
[2024-12-07 15:51:51,454][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 15:52:58,505][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 15:52:58,506][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 15:52:58,506][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 15:52:58,507][flwr][INFO] - 
[2024-12-07 15:52:58,507][flwr][INFO] - [ROUND 22]
[2024-12-07 15:52:58,507][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 16:42:39,505][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 16:45:39,069][flwr][INFO] - fit progress: (22, 0.0027833415095679967, OrderedDict([('ind_iou_0', 0.9790634615414073), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7358, dtype=torch.float64)), ('ind_iou_1', 0.9838418780263609), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6494, dtype=torch.float64)), ('all_iou', 0.9795575630034379), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7308, dtype=torch.float64))]), 94269.13785352744)
[2024-12-07 16:45:39,073][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 16:46:46,182][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 16:46:46,182][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 16:46:46,182][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 16:46:46,182][flwr][INFO] - 
[2024-12-07 16:46:46,183][flwr][INFO] - [ROUND 23]
[2024-12-07 16:46:46,183][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 17:35:54,350][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 17:38:34,046][flwr][INFO] - fit progress: (23, 0.0027550396282174905, OrderedDict([('ind_iou_0', 0.9790626269585961), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7339, dtype=torch.float64)), ('ind_iou_1', 0.9836389842603372), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6466, dtype=torch.float64)), ('all_iou', 0.9795409902585651), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 97444.1142337136)
[2024-12-07 17:38:34,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 17:39:40,710][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 17:39:40,711][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 17:39:40,711][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 17:39:40,712][flwr][INFO] - 
[2024-12-07 17:39:40,712][flwr][INFO] - [ROUND 24]
[2024-12-07 17:39:40,712][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 18:31:22,136][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 18:34:00,206][flwr][INFO] - fit progress: (24, 0.002696557874557663, OrderedDict([('ind_iou_0', 0.9789554558684999), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7351, dtype=torch.float64)), ('ind_iou_1', 0.9837265367281732), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6474, dtype=torch.float64)), ('all_iou', 0.97944512305301), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7298, dtype=torch.float64))]), 100770.27486142237)
[2024-12-07 18:34:00,209][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 18:35:06,435][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 18:35:06,436][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 18:35:06,436][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 18:35:06,436][flwr][INFO] - 
[2024-12-07 18:35:06,436][flwr][INFO] - [ROUND 25]
[2024-12-07 18:35:06,436][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 19:29:19,867][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 19:32:00,279][flwr][INFO] - fit progress: (25, 0.0027986210968575743, OrderedDict([('ind_iou_0', 0.9794564478593093), ('ind_dice_liver_0', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7390, dtype=torch.float64)), ('ind_iou_1', 0.9843485982633502), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6538, dtype=torch.float64)), ('all_iou', 0.9799637091602493), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7342, dtype=torch.float64))]), 104250.34743163735)
[2024-12-07 19:32:00,282][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 19:33:07,649][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 19:33:07,649][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 19:33:07,650][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 19:33:07,650][flwr][INFO] - 
[2024-12-07 19:33:07,650][flwr][INFO] - [ROUND 26]
[2024-12-07 19:33:07,650][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 20:25:52,807][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 20:28:30,597][flwr][INFO] - fit progress: (26, 0.0028066831960660648, OrderedDict([('ind_iou_0', 0.9793763658892571), ('ind_dice_liver_0', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7365, dtype=torch.float64)), ('ind_iou_1', 0.9845516592021007), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.979912619095392), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7317, dtype=torch.float64))]), 107640.66558358539)
[2024-12-07 20:28:30,600][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 20:29:37,724][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 20:29:37,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 20:29:37,724][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 20:29:37,724][flwr][INFO] - 
[2024-12-07 20:29:37,724][flwr][INFO] - [ROUND 27]
[2024-12-07 20:29:37,725][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 21:21:25,156][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 21:24:04,325][flwr][INFO] - fit progress: (27, 0.0028665998403545508, OrderedDict([('ind_iou_0', 0.9795746855469696), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.984807142675954), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6552, dtype=torch.float64)), ('all_iou', 0.9801183575041981), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 110974.39365733415)
[2024-12-07 21:24:04,329][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 21:25:12,540][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 21:25:12,541][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 21:25:12,541][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 21:25:12,541][flwr][INFO] - 
[2024-12-07 21:25:12,541][flwr][INFO] - [ROUND 28]
[2024-12-07 21:25:12,541][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 22:16:58,107][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 22:19:34,630][flwr][INFO] - fit progress: (28, 0.00290923725769885, OrderedDict([('ind_iou_0', 0.9795404318045612), ('ind_dice_liver_0', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7376, dtype=torch.float64)), ('ind_iou_1', 0.9849503680379583), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.9801005181305682), ('all_dice_liver', tensor(0.9899, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7330, dtype=torch.float64))]), 114304.6990551278)
[2024-12-07 22:19:34,634][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 22:20:41,018][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 22:20:41,018][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 22:20:41,019][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 22:20:41,019][flwr][INFO] - 
[2024-12-07 22:20:41,019][flwr][INFO] - [ROUND 29]
[2024-12-07 22:20:41,019][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 23:10:43,520][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-07 23:13:22,145][flwr][INFO] - fit progress: (29, 0.002894408664279634, OrderedDict([('ind_iou_0', 0.9797201328403895), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7389, dtype=torch.float64)), ('ind_iou_1', 0.9851994370959137), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6478, dtype=torch.float64)), ('all_iou', 0.9802878185420908), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7343, dtype=torch.float64))]), 117532.21359448135)
[2024-12-07 23:13:22,149][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 23:14:30,665][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-07 23:14:30,665][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 23:14:30,665][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 23:14:30,666][flwr][INFO] - 
[2024-12-07 23:14:30,666][flwr][INFO] - [ROUND 30]
[2024-12-07 23:14:30,666][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 00:03:45,950][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 00:06:22,442][flwr][INFO] - fit progress: (30, 0.002979754988856029, OrderedDict([('ind_iou_0', 0.9796430157674957), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7398, dtype=torch.float64)), ('ind_iou_1', 0.9853922600985596), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6554, dtype=torch.float64)), ('all_iou', 0.9802307480568904), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7350, dtype=torch.float64))]), 120712.51071073394)
[2024-12-08 00:06:22,445][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 00:07:30,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 00:07:30,257][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 00:07:30,258][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 00:07:30,258][flwr][INFO] - 
[2024-12-08 00:07:30,258][flwr][INFO] - [ROUND 31]
[2024-12-08 00:07:30,258][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 00:56:10,337][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 00:58:49,605][flwr][INFO] - fit progress: (31, 0.0028789388858873784, OrderedDict([('ind_iou_0', 0.9797874817343122), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7413, dtype=torch.float64)), ('ind_iou_1', 0.9854124107842427), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6568, dtype=torch.float64)), ('all_iou', 0.9803637261329388), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 123859.67411900032)
[2024-12-08 00:58:49,609][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 00:59:57,825][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 00:59:57,825][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 00:59:57,825][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 00:59:57,825][flwr][INFO] - 
[2024-12-08 00:59:57,825][flwr][INFO] - [ROUND 32]
[2024-12-08 00:59:57,826][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 01:48:43,766][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 01:51:21,402][flwr][INFO] - fit progress: (32, 0.00295647671651073, OrderedDict([('ind_iou_0', 0.979656398800786), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7396, dtype=torch.float64)), ('ind_iou_1', 0.9851205092076245), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9802267698290927), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7351, dtype=torch.float64))]), 127011.47097146697)
[2024-12-08 01:51:21,406][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 01:52:29,459][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 01:52:29,459][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 01:52:29,460][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 01:52:29,461][flwr][INFO] - 
[2024-12-08 01:52:29,461][flwr][INFO] - [ROUND 33]
[2024-12-08 01:52:29,461][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 02:41:21,632][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 02:44:00,168][flwr][INFO] - fit progress: (33, 0.003039774254455002, OrderedDict([('ind_iou_0', 0.9797891259747098), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7432, dtype=torch.float64)), ('ind_iou_1', 0.985465678610635), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9803753548903253), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7384, dtype=torch.float64))]), 130170.23668911867)
[2024-12-08 02:44:00,172][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 02:45:07,857][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 02:45:07,857][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 02:45:07,858][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 02:45:07,858][flwr][INFO] - 
[2024-12-08 02:45:07,858][flwr][INFO] - [ROUND 34]
[2024-12-08 02:45:07,858][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 03:35:11,456][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 03:37:50,827][flwr][INFO] - fit progress: (34, 0.0029834910009087336, OrderedDict([('ind_iou_0', 0.9797882753908774), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7402, dtype=torch.float64)), ('ind_iou_1', 0.9854698693284877), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6534, dtype=torch.float64)), ('all_iou', 0.9803754467204353), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7359, dtype=torch.float64))]), 133400.89583543688)
[2024-12-08 03:37:50,831][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 03:38:59,776][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 03:38:59,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 03:38:59,777][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 03:38:59,777][flwr][INFO] - 
[2024-12-08 03:38:59,777][flwr][INFO] - [ROUND 35]
[2024-12-08 03:38:59,777][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 04:28:28,301][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 04:31:07,278][flwr][INFO] - fit progress: (35, 0.0030116278926236167, OrderedDict([('ind_iou_0', 0.9798289181488224), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7433, dtype=torch.float64)), ('ind_iou_1', 0.9855443333959065), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6573, dtype=torch.float64)), ('all_iou', 0.9804259809878312), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7390, dtype=torch.float64))]), 136597.34637936577)
[2024-12-08 04:31:07,281][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 04:32:13,791][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 04:32:13,791][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 04:32:13,792][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 04:32:13,792][flwr][INFO] - 
[2024-12-08 04:32:13,792][flwr][INFO] - [ROUND 36]
[2024-12-08 04:32:13,792][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 05:21:12,951][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 05:23:49,407][flwr][INFO] - fit progress: (36, 0.0030641575809845015, OrderedDict([('ind_iou_0', 0.9798462580624995), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7409, dtype=torch.float64)), ('ind_iou_1', 0.9857164943315954), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6589, dtype=torch.float64)), ('all_iou', 0.9804519074037951), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 139759.47539061215)
[2024-12-08 05:23:49,410][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 05:24:57,117][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 05:24:57,118][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 05:24:57,118][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 05:24:57,118][flwr][INFO] - 
[2024-12-08 05:24:57,118][flwr][INFO] - [ROUND 37]
[2024-12-08 05:24:57,118][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 06:13:50,269][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 06:16:33,196][flwr][INFO] - fit progress: (37, 0.003092004302817128, OrderedDict([('ind_iou_0', 0.979842656219177), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.9858599004004814), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9804579069346965), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7381, dtype=torch.float64))]), 142923.26499840152)
[2024-12-08 06:16:33,200][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 06:17:39,748][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 06:17:39,748][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 06:17:39,748][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 06:17:39,748][flwr][INFO] - 
[2024-12-08 06:17:39,749][flwr][INFO] - [ROUND 38]
[2024-12-08 06:17:39,749][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 07:06:21,012][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 07:08:59,906][flwr][INFO] - fit progress: (38, 0.003045855645327325, OrderedDict([('ind_iou_0', 0.9800795344352587), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7441, dtype=torch.float64)), ('ind_iou_1', 0.9863379229269827), ('ind_dice_liver_1', tensor(0.9924, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9807149252391373), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7400, dtype=torch.float64))]), 146069.97475559078)
[2024-12-08 07:08:59,910][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 07:10:07,907][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 07:10:07,907][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 07:10:07,907][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 07:10:07,908][flwr][INFO] - 
[2024-12-08 07:10:07,908][flwr][INFO] - [ROUND 39]
[2024-12-08 07:10:07,908][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 07:58:49,211][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 08:01:29,853][flwr][INFO] - fit progress: (39, 0.0031410919373919223, OrderedDict([('ind_iou_0', 0.9800059208989179), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7406, dtype=torch.float64)), ('ind_iou_1', 0.9861322037831943), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6604, dtype=torch.float64)), ('all_iou', 0.9806324348295402), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7366, dtype=torch.float64))]), 149219.9221066255)
[2024-12-08 08:01:29,857][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 08:02:36,327][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 08:02:36,327][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 08:02:36,327][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 08:02:36,328][flwr][INFO] - 
[2024-12-08 08:02:36,328][flwr][INFO] - [ROUND 40]
[2024-12-08 08:02:36,328][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 08:51:36,817][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-12-08 08:54:18,923][flwr][INFO] - fit progress: (40, 0.003119647732850576, OrderedDict([('ind_iou_0', 0.9800636531130459), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7426, dtype=torch.float64)), ('ind_iou_1', 0.9864739679748924), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6612, dtype=torch.float64)), ('all_iou', 0.9807121977125179), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7388, dtype=torch.float64))]), 152388.9916230878)
[2024-12-08 08:54:18,926][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 08:55:26,575][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-08 08:55:26,575][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 08:55:26,576][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 08:55:26,576][flwr][INFO] - 
[2024-12-08 08:55:26,576][flwr][INFO] - [SUMMARY]
[2024-12-08 08:55:26,577][flwr][INFO] - Run finished 40 round(s) in 152456.64s
[2024-12-08 08:55:26,698][flwr][INFO] - 	History (loss, centralized):
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 0: 0.5985886103899952
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 1: 0.006515936818700306
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 2: 0.004542783957847375
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 3: 0.0038253379100324602
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 4: 0.003386278392848925
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 5: 0.00328210132444603
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 6: 0.003092431255442386
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 7: 0.0029623138369476326
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 8: 0.003743882500372747
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 9: 0.0027589487033706783
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 10: 0.0027761022886981152
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 11: 0.0027208725230792687
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 12: 0.0026659904490806403
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 13: 0.002692050085094061
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 14: 0.002670248093661563
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 15: 0.0026509145685603376
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 16: 0.0027665300903549498
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 17: 0.002657527722059511
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 18: 0.002664060774314639
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 19: 0.002807504808426116
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 20: 0.002668962113345518
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 21: 0.0027130042467715925
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 22: 0.0027833415095679967
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 23: 0.0027550396282174905
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 24: 0.002696557874557663
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 25: 0.0027986210968575743
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 26: 0.0028066831960660648
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 27: 0.0028665998403545508
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 28: 0.00290923725769885
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 29: 0.002894408664279634
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 30: 0.002979754988856029
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 31: 0.0028789388858873784
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 32: 0.00295647671651073
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 33: 0.003039774254455002
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 34: 0.0029834910009087336
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 35: 0.0030116278926236167
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 36: 0.0030641575809845015
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 37: 0.003092004302817128
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 38: 0.003045855645327325
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 39: 0.0031410919373919223
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 40: 0.003119647732850576
[2024-12-08 08:55:26,700][flwr][INFO] - 	History (metrics, centralized):
[2024-12-08 08:55:26,700][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1483, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (1, tensor(0.9636, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (2, tensor(0.9734, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (3, tensor(0.9788, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (4, tensor(0.9812, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (5, tensor(0.9822, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (6, tensor(0.9837, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (7, tensor(0.9851, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (9, tensor(0.9864, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (10, tensor(0.9865, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (11, tensor(0.9869, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (12, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (13, tensor(0.9878, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (14, tensor(0.9878, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (15, tensor(0.9883, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (16, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (17, tensor(0.9886, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (18, tensor(0.9886, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (19, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (20, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (21, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (22, tensor(0.9893, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (23, tensor(0.9893, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (24, tensor(0.9890, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (25, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (26, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (27, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (28, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (29, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (30, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (31, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (32, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (33, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (34, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (35, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (36, tensor(0.9903, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (37, tensor(0.9903, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (38, tensor(0.9904, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (39, tensor(0.9905, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (40, tensor(0.9905, dtype=torch.float64))],
[2024-12-08 08:55:26,702][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0081, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (1, tensor(0.5416, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (2, tensor(0.6260, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (3, tensor(0.6512, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (4, tensor(0.6713, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (5, tensor(0.6738, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (6, tensor(0.6885, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (7, tensor(0.7001, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (8, tensor(0.7039, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (9, tensor(0.7085, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (10, tensor(0.7065, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (11, tensor(0.7129, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (12, tensor(0.7139, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (13, tensor(0.7181, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (14, tensor(0.7180, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (15, tensor(0.7237, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (16, tensor(0.7253, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (17, tensor(0.7228, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (18, tensor(0.7269, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (19, tensor(0.7273, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (20, tensor(0.7303, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (21, tensor(0.7299, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (22, tensor(0.7308, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (23, tensor(0.7283, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (24, tensor(0.7298, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (25, tensor(0.7342, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (26, tensor(0.7317, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (27, tensor(0.7325, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (28, tensor(0.7330, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (29, tensor(0.7343, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (30, tensor(0.7350, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (31, tensor(0.7370, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (32, tensor(0.7351, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (33, tensor(0.7384, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (34, tensor(0.7359, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (35, tensor(0.7390, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (36, tensor(0.7370, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (37, tensor(0.7381, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (38, tensor(0.7400, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (39, tensor(0.7366, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (40, tensor(0.7388, dtype=torch.float64))],
[2024-12-08 08:55:26,704][flwr][INFO] - 	 'all_iou': [(0, 3.5429014830725577e-06),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (1, 0.9447089926663125),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (2, 0.9596553870736655),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (3, 0.9659072714310327),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (4, 0.9695892983599778),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (5, 0.9707688675862118),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (6, 0.9727340808641882),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (7, 0.9745154583346163),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (8, 0.9757239311601605),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (9, 0.9762132838668383),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (10, 0.9760647841186957),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (11, 0.9768700987301548),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (12, 0.9775351606448185),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (13, 0.9779167073957651),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (14, 0.9780978023952315),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (15, 0.9785602852185126),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (16, 0.9782469663226757),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (17, 0.9790202192190148),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (18, 0.9789001887134726),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (19, 0.9788785868476619),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (20, 0.9794348383022707),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (21, 0.9795267290080488),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (22, 0.9795575630034379),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (23, 0.9795409902585651),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (24, 0.97944512305301),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (25, 0.9799637091602493),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (26, 0.979912619095392),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (27, 0.9801183575041981),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (28, 0.9801005181305682),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (29, 0.9802878185420908),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (30, 0.9802307480568904),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (31, 0.9803637261329388),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (32, 0.9802267698290927),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (33, 0.9803753548903253),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (34, 0.9803754467204353),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (35, 0.9804259809878312),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (36, 0.9804519074037951),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (37, 0.9804579069346965),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (38, 0.9807149252391373),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (39, 0.9806324348295402),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (40, 0.9807121977125179)],
[2024-12-08 08:55:26,706][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1485, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (1, tensor(0.9641, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (2, tensor(0.9738, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (3, tensor(0.9790, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (4, tensor(0.9813, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (5, tensor(0.9823, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (6, tensor(0.9838, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (7, tensor(0.9851, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (9, tensor(0.9863, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (10, tensor(0.9864, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (11, tensor(0.9869, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (12, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (13, tensor(0.9877, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (14, tensor(0.9877, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (15, tensor(0.9881, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (16, tensor(0.9883, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (17, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (18, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (19, tensor(0.9887, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (20, tensor(0.9888, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (21, tensor(0.9890, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (22, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (23, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (24, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (25, tensor(0.9895, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (26, tensor(0.9894, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (27, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (28, tensor(0.9897, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (29, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (30, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (31, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (32, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (33, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (34, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (35, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (36, tensor(0.9901, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (37, tensor(0.9901, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (38, tensor(0.9901, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (39, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (40, tensor(0.9902, dtype=torch.float64))],
[2024-12-08 08:55:26,708][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1468, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (1, tensor(0.9583, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (2, tensor(0.9697, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (3, tensor(0.9767, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (4, tensor(0.9800, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (5, tensor(0.9817, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (6, tensor(0.9826, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (7, tensor(0.9850, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (9, tensor(0.9866, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (10, tensor(0.9870, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (11, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (12, tensor(0.9879, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (13, tensor(0.9885, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (14, tensor(0.9885, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (15, tensor(0.9892, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (16, tensor(0.9893, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (17, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (18, tensor(0.9897, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (19, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (20, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (21, tensor(0.9905, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (22, tensor(0.9907, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (23, tensor(0.9906, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (24, tensor(0.9904, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (25, tensor(0.9911, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (26, tensor(0.9911, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (27, tensor(0.9914, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (28, tensor(0.9915, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (29, tensor(0.9917, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (30, tensor(0.9919, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (31, tensor(0.9917, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (32, tensor(0.9918, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (33, tensor(0.9920, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (34, tensor(0.9919, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (35, tensor(0.9920, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (36, tensor(0.9922, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (37, tensor(0.9922, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (38, tensor(0.9924, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (39, tensor(0.9925, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (40, tensor(0.9926, dtype=torch.float64))],
[2024-12-08 08:55:26,711][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0082, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (1, tensor(0.5483, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (2, tensor(0.6324, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (3, tensor(0.6580, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (4, tensor(0.6779, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (5, tensor(0.6799, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (6, tensor(0.6955, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (7, tensor(0.7058, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (8, tensor(0.7099, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (9, tensor(0.7142, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (10, tensor(0.7121, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (11, tensor(0.7181, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (12, tensor(0.7202, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (13, tensor(0.7239, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (14, tensor(0.7237, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (15, tensor(0.7290, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (16, tensor(0.7309, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (17, tensor(0.7285, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (18, tensor(0.7327, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (19, tensor(0.7320, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (20, tensor(0.7354, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (21, tensor(0.7350, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (22, tensor(0.7358, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (23, tensor(0.7339, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (24, tensor(0.7351, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (25, tensor(0.7390, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (26, tensor(0.7365, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (27, tensor(0.7372, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (28, tensor(0.7376, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (29, tensor(0.7389, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (30, tensor(0.7398, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (31, tensor(0.7413, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (32, tensor(0.7396, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (33, tensor(0.7432, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (34, tensor(0.7402, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (35, tensor(0.7433, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (36, tensor(0.7409, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (37, tensor(0.7425, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (38, tensor(0.7441, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (39, tensor(0.7406, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (40, tensor(0.7426, dtype=torch.float64))],
[2024-12-08 08:55:26,713][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0074, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (1, tensor(0.4506, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (2, tensor(0.5436, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (3, tensor(0.5628, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (4, tensor(0.5855, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (5, tensor(0.5871, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (6, tensor(0.5990, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (7, tensor(0.6167, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (8, tensor(0.6200, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (9, tensor(0.6229, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (10, tensor(0.6230, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (11, tensor(0.6306, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (12, tensor(0.6268, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (13, tensor(0.6281, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (14, tensor(0.6342, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (15, tensor(0.6418, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (16, tensor(0.6436, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (17, tensor(0.6405, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (18, tensor(0.6432, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (19, tensor(0.6481, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (20, tensor(0.6487, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (21, tensor(0.6487, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (22, tensor(0.6494, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (23, tensor(0.6466, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (24, tensor(0.6474, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (25, tensor(0.6538, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (26, tensor(0.6522, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (27, tensor(0.6552, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (28, tensor(0.6544, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (29, tensor(0.6478, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (30, tensor(0.6554, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (31, tensor(0.6568, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (32, tensor(0.6540, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (33, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (34, tensor(0.6534, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (35, tensor(0.6573, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (36, tensor(0.6589, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (37, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (38, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (39, tensor(0.6604, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (40, tensor(0.6612, dtype=torch.float64))],
[2024-12-08 08:55:26,715][flwr][INFO] - 	 'ind_iou_0': [(0, 2.4740422930434125e-06),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (1, 0.9454902448352747),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (2, 0.95992076545512),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (3, 0.9660292266965136),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (4, 0.9695533655348568),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (5, 0.9706108669626013),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (6, 0.9727171410860056),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (7, 0.9743037021487023),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (8, 0.9755247023773171),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (9, 0.9759608166970313),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (10, 0.9757961870136389),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (11, 0.9765727632331487),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (12, 0.9772283303190545),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (13, 0.9775635246919407),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (14, 0.977727889992489),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (15, 0.9781627865393916),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (16, 0.9778573106078782),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (17, 0.9786050378058706),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (18, 0.9784739443537188),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (19, 0.97844934473799),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (20, 0.9789663994278827),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (21, 0.9790453675322541),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (22, 0.9790634615414073),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (23, 0.9790626269585961),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (24, 0.9789554558684999),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (25, 0.9794564478593093),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (26, 0.9793763658892571),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (27, 0.9795746855469696),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (28, 0.9795404318045612),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (29, 0.9797201328403895),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (30, 0.9796430157674957),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (31, 0.9797874817343122),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (32, 0.979656398800786),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (33, 0.9797891259747098),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (34, 0.9797882753908774),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (35, 0.9798289181488224),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (36, 0.9798462580624995),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (37, 0.979842656219177),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (38, 0.9800795344352587),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (39, 0.9800059208989179),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (40, 0.9800636531130459)],
[2024-12-08 08:55:26,717][flwr][INFO] - 	 'ind_iou_1': [(0, 1.365228672907438e-05),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (1, 0.9364330953567215),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (2, 0.9570659249348098),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (3, 0.9644579211706455),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (4, 0.9696835670861041),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (5, 0.9719631157032752),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (6, 0.9726723388748973),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (7, 0.9761668574626706),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (8, 0.9774988066479126),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (9, 0.9784240195732182),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (10, 0.9784249133721511),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (11, 0.97917922335383),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (12, 0.9802178397265098),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (13, 0.9808919068721229),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (14, 0.981350302711466),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (15, 0.9820824311422482),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (16, 0.9816082032900846),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (17, 0.982670458207204),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (18, 0.9827090311587),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (19, 0.9825954428977627),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (20, 0.98351758765733),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (21, 0.9838142078614804),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (22, 0.9838418780263609),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (23, 0.9836389842603372),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (24, 0.9837265367281732),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (25, 0.9843485982633502),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (26, 0.9845516592021007),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (27, 0.984807142675954),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (28, 0.9849503680379583),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (29, 0.9851994370959137),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (30, 0.9853922600985596),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (31, 0.9854124107842427),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (32, 0.9851205092076245),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (33, 0.985465678610635),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (34, 0.9854698693284877),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (35, 0.9855443333959065),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (36, 0.9857164943315954),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (37, 0.9858599004004814),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (38, 0.9863379229269827),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (39, 0.9861322037831943),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (40, 0.9864739679748924)]}
[2024-12-08 08:55:26,719][flwr][INFO] - 
