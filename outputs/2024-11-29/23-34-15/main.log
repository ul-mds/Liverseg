[2024-11-29 23:34:16,190][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
[2024-11-29 23:34:38,074][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:172.18.62.12': 1.0, 'node:__internal_head__': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 830590827520.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0}
[2024-11-29 23:34:38,074][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-29 23:34:38,074][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-29 23:34:38,112][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-29 23:34:38,113][flwr][INFO] - [INIT]
[2024-11-29 23:34:38,113][flwr][INFO] - Requesting initial parameters from one random client
[2024-11-29 23:34:42,364][flwr][INFO] - Received initial parameters from one random client
[2024-11-29 23:34:42,365][flwr][INFO] - Evaluating initial global parameters
[2024-11-29 23:38:23,012][flwr][INFO] - initial parameters (loss, other metrics): 0.7414753399337515, OrderedDict([('ind_iou_0', 0.04766415833322114), ('ind_dice_liver_0', tensor(0.1516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.04694000668968212), ('ind_dice_liver_1', tensor(0.1499, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.0475928625471509), ('all_dice_liver', tensor(0.1514, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[2024-11-29 23:38:23,119][flwr][INFO] - 
[2024-11-29 23:38:23,119][flwr][INFO] - [ROUND 1]
[2024-11-29 23:38:23,120][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 23:44:51,950][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-29 23:44:51,975][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-11-29 23:46:37,726][flwr][INFO] - fit progress: (1, 0.05303550318379606, OrderedDict([('ind_iou_0', 0.6316875723875005), ('ind_dice_liver_0', tensor(0.7563, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0358, dtype=torch.float64)), ('ind_iou_1', 0.8362033455466258), ('ind_dice_liver_1', tensor(0.8752, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0395, dtype=torch.float64)), ('all_iou', 0.6519288082394075), ('all_dice_liver', tensor(0.7681, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0362, dtype=torch.float64))]), 494.6069231880829)
[2024-11-29 23:46:37,730][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 23:47:34,381][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-29 23:47:34,381][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 23:47:34,382][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 23:47:34,382][flwr][INFO] - 
[2024-11-29 23:47:34,382][flwr][INFO] - [ROUND 2]
[2024-11-29 23:47:34,382][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 23:53:55,169][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-29 23:55:42,060][flwr][INFO] - fit progress: (2, 0.04925278463045425, OrderedDict([('ind_iou_0', 0.7536420464594646), ('ind_dice_liver_0', tensor(0.8644, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1785, dtype=torch.float64)), ('ind_iou_1', 0.9295314235185855), ('ind_dice_liver_1', tensor(0.9542, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3130, dtype=torch.float64)), ('all_iou', 0.7711695907460727), ('all_dice_liver', tensor(0.8734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1950, dtype=torch.float64))]), 1038.9403722900897)
[2024-11-29 23:55:42,063][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 23:56:36,915][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-29 23:56:36,915][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 23:56:36,915][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 23:56:36,915][flwr][INFO] - 
[2024-11-29 23:56:36,916][flwr][INFO] - [ROUND 3]
[2024-11-29 23:56:36,916][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:02:58,194][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:04:45,458][flwr][INFO] - fit progress: (3, 0.04922053228518909, OrderedDict([('ind_iou_0', 0.7820151522242209), ('ind_dice_liver_0', tensor(0.8861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2361, dtype=torch.float64)), ('ind_iou_1', 0.9447122111257642), ('ind_dice_liver_1', tensor(0.9657, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4101, dtype=torch.float64)), ('all_iou', 0.7981788571034795), ('all_dice_liver', tensor(0.8940, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2571, dtype=torch.float64))]), 1582.3382836207747)
[2024-11-30 00:04:45,461][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:05:40,535][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:05:40,535][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:05:40,540][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:05:40,540][flwr][INFO] - 
[2024-11-30 00:05:40,540][flwr][INFO] - [ROUND 4]
[2024-11-30 00:05:40,540][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:11:59,466][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:13:46,581][flwr][INFO] - fit progress: (4, 0.05813819540068773, OrderedDict([('ind_iou_0', 0.7452841414649035), ('ind_dice_liver_0', tensor(0.8673, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2178, dtype=torch.float64)), ('ind_iou_1', 0.9479294328973502), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4632, dtype=torch.float64)), ('all_iou', 0.7654355161020596), ('all_dice_liver', tensor(0.8769, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2460, dtype=torch.float64))]), 2123.461986010894)
[2024-11-30 00:13:46,585][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:14:40,916][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:14:40,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:14:40,917][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:14:40,917][flwr][INFO] - 
[2024-11-30 00:14:40,917][flwr][INFO] - [ROUND 5]
[2024-11-30 00:14:40,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:21:01,357][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:22:48,772][flwr][INFO] - fit progress: (5, 0.05193330802911545, OrderedDict([('ind_iou_0', 0.7720739542713111), ('ind_dice_liver_0', tensor(0.8854, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2104, dtype=torch.float64)), ('ind_iou_1', 0.9514002418093063), ('ind_dice_liver_1', tensor(0.9693, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4751, dtype=torch.float64)), ('all_iou', 0.789865516286173), ('all_dice_liver', tensor(0.8937, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2404, dtype=torch.float64))]), 2665.6525636278093)
[2024-11-30 00:22:48,776][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:23:44,149][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:23:44,149][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:23:44,150][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:23:44,150][flwr][INFO] - 
[2024-11-30 00:23:44,150][flwr][INFO] - [ROUND 6]
[2024-11-30 00:23:44,150][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:30:03,238][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:31:49,693][flwr][INFO] - fit progress: (6, 0.0595124055107659, OrderedDict([('ind_iou_0', 0.7108457075431956), ('ind_dice_liver_0', tensor(0.8347, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1899, dtype=torch.float64)), ('ind_iou_1', 0.9380788168094929), ('ind_dice_liver_1', tensor(0.9552, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4111, dtype=torch.float64)), ('all_iou', 0.7334295273680683), ('all_dice_liver', tensor(0.8466, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2149, dtype=torch.float64))]), 3206.573595240712)
[2024-11-30 00:31:49,696][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:32:45,975][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:32:45,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:32:45,975][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:32:45,975][flwr][INFO] - 
[2024-11-30 00:32:45,975][flwr][INFO] - [ROUND 7]
[2024-11-30 00:32:45,975][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:39:02,556][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:40:48,988][flwr][INFO] - fit progress: (7, 0.054658803450969115, OrderedDict([('ind_iou_0', 0.7999996553181479), ('ind_dice_liver_0', tensor(0.8957, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2720, dtype=torch.float64)), ('ind_iou_1', 0.9566744201094628), ('ind_dice_liver_1', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4873, dtype=torch.float64)), ('all_iou', 0.8155179756401552), ('all_dice_liver', tensor(0.9034, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2978, dtype=torch.float64))]), 3745.8684603897855)
[2024-11-30 00:40:48,991][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:41:43,369][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:41:43,369][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:41:43,369][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:41:43,370][flwr][INFO] - 
[2024-11-30 00:41:43,370][flwr][INFO] - [ROUND 8]
[2024-11-30 00:41:43,370][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:48:01,261][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:49:47,863][flwr][INFO] - fit progress: (8, 0.06094796382606153, OrderedDict([('ind_iou_0', 0.7929387574260767), ('ind_dice_liver_0', tensor(0.8929, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2976, dtype=torch.float64)), ('ind_iou_1', 0.9635342443527264), ('ind_dice_liver_1', tensor(0.9769, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5541, dtype=torch.float64)), ('all_iou', 0.8098240228808102), ('all_dice_liver', tensor(0.9012, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3270, dtype=torch.float64))]), 4284.743214330636)
[2024-11-30 00:49:47,866][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:50:42,638][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:50:42,638][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:50:42,638][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:50:42,639][flwr][INFO] - 
[2024-11-30 00:50:42,639][flwr][INFO] - [ROUND 9]
[2024-11-30 00:50:42,639][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:57:01,492][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 00:58:48,371][flwr][INFO] - fit progress: (9, 0.06346101352466574, OrderedDict([('ind_iou_0', 0.7895828309521433), ('ind_dice_liver_0', tensor(0.8920, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2845, dtype=torch.float64)), ('ind_iou_1', 0.9633393220798547), ('ind_dice_liver_1', tensor(0.9778, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.8068082440479202), ('all_dice_liver', tensor(0.9005, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3150, dtype=torch.float64))]), 4825.251417716965)
[2024-11-30 00:58:48,374][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:59:42,552][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:59:42,552][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 00:59:42,552][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:59:42,553][flwr][INFO] - 
[2024-11-30 00:59:42,553][flwr][INFO] - [ROUND 10]
[2024-11-30 00:59:42,553][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:06:04,182][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:07:50,952][flwr][INFO] - fit progress: (10, 0.06813601635963469, OrderedDict([('ind_iou_0', 0.7930287733831317), ('ind_dice_liver_0', tensor(0.8941, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2796, dtype=torch.float64)), ('ind_iou_1', 0.9650760878658963), ('ind_dice_liver_1', tensor(0.9786, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.8100800327081573), ('all_dice_liver', tensor(0.9025, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3109, dtype=torch.float64))]), 5367.833003301173)
[2024-11-30 01:07:50,956][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:08:44,893][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:08:44,894][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:08:44,895][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:08:44,895][flwr][INFO] - 
[2024-11-30 01:08:44,895][flwr][INFO] - [ROUND 11]
[2024-11-30 01:08:44,895][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:15:03,463][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:16:49,945][flwr][INFO] - fit progress: (11, 0.07734067768553952, OrderedDict([('ind_iou_0', 0.7778061268448617), ('ind_dice_liver_0', tensor(0.8856, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2821, dtype=torch.float64)), ('ind_iou_1', 0.9669066646043755), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.7965341836797774), ('all_dice_liver', tensor(0.8950, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3134, dtype=torch.float64))]), 5906.826113084331)
[2024-11-30 01:16:49,949][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:17:45,491][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:17:45,491][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:17:45,491][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:17:45,492][flwr][INFO] - 
[2024-11-30 01:17:45,492][flwr][INFO] - [ROUND 12]
[2024-11-30 01:17:45,492][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:24:03,087][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:25:49,926][flwr][INFO] - fit progress: (12, 0.06587269239606032, OrderedDict([('ind_iou_0', 0.7561715069928102), ('ind_dice_liver_0', tensor(0.8651, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2997, dtype=torch.float64)), ('ind_iou_1', 0.9513818242415281), ('ind_dice_liver_1', tensor(0.9709, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5340, dtype=torch.float64)), ('all_iou', 0.7754728091344196), ('all_dice_liver', tensor(0.8756, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3275, dtype=torch.float64))]), 6446.8068203460425)
[2024-11-30 01:25:49,930][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:26:45,794][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:26:45,794][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:26:45,794][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:26:45,795][flwr][INFO] - 
[2024-11-30 01:26:45,795][flwr][INFO] - [ROUND 13]
[2024-11-30 01:26:45,795][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:33:02,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:34:49,264][flwr][INFO] - fit progress: (13, 0.07295164013592643, OrderedDict([('ind_iou_0', 0.7836245416784494), ('ind_dice_liver_0', tensor(0.8878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2786, dtype=torch.float64)), ('ind_iou_1', 0.9697805119168175), ('ind_dice_liver_1', tensor(0.9825, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5662, dtype=torch.float64)), ('all_iou', 0.8020391622400234), ('all_dice_liver', tensor(0.8971, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3114, dtype=torch.float64))]), 6986.14476177562)
[2024-11-30 01:34:49,268][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:35:43,808][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:35:43,808][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:35:43,809][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:35:43,809][flwr][INFO] - 
[2024-11-30 01:35:43,809][flwr][INFO] - [ROUND 14]
[2024-11-30 01:35:43,809][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:42:03,152][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:43:48,949][flwr][INFO] - fit progress: (14, 0.0805002936439458, OrderedDict([('ind_iou_0', 0.7826007748222609), ('ind_dice_liver_0', tensor(0.8892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2870, dtype=torch.float64)), ('ind_iou_1', 0.9702681002816052), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.801182400148261), ('all_dice_liver', tensor(0.8985, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3194, dtype=torch.float64))]), 7525.829721639864)
[2024-11-30 01:43:48,953][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:44:44,122][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:44:44,122][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:44:44,122][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:44:44,122][flwr][INFO] - 
[2024-11-30 01:44:44,122][flwr][INFO] - [ROUND 15]
[2024-11-30 01:44:44,122][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:51:03,429][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 01:52:49,230][flwr][INFO] - fit progress: (15, 0.07781547019468547, OrderedDict([('ind_iou_0', 0.7925253756492625), ('ind_dice_liver_0', tensor(0.8946, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2974, dtype=torch.float64)), ('ind_iou_1', 0.9715224074084938), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8102602849777714), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3293, dtype=torch.float64))]), 8066.1102245152)
[2024-11-30 01:52:49,233][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:53:44,194][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:53:44,194][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:53:44,194][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:53:44,195][flwr][INFO] - 
[2024-11-30 01:53:44,195][flwr][INFO] - [ROUND 16]
[2024-11-30 01:53:44,195][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:00:02,909][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:01:49,977][flwr][INFO] - fit progress: (16, 0.07666210907707423, OrderedDict([('ind_iou_0', 0.794770611049503), ('ind_dice_liver_0', tensor(0.8947, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3189, dtype=torch.float64)), ('ind_iou_1', 0.9700779992206202), ('ind_dice_liver_1', tensor(0.9834, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5808, dtype=torch.float64)), ('all_iou', 0.8121368422383726), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3487, dtype=torch.float64))]), 8606.85745873116)
[2024-11-30 02:01:49,980][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:02:43,519][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:02:43,519][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:02:43,520][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:02:43,520][flwr][INFO] - 
[2024-11-30 02:02:43,520][flwr][INFO] - [ROUND 17]
[2024-11-30 02:02:43,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:09:01,052][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:10:47,514][flwr][INFO] - fit progress: (17, 0.07800370926689688, OrderedDict([('ind_iou_0', 0.7917326566061946), ('ind_dice_liver_0', tensor(0.8930, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3016, dtype=torch.float64)), ('ind_iou_1', 0.9706330449831999), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5683, dtype=torch.float64)), ('all_iou', 0.8094801036365123), ('all_dice_liver', tensor(0.9020, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3319, dtype=torch.float64))]), 9144.394592504948)
[2024-11-30 02:10:47,517][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:11:41,749][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:11:41,750][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:11:41,751][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:11:41,751][flwr][INFO] - 
[2024-11-30 02:11:41,751][flwr][INFO] - [ROUND 18]
[2024-11-30 02:11:41,751][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:17:58,942][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:19:45,336][flwr][INFO] - fit progress: (18, 0.08207932139296133, OrderedDict([('ind_iou_0', 0.7958701546502802), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3283, dtype=torch.float64)), ('ind_iou_1', 0.9721577140487381), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8133492611987482), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3571, dtype=torch.float64))]), 9682.216391171329)
[2024-11-30 02:19:45,339][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:20:39,288][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:20:39,289][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:20:39,289][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:20:39,289][flwr][INFO] - 
[2024-11-30 02:20:39,289][flwr][INFO] - [ROUND 19]
[2024-11-30 02:20:39,290][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:26:58,403][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:28:44,775][flwr][INFO] - fit progress: (19, 0.08346623614592108, OrderedDict([('ind_iou_0', 0.7907357953627282), ('ind_dice_liver_0', tensor(0.8933, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3057, dtype=torch.float64)), ('ind_iou_1', 0.9726733307368213), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5879, dtype=torch.float64)), ('all_iou', 0.8087580004949835), ('all_dice_liver', tensor(0.9024, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3373, dtype=torch.float64))]), 10221.655718009919)
[2024-11-30 02:28:44,779][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:29:38,875][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:29:38,876][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:29:38,883][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:29:38,883][flwr][INFO] - 
[2024-11-30 02:29:38,883][flwr][INFO] - [ROUND 20]
[2024-11-30 02:29:38,884][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:35:57,511][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:37:43,689][flwr][INFO] - fit progress: (20, 0.08608568779925962, OrderedDict([('ind_iou_0', 0.7751670209418916), ('ind_dice_liver_0', tensor(0.8846, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2775, dtype=torch.float64)), ('ind_iou_1', 0.9726740116184747), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5825, dtype=torch.float64)), ('all_iou', 0.7947234413923687), ('all_dice_liver', tensor(0.8946, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3115, dtype=torch.float64))]), 10760.569711542688)
[2024-11-30 02:37:43,692][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:38:38,589][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:38:38,589][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:38:38,590][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:38:38,590][flwr][INFO] - 
[2024-11-30 02:38:38,590][flwr][INFO] - [ROUND 21]
[2024-11-30 02:38:38,590][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:44:54,867][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:46:41,760][flwr][INFO] - fit progress: (21, 0.09094283431768417, OrderedDict([('ind_iou_0', 0.7885281167213914), ('ind_dice_liver_0', tensor(0.8915, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3152, dtype=torch.float64)), ('ind_iou_1', 0.972346415571436), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8067385506169092), ('all_dice_liver', tensor(0.9008, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3455, dtype=torch.float64))]), 11298.64030539617)
[2024-11-30 02:46:41,763][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:47:34,279][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:47:34,280][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:47:34,281][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:47:34,281][flwr][INFO] - 
[2024-11-30 02:47:34,281][flwr][INFO] - [ROUND 22]
[2024-11-30 02:47:34,281][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:53:52,374][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 02:55:37,672][flwr][INFO] - fit progress: (22, 0.08323826869190022, OrderedDict([('ind_iou_0', 0.794820627088442), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3324, dtype=torch.float64)), ('ind_iou_1', 0.9726798593246316), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.8124173732077967), ('all_dice_liver', tensor(0.9055, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3602, dtype=torch.float64))]), 11834.552490278147)
[2024-11-30 02:55:37,675][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:56:30,798][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:56:30,798][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:56:30,798][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:56:30,799][flwr][INFO] - 
[2024-11-30 02:56:30,799][flwr][INFO] - [ROUND 23]
[2024-11-30 02:56:30,799][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:02:47,111][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:04:32,769][flwr][INFO] - fit progress: (23, 0.06475172791968893, OrderedDict([('ind_iou_0', 0.7748129285735644), ('ind_dice_liver_0', tensor(0.8838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2660, dtype=torch.float64)), ('ind_iou_1', 0.9660274418780755), ('ind_dice_liver_1', tensor(0.9801, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5345, dtype=torch.float64)), ('all_iou', 0.7937778530542612), ('all_dice_liver', tensor(0.8934, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2959, dtype=torch.float64))]), 12369.649744211696)
[2024-11-30 03:04:32,773][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:05:26,754][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:05:26,755][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:05:26,755][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:05:26,755][flwr][INFO] - 
[2024-11-30 03:05:26,756][flwr][INFO] - [ROUND 24]
[2024-11-30 03:05:26,756][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:11:43,990][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:13:29,054][flwr][INFO] - fit progress: (24, 0.08459392053116109, OrderedDict([('ind_iou_0', 0.8003105445286044), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3331, dtype=torch.float64)), ('ind_iou_1', 0.9732658740725458), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5921, dtype=torch.float64)), ('all_iou', 0.8174465570904365), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 12905.934644649737)
[2024-11-30 03:13:29,057][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:14:23,096][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:14:23,096][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:14:23,097][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:14:23,098][flwr][INFO] - 
[2024-11-30 03:14:23,098][flwr][INFO] - [ROUND 25]
[2024-11-30 03:14:23,098][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:20:39,355][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:22:25,092][flwr][INFO] - fit progress: (25, 0.08802219089104016, OrderedDict([('ind_iou_0', 0.799241978213032), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3296, dtype=torch.float64)), ('ind_iou_1', 0.973483713650208), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5766, dtype=torch.float64)), ('all_iou', 0.8164982508230381), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3576, dtype=torch.float64))]), 13441.97280604206)
[2024-11-30 03:22:25,095][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:23:18,462][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:23:18,462][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:23:18,463][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:23:18,463][flwr][INFO] - 
[2024-11-30 03:23:18,463][flwr][INFO] - [ROUND 26]
[2024-11-30 03:23:18,463][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:29:34,850][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:31:20,533][flwr][INFO] - fit progress: (26, 0.09048079585005372, OrderedDict([('ind_iou_0', 0.7994760698614096), ('ind_dice_liver_0', tensor(0.8981, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3401, dtype=torch.float64)), ('ind_iou_1', 0.974029525142851), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8167572368705338), ('all_dice_liver', tensor(0.9069, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3679, dtype=torch.float64))]), 13977.413542283699)
[2024-11-30 03:31:20,536][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:32:14,957][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:32:14,957][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:32:14,958][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:32:14,958][flwr][INFO] - 
[2024-11-30 03:32:14,958][flwr][INFO] - [ROUND 27]
[2024-11-30 03:32:14,958][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:38:32,237][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:40:17,851][flwr][INFO] - fit progress: (27, 0.09174106121982374, OrderedDict([('ind_iou_0', 0.7950781061937892), ('ind_dice_liver_0', tensor(0.8972, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3347, dtype=torch.float64)), ('ind_iou_1', 0.9732923978943294), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8127388122800211), ('all_dice_liver', tensor(0.9061, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3632, dtype=torch.float64))]), 14514.731176161207)
[2024-11-30 03:40:17,854][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:41:10,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:41:10,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:41:10,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:41:10,922][flwr][INFO] - 
[2024-11-30 03:41:10,922][flwr][INFO] - [ROUND 28]
[2024-11-30 03:41:10,922][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:47:27,063][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:49:12,390][flwr][INFO] - fit progress: (28, 0.08486959324921531, OrderedDict([('ind_iou_0', 0.7817250958420316), ('ind_dice_liver_0', tensor(0.8875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2869, dtype=torch.float64)), ('ind_iou_1', 0.9729190181656941), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5764, dtype=torch.float64)), ('all_iou', 0.8006589862704299), ('all_dice_liver', tensor(0.8973, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3193, dtype=torch.float64))]), 15049.270671334118)
[2024-11-30 03:49:12,394][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:50:06,680][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:50:06,680][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:50:06,681][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:50:06,681][flwr][INFO] - 
[2024-11-30 03:50:06,681][flwr][INFO] - [ROUND 29]
[2024-11-30 03:50:06,681][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:56:26,277][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 03:58:13,317][flwr][INFO] - fit progress: (29, 0.0934941541902969, OrderedDict([('ind_iou_0', 0.7935916451200561), ('ind_dice_liver_0', tensor(0.8952, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3251, dtype=torch.float64)), ('ind_iou_1', 0.9736055323068126), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5795, dtype=torch.float64)), ('all_iou', 0.8114353229454422), ('all_dice_liver', tensor(0.9043, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3537, dtype=torch.float64))]), 15590.198030388914)
[2024-11-30 03:58:13,321][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:59:07,868][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:59:07,868][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:59:07,868][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:59:07,869][flwr][INFO] - 
[2024-11-30 03:59:07,869][flwr][INFO] - [ROUND 30]
[2024-11-30 03:59:07,869][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:05:26,673][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:07:12,554][flwr][INFO] - fit progress: (30, 0.09592473836832732, OrderedDict([('ind_iou_0', 0.794403298223325), ('ind_dice_liver_0', tensor(0.8953, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3323, dtype=torch.float64)), ('ind_iou_1', 0.973732716093236), ('ind_dice_liver_1', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8121628868551101), ('all_dice_liver', tensor(0.9044, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3611, dtype=torch.float64))]), 16129.434625338763)
[2024-11-30 04:07:12,558][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:08:06,363][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:08:06,363][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:08:06,363][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:08:06,363][flwr][INFO] - 
[2024-11-30 04:08:06,363][flwr][INFO] - [ROUND 31]
[2024-11-30 04:08:06,364][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:14:24,674][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:16:10,498][flwr][INFO] - fit progress: (31, 0.0962061827771441, OrderedDict([('ind_iou_0', 0.7931324133784465), ('ind_dice_liver_0', tensor(0.8956, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3119, dtype=torch.float64)), ('ind_iou_1', 0.9741346940386385), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5846, dtype=torch.float64)), ('all_iou', 0.8110572377033446), ('all_dice_liver', tensor(0.9046, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3424, dtype=torch.float64))]), 16667.378705914132)
[2024-11-30 04:16:10,502][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:17:04,526][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:17:04,527][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:17:04,527][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:17:04,527][flwr][INFO] - 
[2024-11-30 04:17:04,527][flwr][INFO] - [ROUND 32]
[2024-11-30 04:17:04,528][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:23:22,228][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:25:07,046][flwr][INFO] - fit progress: (32, 0.0961772500061708, OrderedDict([('ind_iou_0', 0.7950077196435238), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3223, dtype=torch.float64)), ('ind_iou_1', 0.9741582306300837), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5819, dtype=torch.float64)), ('all_iou', 0.8127452166952082), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3514, dtype=torch.float64))]), 17203.92630218342)
[2024-11-30 04:25:07,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:26:00,052][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:26:00,052][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:26:00,052][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:26:00,052][flwr][INFO] - 
[2024-11-30 04:26:00,053][flwr][INFO] - [ROUND 33]
[2024-11-30 04:26:00,053][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:32:15,296][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:34:00,016][flwr][INFO] - fit progress: (33, 0.09608880142414418, OrderedDict([('ind_iou_0', 0.7991970050149196), ('ind_dice_liver_0', tensor(0.8999, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3430, dtype=torch.float64)), ('ind_iou_1', 0.9737154709765082), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5867, dtype=torch.float64)), ('all_iou', 0.8164878841193062), ('all_dice_liver', tensor(0.9086, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3707, dtype=torch.float64))]), 17736.89665346779)
[2024-11-30 04:34:00,019][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:34:53,922][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:34:53,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:34:53,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:34:53,922][flwr][INFO] - 
[2024-11-30 04:34:53,922][flwr][INFO] - [ROUND 34]
[2024-11-30 04:34:53,922][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:41:10,222][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:42:54,375][flwr][INFO] - fit progress: (34, 0.098250433641312, OrderedDict([('ind_iou_0', 0.7969106231438474), ('ind_dice_liver_0', tensor(0.8975, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3388, dtype=torch.float64)), ('ind_iou_1', 0.974259399170424), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5876, dtype=torch.float64)), ('all_iou', 0.8144782037544025), ('all_dice_liver', tensor(0.9065, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3672, dtype=torch.float64))]), 18271.255173244514)
[2024-11-30 04:42:54,378][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:43:49,887][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:43:49,887][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:43:49,887][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:43:49,888][flwr][INFO] - 
[2024-11-30 04:43:49,888][flwr][INFO] - [ROUND 35]
[2024-11-30 04:43:49,888][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:50:07,618][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 04:51:52,290][flwr][INFO] - fit progress: (35, 0.10414930166799562, OrderedDict([('ind_iou_0', 0.7953932442769412), ('ind_dice_liver_0', tensor(0.8963, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3371, dtype=torch.float64)), ('ind_iou_1', 0.9742189859794027), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5844, dtype=torch.float64)), ('all_iou', 0.813090732472662), ('all_dice_liver', tensor(0.9053, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3653, dtype=torch.float64))]), 18809.17090769671)
[2024-11-30 04:51:52,294][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:52:47,999][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:52:47,999][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 04:52:48,000][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:52:48,000][flwr][INFO] - 
[2024-11-30 04:52:48,000][flwr][INFO] - [ROUND 36]
[2024-11-30 04:52:48,001][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:59:03,725][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 05:00:49,962][flwr][INFO] - fit progress: (36, 0.10581186685365637, OrderedDict([('ind_iou_0', 0.7938275326122274), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3285, dtype=torch.float64)), ('ind_iou_1', 0.9742970206234295), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5926, dtype=torch.float64)), ('all_iou', 0.8116919335533389), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3585, dtype=torch.float64))]), 19346.84276806377)
[2024-11-30 05:00:49,966][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:01:44,454][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:01:44,454][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:01:44,455][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:01:44,455][flwr][INFO] - 
[2024-11-30 05:01:44,455][flwr][INFO] - [ROUND 37]
[2024-11-30 05:01:44,455][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:08:01,392][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 05:09:47,196][flwr][INFO] - fit progress: (37, 0.10754595931323731, OrderedDict([('ind_iou_0', 0.7938397296356953), ('ind_dice_liver_0', tensor(0.8959, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3308, dtype=torch.float64)), ('ind_iou_1', 0.9748234992278885), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5886, dtype=torch.float64)), ('all_iou', 0.8117460209383668), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3603, dtype=torch.float64))]), 19884.076712256297)
[2024-11-30 05:09:47,199][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:10:40,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:10:40,867][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:10:40,867][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:10:40,867][flwr][INFO] - 
[2024-11-30 05:10:40,867][flwr][INFO] - [ROUND 38]
[2024-11-30 05:10:40,867][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:16:57,951][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 05:18:43,380][flwr][INFO] - fit progress: (38, 0.10519228303803886, OrderedDict([('ind_iou_0', 0.7931336049239085), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3334, dtype=torch.float64)), ('ind_iou_1', 0.9745480935375148), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.8110971479071926), ('all_dice_liver', tensor(0.9051, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 20420.2604021905)
[2024-11-30 05:18:43,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:19:37,760][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:19:37,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:19:37,761][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:19:37,761][flwr][INFO] - 
[2024-11-30 05:19:37,761][flwr][INFO] - [ROUND 39]
[2024-11-30 05:19:37,761][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:25:52,489][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 05:27:36,923][flwr][INFO] - fit progress: (39, 0.10713021535222617, OrderedDict([('ind_iou_0', 0.7940132921480715), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3374, dtype=torch.float64)), ('ind_iou_1', 0.9745763808735843), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.811889422667287), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3662, dtype=torch.float64))]), 20953.80361468997)
[2024-11-30 05:27:36,926][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:28:31,556][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:28:31,556][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:28:31,556][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:28:31,557][flwr][INFO] - 
[2024-11-30 05:28:31,557][flwr][INFO] - [ROUND 40]
[2024-11-30 05:28:31,557][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:34:50,303][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[2024-11-30 05:36:35,446][flwr][INFO] - fit progress: (40, 0.0988124312408264, OrderedDict([('ind_iou_0', 0.7820696327087762), ('ind_dice_liver_0', tensor(0.8882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3127, dtype=torch.float64)), ('ind_iou_1', 0.9745350741360002), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.8011189139020328), ('all_dice_liver', tensor(0.8980, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3440, dtype=torch.float64))]), 21492.32689800393)
[2024-11-30 05:36:35,450][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:37:29,420][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:37:29,420][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:37:29,421][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:37:29,421][flwr][INFO] - 
[2024-11-30 05:37:29,421][flwr][INFO] - [SUMMARY]
[2024-11-30 05:37:29,421][flwr][INFO] - Run finished 40 round(s) in 21546.30s
[2024-11-30 05:37:29,540][flwr][INFO] - 	History (loss, centralized):
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 0: 0.7414753399337515
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 1: 0.05303550318379606
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 2: 0.04925278463045425
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 3: 0.04922053228518909
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 4: 0.05813819540068773
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 5: 0.05193330802911545
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 6: 0.0595124055107659
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 7: 0.054658803450969115
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 8: 0.06094796382606153
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 9: 0.06346101352466574
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 10: 0.06813601635963469
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 11: 0.07734067768553952
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 12: 0.06587269239606032
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 13: 0.07295164013592643
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 14: 0.0805002936439458
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 15: 0.07781547019468547
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 16: 0.07666210907707423
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 17: 0.07800370926689688
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 18: 0.08207932139296133
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 19: 0.08346623614592108
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 20: 0.08608568779925962
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 21: 0.09094283431768417
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 22: 0.08323826869190022
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 23: 0.06475172791968893
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 24: 0.08459392053116109
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 25: 0.08802219089104016
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 26: 0.09048079585005372
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 27: 0.09174106121982374
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 28: 0.08486959324921531
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 29: 0.0934941541902969
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 30: 0.09592473836832732
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 31: 0.0962061827771441
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 32: 0.0961772500061708
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 33: 0.09608880142414418
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 34: 0.098250433641312
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 35: 0.10414930166799562
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 36: 0.10581186685365637
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 37: 0.10754595931323731
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 38: 0.10519228303803886
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 39: 0.10713021535222617
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 40: 0.0988124312408264
[2024-11-30 05:37:29,542][flwr][INFO] - 	History (metrics, centralized):
[2024-11-30 05:37:29,542][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1514, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (1, tensor(0.7681, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (2, tensor(0.8734, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (3, tensor(0.8940, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (4, tensor(0.8769, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (5, tensor(0.8937, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (6, tensor(0.8466, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (7, tensor(0.9034, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (8, tensor(0.9012, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (9, tensor(0.9005, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (10, tensor(0.9025, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (11, tensor(0.8950, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (12, tensor(0.8756, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (13, tensor(0.8971, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (14, tensor(0.8985, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (15, tensor(0.9035, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (16, tensor(0.9035, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (17, tensor(0.9020, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (18, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (19, tensor(0.9024, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (20, tensor(0.8946, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (21, tensor(0.9008, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (22, tensor(0.9055, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (23, tensor(0.8934, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (24, tensor(0.9074, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (25, tensor(0.9074, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (26, tensor(0.9069, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (27, tensor(0.9061, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (28, tensor(0.8973, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (29, tensor(0.9043, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (30, tensor(0.9044, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (31, tensor(0.9046, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (32, tensor(0.9050, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (33, tensor(0.9086, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (34, tensor(0.9065, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (35, tensor(0.9053, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (36, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (37, tensor(0.9050, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (38, tensor(0.9051, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (39, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (40, tensor(0.8980, dtype=torch.float64))],
[2024-11-30 05:37:29,544][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (1, tensor(0.0362, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (2, tensor(0.1950, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (3, tensor(0.2571, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (4, tensor(0.2460, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (5, tensor(0.2404, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (6, tensor(0.2149, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (7, tensor(0.2978, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (8, tensor(0.3270, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (9, tensor(0.3150, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (10, tensor(0.3109, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (11, tensor(0.3134, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (12, tensor(0.3275, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (13, tensor(0.3114, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (14, tensor(0.3194, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (15, tensor(0.3293, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (16, tensor(0.3487, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (17, tensor(0.3319, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (18, tensor(0.3571, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (19, tensor(0.3373, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (20, tensor(0.3115, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (21, tensor(0.3455, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (22, tensor(0.3602, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (23, tensor(0.2959, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (24, tensor(0.3621, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (25, tensor(0.3576, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (26, tensor(0.3679, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (27, tensor(0.3632, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (28, tensor(0.3193, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (29, tensor(0.3537, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (30, tensor(0.3611, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (31, tensor(0.3424, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (32, tensor(0.3514, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (33, tensor(0.3707, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (34, tensor(0.3672, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (35, tensor(0.3653, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (36, tensor(0.3585, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (37, tensor(0.3603, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (38, tensor(0.3621, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (39, tensor(0.3662, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (40, tensor(0.3440, dtype=torch.float64))],
[2024-11-30 05:37:29,546][flwr][INFO] - 	 'all_iou': [(0, 0.0475928625471509),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (1, 0.6519288082394075),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (2, 0.7711695907460727),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (3, 0.7981788571034795),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (4, 0.7654355161020596),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (5, 0.789865516286173),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (6, 0.7334295273680683),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (7, 0.8155179756401552),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (8, 0.8098240228808102),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (9, 0.8068082440479202),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (10, 0.8100800327081573),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (11, 0.7965341836797774),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (12, 0.7754728091344196),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (13, 0.8020391622400234),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (14, 0.801182400148261),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (15, 0.8102602849777714),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (16, 0.8121368422383726),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (17, 0.8094801036365123),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (18, 0.8133492611987482),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (19, 0.8087580004949835),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (20, 0.7947234413923687),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (21, 0.8067385506169092),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (22, 0.8124173732077967),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (23, 0.7937778530542612),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (24, 0.8174465570904365),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (25, 0.8164982508230381),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (26, 0.8167572368705338),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (27, 0.8127388122800211),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (28, 0.8006589862704299),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (29, 0.8114353229454422),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (30, 0.8121628868551101),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (31, 0.8110572377033446),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (32, 0.8127452166952082),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (33, 0.8164878841193062),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (34, 0.8144782037544025),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (35, 0.813090732472662),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (36, 0.8116919335533389),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (37, 0.8117460209383668),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (38, 0.8110971479071926),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (39, 0.811889422667287),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (40, 0.8011189139020328)],
[2024-11-30 05:37:29,548][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1516, dtype=torch.float64)),
[2024-11-30 05:37:29,548][flwr][INFO] - 	                      (1, tensor(0.7563, dtype=torch.float64)),
[2024-11-30 05:37:29,548][flwr][INFO] - 	                      (2, tensor(0.8644, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (3, tensor(0.8861, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (4, tensor(0.8673, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (5, tensor(0.8854, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (6, tensor(0.8347, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (7, tensor(0.8957, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (8, tensor(0.8929, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (9, tensor(0.8920, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (10, tensor(0.8941, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (11, tensor(0.8856, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (12, tensor(0.8651, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (13, tensor(0.8878, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (14, tensor(0.8892, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (15, tensor(0.8946, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (16, tensor(0.8947, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (17, tensor(0.8930, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (18, tensor(0.8966, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (19, tensor(0.8933, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (20, tensor(0.8846, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (21, tensor(0.8915, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (22, tensor(0.8966, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (23, tensor(0.8838, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (24, tensor(0.8987, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (25, tensor(0.8987, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (26, tensor(0.8981, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (27, tensor(0.8972, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (28, tensor(0.8875, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (29, tensor(0.8952, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (30, tensor(0.8953, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (31, tensor(0.8956, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (32, tensor(0.8960, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (33, tensor(0.8999, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (34, tensor(0.8975, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (35, tensor(0.8963, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (36, tensor(0.8964, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (37, tensor(0.8959, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (38, tensor(0.8960, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (39, tensor(0.8964, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (40, tensor(0.8882, dtype=torch.float64))],
[2024-11-30 05:37:29,550][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1499, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (1, tensor(0.8752, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (2, tensor(0.9542, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (3, tensor(0.9657, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (4, tensor(0.9641, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (5, tensor(0.9693, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (6, tensor(0.9552, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (7, tensor(0.9731, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (8, tensor(0.9769, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (9, tensor(0.9778, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (10, tensor(0.9786, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (11, tensor(0.9804, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (12, tensor(0.9709, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (13, tensor(0.9825, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (14, tensor(0.9832, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (15, tensor(0.9843, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (16, tensor(0.9834, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (17, tensor(0.9838, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (18, tensor(0.9851, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (19, tensor(0.9853, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (20, tensor(0.9852, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (21, tensor(0.9855, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (22, tensor(0.9859, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (23, tensor(0.9801, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (24, tensor(0.9862, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (25, tensor(0.9865, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (26, tensor(0.9869, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (27, tensor(0.9866, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (28, tensor(0.9862, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (29, tensor(0.9869, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (30, tensor(0.9871, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (31, tensor(0.9872, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (32, tensor(0.9873, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (33, tensor(0.9873, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (34, tensor(0.9876, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (35, tensor(0.9877, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (36, tensor(0.9876, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (37, tensor(0.9879, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (38, tensor(0.9879, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (39, tensor(0.9878, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (40, tensor(0.9875, dtype=torch.float64))],
[2024-11-30 05:37:29,552][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                       (1, tensor(0.0358, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                       (2, tensor(0.1785, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (3, tensor(0.2361, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (4, tensor(0.2178, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (5, tensor(0.2104, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (6, tensor(0.1899, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (7, tensor(0.2720, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (8, tensor(0.2976, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (9, tensor(0.2845, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (10, tensor(0.2796, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (11, tensor(0.2821, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (12, tensor(0.2997, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (13, tensor(0.2786, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (14, tensor(0.2870, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (15, tensor(0.2974, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (16, tensor(0.3189, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (17, tensor(0.3016, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (18, tensor(0.3283, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (19, tensor(0.3057, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (20, tensor(0.2775, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (21, tensor(0.3152, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (22, tensor(0.3324, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (23, tensor(0.2660, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (24, tensor(0.3331, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (25, tensor(0.3296, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (26, tensor(0.3401, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (27, tensor(0.3347, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (28, tensor(0.2869, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (29, tensor(0.3251, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (30, tensor(0.3323, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (31, tensor(0.3119, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (32, tensor(0.3223, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (33, tensor(0.3430, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (34, tensor(0.3388, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (35, tensor(0.3371, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (36, tensor(0.3285, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (37, tensor(0.3308, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (38, tensor(0.3334, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (39, tensor(0.3374, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (40, tensor(0.3127, dtype=torch.float64))],
[2024-11-30 05:37:29,554][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (1, tensor(0.0395, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (2, tensor(0.3130, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (3, tensor(0.4101, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (4, tensor(0.4632, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (5, tensor(0.4751, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (6, tensor(0.4111, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (7, tensor(0.4873, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (8, tensor(0.5541, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (9, tensor(0.5497, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (10, tensor(0.5540, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (11, tensor(0.5540, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (12, tensor(0.5340, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (13, tensor(0.5662, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (14, tensor(0.5759, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (15, tensor(0.5823, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (16, tensor(0.5808, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (17, tensor(0.5683, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (18, tensor(0.5850, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (19, tensor(0.5879, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (20, tensor(0.5825, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (21, tensor(0.5820, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (22, tensor(0.5806, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (23, tensor(0.5345, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (24, tensor(0.5921, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (25, tensor(0.5766, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (26, tensor(0.5820, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (27, tensor(0.5850, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (28, tensor(0.5764, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (29, tensor(0.5795, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (30, tensor(0.5823, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (31, tensor(0.5846, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (32, tensor(0.5819, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (33, tensor(0.5867, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (34, tensor(0.5876, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (35, tensor(0.5844, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (36, tensor(0.5926, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (37, tensor(0.5886, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (38, tensor(0.5858, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (39, tensor(0.5858, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (40, tensor(0.5901, dtype=torch.float64))],
[2024-11-30 05:37:29,556][flwr][INFO] - 	 'ind_iou_0': [(0, 0.04766415833322114),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (1, 0.6316875723875005),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (2, 0.7536420464594646),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (3, 0.7820151522242209),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (4, 0.7452841414649035),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (5, 0.7720739542713111),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (6, 0.7108457075431956),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (7, 0.7999996553181479),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (8, 0.7929387574260767),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (9, 0.7895828309521433),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (10, 0.7930287733831317),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (11, 0.7778061268448617),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (12, 0.7561715069928102),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (13, 0.7836245416784494),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (14, 0.7826007748222609),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (15, 0.7925253756492625),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (16, 0.794770611049503),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (17, 0.7917326566061946),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (18, 0.7958701546502802),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (19, 0.7907357953627282),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (20, 0.7751670209418916),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (21, 0.7885281167213914),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (22, 0.794820627088442),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (23, 0.7748129285735644),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (24, 0.8003105445286044),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (25, 0.799241978213032),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (26, 0.7994760698614096),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (27, 0.7950781061937892),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (28, 0.7817250958420316),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (29, 0.7935916451200561),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (30, 0.794403298223325),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (31, 0.7931324133784465),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (32, 0.7950077196435238),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (33, 0.7991970050149196),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (34, 0.7969106231438474),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (35, 0.7953932442769412),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (36, 0.7938275326122274),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (37, 0.7938397296356953),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (38, 0.7931336049239085),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (39, 0.7940132921480715),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (40, 0.7820696327087762)],
[2024-11-30 05:37:29,559][flwr][INFO] - 	 'ind_iou_1': [(0, 0.04694000668968212),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (1, 0.8362033455466258),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (2, 0.9295314235185855),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (3, 0.9447122111257642),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (4, 0.9479294328973502),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (5, 0.9514002418093063),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (6, 0.9380788168094929),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (7, 0.9566744201094628),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (8, 0.9635342443527264),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (9, 0.9633393220798547),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (10, 0.9650760878658963),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (11, 0.9669066646043755),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (12, 0.9513818242415281),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (13, 0.9697805119168175),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (14, 0.9702681002816052),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (15, 0.9715224074084938),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (16, 0.9700779992206202),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (17, 0.9706330449831999),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (18, 0.9721577140487381),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (19, 0.9726733307368213),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (20, 0.9726740116184747),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (21, 0.972346415571436),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (22, 0.9726798593246316),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (23, 0.9660274418780755),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (24, 0.9732658740725458),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (25, 0.973483713650208),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (26, 0.974029525142851),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (27, 0.9732923978943294),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (28, 0.9729190181656941),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (29, 0.9736055323068126),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (30, 0.973732716093236),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (31, 0.9741346940386385),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (32, 0.9741582306300837),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (33, 0.9737154709765082),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (34, 0.974259399170424),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (35, 0.9742189859794027),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (36, 0.9742970206234295),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (37, 0.9748234992278885),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (38, 0.9745480935375148),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (39, 0.9745763808735843),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (40, 0.9745350741360002)]}
[2024-11-30 05:37:29,561][flwr][INFO] - 
