/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.res_unet_plus.ResUnetPlusPlus
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 1658
3 3791
3 414
3 4205
cuda:0
[2024-12-02 10:59:28,294][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-12-02 10:59:31,647	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'object_store_memory': 200000000000.0, 'GPU': 3.0, 'node:172.18.62.2': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 846183984128.0, 'node:__internal_head__': 1.0}
[2024-12-02 10:59:51,600][flwr][INFO] - Flower VCE: Ray initialized with resources: {'object_store_memory': 200000000000.0, 'GPU': 3.0, 'node:172.18.62.2': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 846183984128.0, 'node:__internal_head__': 1.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-02 10:59:51,600][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-02 10:59:51,601][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-02 10:59:51,649][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-12-02 10:59:51,649][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-12-02 10:59:51,650][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-12-02 10:59:55,504][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-12-02 10:59:55,504][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.7025126381946659, OrderedDict([('ind_iou_0', 0.01798301739228557), ('ind_dice_liver_0', tensor(0.1541, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0086, dtype=torch.float64)), ('ind_iou_1', 0.018857945583812354), ('ind_dice_liver_1', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.018069193949506995), ('all_dice_liver', tensor(0.1539, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-12-02 11:05:26,095][flwr][INFO] - initial parameters (loss, other metrics): 0.7025126381946659, OrderedDict([('ind_iou_0', 0.01798301739228557), ('ind_dice_liver_0', tensor(0.1541, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0086, dtype=torch.float64)), ('ind_iou_1', 0.018857945583812354), ('ind_dice_liver_1', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.018069193949506995), ('all_dice_liver', tensor(0.1539, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[92mINFO [0m:      
[2024-12-02 11:05:26,190][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-12-02 11:05:26,190][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:05:26,190][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.49947151762734016
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.5980, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.0080, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.6933229185178553
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.7212, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.0138, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.8720551533971845
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.8860, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.0525, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.6615827796341456
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.7695, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.0851, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9136109232223802
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9324, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.1978, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7269932683287061
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8339, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1281, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9335560884381332
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9521, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.2966, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7041531619332229
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8179, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1117, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 11:15:12,172][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-12-02 11:15:12,197][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.06533749376143486, OrderedDict([('ind_iou_0', 0.7041531619332229), ('ind_dice_liver_0', tensor(0.8179, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1117, dtype=torch.float64)), ('ind_iou_1', 0.9375965819501104), ('ind_dice_liver_1', tensor(0.9538, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3129, dtype=torch.float64)), ('all_iou', 0.727316112938662), ('all_dice_liver', tensor(0.8313, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1339, dtype=torch.float64))]), 742.5006239442155)
Entrei no test
Meio do test
Fim do test
[2024-12-02 11:17:48,690][flwr][INFO] - fit progress: (1, 0.06533749376143486, OrderedDict([('ind_iou_0', 0.7041531619332229), ('ind_dice_liver_0', tensor(0.8179, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1117, dtype=torch.float64)), ('ind_iou_1', 0.9375965819501104), ('ind_dice_liver_1', tensor(0.9538, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3129, dtype=torch.float64)), ('all_iou', 0.727316112938662), ('all_dice_liver', tensor(0.8313, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1339, dtype=torch.float64))]), 742.5006239442155)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:17:48,697][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:19:08,149][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 11:19:08,150][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:19:08,150][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 11:19:08,151][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-12-02 11:19:08,151][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:19:08,152][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9282553192833266
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9534, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.3338, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.6782693103894777
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8063, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.0477, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9300650868435401
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9540, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.3907, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7099325883238242
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8268, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1290, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9493901180720437
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9670, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.4729, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.729475858699945
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8447, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1368, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:28:49,127][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.061394247736706535, OrderedDict([('ind_iou_0', 0.7194946885207562), ('ind_dice_liver_0', tensor(0.8350, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1377, dtype=torch.float64)), ('ind_iou_1', 0.944296759365001), ('ind_dice_liver_1', tensor(0.9625, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4492, dtype=torch.float64)), ('all_iou', 0.7417931011789024), ('all_dice_liver', tensor(0.8476, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1716, dtype=torch.float64))]), 1557.3939261799678)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9033374539485173
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9327, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.3457, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7194946885207562
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8350, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1377, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 11:31:23,584][flwr][INFO] - fit progress: (2, 0.061394247736706535, OrderedDict([('ind_iou_0', 0.7194946885207562), ('ind_dice_liver_0', tensor(0.8350, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1377, dtype=torch.float64)), ('ind_iou_1', 0.944296759365001), ('ind_dice_liver_1', tensor(0.9625, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4492, dtype=torch.float64)), ('all_iou', 0.7417931011789024), ('all_dice_liver', tensor(0.8476, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1716, dtype=torch.float64))]), 1557.3939261799678)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:31:23,587][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:32:35,001][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:32:35,001][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:32:35,001][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 11:32:35,001][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-12-02 11:32:35,001][flwr][INFO] - [ROUND 3]
[2024-12-02 11:32:35,002][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9405739802245907
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9618, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.4120, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.716917503603904
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8339, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.0982, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.943258253492002
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9625, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.4530, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.680632247796568
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8058, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1270, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9570694342275868
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9721, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.4842, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7403935201914653
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8522, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1580, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:42:00,406][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.07691254839611181, OrderedDict([('ind_iou_0', 0.7094079618685047), ('ind_dice_liver_0', tensor(0.8313, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1225, dtype=torch.float64)), ('ind_iou_1', 0.9580016892356201), ('ind_dice_liver_1', tensor(0.9729, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4798, dtype=torch.float64)), ('all_iou', 0.7339828838071676), ('all_dice_liver', tensor(0.8453, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1610, dtype=torch.float64))]), 2335.4384021395817)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.958935325007672
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9735, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5142, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7094079618685047
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8313, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1225, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 11:44:21,628][flwr][INFO] - fit progress: (3, 0.07691254839611181, OrderedDict([('ind_iou_0', 0.7094079618685047), ('ind_dice_liver_0', tensor(0.8313, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1225, dtype=torch.float64)), ('ind_iou_1', 0.9580016892356201), ('ind_dice_liver_1', tensor(0.9729, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4798, dtype=torch.float64)), ('all_iou', 0.7339828838071676), ('all_dice_liver', tensor(0.8453, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1610, dtype=torch.float64))]), 2335.4384021395817)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:44:21,632][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:45:41,433][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:45:41,433][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:45:41,434][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 11:45:41,434][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-12-02 11:45:41,434][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:45:41,434][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9581785961914071
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9735, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5133, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7436731609273437
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8565, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1650, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9611042104093471
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9749, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5181, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7003258947564556
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8238, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1173, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9594742563520219
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9738, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5399, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7283975512433777
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8433, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1548, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:54:49,885][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.07207691698444743, OrderedDict([('ind_iou_0', 0.7270871639813715), ('ind_dice_liver_0', tensor(0.8431, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1780, dtype=torch.float64)), ('ind_iou_1', 0.9633678403530899), ('ind_dice_liver_1', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5325, dtype=torch.float64)), ('all_iou', 0.7504383510157522), ('all_dice_liver', tensor(0.8563, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2160, dtype=torch.float64))]), 3106.46458590962)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.96654751398798
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9783, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5681, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7270871639813715
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8431, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1780, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 11:57:12,654][flwr][INFO] - fit progress: (4, 0.07207691698444743, OrderedDict([('ind_iou_0', 0.7270871639813715), ('ind_dice_liver_0', tensor(0.8431, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1780, dtype=torch.float64)), ('ind_iou_1', 0.9633678403530899), ('ind_dice_liver_1', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5325, dtype=torch.float64)), ('all_iou', 0.7504383510157522), ('all_dice_liver', tensor(0.8563, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2160, dtype=torch.float64))]), 3106.46458590962)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 11:57:12,658][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 11:58:21,061][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-02 11:58:21,061][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 11:58:21,061][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 11:58:21,061][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-12-02 11:58:21,061][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 11:58:21,061][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9646343767791707
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9775, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5244, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7611591856306241
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8666, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1470, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9687343010960275
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5496, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7314090538608375
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8461, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1270, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9689145779991625
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9802, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5359, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7456180569197497
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8592, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1729, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9625219414470724
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9757, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5344, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7419651041102922
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8533, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1326, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 12:07:31,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.06331943691748014, OrderedDict([('ind_iou_0', 0.7419651041102922), ('ind_dice_liver_0', tensor(0.8533, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1326, dtype=torch.float64)), ('ind_iou_1', 0.9625522077531313), ('ind_dice_liver_1', tensor(0.9764, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5092, dtype=torch.float64)), ('all_iou', 0.7637925635909898), ('all_dice_liver', tensor(0.8654, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1728, dtype=torch.float64))]), 3908.924595230259)
Entrei no test
Meio do test
Fim do test
[2024-12-02 12:10:35,114][flwr][INFO] - fit progress: (5, 0.06331943691748014, OrderedDict([('ind_iou_0', 0.7419651041102922), ('ind_dice_liver_0', tensor(0.8533, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1326, dtype=torch.float64)), ('ind_iou_1', 0.9625522077531313), ('ind_dice_liver_1', tensor(0.9764, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5092, dtype=torch.float64)), ('all_iou', 0.7637925635909898), ('all_dice_liver', tensor(0.8654, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1728, dtype=torch.float64))]), 3908.924595230259)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:10:35,118][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 12:11:45,647][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:11:45,647][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:11:45,647][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 12:11:45,647][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-12-02 12:11:45,648][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:11:45,648][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9698119583745136
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9807, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5619, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7270131469445701
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8443, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1651, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9709037774906035
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9814, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5756, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7344646660826261
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8498, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1603, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9737864306423193
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5906, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7349057076186652
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8512, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1760, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9586559565784705
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9727, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5413, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7224517294530366
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8398, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1447, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 12:20:43,963][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.07585824414928234, OrderedDict([('ind_iou_0', 0.7224517294530366), ('ind_dice_liver_0', tensor(0.8398, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1447, dtype=torch.float64)), ('ind_iou_1', 0.9633174649826567), ('ind_dice_liver_1', tensor(0.9770, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5303, dtype=torch.float64)), ('all_iou', 0.74626084945478), ('all_dice_liver', tensor(0.8534, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1858, dtype=torch.float64))]), 4660.658047207631)
Entrei no test
Meio do test
Fim do test
[2024-12-02 12:23:06,848][flwr][INFO] - fit progress: (6, 0.07585824414928234, OrderedDict([('ind_iou_0', 0.7224517294530366), ('ind_dice_liver_0', tensor(0.8398, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1447, dtype=torch.float64)), ('ind_iou_1', 0.9633174649826567), ('ind_dice_liver_1', tensor(0.9770, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5303, dtype=torch.float64)), ('all_iou', 0.74626084945478), ('all_dice_liver', tensor(0.8534, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1858, dtype=torch.float64))]), 4660.658047207631)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:23:06,851][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 12:24:16,312][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:24:16,313][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:24:16,314][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 12:24:16,314][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-12-02 12:24:16,314][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:24:16,314][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9708712285151512
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5741, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7203272133485653
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8403, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1729, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9751792956276807
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5897, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7075489704263058
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8334, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1779, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9757288120181543
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5831, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.729674943636587
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8478, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1684, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.976335129913787
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5950, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7218763264937371
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8418, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1775, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 12:33:56,807][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0897120629245134, OrderedDict([('ind_iou_0', 0.7218763264937371), ('ind_dice_liver_0', tensor(0.8418, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9692948080432837), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5715, dtype=torch.float64)), ('all_iou', 0.7463114849414169), ('all_dice_liver', tensor(0.8556, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2196, dtype=torch.float64))]), 5469.0244574462995)
Entrei no test
Meio do test
Fim do test
[2024-12-02 12:36:35,214][flwr][INFO] - fit progress: (7, 0.0897120629245134, OrderedDict([('ind_iou_0', 0.7218763264937371), ('ind_dice_liver_0', tensor(0.8418, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9692948080432837), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5715, dtype=torch.float64)), ('all_iou', 0.7463114849414169), ('all_dice_liver', tensor(0.8556, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2196, dtype=torch.float64))]), 5469.0244574462995)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:36:35,218][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 12:37:52,020][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:37:52,021][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:37:52,022][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 12:37:52,022][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-12-02 12:37:52,022][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:37:52,022][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9764042729767193
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6136, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7005495954456614
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8254, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1452, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9758772507329699
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6036, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7305480470568483
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8483, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1795, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9794953834875417
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6014, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.730837151276752
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8487, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1697, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9796407591350874
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5944, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7023686250431647
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8287, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1529, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 12:47:36,070][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.10556496886999371, OrderedDict([('ind_iou_0', 0.7023686250431647), ('ind_dice_liver_0', tensor(0.8287, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1529, dtype=torch.float64)), ('ind_iou_1', 0.9701511841865161), ('ind_dice_liver_1', tensor(0.9827, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5772, dtype=torch.float64)), ('all_iou', 0.7288425552887139), ('all_dice_liver', tensor(0.8439, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1987, dtype=torch.float64))]), 6287.6246060896665)
Entrei no test
Meio do test
Fim do test
[2024-12-02 12:50:13,814][flwr][INFO] - fit progress: (8, 0.10556496886999371, OrderedDict([('ind_iou_0', 0.7023686250431647), ('ind_dice_liver_0', tensor(0.8287, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1529, dtype=torch.float64)), ('ind_iou_1', 0.9701511841865161), ('ind_dice_liver_1', tensor(0.9827, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5772, dtype=torch.float64)), ('all_iou', 0.7288425552887139), ('all_dice_liver', tensor(0.8439, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1987, dtype=torch.float64))]), 6287.6246060896665)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 12:50:13,818][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 12:51:32,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 12:51:32,389][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 12:51:32,389][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 12:51:32,390][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-12-02 12:51:32,390][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 12:51:32,390][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9793786332964084
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6174, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7249166765885787
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8454, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1908, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9786275655318253
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6217, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7228934283303933
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8434, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1607, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9802223491100082
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6022, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7313352892533727
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8500, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1970, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:01:02,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.09029007634307468, OrderedDict([('ind_iou_0', 0.721936273853132), ('ind_dice_liver_0', tensor(0.8439, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1838, dtype=torch.float64)), ('ind_iou_1', 0.9720497372165715), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5878, dtype=torch.float64)), ('all_iou', 0.7466206317299993), ('all_dice_liver', tensor(0.8578, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2268, dtype=torch.float64))]), 7091.965386918746)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9804094884299269
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5942, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.721936273853132
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8439, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1838, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 13:03:38,155][flwr][INFO] - fit progress: (9, 0.09029007634307468, OrderedDict([('ind_iou_0', 0.721936273853132), ('ind_dice_liver_0', tensor(0.8439, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1838, dtype=torch.float64)), ('ind_iou_1', 0.9720497372165715), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5878, dtype=torch.float64)), ('all_iou', 0.7466206317299993), ('all_dice_liver', tensor(0.8578, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2268, dtype=torch.float64))]), 7091.965386918746)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:03:38,159][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:04:58,077][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:04:58,078][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:04:58,079][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 13:04:58,079][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-12-02 13:04:58,079][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:04:58,079][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9811838462400256
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.5960, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.724379316009844
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8452, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1587, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9816906050073771
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6221, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.720935710922336
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8419, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1740, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9813198312958334
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6123, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7215845163272471
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8435, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1710, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:14:36,214][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.09569710588180122, OrderedDict([('ind_iou_0', 0.7320079239608482), ('ind_dice_liver_0', tensor(0.8506, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1814, dtype=torch.float64)), ('ind_iou_1', 0.9719249580257454), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5883, dtype=torch.float64)), ('all_iou', 0.7557082247861632), ('all_dice_liver', tensor(0.8638, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 7905.204765388742)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9810364066475932
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6116, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7320079239608482
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8506, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1814, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 13:17:11,394][flwr][INFO] - fit progress: (10, 0.09569710588180122, OrderedDict([('ind_iou_0', 0.7320079239608482), ('ind_dice_liver_0', tensor(0.8506, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1814, dtype=torch.float64)), ('ind_iou_1', 0.9719249580257454), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5883, dtype=torch.float64)), ('all_iou', 0.7557082247861632), ('all_dice_liver', tensor(0.8638, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 7905.204765388742)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:17:11,398][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:18:29,912][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:18:29,912][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:18:29,912][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 13:18:29,912][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-12-02 13:18:29,912][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:18:29,912][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9825464253744678
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6055, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7254663784147194
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8466, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1896, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9827025339223365
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6065, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.732294930021828
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8512, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1839, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9836210273298411
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6255, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7336957895128299
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8530, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1845, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:28:02,519][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.09649466932446704, OrderedDict([('ind_iou_0', 0.7312641775839636), ('ind_dice_liver_0', tensor(0.8509, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2031, dtype=torch.float64)), ('ind_iou_1', 0.9731929023227956), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5917, dtype=torch.float64)), ('all_iou', 0.7551510841301642), ('all_dice_liver', tensor(0.8641, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2450, dtype=torch.float64))]), 8714.172932119109)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9833451912442834
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6112, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7312641775839636
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8509, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.2031, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 13:30:40,363][flwr][INFO] - fit progress: (11, 0.09649466932446704, OrderedDict([('ind_iou_0', 0.7312641775839636), ('ind_dice_liver_0', tensor(0.8509, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2031, dtype=torch.float64)), ('ind_iou_1', 0.9731929023227956), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5917, dtype=torch.float64)), ('all_iou', 0.7551510841301642), ('all_dice_liver', tensor(0.8641, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2450, dtype=torch.float64))]), 8714.172932119109)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:30:40,366][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:31:54,603][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:31:54,603][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:31:54,604][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 13:31:54,604][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-12-02 13:31:54,604][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:31:54,605][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9783278781505448
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6392, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7145576880992586
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8374, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1818, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9827158474654489
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6308, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7307765110268408
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8504, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1687, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9857259822374603
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6191, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7316077280705748
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8513, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1838, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:41:46,375][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.09931049717786222, OrderedDict([('ind_iou_0', 0.7307315109103913), ('ind_dice_liver_0', tensor(0.8512, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1831, dtype=torch.float64)), ('ind_iou_1', 0.9751504991954452), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6070, dtype=torch.float64)), ('all_iou', 0.7548512285605786), ('all_dice_liver', tensor(0.8645, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2284, dtype=torch.float64))]), 9543.427189936861)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.986669780557368
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6393, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7307315109103913
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8512, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1831, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 13:44:29,617][flwr][INFO] - fit progress: (12, 0.09931049717786222, OrderedDict([('ind_iou_0', 0.7307315109103913), ('ind_dice_liver_0', tensor(0.8512, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1831, dtype=torch.float64)), ('ind_iou_1', 0.9751504991954452), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6070, dtype=torch.float64)), ('all_iou', 0.7548512285605786), ('all_dice_liver', tensor(0.8645, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2284, dtype=torch.float64))]), 9543.427189936861)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:44:29,621][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:45:43,655][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:45:43,656][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:45:43,660][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 13:45:43,660][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-12-02 13:45:43,661][flwr][INFO] - [ROUND 13]
[2024-12-02 13:45:43,661][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9846604497357849
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6493, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7270260458287753
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8483, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1725, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9842271907143554
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6291, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7266841410547522
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8482, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1909, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9851144070713147
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6335, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7234121935135942
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8462, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1769, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9843389695949043
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6154, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7362298969330995
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8551, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1851, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 13:55:27,315][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.09290033466388625, OrderedDict([('ind_iou_0', 0.7362298969330995), ('ind_dice_liver_0', tensor(0.8551, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1851, dtype=torch.float64)), ('ind_iou_1', 0.9727027078988038), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5923, dtype=torch.float64)), ('all_iou', 0.7595787382708291), ('all_dice_liver', tensor(0.8679, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2285, dtype=torch.float64))]), 10349.511825078167)
Entrei no test
Meio do test
Fim do test
[2024-12-02 13:57:55,701][flwr][INFO] - fit progress: (13, 0.09290033466388625, OrderedDict([('ind_iou_0', 0.7362298969330995), ('ind_dice_liver_0', tensor(0.8551, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1851, dtype=torch.float64)), ('ind_iou_1', 0.9727027078988038), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5923, dtype=torch.float64)), ('all_iou', 0.7595787382708291), ('all_dice_liver', tensor(0.8679, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2285, dtype=torch.float64))]), 10349.511825078167)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 13:57:55,705][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 13:59:07,934][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 13:59:07,936][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 13:59:07,937][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 13:59:07,937][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-12-02 13:59:07,937][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 13:59:07,937][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9851404110742957
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6114, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7299931607856238
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8504, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1677, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.985602107025824
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6001, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7224306946113754
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8457, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1800, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9860211573207031
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6324, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.733521765412208
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8529, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1773, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:08:55,515][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.10395984017499474, OrderedDict([('ind_iou_0', 0.7372483988966657), ('ind_dice_liver_0', tensor(0.8560, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1852, dtype=torch.float64)), ('ind_iou_1', 0.9740743225676086), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5949, dtype=torch.float64)), ('all_iou', 0.7606229436488575), ('all_dice_liver', tensor(0.8688, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2286, dtype=torch.float64))]), 11160.043261723593)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9863263004863484
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6478, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7372483988966657
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8560, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1852, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 14:11:26,233][flwr][INFO] - fit progress: (14, 0.10395984017499474, OrderedDict([('ind_iou_0', 0.7372483988966657), ('ind_dice_liver_0', tensor(0.8560, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1852, dtype=torch.float64)), ('ind_iou_1', 0.9740743225676086), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5949, dtype=torch.float64)), ('all_iou', 0.7606229436488575), ('all_dice_liver', tensor(0.8688, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2286, dtype=torch.float64))]), 11160.043261723593)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:11:26,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:12:42,766][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:12:42,766][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:12:42,767][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 14:12:42,767][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-12-02 14:12:42,767][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:12:42,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9862718386786601
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6194, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7253980992970861
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1871, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9864864602884894
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6386, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7389851346344297
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8575, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1706, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9867005175767961
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6491, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7211470213461927
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8444, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1814, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9858191821491346
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6406, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7205718522029123
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8447, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1878, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 14:22:11,855][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.10052120273558514, OrderedDict([('ind_iou_0', 0.7205718522029123), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1878, dtype=torch.float64)), ('ind_iou_1', 0.9742031996262013), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6006, dtype=torch.float64)), ('all_iou', 0.7455866286429177), ('all_dice_liver', tensor(0.8586, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2314, dtype=torch.float64))]), 11959.822050550953)
Entrei no test
Meio do test
Fim do test
[2024-12-02 14:24:46,012][flwr][INFO] - fit progress: (15, 0.10052120273558514, OrderedDict([('ind_iou_0', 0.7205718522029123), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1878, dtype=torch.float64)), ('ind_iou_1', 0.9742031996262013), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6006, dtype=torch.float64)), ('all_iou', 0.7455866286429177), ('all_dice_liver', tensor(0.8586, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2314, dtype=torch.float64))]), 11959.822050550953)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:24:46,015][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:26:06,506][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:26:06,506][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:26:06,506][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 14:26:06,507][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-12-02 14:26:06,507][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:26:06,507][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9868182298826998
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6493, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.735496218517712
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8548, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1890, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9870814824850018
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6371, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.735281983725016
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8550, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1978, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9878511068660929
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6239, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.731176669234324
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8520, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1847, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9877001457283278
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6289, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7232672097729499
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8457, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1939, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 14:35:38,245][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.10332481511397892, OrderedDict([('ind_iou_0', 0.7232672097729499), ('ind_dice_liver_0', tensor(0.8457, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1939, dtype=torch.float64)), ('ind_iou_1', 0.9740651857748662), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6042, dtype=torch.float64)), ('all_iou', 0.748020095222177), ('all_dice_liver', tensor(0.8595, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2378, dtype=torch.float64))]), 12763.517516203225)
Entrei no test
Meio do test
Fim do test
[2024-12-02 14:38:09,707][flwr][INFO] - fit progress: (16, 0.10332481511397892, OrderedDict([('ind_iou_0', 0.7232672097729499), ('ind_dice_liver_0', tensor(0.8457, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1939, dtype=torch.float64)), ('ind_iou_1', 0.9740651857748662), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6042, dtype=torch.float64)), ('all_iou', 0.748020095222177), ('all_dice_liver', tensor(0.8595, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2378, dtype=torch.float64))]), 12763.517516203225)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:38:09,711][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:39:25,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:39:25,141][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:39:25,141][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 14:39:25,141][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-12-02 14:39:25,141][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:39:25,141][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9874515896216252
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6248, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7258440537425256
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8484, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1692, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9882601438455478
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6373, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7274142171799923
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8501, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1869, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.986962338121079
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6310, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7057274584408397
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8345, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1927, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:48:59,762][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.10705830874685619, OrderedDict([('ind_iou_0', 0.7291407390627709), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1582, dtype=torch.float64)), ('ind_iou_1', 0.9749448409879337), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6004, dtype=torch.float64)), ('all_iou', 0.7533919837400301), ('all_dice_liver', tensor(0.8636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2047, dtype=torch.float64))]), 13572.587025783956)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9855661512368904
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6310, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7291407390627709
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8501, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1582, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 14:51:38,777][flwr][INFO] - fit progress: (17, 0.10705830874685619, OrderedDict([('ind_iou_0', 0.7291407390627709), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1582, dtype=torch.float64)), ('ind_iou_1', 0.9749448409879337), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6004, dtype=torch.float64)), ('all_iou', 0.7533919837400301), ('all_dice_liver', tensor(0.8636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2047, dtype=torch.float64))]), 13572.587025783956)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 14:51:38,781][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 14:52:58,015][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 14:52:58,016][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 14:52:58,016][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 14:52:58,017][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-12-02 14:52:58,017][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 14:52:58,021][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9877839692035532
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6271, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7229366287862609
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8462, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1611, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9882223463760924
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6410, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.728178218768269
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8504, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1820, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.988210097765964
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6391, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.722712971295853
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8467, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1783, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:02:38,706][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.11272720182829456, OrderedDict([('ind_iou_0', 0.7316116301981007), ('ind_dice_liver_0', tensor(0.8534, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9750643659019975), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6186, dtype=torch.float64)), ('all_iou', 0.7556379610584132), ('all_dice_liver', tensor(0.8666, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2340, dtype=torch.float64))]), 14382.876874608919)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9885672239664501
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6370, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7316116301981007
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8534, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1886, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 15:05:09,067][flwr][INFO] - fit progress: (18, 0.11272720182829456, OrderedDict([('ind_iou_0', 0.7316116301981007), ('ind_dice_liver_0', tensor(0.8534, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9750643659019975), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6186, dtype=torch.float64)), ('all_iou', 0.7556379610584132), ('all_dice_liver', tensor(0.8666, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2340, dtype=torch.float64))]), 14382.876874608919)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:05:09,071][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:06:30,700][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:06:30,701][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:06:30,702][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 15:06:30,702][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-12-02 15:06:30,702][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:06:30,702][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9887114206424497
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6519, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.731670116255495
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8524, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1783, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9889401080453315
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6338, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7312926509792885
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8527, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1693, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9890776903537198
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6477, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7214871083701222
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8450, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1730, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9886467786760851
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6345, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7306175085206605
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8516, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1595, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 15:16:15,042][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.11003257228885462, OrderedDict([('ind_iou_0', 0.7306175085206605), ('ind_dice_liver_0', tensor(0.8516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1595, dtype=torch.float64)), ('ind_iou_1', 0.9743329883733235), ('ind_dice_liver_1', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6010, dtype=torch.float64)), ('all_iou', 0.7546480231703984), ('all_dice_liver', tensor(0.8650, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2062, dtype=torch.float64))]), 15210.099638123065)
Entrei no test
Meio do test
Fim do test
[2024-12-02 15:18:56,289][flwr][INFO] - fit progress: (19, 0.11003257228885462, OrderedDict([('ind_iou_0', 0.7306175085206605), ('ind_dice_liver_0', tensor(0.8516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1595, dtype=torch.float64)), ('ind_iou_1', 0.9743329883733235), ('ind_dice_liver_1', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6010, dtype=torch.float64)), ('all_iou', 0.7546480231703984), ('all_dice_liver', tensor(0.8650, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2062, dtype=torch.float64))]), 15210.099638123065)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:18:56,293][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:20:16,298][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:20:16,298][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:20:16,299][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 15:20:16,299][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-12-02 15:20:16,300][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:20:16,300][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9892962986852734
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6444, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7289288322750523
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8507, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1494, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9891145144282181
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6300, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7242843616423489
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8470, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1675, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9894049812239105
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6480, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7306074363575378
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8522, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1676, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:29:39,629][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.12063597879504318, OrderedDict([('ind_iou_0', 0.7274818247053653), ('ind_dice_liver_0', tensor(0.8502, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1828, dtype=torch.float64)), ('ind_iou_1', 0.9747492124143237), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6117, dtype=torch.float64)), ('all_iou', 0.751880585438273), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2282, dtype=torch.float64))]), 16005.654988894239)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9896998427480851
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6531, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7274818247053653
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8502, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1828, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 15:32:11,845][flwr][INFO] - fit progress: (20, 0.12063597879504318, OrderedDict([('ind_iou_0', 0.7274818247053653), ('ind_dice_liver_0', tensor(0.8502, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1828, dtype=torch.float64)), ('ind_iou_1', 0.9747492124143237), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6117, dtype=torch.float64)), ('all_iou', 0.751880585438273), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2282, dtype=torch.float64))]), 16005.654988894239)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:32:11,848][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:33:32,193][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:33:32,193][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:33:32,193][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 15:33:32,194][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-12-02 15:33:32,194][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:33:32,194][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9897152457582619
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6456, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7304252930418813
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8521, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1674, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9897689806865945
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6502, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7154450476029713
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8411, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1628, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9901679256206284
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6288, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7357113477046664
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8557, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1673, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9903817157850727
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6398, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7259691697398462
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8499, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1862, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 15:43:20,633][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.12181818578176325, OrderedDict([('ind_iou_0', 0.7259691697398462), ('ind_dice_liver_0', tensor(0.8499, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1862, dtype=torch.float64)), ('ind_iou_1', 0.9751794542399312), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6136, dtype=torch.float64)), ('all_iou', 0.7505551985901607), ('all_dice_liver', tensor(0.8635, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2313, dtype=torch.float64))]), 16835.016364563257)
Entrei no test
Meio do test
Fim do test
[2024-12-02 15:46:01,206][flwr][INFO] - fit progress: (21, 0.12181818578176325, OrderedDict([('ind_iou_0', 0.7259691697398462), ('ind_dice_liver_0', tensor(0.8499, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1862, dtype=torch.float64)), ('ind_iou_1', 0.9751794542399312), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6136, dtype=torch.float64)), ('all_iou', 0.7505551985901607), ('all_dice_liver', tensor(0.8635, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2313, dtype=torch.float64))]), 16835.016364563257)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:46:01,210][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 15:47:20,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 15:47:20,624][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 15:47:20,624][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 15:47:20,624][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-12-02 15:47:20,625][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 15:47:20,625][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9902455899643877
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6355, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7280033404155772
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8503, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1572, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9903842075198039
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6395, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.724471794027019
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8483, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1768, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9904039076503909
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6417, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7263574806590539
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8492, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1765, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9907384673867355
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6505, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7269812776285638
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8496, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1794, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 15:56:54,703][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.12501691785296615, OrderedDict([('ind_iou_0', 0.7269812776285638), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.9750270047811321), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6100, dtype=torch.float64)), ('all_iou', 0.7514634898345732), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 17641.281647524796)
Entrei no test
Meio do test
Fim do test
[2024-12-02 15:59:27,471][flwr][INFO] - fit progress: (22, 0.12501691785296615, OrderedDict([('ind_iou_0', 0.7269812776285638), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.9750270047811321), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6100, dtype=torch.float64)), ('all_iou', 0.7514634898345732), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2247, dtype=torch.float64))]), 17641.281647524796)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 15:59:27,475][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:00:42,409][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:00:42,410][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:00:42,410][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 16:00:42,410][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-12-02 16:00:42,410][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:00:42,410][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9905192634695194
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6234, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7306051555601173
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8527, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1890, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9907916587821453
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6198, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7288199665084818
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8509, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1631, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9908289654920793
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6628, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7201936663181893
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8453, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1574, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:10:26,966][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.12641964560500862, OrderedDict([('ind_iou_0', 0.7237389437328068), ('ind_dice_liver_0', tensor(0.8476, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1639, dtype=torch.float64)), ('ind_iou_1', 0.9746424105262835), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6072, dtype=torch.float64)), ('all_iou', 0.7484836549077853), ('all_dice_liver', tensor(0.8614, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2104, dtype=torch.float64))]), 18452.11366850231)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9907730236166818
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6589, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7237389437328068
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1639, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 16:12:58,303][flwr][INFO] - fit progress: (23, 0.12641964560500862, OrderedDict([('ind_iou_0', 0.7237389437328068), ('ind_dice_liver_0', tensor(0.8476, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1639, dtype=torch.float64)), ('ind_iou_1', 0.9746424105262835), ('ind_dice_liver_1', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6072, dtype=torch.float64)), ('all_iou', 0.7484836549077853), ('all_dice_liver', tensor(0.8614, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2104, dtype=torch.float64))]), 18452.11366850231)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:12:58,307][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:14:17,809][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:14:17,809][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:14:17,810][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 16:14:17,810][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-12-02 16:14:17,810][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:14:17,811][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9910080997162943
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6531, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7234914449664985
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8474, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1769, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9911362264567453
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6353, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7233595455051379
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8475, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1688, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9911541110985959
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6658, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7234439726552292
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1836, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:24:08,962][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.14115346669951426, OrderedDict([('ind_iou_0', 0.7261652971136258), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1709, dtype=torch.float64)), ('ind_iou_1', 0.9750677650726011), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6147, dtype=torch.float64)), ('all_iou', 0.7507343272368976), ('all_dice_liver', tensor(0.8633, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2176, dtype=torch.float64))]), 19280.644142654724)
Entrei no test
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9912769585011535
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6457, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7261652971136258
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8496, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1709, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Meio do test
Fim do test
[2024-12-02 16:26:46,834][flwr][INFO] - fit progress: (24, 0.14115346669951426, OrderedDict([('ind_iou_0', 0.7261652971136258), ('ind_dice_liver_0', tensor(0.8496, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1709, dtype=torch.float64)), ('ind_iou_1', 0.9750677650726011), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6147, dtype=torch.float64)), ('all_iou', 0.7507343272368976), ('all_dice_liver', tensor(0.8633, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2176, dtype=torch.float64))]), 19280.644142654724)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:26:46,838][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:28:08,071][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:28:08,072][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:28:08,072][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 16:28:08,072][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-12-02 16:28:08,072][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:28:08,072][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9910555502016345
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6362, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7110882642190792
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8381, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1685, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9915448083040268
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6580, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7283550296105011
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8511, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1826, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9917141972544197
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6714, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7159272045827847
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8414, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1684, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:37:52,051][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.145335698921198, OrderedDict([('ind_iou_0', 0.715965063410553), ('ind_dice_liver_0', tensor(0.8416, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1812, dtype=torch.float64)), ('ind_iou_1', 0.9749645790131531), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6046, dtype=torch.float64)), ('all_iou', 0.7415246571227045), ('all_dice_liver', tensor(0.8560, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2261, dtype=torch.float64))]), 20105.274953315966)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9914211632048919
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6329, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.715965063410553
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8416, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1812, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 16:40:31,465][flwr][INFO] - fit progress: (25, 0.145335698921198, OrderedDict([('ind_iou_0', 0.715965063410553), ('ind_dice_liver_0', tensor(0.8416, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1812, dtype=torch.float64)), ('ind_iou_1', 0.9749645790131531), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6046, dtype=torch.float64)), ('all_iou', 0.7415246571227045), ('all_dice_liver', tensor(0.8560, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2261, dtype=torch.float64))]), 20105.274953315966)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:40:31,468][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:41:48,724][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:41:48,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:41:48,724][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 16:41:48,725][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-12-02 16:41:48,725][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:41:48,725][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9914362723406438
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6372, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7261440914567877
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8495, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1896, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9918754224012201
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6490, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7237925630244995
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8480, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1809, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9919024307140036
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6356, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7230651735838696
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8478, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1736, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:51:26,645][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.145688148781294, OrderedDict([('ind_iou_0', 0.7166411077297714), ('ind_dice_liver_0', tensor(0.8424, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1638, dtype=torch.float64)), ('ind_iou_1', 0.9752426309106433), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6110, dtype=torch.float64)), ('all_iou', 0.7421560010601862), ('all_dice_liver', tensor(0.8567, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2107, dtype=torch.float64))]), 20915.62586519867)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9920290896453638
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6967, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7166411077297714
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8424, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1638, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 16:54:01,816][flwr][INFO] - fit progress: (26, 0.145688148781294, OrderedDict([('ind_iou_0', 0.7166411077297714), ('ind_dice_liver_0', tensor(0.8424, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1638, dtype=torch.float64)), ('ind_iou_1', 0.9752426309106433), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6110, dtype=torch.float64)), ('all_iou', 0.7421560010601862), ('all_dice_liver', tensor(0.8567, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2107, dtype=torch.float64))]), 20915.62586519867)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 16:54:01,819][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 16:55:16,710][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 16:55:16,710][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 16:55:16,711][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 16:55:16,711][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-12-02 16:55:16,711][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 16:55:16,712][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9920547627943057
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6543, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7205290076575573
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8460, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1809, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9920636965827907
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6412, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7227479330354513
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8473, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1765, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9920395911278683
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6574, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7230528439370663
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1727, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9921045414711851
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6629, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m 
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7228876470446968
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8471, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1647, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 17:04:54,224][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.1439196403845414, OrderedDict([('ind_iou_0', 0.7228876470446968), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1647, dtype=torch.float64)), ('ind_iou_1', 0.974704673544276), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.7477293069758247), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2106, dtype=torch.float64))]), 21736.062817586586)
Entrei no test
Meio do test
Fim do test
[2024-12-02 17:07:42,252][flwr][INFO] - fit progress: (27, 0.1439196403845414, OrderedDict([('ind_iou_0', 0.7228876470446968), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1647, dtype=torch.float64)), ('ind_iou_1', 0.974704673544276), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.7477293069758247), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2106, dtype=torch.float64))]), 21736.062817586586)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:07:42,256][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:09:01,871][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:09:01,871][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:09:01,871][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 17:09:01,871][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-12-02 17:09:01,871][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:09:01,872][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9921867310117078
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6567, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7197774882496187
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8450, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1829, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9920489216410832
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6463, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.723037057613395
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8474, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1826, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.992273228469385
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6380, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7209700360360409
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8463, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1829, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:18:37,892][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.10407194326926293, OrderedDict([('ind_iou_0', 0.7150969245980148), ('ind_dice_liver_0', tensor(0.8399, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1748, dtype=torch.float64)), ('ind_iou_1', 0.9748310864525674), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6121, dtype=torch.float64)), ('all_iou', 0.7407270313668036), ('all_dice_liver', tensor(0.8544, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2210, dtype=torch.float64))]), 22550.975610208698)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.982985296506399
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6572, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7150969245980148
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8399, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1748, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 17:21:17,165][flwr][INFO] - fit progress: (28, 0.10407194326926293, OrderedDict([('ind_iou_0', 0.7150969245980148), ('ind_dice_liver_0', tensor(0.8399, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1748, dtype=torch.float64)), ('ind_iou_1', 0.9748310864525674), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6121, dtype=torch.float64)), ('all_iou', 0.7407270313668036), ('all_dice_liver', tensor(0.8544, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2210, dtype=torch.float64))]), 22550.975610208698)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:21:17,169][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:22:37,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:22:37,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:22:37,918][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 17:22:37,918][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-12-02 17:22:37,918][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:22:37,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9908682553983145
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6411, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7240286695801955
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8474, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1744, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9919012525112544
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6304, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7238284314148066
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1740, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9922411453741413
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6542, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7254059047396888
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8488, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1768, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:32:07,938][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.13381527420000464, OrderedDict([('ind_iou_0', 0.7251840270681922), ('ind_dice_liver_0', tensor(0.8489, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1764, dtype=torch.float64)), ('ind_iou_1', 0.974930778806632), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6073, dtype=torch.float64)), ('all_iou', 0.7498316317235971), ('all_dice_liver', tensor(0.8626, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2220, dtype=torch.float64))]), 23356.033204157837)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9922401827296425
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6558, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7251840270681922
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8489, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1764, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 17:34:42,223][flwr][INFO] - fit progress: (29, 0.13381527420000464, OrderedDict([('ind_iou_0', 0.7251840270681922), ('ind_dice_liver_0', tensor(0.8489, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1764, dtype=torch.float64)), ('ind_iou_1', 0.974930778806632), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6073, dtype=torch.float64)), ('all_iou', 0.7498316317235971), ('all_dice_liver', tensor(0.8626, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2220, dtype=torch.float64))]), 23356.033204157837)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:34:42,226][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:35:56,245][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:35:56,246][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:35:56,246][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 17:35:56,246][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-12-02 17:35:56,247][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:35:56,247][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9924715662015748
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6685, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7286812220722497
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8513, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1845, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9924384687850879
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6378, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7196195528554966
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8456, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1745, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9922261743889248
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6770, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7263673238606607
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8497, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1844, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:45:32,235][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.13423243710675967, OrderedDict([('ind_iou_0', 0.7251276649787706), ('ind_dice_liver_0', tensor(0.8487, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1767, dtype=torch.float64)), ('ind_iou_1', 0.9749845369549209), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6064, dtype=torch.float64)), ('all_iou', 0.749790806966832), ('all_dice_liver', tensor(0.8624, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2223, dtype=torch.float64))]), 24160.164721524343)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9925621223559727
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6664, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7251276649787706
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8487, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1767, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 17:48:06,354][flwr][INFO] - fit progress: (30, 0.13423243710675967, OrderedDict([('ind_iou_0', 0.7251276649787706), ('ind_dice_liver_0', tensor(0.8487, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1767, dtype=torch.float64)), ('ind_iou_1', 0.9749845369549209), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6064, dtype=torch.float64)), ('all_iou', 0.749790806966832), ('all_dice_liver', tensor(0.8624, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2223, dtype=torch.float64))]), 24160.164721524343)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 17:48:06,358][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:49:25,865][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 17:49:25,865][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 17:49:25,866][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 17:49:25,866][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-12-02 17:49:25,866][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 17:49:25,866][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9928400309729768
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6503, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.725524383402381
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8492, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1897, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9926728093114673
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6361, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7304015751935795
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8525, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1753, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9927504576015573
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6352, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7240143745015827
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8486, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1937, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 17:59:11,887][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.14497658857880835, OrderedDict([('ind_iou_0', 0.7218559494756757), ('ind_dice_liver_0', tensor(0.8465, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1750, dtype=torch.float64)), ('ind_iou_1', 0.975331847743366), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6085, dtype=torch.float64)), ('all_iou', 0.7468716469303294), ('all_dice_liver', tensor(0.8605, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2209, dtype=torch.float64))]), 24980.96465636231)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9927240572555587
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6581, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7218559494756757
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8465, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1750, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 18:01:47,154][flwr][INFO] - fit progress: (31, 0.14497658857880835, OrderedDict([('ind_iou_0', 0.7218559494756757), ('ind_dice_liver_0', tensor(0.8465, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1750, dtype=torch.float64)), ('ind_iou_1', 0.975331847743366), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6085, dtype=torch.float64)), ('all_iou', 0.7468716469303294), ('all_dice_liver', tensor(0.8605, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2209, dtype=torch.float64))]), 24980.96465636231)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:01:47,158][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 18:03:07,239][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:03:07,240][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:03:07,240][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 18:03:07,240][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-12-02 18:03:07,241][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:03:07,241][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9929401367819586
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6684, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7177456916964428
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8435, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1772, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9930230807717123
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6689, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7222743254333087
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8466, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1730, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9930786131424152
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6676, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7230720469400024
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8476, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1763, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9928707254720586
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6391, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7244723153791756
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8483, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1687, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 18:12:44,317][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.1490333661126963, OrderedDict([('ind_iou_0', 0.7244723153791756), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1687, dtype=torch.float64)), ('ind_iou_1', 0.9753367262195519), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7492265490148974), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2154, dtype=torch.float64))]), 25797.642084081657)
Entrei no test
Meio do test
Fim do test
[2024-12-02 18:15:23,832][flwr][INFO] - fit progress: (32, 0.1490333661126963, OrderedDict([('ind_iou_0', 0.7244723153791756), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1687, dtype=torch.float64)), ('ind_iou_1', 0.9753367262195519), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7492265490148974), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2154, dtype=torch.float64))]), 25797.642084081657)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:15:23,835][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 18:16:38,756][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:16:38,757][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:16:38,757][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 18:16:38,757][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-12-02 18:16:38,758][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:16:38,758][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9930258889249454
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6597, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7233063055748931
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8479, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1810, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9933171692084007
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6522, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7240958770287458
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8486, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1918, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9933885860955224
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6412, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.729615613483883
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8525, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1828, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  
[2024-12-02 18:27:25,000][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.15407388924740645, OrderedDict([('ind_iou_0', 0.719385541729906), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1674, dtype=torch.float64)), ('ind_iou_1', 0.9752021171127921), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6144, dtype=torch.float64)), ('all_iou', 0.7446340566078806), ('all_dice_liver', tensor(0.8588, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2143, dtype=torch.float64))]), 26740.803437235765)
[36m(ClientAppActor pid=1057960)[0m 0.9932720736162234
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6655, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.719385541729906
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8447, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1674, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 18:31:06,993][flwr][INFO] - fit progress: (33, 0.15407388924740645, OrderedDict([('ind_iou_0', 0.719385541729906), ('ind_dice_liver_0', tensor(0.8447, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1674, dtype=torch.float64)), ('ind_iou_1', 0.9752021171127921), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6144, dtype=torch.float64)), ('all_iou', 0.7446340566078806), ('all_dice_liver', tensor(0.8588, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2143, dtype=torch.float64))]), 26740.803437235765)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:31:06,997][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 18:32:30,640][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:32:30,641][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:32:30,641][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 18:32:30,642][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-12-02 18:32:30,642][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:32:30,642][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.993318079733669
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6757, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7248012038402679
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8491, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1797, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.993303430002792
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6530, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7166621574267801
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8431, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1678, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9935944889642375
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6542, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7193446533096027
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8457, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1942, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9911805095989742
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6553, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.722000433033335
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8464, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1656, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 18:43:45,241][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.12359339377934758, OrderedDict([('ind_iou_0', 0.722000433033335), ('ind_dice_liver_0', tensor(0.8464, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1656, dtype=torch.float64)), ('ind_iou_1', 0.9750464313811438), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7469834162389144), ('all_dice_liver', tensor(0.8603, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2126, dtype=torch.float64))]), 27676.32599514723)
Entrei no test
Meio do test
Fim do test
[2024-12-02 18:46:42,516][flwr][INFO] - fit progress: (34, 0.12359339377934758, OrderedDict([('ind_iou_0', 0.722000433033335), ('ind_dice_liver_0', tensor(0.8464, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1656, dtype=torch.float64)), ('ind_iou_1', 0.9750464313811438), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7469834162389144), ('all_dice_liver', tensor(0.8603, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2126, dtype=torch.float64))]), 27676.32599514723)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 18:46:42,519][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 18:48:03,654][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 18:48:03,654][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 18:48:03,654][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 18:48:03,655][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-12-02 18:48:03,655][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 18:48:03,655][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.992991612170585
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6779, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7271606055998184
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8506, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1714, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9932872911494678
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6319, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7259067878896014
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8500, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1744, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9934287802459214
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6432, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7278536822245769
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8506, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1688, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 18:57:40,031][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.1513446753040647, OrderedDict([('ind_iou_0', 0.7247695011816836), ('ind_dice_liver_0', tensor(0.8495, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9753209283612883), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6208, dtype=torch.float64)), ('all_iou', 0.7494996712214848), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2341, dtype=torch.float64))]), 28492.9313440891)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9937310383765636
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6812, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7247695011816836
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8495, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1886, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 19:00:19,121][flwr][INFO] - fit progress: (35, 0.1513446753040647, OrderedDict([('ind_iou_0', 0.7247695011816836), ('ind_dice_liver_0', tensor(0.8495, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1886, dtype=torch.float64)), ('ind_iou_1', 0.9753209283612883), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6208, dtype=torch.float64)), ('all_iou', 0.7494996712214848), ('all_dice_liver', tensor(0.8632, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2341, dtype=torch.float64))]), 28492.9313440891)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:00:19,124][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:01:41,386][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:01:41,386][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:01:41,387][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 19:01:41,387][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-12-02 19:01:41,387][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:01:41,388][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9937510096617455
[36m(ClientAppActor pid=1057960)[0m train dice liver:  
[36m(ClientAppActor pid=1057960)[0m tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6705, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7236489168202144
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8489, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1805, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9935194692212476
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6868, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7283029191598577
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8517, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1961, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9936984829510085
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6642, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7270960702875047
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8509, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1697, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9937638070632322
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6835, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7238246357946218
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8483, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1853, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 19:12:26,105][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.1520834437976774, OrderedDict([('ind_iou_0', 0.7238246357946218), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1853, dtype=torch.float64)), ('ind_iou_1', 0.9753277144781742), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7486477461270815), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2304, dtype=torch.float64))]), 29403.277303904295)
Entrei no test
Meio do test
Fim do test
[2024-12-02 19:15:29,467][flwr][INFO] - fit progress: (36, 0.1520834437976774, OrderedDict([('ind_iou_0', 0.7238246357946218), ('ind_dice_liver_0', tensor(0.8483, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1853, dtype=torch.float64)), ('ind_iou_1', 0.9753277144781742), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6116, dtype=torch.float64)), ('all_iou', 0.7486477461270815), ('all_dice_liver', tensor(0.8621, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2304, dtype=torch.float64))]), 29403.277303904295)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:15:29,470][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:16:52,772][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:16:52,773][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:16:52,774][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 19:16:52,774][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-12-02 19:16:52,774][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:16:52,774][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9937747255266981
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6670, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7244961971049293
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8489, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1731, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9939943844905655
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6683, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7238020264539782
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8487, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1797, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9939481771418982
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6644, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7308778010232702
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8529, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1713, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9939437019793524
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6586, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7263629967892827
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8501, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1775, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 19:26:27,925][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.15254300538872398, OrderedDict([('ind_iou_0', 0.7263629967892827), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9751100342387964), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6180, dtype=torch.float64)), ('all_iou', 0.7509109777724438), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2236, dtype=torch.float64))]), 30243.44679978583)
Entrei no test
Meio do test
Fim do test
[2024-12-02 19:29:29,636][flwr][INFO] - fit progress: (37, 0.15254300538872398, OrderedDict([('ind_iou_0', 0.7263629967892827), ('ind_dice_liver_0', tensor(0.8501, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1775, dtype=torch.float64)), ('ind_iou_1', 0.9751100342387964), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6180, dtype=torch.float64)), ('all_iou', 0.7509109777724438), ('all_dice_liver', tensor(0.8637, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2236, dtype=torch.float64))]), 30243.44679978583)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:29:29,640][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:30:47,744][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:30:47,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:30:47,745][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 19:30:47,745][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-12-02 19:30:47,745][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:30:47,746][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.994018060155896
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6532, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7213595689257772
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8467, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1836, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9940244275048942
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6684, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7208943625010967
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8458, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1730, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9940337127540979
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6779, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7255717702264584
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8493, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1729, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9941928204076543
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6533, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7226870228934359
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8471, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1680, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
[2024-12-02 19:40:30,955][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.15611548511943737, OrderedDict([('ind_iou_0', 0.7226870228934359), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1680, dtype=torch.float64)), ('ind_iou_1', 0.9750581862326032), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6096, dtype=torch.float64)), ('all_iou', 0.7475960839987092), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2147, dtype=torch.float64))]), 31053.203277233988)
Entrei no test
Meio do test
Fim do test
[2024-12-02 19:42:59,393][flwr][INFO] - fit progress: (38, 0.15611548511943737, OrderedDict([('ind_iou_0', 0.7226870228934359), ('ind_dice_liver_0', tensor(0.8471, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1680, dtype=torch.float64)), ('ind_iou_1', 0.9750581862326032), ('ind_dice_liver_1', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6096, dtype=torch.float64)), ('all_iou', 0.7475960839987092), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2147, dtype=torch.float64))]), 31053.203277233988)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:42:59,397][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:44:14,831][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:44:14,832][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:44:14,833][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 19:44:14,833][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-12-02 19:44:14,834][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:44:14,834][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9942147015115218
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6682, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.725202061065458
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8493, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1858, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9942266467959885
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6713, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7271836038455993
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8506, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1895, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9941871038658747
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6450, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7246922481157151
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8492, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1877, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:54:53,969][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.1617509433337433, OrderedDict([('ind_iou_0', 0.725677992368557), ('ind_dice_liver_0', tensor(0.8494, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.975357226864584), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6159, dtype=torch.float64)), ('all_iou', 0.7503227118118482), ('all_dice_liver', tensor(0.8631, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2254, dtype=torch.float64))]), 31929.176393420435)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.994238625966623
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6627, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.725677992368557
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8494, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1794, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 19:57:35,366][flwr][INFO] - fit progress: (39, 0.1617509433337433, OrderedDict([('ind_iou_0', 0.725677992368557), ('ind_dice_liver_0', tensor(0.8494, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1794, dtype=torch.float64)), ('ind_iou_1', 0.975357226864584), ('ind_dice_liver_1', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6159, dtype=torch.float64)), ('all_iou', 0.7503227118118482), ('all_dice_liver', tensor(0.8631, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2254, dtype=torch.float64))]), 31929.176393420435)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 19:57:35,369][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 19:58:49,189][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 19:58:49,189][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 19:58:49,189][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 19:58:49,190][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-12-02 19:58:49,190][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-02 19:58:49,190][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  0
[36m(ClientAppActor pid=1057960)[0m train ious:  0.994346964883697
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6818, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7243494139666901
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8484, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1873, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  0
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  1
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9944934328726596
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9965, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6681, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7236782449946322
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8485, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1825, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  1
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1057960)[0m epoch:  2
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9944346963282096
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9965, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6819, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7236459472470186
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8486, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1763, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  2
[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 20:08:45,879][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.17482483374900612, OrderedDict([('ind_iou_0', 0.7220656703344716), ('ind_dice_liver_0', tensor(0.8470, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1740, dtype=torch.float64)), ('ind_iou_1', 0.9755206556225807), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.7470864741444693), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2212, dtype=torch.float64))]), 32754.85919907689)
[36m(ClientAppActor pid=1057960)[0m epoch:  3
[36m(ClientAppActor pid=1057960)[0m train ious:  0.9944779622719767
[36m(ClientAppActor pid=1057960)[0m train dice liver:  tensor(0.9965, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m train dice tumour:  tensor(0.6726, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation ious:  0.7220656703344716
[36m(ClientAppActor pid=1057960)[0m validation dice liver:  tensor(0.8470, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m validation dice tumour:  tensor(0.1740, dtype=torch.float64)
[36m(ClientAppActor pid=1057960)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-02 20:11:21,049][flwr][INFO] - fit progress: (40, 0.17482483374900612, OrderedDict([('ind_iou_0', 0.7220656703344716), ('ind_dice_liver_0', tensor(0.8470, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1740, dtype=torch.float64)), ('ind_iou_1', 0.9755206556225807), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.7470864741444693), ('all_dice_liver', tensor(0.8610, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2212, dtype=torch.float64))]), 32754.85919907689)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-02 20:11:21,052][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1057960)[0m Entrei no validation 1 3
[2024-12-02 20:12:41,986][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-02 20:12:41,987][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1057960, ip=172.18.62.2, actor_id=c32921c3a2f3b37f392e171601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14525836c520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-02 20:12:41,988][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-02 20:12:41,988][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-12-02 20:12:41,988][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 32835.80s
[2024-12-02 20:12:41,988][flwr][INFO] - Run finished 40 round(s) in 32835.80s
[92mINFO [0m:      	History (loss, centralized):
[2024-12-02 20:12:42,118][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.7025126381946659
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 0: 0.7025126381946659
[92mINFO [0m:      		round 1: 0.06533749376143486
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 1: 0.06533749376143486
[92mINFO [0m:      		round 2: 0.061394247736706535
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 2: 0.061394247736706535
[92mINFO [0m:      		round 3: 0.07691254839611181
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 3: 0.07691254839611181
[92mINFO [0m:      		round 4: 0.07207691698444743
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 4: 0.07207691698444743
[92mINFO [0m:      		round 5: 0.06331943691748014
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 5: 0.06331943691748014
[92mINFO [0m:      		round 6: 0.07585824414928234
[2024-12-02 20:12:42,118][flwr][INFO] - 		round 6: 0.07585824414928234
[92mINFO [0m:      		round 7: 0.0897120629245134
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 7: 0.0897120629245134
[92mINFO [0m:      		round 8: 0.10556496886999371
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 8: 0.10556496886999371
[92mINFO [0m:      		round 9: 0.09029007634307468
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 9: 0.09029007634307468
[92mINFO [0m:      		round 10: 0.09569710588180122
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 10: 0.09569710588180122
[92mINFO [0m:      		round 11: 0.09649466932446704
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 11: 0.09649466932446704
[92mINFO [0m:      		round 12: 0.09931049717786222
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 12: 0.09931049717786222
[92mINFO [0m:      		round 13: 0.09290033466388625
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 13: 0.09290033466388625
[92mINFO [0m:      		round 14: 0.10395984017499474
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 14: 0.10395984017499474
[92mINFO [0m:      		round 15: 0.10052120273558514
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 15: 0.10052120273558514
[92mINFO [0m:      		round 16: 0.10332481511397892
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 16: 0.10332481511397892
[92mINFO [0m:      		round 17: 0.10705830874685619
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 17: 0.10705830874685619
[92mINFO [0m:      		round 18: 0.11272720182829456
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 18: 0.11272720182829456
[92mINFO [0m:      		round 19: 0.11003257228885462
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 19: 0.11003257228885462
[92mINFO [0m:      		round 20: 0.12063597879504318
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 20: 0.12063597879504318
[92mINFO [0m:      		round 21: 0.12181818578176325
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 21: 0.12181818578176325
[92mINFO [0m:      		round 22: 0.12501691785296615
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 22: 0.12501691785296615
[92mINFO [0m:      		round 23: 0.12641964560500862
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 23: 0.12641964560500862
[92mINFO [0m:      		round 24: 0.14115346669951426
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 24: 0.14115346669951426
[92mINFO [0m:      		round 25: 0.145335698921198
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 25: 0.145335698921198
[92mINFO [0m:      		round 26: 0.145688148781294
[2024-12-02 20:12:42,119][flwr][INFO] - 		round 26: 0.145688148781294
[92mINFO [0m:      		round 27: 0.1439196403845414
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 27: 0.1439196403845414
[92mINFO [0m:      		round 28: 0.10407194326926293
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 28: 0.10407194326926293
[92mINFO [0m:      		round 29: 0.13381527420000464
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 29: 0.13381527420000464
[92mINFO [0m:      		round 30: 0.13423243710675967
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 30: 0.13423243710675967
[92mINFO [0m:      		round 31: 0.14497658857880835
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 31: 0.14497658857880835
[92mINFO [0m:      		round 32: 0.1490333661126963
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 32: 0.1490333661126963
[92mINFO [0m:      		round 33: 0.15407388924740645
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 33: 0.15407388924740645
[92mINFO [0m:      		round 34: 0.12359339377934758
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 34: 0.12359339377934758
[92mINFO [0m:      		round 35: 0.1513446753040647
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 35: 0.1513446753040647
[92mINFO [0m:      		round 36: 0.1520834437976774
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 36: 0.1520834437976774
[92mINFO [0m:      		round 37: 0.15254300538872398
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 37: 0.15254300538872398
[92mINFO [0m:      		round 38: 0.15611548511943737
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 38: 0.15611548511943737
[92mINFO [0m:      		round 39: 0.1617509433337433
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 39: 0.1617509433337433
[92mINFO [0m:      		round 40: 0.17482483374900612
[2024-12-02 20:12:42,120][flwr][INFO] - 		round 40: 0.17482483374900612
[92mINFO [0m:      	History (metrics, centralized):
[2024-12-02 20:12:42,120][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1539, dtype=torch.float64)),
[2024-12-02 20:12:42,120][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1539, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.8313, dtype=torch.float64)),
[2024-12-02 20:12:42,120][flwr][INFO] - 	                    (1, tensor(0.8313, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.8476, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (2, tensor(0.8476, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.8453, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (3, tensor(0.8453, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.8563, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (4, tensor(0.8563, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.8654, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (5, tensor(0.8654, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.8534, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (6, tensor(0.8534, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.8556, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (7, tensor(0.8556, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.8439, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (8, tensor(0.8439, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.8578, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (9, tensor(0.8578, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.8638, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (10, tensor(0.8638, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.8641, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (11, tensor(0.8641, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.8645, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (12, tensor(0.8645, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.8679, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (13, tensor(0.8679, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.8688, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (14, tensor(0.8688, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.8586, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (15, tensor(0.8586, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.8595, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (16, tensor(0.8595, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.8636, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (17, tensor(0.8636, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.8666, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (18, tensor(0.8666, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.8650, dtype=torch.float64)),
[2024-12-02 20:12:42,121][flwr][INFO] - 	                    (19, tensor(0.8650, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.8637, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (20, tensor(0.8637, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.8635, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (21, tensor(0.8635, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.8632, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (22, tensor(0.8632, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.8614, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (23, tensor(0.8614, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.8633, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (24, tensor(0.8633, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.8560, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (25, tensor(0.8560, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.8567, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (26, tensor(0.8567, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.8610, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (27, tensor(0.8610, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.8544, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (28, tensor(0.8544, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.8626, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (29, tensor(0.8626, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.8624, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (30, tensor(0.8624, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.8605, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (31, tensor(0.8605, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.8621, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (32, tensor(0.8621, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.8588, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (33, tensor(0.8588, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.8603, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (34, tensor(0.8603, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.8632, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (35, tensor(0.8632, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.8621, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (36, tensor(0.8621, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.8637, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (37, tensor(0.8637, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.8610, dtype=torch.float64)),
[2024-12-02 20:12:42,122][flwr][INFO] - 	                    (38, tensor(0.8610, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.8631, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                    (39, tensor(0.8631, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.8610, dtype=torch.float64))],
[2024-12-02 20:12:42,123][flwr][INFO] - 	                    (40, tensor(0.8610, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.1339, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (1, tensor(0.1339, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.1716, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (2, tensor(0.1716, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.1610, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (3, tensor(0.1610, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.2160, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (4, tensor(0.2160, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.1728, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (5, tensor(0.1728, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.1858, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (6, tensor(0.1858, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.2196, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (7, tensor(0.2196, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.1987, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (8, tensor(0.1987, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.2268, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (9, tensor(0.2268, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.2247, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (10, tensor(0.2247, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.2450, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (11, tensor(0.2450, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.2284, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (12, tensor(0.2284, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.2285, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (13, tensor(0.2285, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.2286, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (14, tensor(0.2286, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.2314, dtype=torch.float64)),
[2024-12-02 20:12:42,123][flwr][INFO] - 	                     (15, tensor(0.2314, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.2378, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (16, tensor(0.2378, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.2047, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (17, tensor(0.2047, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.2340, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (18, tensor(0.2340, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.2062, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (19, tensor(0.2062, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.2282, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (20, tensor(0.2282, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.2313, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (21, tensor(0.2313, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.2247, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (22, tensor(0.2247, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.2104, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (23, tensor(0.2104, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.2176, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (24, tensor(0.2176, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.2261, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (25, tensor(0.2261, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.2107, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (26, tensor(0.2107, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.2106, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (27, tensor(0.2106, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.2210, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (28, tensor(0.2210, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.2220, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (29, tensor(0.2220, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.2223, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (30, tensor(0.2223, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.2209, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (31, tensor(0.2209, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.2154, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (32, tensor(0.2154, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.2143, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (33, tensor(0.2143, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.2126, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (34, tensor(0.2126, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.2341, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (35, tensor(0.2341, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.2304, dtype=torch.float64)),
[2024-12-02 20:12:42,124][flwr][INFO] - 	                     (36, tensor(0.2304, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.2236, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (37, tensor(0.2236, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.2147, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (38, tensor(0.2147, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.2254, dtype=torch.float64)),
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (39, tensor(0.2254, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.2212, dtype=torch.float64))],
[2024-12-02 20:12:42,125][flwr][INFO] - 	                     (40, tensor(0.2212, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 0.018069193949506995),
[2024-12-02 20:12:42,125][flwr][INFO] - 	 'all_iou': [(0, 0.018069193949506995),
[92mINFO [0m:      	             (1, 0.727316112938662),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (1, 0.727316112938662),
[92mINFO [0m:      	             (2, 0.7417931011789024),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (2, 0.7417931011789024),
[92mINFO [0m:      	             (3, 0.7339828838071676),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (3, 0.7339828838071676),
[92mINFO [0m:      	             (4, 0.7504383510157522),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (4, 0.7504383510157522),
[92mINFO [0m:      	             (5, 0.7637925635909898),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (5, 0.7637925635909898),
[92mINFO [0m:      	             (6, 0.74626084945478),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (6, 0.74626084945478),
[92mINFO [0m:      	             (7, 0.7463114849414169),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (7, 0.7463114849414169),
[92mINFO [0m:      	             (8, 0.7288425552887139),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (8, 0.7288425552887139),
[92mINFO [0m:      	             (9, 0.7466206317299993),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (9, 0.7466206317299993),
[92mINFO [0m:      	             (10, 0.7557082247861632),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (10, 0.7557082247861632),
[92mINFO [0m:      	             (11, 0.7551510841301642),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (11, 0.7551510841301642),
[92mINFO [0m:      	             (12, 0.7548512285605786),
[2024-12-02 20:12:42,125][flwr][INFO] - 	             (12, 0.7548512285605786),
[92mINFO [0m:      	             (13, 0.7595787382708291),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (13, 0.7595787382708291),
[92mINFO [0m:      	             (14, 0.7606229436488575),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (14, 0.7606229436488575),
[92mINFO [0m:      	             (15, 0.7455866286429177),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (15, 0.7455866286429177),
[92mINFO [0m:      	             (16, 0.748020095222177),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (16, 0.748020095222177),
[92mINFO [0m:      	             (17, 0.7533919837400301),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (17, 0.7533919837400301),
[92mINFO [0m:      	             (18, 0.7556379610584132),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (18, 0.7556379610584132),
[92mINFO [0m:      	             (19, 0.7546480231703984),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (19, 0.7546480231703984),
[92mINFO [0m:      	             (20, 0.751880585438273),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (20, 0.751880585438273),
[92mINFO [0m:      	             (21, 0.7505551985901607),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (21, 0.7505551985901607),
[92mINFO [0m:      	             (22, 0.7514634898345732),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (22, 0.7514634898345732),
[92mINFO [0m:      	             (23, 0.7484836549077853),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (23, 0.7484836549077853),
[92mINFO [0m:      	             (24, 0.7507343272368976),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (24, 0.7507343272368976),
[92mINFO [0m:      	             (25, 0.7415246571227045),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (25, 0.7415246571227045),
[92mINFO [0m:      	             (26, 0.7421560010601862),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (26, 0.7421560010601862),
[92mINFO [0m:      	             (27, 0.7477293069758247),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (27, 0.7477293069758247),
[92mINFO [0m:      	             (28, 0.7407270313668036),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (28, 0.7407270313668036),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (29, 0.7498316317235971),
[92mINFO [0m:      	             (29, 0.7498316317235971),
[92mINFO [0m:      	             (30, 0.749790806966832),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (30, 0.749790806966832),
[92mINFO [0m:      	             (31, 0.7468716469303294),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (31, 0.7468716469303294),
[92mINFO [0m:      	             (32, 0.7492265490148974),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (32, 0.7492265490148974),
[92mINFO [0m:      	             (33, 0.7446340566078806),
[2024-12-02 20:12:42,126][flwr][INFO] - 	             (33, 0.7446340566078806),
[92mINFO [0m:      	             (34, 0.7469834162389144),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (34, 0.7469834162389144),
[92mINFO [0m:      	             (35, 0.7494996712214848),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (35, 0.7494996712214848),
[92mINFO [0m:      	             (36, 0.7486477461270815),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (36, 0.7486477461270815),
[92mINFO [0m:      	             (37, 0.7509109777724438),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (37, 0.7509109777724438),
[92mINFO [0m:      	             (38, 0.7475960839987092),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (38, 0.7475960839987092),
[92mINFO [0m:      	             (39, 0.7503227118118482),
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (39, 0.7503227118118482),
[92mINFO [0m:      	             (40, 0.7470864741444693)],
[2024-12-02 20:12:42,127][flwr][INFO] - 	             (40, 0.7470864741444693)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1541, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1541, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.8179, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (1, tensor(0.8179, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.8350, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (2, tensor(0.8350, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.8313, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (3, tensor(0.8313, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.8431, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (4, tensor(0.8431, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.8533, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (5, tensor(0.8533, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.8398, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (6, tensor(0.8398, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.8418, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (7, tensor(0.8418, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.8287, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (8, tensor(0.8287, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.8439, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (9, tensor(0.8439, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.8506, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (10, tensor(0.8506, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.8509, dtype=torch.float64)),
[2024-12-02 20:12:42,127][flwr][INFO] - 	                      (11, tensor(0.8509, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.8512, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (12, tensor(0.8512, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.8551, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (13, tensor(0.8551, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.8560, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (14, tensor(0.8560, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.8447, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (15, tensor(0.8447, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.8457, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (16, tensor(0.8457, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.8501, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (17, tensor(0.8501, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.8534, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (18, tensor(0.8534, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.8516, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (19, tensor(0.8516, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.8502, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (20, tensor(0.8502, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.8499, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (21, tensor(0.8499, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.8496, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (22, tensor(0.8496, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.8476, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (23, tensor(0.8476, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.8496, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (24, tensor(0.8496, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.8416, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (25, tensor(0.8416, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.8424, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (26, tensor(0.8424, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.8471, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (27, tensor(0.8471, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.8399, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (28, tensor(0.8399, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.8489, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (29, tensor(0.8489, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.8487, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (30, tensor(0.8487, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.8465, dtype=torch.float64)),
[2024-12-02 20:12:42,128][flwr][INFO] - 	                      (31, tensor(0.8465, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.8483, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (32, tensor(0.8483, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.8447, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (33, tensor(0.8447, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.8464, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (34, tensor(0.8464, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.8495, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (35, tensor(0.8495, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.8483, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (36, tensor(0.8483, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.8501, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (37, tensor(0.8501, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.8471, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (38, tensor(0.8471, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.8494, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (39, tensor(0.8494, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.8470, dtype=torch.float64))],
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (40, tensor(0.8470, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1523, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1523, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9538, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (1, tensor(0.9538, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9625, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (2, tensor(0.9625, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9729, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (3, tensor(0.9729, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9766, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (4, tensor(0.9766, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9764, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (5, tensor(0.9764, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9770, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (6, tensor(0.9770, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9817, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (7, tensor(0.9817, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9827, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (8, tensor(0.9827, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9839, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (9, tensor(0.9839, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9842, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (10, tensor(0.9842, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9852, dtype=torch.float64)),
[2024-12-02 20:12:42,129][flwr][INFO] - 	                      (11, tensor(0.9852, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9864, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (12, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9851, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (13, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9862, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (14, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9856, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (15, tensor(0.9856, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9861, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (16, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9869, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (17, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9870, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (18, tensor(0.9870, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9867, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (19, tensor(0.9867, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9872, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (20, tensor(0.9872, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9875, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (21, tensor(0.9875, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9874, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (22, tensor(0.9874, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9874, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (23, tensor(0.9874, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9877, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (24, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9877, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (25, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (26, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9878, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (27, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9869, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (28, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (29, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (30, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9879, dtype=torch.float64)),
[2024-12-02 20:12:42,130][flwr][INFO] - 	                      (31, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (32, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9880, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (33, tensor(0.9880, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9876, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (34, tensor(0.9876, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9882, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (35, tensor(0.9882, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9883, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (36, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (37, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9881, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (38, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9883, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (39, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9884, dtype=torch.float64))],
[2024-12-02 20:12:42,131][flwr][INFO] - 	                      (40, tensor(0.9884, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0086, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0086, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.1117, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (1, tensor(0.1117, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.1377, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (2, tensor(0.1377, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.1225, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (3, tensor(0.1225, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.1780, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (4, tensor(0.1780, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.1326, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (5, tensor(0.1326, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.1447, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (6, tensor(0.1447, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.1775, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (7, tensor(0.1775, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.1529, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (8, tensor(0.1529, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.1838, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (9, tensor(0.1838, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.1814, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (10, tensor(0.1814, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.2031, dtype=torch.float64)),
[2024-12-02 20:12:42,131][flwr][INFO] - 	                       (11, tensor(0.2031, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.1831, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (12, tensor(0.1831, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.1851, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (13, tensor(0.1851, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.1852, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (14, tensor(0.1852, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.1878, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (15, tensor(0.1878, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.1939, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (16, tensor(0.1939, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (17, tensor(0.1582, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (18, tensor(0.1886, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (19, tensor(0.1595, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (20, tensor(0.1828, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (21, tensor(0.1862, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (22, tensor(0.1794, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (23, tensor(0.1639, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (24, tensor(0.1709, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (25, tensor(0.1812, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (26, tensor(0.1638, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (27, tensor(0.1647, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (28, tensor(0.1748, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (29, tensor(0.1764, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (30, tensor(0.1767, dtype=torch.float64)),
[2024-12-02 20:12:42,132][flwr][INFO] - 	                       (31, tensor(0.1750, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (32, tensor(0.1687, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (33, tensor(0.1674, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (34, tensor(0.1656, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (35, tensor(0.1886, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (36, tensor(0.1853, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (37, tensor(0.1775, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (38, tensor(0.1680, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (39, tensor(0.1794, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (40, tensor(0.1740, dtype=torch.float64))],
[2024-12-02 20:12:42,133][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (1, tensor(0.3129, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (2, tensor(0.4492, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (3, tensor(0.4798, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (4, tensor(0.5325, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (5, tensor(0.5092, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (6, tensor(0.5303, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (7, tensor(0.5715, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (8, tensor(0.5772, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (9, tensor(0.5878, dtype=torch.float64)),
[2024-12-02 20:12:42,133][flwr][INFO] - 	                       (10, tensor(0.5883, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (11, tensor(0.5917, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (12, tensor(0.6070, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (13, tensor(0.5923, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.1582, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.1886, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.1595, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.1828, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.1862, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.1794, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.1639, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.1709, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.1812, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.1638, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.1647, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.1748, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.1764, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.1767, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.1750, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.1687, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.1674, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.1656, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.1886, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.1853, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.1775, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.1680, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.1794, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.1740, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.3129, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.4492, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.4798, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.5325, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.5092, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.5303, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.5715, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.5772, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.5878, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.5883, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.5917, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.6070, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.5923, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.5949, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.6006, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.6042, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.6004, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.6186, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.6010, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.6117, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.6136, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (14, tensor(0.5949, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (15, tensor(0.6006, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (16, tensor(0.6042, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (17, tensor(0.6004, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (18, tensor(0.6186, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (19, tensor(0.6010, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (20, tensor(0.6117, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (21, tensor(0.6136, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (22, tensor(0.6100, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (23, tensor(0.6072, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.6100, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.6072, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.6147, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (24, tensor(0.6147, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.6046, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (25, tensor(0.6046, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.6110, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (26, tensor(0.6110, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (27, tensor(0.6000, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.6000, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.6121, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (28, tensor(0.6121, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.6073, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (29, tensor(0.6073, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.6064, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (30, tensor(0.6064, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.6085, dtype=torch.float64)),
[2024-12-02 20:12:42,134][flwr][INFO] - 	                       (31, tensor(0.6085, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (32, tensor(0.6116, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.6144, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (33, tensor(0.6144, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (34, tensor(0.6116, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.6208, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (35, tensor(0.6208, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.6116, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (36, tensor(0.6116, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.6180, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (37, tensor(0.6180, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.6096, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (38, tensor(0.6096, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.6159, dtype=torch.float64)),
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (39, tensor(0.6159, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.6222, dtype=torch.float64))],
[2024-12-02 20:12:42,135][flwr][INFO] - 	                       (40, tensor(0.6222, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 0.01798301739228557),
[2024-12-02 20:12:42,135][flwr][INFO] - 	 'ind_iou_0': [(0, 0.01798301739228557),
[92mINFO [0m:      	               (1, 0.7041531619332229),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (1, 0.7041531619332229),
[92mINFO [0m:      	               (2, 0.7194946885207562),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (2, 0.7194946885207562),
[92mINFO [0m:      	               (3, 0.7094079618685047),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (3, 0.7094079618685047),
[92mINFO [0m:      	               (4, 0.7270871639813715),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (4, 0.7270871639813715),
[92mINFO [0m:      	               (5, 0.7419651041102922),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (5, 0.7419651041102922),
[92mINFO [0m:      	               (6, 0.7224517294530366),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (6, 0.7224517294530366),
[92mINFO [0m:      	               (7, 0.7218763264937371),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (7, 0.7218763264937371),
[92mINFO [0m:      	               (8, 0.7023686250431647),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (8, 0.7023686250431647),
[92mINFO [0m:      	               (9, 0.721936273853132),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (9, 0.721936273853132),
[92mINFO [0m:      	               (10, 0.7320079239608482),
[2024-12-02 20:12:42,135][flwr][INFO] - 	               (10, 0.7320079239608482),
[92mINFO [0m:      	               (11, 0.7312641775839636),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (11, 0.7312641775839636),
[92mINFO [0m:      	               (12, 0.7307315109103913),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (12, 0.7307315109103913),
[92mINFO [0m:      	               (13, 0.7362298969330995),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (13, 0.7362298969330995),
[92mINFO [0m:      	               (14, 0.7372483988966657),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (14, 0.7372483988966657),
[92mINFO [0m:      	               (15, 0.7205718522029123),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (15, 0.7205718522029123),
[92mINFO [0m:      	               (16, 0.7232672097729499),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (16, 0.7232672097729499),
[92mINFO [0m:      	               (17, 0.7291407390627709),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (17, 0.7291407390627709),
[92mINFO [0m:      	               (18, 0.7316116301981007),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (18, 0.7316116301981007),
[92mINFO [0m:      	               (19, 0.7306175085206605),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (19, 0.7306175085206605),
[92mINFO [0m:      	               (20, 0.7274818247053653),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (20, 0.7274818247053653),
[92mINFO [0m:      	               (21, 0.7259691697398462),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (21, 0.7259691697398462),
[92mINFO [0m:      	               (22, 0.7269812776285638),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (22, 0.7269812776285638),
[92mINFO [0m:      	               (23, 0.7237389437328068),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (23, 0.7237389437328068),
[92mINFO [0m:      	               (24, 0.7261652971136258),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (24, 0.7261652971136258),
[92mINFO [0m:      	               (25, 0.715965063410553),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (25, 0.715965063410553),
[92mINFO [0m:      	               (26, 0.7166411077297714),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (26, 0.7166411077297714),
[92mINFO [0m:      	               (27, 0.7228876470446968),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (27, 0.7228876470446968),
[92mINFO [0m:      	               (28, 0.7150969245980148),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (28, 0.7150969245980148),
[92mINFO [0m:      	               (29, 0.7251840270681922),
[2024-12-02 20:12:42,136][flwr][INFO] - 	               (29, 0.7251840270681922),
[92mINFO [0m:      	               (30, 0.7251276649787706),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (30, 0.7251276649787706),
[92mINFO [0m:      	               (31, 0.7218559494756757),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (31, 0.7218559494756757),
[92mINFO [0m:      	               (32, 0.7244723153791756),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (32, 0.7244723153791756),
[92mINFO [0m:      	               (33, 0.719385541729906),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (33, 0.719385541729906),
[92mINFO [0m:      	               (34, 0.722000433033335),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (34, 0.722000433033335),
[92mINFO [0m:      	               (35, 0.7247695011816836),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (35, 0.7247695011816836),
[92mINFO [0m:      	               (36, 0.7238246357946218),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (36, 0.7238246357946218),
[92mINFO [0m:      	               (37, 0.7263629967892827),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (37, 0.7263629967892827),
[92mINFO [0m:      	               (38, 0.7226870228934359),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (38, 0.7226870228934359),
[92mINFO [0m:      	               (39, 0.725677992368557),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (39, 0.725677992368557),
[92mINFO [0m:      	               (40, 0.7220656703344716)],
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (40, 0.7220656703344716)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 0.018857945583812354),
[2024-12-02 20:12:42,137][flwr][INFO] - 	 'ind_iou_1': [(0, 0.018857945583812354),
[92mINFO [0m:      	               (1, 0.9375965819501104),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (1, 0.9375965819501104),
[92mINFO [0m:      	               (2, 0.944296759365001),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (2, 0.944296759365001),
[92mINFO [0m:      	               (3, 0.9580016892356201),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (3, 0.9580016892356201),
[92mINFO [0m:      	               (4, 0.9633678403530899),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (4, 0.9633678403530899),
[92mINFO [0m:      	               (5, 0.9625522077531313),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (5, 0.9625522077531313),
[92mINFO [0m:      	               (6, 0.9633174649826567),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (6, 0.9633174649826567),
[92mINFO [0m:      	               (7, 0.9692948080432837),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (7, 0.9692948080432837),
[92mINFO [0m:      	               (8, 0.9701511841865161),
[2024-12-02 20:12:42,137][flwr][INFO] - 	               (8, 0.9701511841865161),
[92mINFO [0m:      	               (9, 0.9720497372165715),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (9, 0.9720497372165715),
[92mINFO [0m:      	               (10, 0.9719249580257454),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (10, 0.9719249580257454),
[92mINFO [0m:      	               (11, 0.9731929023227956),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (11, 0.9731929023227956),
[92mINFO [0m:      	               (12, 0.9751504991954452),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (12, 0.9751504991954452),
[92mINFO [0m:      	               (13, 0.9727027078988038),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (13, 0.9727027078988038),
[92mINFO [0m:      	               (14, 0.9740743225676086),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (14, 0.9740743225676086),
[92mINFO [0m:      	               (15, 0.9742031996262013),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (15, 0.9742031996262013),
[92mINFO [0m:      	               (16, 0.9740651857748662),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (16, 0.9740651857748662),
[92mINFO [0m:      	               (17, 0.9749448409879337),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (17, 0.9749448409879337),
[92mINFO [0m:      	               (18, 0.9750643659019975),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (18, 0.9750643659019975),
[92mINFO [0m:      	               (19, 0.9743329883733235),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (19, 0.9743329883733235),
[92mINFO [0m:      	               (20, 0.9747492124143237),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (20, 0.9747492124143237),
[92mINFO [0m:      	               (21, 0.9751794542399312),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (21, 0.9751794542399312),
[92mINFO [0m:      	               (22, 0.9750270047811321),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (22, 0.9750270047811321),
[92mINFO [0m:      	               (23, 0.9746424105262835),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (23, 0.9746424105262835),
[92mINFO [0m:      	               (24, 0.9750677650726011),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (24, 0.9750677650726011),
[92mINFO [0m:      	               (25, 0.9749645790131531),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (25, 0.9749645790131531),
[92mINFO [0m:      	               (26, 0.9752426309106433),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (26, 0.9752426309106433),
[92mINFO [0m:      	               (27, 0.974704673544276),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (27, 0.974704673544276),
[92mINFO [0m:      	               (28, 0.9748310864525674),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (28, 0.9748310864525674),
[92mINFO [0m:      	               (29, 0.974930778806632),
[2024-12-02 20:12:42,138][flwr][INFO] - 	               (29, 0.974930778806632),
[92mINFO [0m:      	               (30, 0.9749845369549209),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (30, 0.9749845369549209),
[92mINFO [0m:      	               (31, 0.975331847743366),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (31, 0.975331847743366),
[92mINFO [0m:      	               (32, 0.9753367262195519),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (32, 0.9753367262195519),
[92mINFO [0m:      	               (33, 0.9752021171127921),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (33, 0.9752021171127921),
[92mINFO [0m:      	               (34, 0.9750464313811438),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (34, 0.9750464313811438),
[92mINFO [0m:      	               (35, 0.9753209283612883),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (35, 0.9753209283612883),
[92mINFO [0m:      	               (36, 0.9753277144781742),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (36, 0.9753277144781742),
[92mINFO [0m:      	               (37, 0.9751100342387964),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (37, 0.9751100342387964),
[92mINFO [0m:      	               (38, 0.9750581862326032),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (38, 0.9750581862326032),
[92mINFO [0m:      	               (39, 0.975357226864584),
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (39, 0.975357226864584),
[92mINFO [0m:      	               (40, 0.9755206556225807)]}
[2024-12-02 20:12:42,139][flwr][INFO] - 	               (40, 0.9755206556225807)]}
[92mINFO [0m:      
[2024-12-02 20:12:42,139][flwr][INFO] - 
