/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.res_unet_plus.ResUnetPlusPlus
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 15165
3 3791
3 414
3 4205
cuda:0
[2024-12-06 14:29:57,802][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-12-06 14:29:59,911	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0, 'memory': 859521694720.0, 'node:172.18.62.8': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[2024-12-06 14:30:20,265][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0, 'memory': 859521694720.0, 'node:172.18.62.8': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-06 14:30:20,265][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-06 14:30:20,265][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-06 14:30:20,278][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-12-06 14:30:20,279][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-12-06 14:30:20,280][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-12-06 14:30:23,449][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-12-06 14:30:23,449][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.5985886103899952, OrderedDict([('ind_iou_0', 2.4740422930434125e-06), ('ind_dice_liver_0', tensor(0.1485, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0082, dtype=torch.float64)), ('ind_iou_1', 1.365228672907438e-05), ('ind_dice_liver_1', tensor(0.1468, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0074, dtype=torch.float64)), ('all_iou', 3.5429014830725577e-06), ('all_dice_liver', tensor(0.1483, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0081, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-12-06 14:34:29,849][flwr][INFO] - initial parameters (loss, other metrics): 0.5985886103899952, OrderedDict([('ind_iou_0', 2.4740422930434125e-06), ('ind_dice_liver_0', tensor(0.1485, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0082, dtype=torch.float64)), ('ind_iou_1', 1.365228672907438e-05), ('ind_dice_liver_1', tensor(0.1468, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0074, dtype=torch.float64)), ('all_iou', 3.5429014830725577e-06), ('all_dice_liver', tensor(0.1483, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0081, dtype=torch.float64))])
[92mINFO [0m:      
[2024-12-06 14:34:29,931][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-12-06 14:34:29,932][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 14:34:29,932][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.8192537879843486
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.8421, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.1694, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9075602923744512
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9359, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.3635, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.919131422347625
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9488, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.4301, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9361207458870173
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9590, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.4834, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9367903425501211
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9602, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.5147, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9287078486531078
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9477, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.4529, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9457189980933892
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9658, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.5621, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9454902448352747
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9641, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.5483, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-06 15:41:47,849][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-12-06 15:41:47,891][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.006515936818700306, OrderedDict([('ind_iou_0', 0.9454902448352747), ('ind_dice_liver_0', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5483, dtype=torch.float64)), ('ind_iou_1', 0.9364330953567215), ('ind_dice_liver_1', tensor(0.9583, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4506, dtype=torch.float64)), ('all_iou', 0.9447089926663125), ('all_dice_liver', tensor(0.9636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5416, dtype=torch.float64))]), 4274.1716615715995)
Entrei no test
Meio do test
Fim do test
[2024-12-06 15:45:44,103][flwr][INFO] - fit progress: (1, 0.006515936818700306, OrderedDict([('ind_iou_0', 0.9454902448352747), ('ind_dice_liver_0', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5483, dtype=torch.float64)), ('ind_iou_1', 0.9364330953567215), ('ind_dice_liver_1', tensor(0.9583, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4506, dtype=torch.float64)), ('all_iou', 0.9447089926663125), ('all_dice_liver', tensor(0.9636, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5416, dtype=torch.float64))]), 4274.1716615715995)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 15:45:44,113][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 15:46:52,056][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 15:46:52,057][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 15:46:52,057][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 15:46:52,057][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-12-06 15:46:52,057][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 15:46:52,058][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9491916811898898
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9678, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.5789, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9534559947782638
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9703, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.5951, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9533675879876125
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9705, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6106, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9550902769107391
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9709, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.5920, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9555547683092941
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9720, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6150, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9576065949948045
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6169, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 16:38:35,680][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.004542783957847375, OrderedDict([('ind_iou_0', 0.95992076545512), ('ind_dice_liver_0', tensor(0.9738, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6324, dtype=torch.float64)), ('ind_iou_1', 0.9570659249348098), ('ind_dice_liver_1', tensor(0.9697, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5436, dtype=torch.float64)), ('all_iou', 0.9596553870736655), ('all_dice_liver', tensor(0.9734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6260, dtype=torch.float64))]), 7603.496656024829)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9596669131008443
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9746, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6350, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.95992076545512
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9738, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6324, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 16:41:13,428][flwr][INFO] - fit progress: (2, 0.004542783957847375, OrderedDict([('ind_iou_0', 0.95992076545512), ('ind_dice_liver_0', tensor(0.9738, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6324, dtype=torch.float64)), ('ind_iou_1', 0.9570659249348098), ('ind_dice_liver_1', tensor(0.9697, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5436, dtype=torch.float64)), ('all_iou', 0.9596553870736655), ('all_dice_liver', tensor(0.9734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6260, dtype=torch.float64))]), 7603.496656024829)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 16:41:13,431][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 16:42:22,330][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 16:42:22,330][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 16:42:22,331][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 16:42:22,331][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-12-06 16:42:22,331][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 16:42:22,331][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9608476000965562
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9754, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6417, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9611308039399323
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9751, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6393, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9627368135945352
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9767, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6477, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9642874850860387
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9769, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6505, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9652845374284375
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9782, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6622, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9653732540311775
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9779, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6465, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 17:31:07,963][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.0038253379100324602, OrderedDict([('ind_iou_0', 0.9660292266965136), ('ind_dice_liver_0', tensor(0.9790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6580, dtype=torch.float64)), ('ind_iou_1', 0.9644579211706455), ('ind_dice_liver_1', tensor(0.9767, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5628, dtype=torch.float64)), ('all_iou', 0.9659072714310327), ('all_dice_liver', tensor(0.9788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6512, dtype=torch.float64))]), 10750.750456212088)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9668674336298382
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9793, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6638, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9660292266965136
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9790, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6580, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 17:33:40,682][flwr][INFO] - fit progress: (3, 0.0038253379100324602, OrderedDict([('ind_iou_0', 0.9660292266965136), ('ind_dice_liver_0', tensor(0.9790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6580, dtype=torch.float64)), ('ind_iou_1', 0.9644579211706455), ('ind_dice_liver_1', tensor(0.9767, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5628, dtype=torch.float64)), ('all_iou', 0.9659072714310327), ('all_dice_liver', tensor(0.9788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6512, dtype=torch.float64))]), 10750.750456212088)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 17:33:40,685][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 17:34:48,238][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 17:34:48,238][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 17:34:48,239][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 17:34:48,239][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-12-06 17:34:48,239][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 17:34:48,239][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9681195345107315
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9802, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6734, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9671331438143451
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9792, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6621, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9689306826381834
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9807, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6738, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9659205607554051
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6626, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9703542048468199
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9815, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6835, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9683275769254681
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9807, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6767, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 18:23:34,264][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.003386278392848925, OrderedDict([('ind_iou_0', 0.9695533655348568), ('ind_dice_liver_0', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6779, dtype=torch.float64)), ('ind_iou_1', 0.9696835670861041), ('ind_dice_liver_1', tensor(0.9800, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5855, dtype=torch.float64)), ('all_iou', 0.9695892983599778), ('all_dice_liver', tensor(0.9812, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6713, dtype=torch.float64))]), 13899.118824236095)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9716044126923167
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9824, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6845, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9695533655348568
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6779, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 18:26:09,050][flwr][INFO] - fit progress: (4, 0.003386278392848925, OrderedDict([('ind_iou_0', 0.9695533655348568), ('ind_dice_liver_0', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6779, dtype=torch.float64)), ('ind_iou_1', 0.9696835670861041), ('ind_dice_liver_1', tensor(0.9800, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5855, dtype=torch.float64)), ('all_iou', 0.9695892983599778), ('all_dice_liver', tensor(0.9812, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6713, dtype=torch.float64))]), 13899.118824236095)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 18:26:09,054][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 18:27:17,164][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 18:27:17,164][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 18:27:17,165][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 18:27:17,165][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-12-06 18:27:17,165][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 18:27:17,166][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9719560296760272
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6970, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9699312691996498
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6799, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9718665157887715
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9824, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.6924, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9703839567103146
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6751, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9737317879117592
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9837, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7036, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9704934252309416
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9823, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6815, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 19:16:06,168][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.00328210132444603, OrderedDict([('ind_iou_0', 0.9706108669626013), ('ind_dice_liver_0', tensor(0.9823, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6799, dtype=torch.float64)), ('ind_iou_1', 0.9719631157032752), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5871, dtype=torch.float64)), ('all_iou', 0.9707688675862118), ('all_dice_liver', tensor(0.9822, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6738, dtype=torch.float64))]), 17049.847650198266)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9741847363196192
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7024, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9706108669626013
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9823, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6799, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 19:18:39,779][flwr][INFO] - fit progress: (5, 0.00328210132444603, OrderedDict([('ind_iou_0', 0.9706108669626013), ('ind_dice_liver_0', tensor(0.9823, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6799, dtype=torch.float64)), ('ind_iou_1', 0.9719631157032752), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5871, dtype=torch.float64)), ('all_iou', 0.9707688675862118), ('all_dice_liver', tensor(0.9822, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6738, dtype=torch.float64))]), 17049.847650198266)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 19:18:39,783][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 19:19:46,694][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 19:19:46,694][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 19:19:46,695][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 19:19:46,695][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-12-06 19:19:46,695][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 19:19:46,695][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9749285060884044
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7037, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9711555698749554
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9827, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6912, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9753244507010859
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9847, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7065, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9725258665199678
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9833, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6907, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9763685763579072
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7151, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9725329560389311
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6885, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9768498061758197
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7175, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9727171410860056
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9838, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6955, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-06 20:08:33,602][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.003092431255442386, OrderedDict([('ind_iou_0', 0.9727171410860056), ('ind_dice_liver_0', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6955, dtype=torch.float64)), ('ind_iou_1', 0.9726723388748973), ('ind_dice_liver_1', tensor(0.9826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5990, dtype=torch.float64)), ('all_iou', 0.9727340808641882), ('all_dice_liver', tensor(0.9837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6885, dtype=torch.float64))]), 20198.30798675213)
Entrei no test
Meio do test
Fim do test
[2024-12-06 20:11:08,239][flwr][INFO] - fit progress: (6, 0.003092431255442386, OrderedDict([('ind_iou_0', 0.9727171410860056), ('ind_dice_liver_0', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6955, dtype=torch.float64)), ('ind_iou_1', 0.9726723388748973), ('ind_dice_liver_1', tensor(0.9826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5990, dtype=torch.float64)), ('all_iou', 0.9727340808641882), ('all_dice_liver', tensor(0.9837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6885, dtype=torch.float64))]), 20198.30798675213)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 20:11:08,243][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 20:12:17,040][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 20:12:17,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 20:12:17,042][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 20:12:17,042][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-12-06 20:12:17,042][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 20:12:17,043][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9770137848947578
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7201, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9731891460590552
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9841, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7003, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9775602267124026
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7187, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9736731456268545
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6966, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9776017160220076
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7133, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9744223427771421
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7029, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 21:00:58,033][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0029623138369476326, OrderedDict([('ind_iou_0', 0.9743037021487023), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7058, dtype=torch.float64)), ('ind_iou_1', 0.9761668574626706), ('ind_dice_liver_1', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6167, dtype=torch.float64)), ('all_iou', 0.9745154583346163), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7001, dtype=torch.float64))]), 23341.169243730605)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9785853153468677
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7221, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9743037021487023
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7058, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 21:03:31,101][flwr][INFO] - fit progress: (7, 0.0029623138369476326, OrderedDict([('ind_iou_0', 0.9743037021487023), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7058, dtype=torch.float64)), ('ind_iou_1', 0.9761668574626706), ('ind_dice_liver_1', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6167, dtype=torch.float64)), ('all_iou', 0.9745154583346163), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7001, dtype=torch.float64))]), 23341.169243730605)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 21:03:31,104][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 21:04:38,305][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 21:04:38,306][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 21:04:38,306][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 21:04:38,306][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-12-06 21:04:38,306][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 21:04:38,306][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9786808262794565
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7258, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9749332232576844
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7030, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9793001765961709
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7239, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9749724468437094
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7086, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9794341351050396
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7308, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9729555187417882
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7007, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 21:53:07,463][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.003743882500372747, OrderedDict([('ind_iou_0', 0.9755247023773171), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7099, dtype=torch.float64)), ('ind_iou_1', 0.9774988066479126), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6200, dtype=torch.float64)), ('all_iou', 0.9757239311601605), ('all_dice_liver', tensor(0.9860, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7039, dtype=torch.float64))]), 26470.364127457142)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9789489964336122
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7293, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9755247023773171
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7099, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 21:55:40,295][flwr][INFO] - fit progress: (8, 0.003743882500372747, OrderedDict([('ind_iou_0', 0.9755247023773171), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7099, dtype=torch.float64)), ('ind_iou_1', 0.9774988066479126), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6200, dtype=torch.float64)), ('all_iou', 0.9757239311601605), ('all_dice_liver', tensor(0.9860, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7039, dtype=torch.float64))]), 26470.364127457142)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 21:55:40,299][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 21:56:48,154][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-12-06 21:56:48,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 21:56:48,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 21:56:48,155][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-12-06 21:56:48,155][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 21:56:48,155][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9801369424556389
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7311, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9747910257759154
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7054, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9801987839893126
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7257, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9751382190735164
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7007, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9808403389621122
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7381, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9730708431202406
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6984, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9807628523180786
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7397, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9759608166970313
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7142, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-06 22:45:27,390][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.0027589487033706783, OrderedDict([('ind_iou_0', 0.9759608166970313), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7142, dtype=torch.float64)), ('ind_iou_1', 0.9784240195732182), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6229, dtype=torch.float64)), ('all_iou', 0.9762132838668383), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7085, dtype=torch.float64))]), 29609.564025849104)
Entrei no test
Meio do test
Fim do test
[2024-12-06 22:47:59,495][flwr][INFO] - fit progress: (9, 0.0027589487033706783, OrderedDict([('ind_iou_0', 0.9759608166970313), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7142, dtype=torch.float64)), ('ind_iou_1', 0.9784240195732182), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6229, dtype=torch.float64)), ('all_iou', 0.9762132838668383), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7085, dtype=torch.float64))]), 29609.564025849104)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 22:47:59,499][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 22:49:08,214][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 22:49:08,214][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 22:49:08,215][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 22:49:08,215][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-12-06 22:49:08,215][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 22:49:08,216][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9812650041158028
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7424, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9756686252440726
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7115, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9815896182288598
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7341, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9762572691176359
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7157, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9817220434018327
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7411, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9763221654947369
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7117, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9822190819180433
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7404, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9757961870136389
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7121, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-06 23:37:49,413][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.0027761022886981152, OrderedDict([('ind_iou_0', 0.9757961870136389), ('ind_dice_liver_0', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7121, dtype=torch.float64)), ('ind_iou_1', 0.9784249133721511), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6230, dtype=torch.float64)), ('all_iou', 0.9760647841186957), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7065, dtype=torch.float64))]), 32752.96811099723)
Entrei no test
Meio do test
Fim do test
[2024-12-06 23:40:22,899][flwr][INFO] - fit progress: (10, 0.0027761022886981152, OrderedDict([('ind_iou_0', 0.9757961870136389), ('ind_dice_liver_0', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7121, dtype=torch.float64)), ('ind_iou_1', 0.9784249133721511), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6230, dtype=torch.float64)), ('all_iou', 0.9760647841186957), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7065, dtype=torch.float64))]), 32752.96811099723)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 23:40:22,903][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-06 23:41:31,032][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 23:41:31,032][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 23:41:31,032][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 23:41:31,033][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-12-06 23:41:31,033][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 23:41:31,033][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9813233204590719
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7486, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9743142249254736
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7034, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9828362608827557
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.977227121860332
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7199, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9830251762283012
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7446, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9768936453179146
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7153, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 00:30:13,821][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.0027208725230792687, OrderedDict([('ind_iou_0', 0.9765727632331487), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7181, dtype=torch.float64)), ('ind_iou_1', 0.97917922335383), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6306, dtype=torch.float64)), ('all_iou', 0.9768700987301548), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7129, dtype=torch.float64))]), 35897.30215529539)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9829731577819304
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7452, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9765727632331487
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7181, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 00:32:47,234][flwr][INFO] - fit progress: (11, 0.0027208725230792687, OrderedDict([('ind_iou_0', 0.9765727632331487), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7181, dtype=torch.float64)), ('ind_iou_1', 0.97917922335383), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6306, dtype=torch.float64)), ('all_iou', 0.9768700987301548), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7129, dtype=torch.float64))]), 35897.30215529539)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 00:32:47,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 00:33:56,274][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 00:33:56,274][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 00:33:56,274][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 00:33:56,274][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-12-07 00:33:56,274][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 00:33:56,274][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9831401498867129
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7481, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9767537031635622
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7174, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9832224967571946
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7451, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9772951245607824
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7252, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9834457775169378
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7565, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9769383328692607
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7202, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9838245337563458
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7540, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9772283303190545
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7202, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 01:55:09,102][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.0026659904490806403, OrderedDict([('ind_iou_0', 0.9772283303190545), ('ind_dice_liver_0', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7202, dtype=torch.float64)), ('ind_iou_1', 0.9802178397265098), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6268, dtype=torch.float64)), ('all_iou', 0.9775351606448185), ('all_dice_liver', tensor(0.9873, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 41023.42520035524)
Entrei no test
Meio do test
Fim do test
[2024-12-07 01:58:13,357][flwr][INFO] - fit progress: (12, 0.0026659904490806403, OrderedDict([('ind_iou_0', 0.9772283303190545), ('ind_dice_liver_0', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7202, dtype=torch.float64)), ('ind_iou_1', 0.9802178397265098), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6268, dtype=torch.float64)), ('all_iou', 0.9775351606448185), ('all_dice_liver', tensor(0.9873, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 41023.42520035524)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 01:58:13,360][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 01:59:21,666][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 01:59:21,666][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 01:59:21,667][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 01:59:21,667][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-12-07 01:59:21,667][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 01:59:21,667][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9838919693486305
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7478, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9775695746007053
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7259, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.984100319856187
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7603, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9774308857172183
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7232, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9834825573107034
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7401, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9775888704950335
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7185, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 03:42:52,659][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.002692050085094061, OrderedDict([('ind_iou_0', 0.9775635246919407), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7239, dtype=torch.float64)), ('ind_iou_1', 0.9808919068721229), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6281, dtype=torch.float64)), ('all_iou', 0.9779167073957651), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7181, dtype=torch.float64))]), 47470.795742058195)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9846200719748007
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7549, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9775635246919407
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7239, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 03:45:40,727][flwr][INFO] - fit progress: (13, 0.002692050085094061, OrderedDict([('ind_iou_0', 0.9775635246919407), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7239, dtype=torch.float64)), ('ind_iou_1', 0.9808919068721229), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6281, dtype=torch.float64)), ('all_iou', 0.9779167073957651), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7181, dtype=torch.float64))]), 47470.795742058195)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 03:45:40,731][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 03:46:48,183][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 03:46:48,183][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 03:46:48,184][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 03:46:48,184][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-12-07 03:46:48,184][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 03:46:48,184][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9845473092657823
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7607, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9774821160616035
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7145, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9846076589744802
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7604, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9775864957054082
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7240, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9848193087505048
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7525, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9777964395052073
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7271, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 05:49:46,804][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.002670248093661563, OrderedDict([('ind_iou_0', 0.977727889992489), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7237, dtype=torch.float64)), ('ind_iou_1', 0.981350302711466), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6342, dtype=torch.float64)), ('all_iou', 0.9780978023952315), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7180, dtype=torch.float64))]), 55102.31454323698)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9849708297235217
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7520, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.977727889992489
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7237, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 05:52:52,246][flwr][INFO] - fit progress: (14, 0.002670248093661563, OrderedDict([('ind_iou_0', 0.977727889992489), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7237, dtype=torch.float64)), ('ind_iou_1', 0.981350302711466), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6342, dtype=torch.float64)), ('all_iou', 0.9780978023952315), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7180, dtype=torch.float64))]), 55102.31454323698)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 05:52:52,249][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 05:54:00,832][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 05:54:00,832][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 05:54:00,833][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 05:54:00,833][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-12-07 05:54:00,833][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 05:54:00,833][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9850391164131812
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7571, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9774191392644485
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7195, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9850074876756604
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7582, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9772228183063546
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7183, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9855493229198649
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7631, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9778333430889234
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7273, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 07:41:09,496][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.0026509145685603376, OrderedDict([('ind_iou_0', 0.9781627865393916), ('ind_dice_liver_0', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7290, dtype=torch.float64)), ('ind_iou_1', 0.9820824311422482), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6418, dtype=torch.float64)), ('all_iou', 0.9785602852185126), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 61775.62238966301)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9855544891560516
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7499, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9781627865393916
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7290, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 07:44:05,554][flwr][INFO] - fit progress: (15, 0.0026509145685603376, OrderedDict([('ind_iou_0', 0.9781627865393916), ('ind_dice_liver_0', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7290, dtype=torch.float64)), ('ind_iou_1', 0.9820824311422482), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6418, dtype=torch.float64)), ('all_iou', 0.9785602852185126), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 61775.62238966301)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 07:44:05,557][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 07:45:14,125][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 07:45:14,125][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 07:45:14,126][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 07:45:14,126][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-12-07 07:45:14,126][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 07:45:14,126][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9856197650828642
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7566, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.977984402500272
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7280, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9858622562884793
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7612, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9780779399863302
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7289, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9859102294242594
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7629, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9780670484605483
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7283, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 08:57:05,208][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.0027665300903549498, OrderedDict([('ind_iou_0', 0.9778573106078782), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7309, dtype=torch.float64)), ('ind_iou_1', 0.9816082032900846), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6436, dtype=torch.float64)), ('all_iou', 0.9782469663226757), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7253, dtype=torch.float64))]), 66344.72983278893)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9859493723212831
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7623, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9778573106078782
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7309, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 09:00:14,661][flwr][INFO] - fit progress: (16, 0.0027665300903549498, OrderedDict([('ind_iou_0', 0.9778573106078782), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7309, dtype=torch.float64)), ('ind_iou_1', 0.9816082032900846), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6436, dtype=torch.float64)), ('all_iou', 0.9782469663226757), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7253, dtype=torch.float64))]), 66344.72983278893)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 09:00:14,665][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 09:01:22,155][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 09:01:22,155][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 09:01:22,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 09:01:22,155][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-12-07 09:01:22,155][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 09:01:22,156][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.985992803671884
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7615, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9784886589046529
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7282, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9860119180002989
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7670, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9780867650926479
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7284, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9861684979926623
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7647, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9567640747934003
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9758, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.6654, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9862469107835519
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7635, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9786050378058706
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7285, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 10:25:56,776][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.002657527722059511, OrderedDict([('ind_iou_0', 0.9786050378058706), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7285, dtype=torch.float64)), ('ind_iou_1', 0.982670458207204), ('ind_dice_liver_1', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6405, dtype=torch.float64)), ('all_iou', 0.9790202192190148), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7228, dtype=torch.float64))]), 71661.54598313477)
Entrei no test
Meio do test
Fim do test
[2024-12-07 10:28:51,477][flwr][INFO] - fit progress: (17, 0.002657527722059511, OrderedDict([('ind_iou_0', 0.9786050378058706), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7285, dtype=torch.float64)), ('ind_iou_1', 0.982670458207204), ('ind_dice_liver_1', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6405, dtype=torch.float64)), ('all_iou', 0.9790202192190148), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7228, dtype=torch.float64))]), 71661.54598313477)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 10:28:51,481][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 10:29:59,980][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 10:29:59,980][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 10:29:59,981][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 10:29:59,981][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-12-07 10:29:59,981][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 10:29:59,981][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.986586323590149
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7644, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.97814447466058
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7321, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9864253361042121
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7665, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9784773582378057
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7308, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9867041076761264
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7618, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9786730320661118
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7324, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9867192314126126
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7714, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9784739443537188
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7327, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 11:26:09,293][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.002664060774314639, OrderedDict([('ind_iou_0', 0.9784739443537188), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7327, dtype=torch.float64)), ('ind_iou_1', 0.9827090311587), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6432, dtype=torch.float64)), ('all_iou', 0.9789001887134726), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7269, dtype=torch.float64))]), 75278.13102878164)
Entrei no test
Meio do test
Fim do test
[2024-12-07 11:29:08,062][flwr][INFO] - fit progress: (18, 0.002664060774314639, OrderedDict([('ind_iou_0', 0.9784739443537188), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7327, dtype=torch.float64)), ('ind_iou_1', 0.9827090311587), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6432, dtype=torch.float64)), ('all_iou', 0.9789001887134726), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7269, dtype=torch.float64))]), 75278.13102878164)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 11:29:08,066][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 11:30:17,176][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 11:30:17,176][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 11:30:17,176][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 11:30:17,177][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-12-07 11:30:17,177][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 11:30:17,177][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9868422785471013
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7661, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9784568773678552
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7308, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9869634281191553
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7698, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9786457193158224
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7313, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9868211567474294
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7701, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9786453485109036
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7333, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.987186432512097
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7669, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.97844934473799
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7320, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 12:50:13,044][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.002807504808426116, OrderedDict([('ind_iou_0', 0.97844934473799), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7320, dtype=torch.float64)), ('ind_iou_1', 0.9825954428977627), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9788785868476619), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7273, dtype=torch.float64))]), 80320.18296504859)
Entrei no test
Meio do test
Fim do test
[2024-12-07 12:53:10,114][flwr][INFO] - fit progress: (19, 0.002807504808426116, OrderedDict([('ind_iou_0', 0.97844934473799), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7320, dtype=torch.float64)), ('ind_iou_1', 0.9825954428977627), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9788785868476619), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7273, dtype=torch.float64))]), 80320.18296504859)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 12:53:10,118][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 12:54:18,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 12:54:18,140][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 12:54:18,141][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 12:54:18,141][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-12-07 12:54:18,141][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 12:54:18,141][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9872716727508226
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7711, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9786854483157719
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7334, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9873130867285463
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7770, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9787279792771116
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7347, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9872740826599354
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7664, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9785059554849636
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7312, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9875486295093303
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7699, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9789663994278827
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7354, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 14:16:39,270][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.002668962113345518, OrderedDict([('ind_iou_0', 0.9789663994278827), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7354, dtype=torch.float64)), ('ind_iou_1', 0.98351758765733), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9794348383022707), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7303, dtype=torch.float64))]), 85517.52526586782)
Entrei no test
Meio do test
Fim do test
[2024-12-07 14:19:47,457][flwr][INFO] - fit progress: (20, 0.002668962113345518, OrderedDict([('ind_iou_0', 0.9789663994278827), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7354, dtype=torch.float64)), ('ind_iou_1', 0.98351758765733), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9794348383022707), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7303, dtype=torch.float64))]), 85517.52526586782)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 14:19:47,460][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 14:20:55,408][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 14:20:55,408][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 14:20:55,408][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 14:20:55,409][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-12-07 14:20:55,409][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 14:20:55,409][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9876738594328853
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7714, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9788982061053751
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7341, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9876430888178582
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7699, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.978577456367888
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7321, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9878172675298471
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7760, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9785271616088619
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7359, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9879650903163527
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7760, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790453675322541
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7350, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 15:48:54,683][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.0027130042467715925, OrderedDict([('ind_iou_0', 0.9790453675322541), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7350, dtype=torch.float64)), ('ind_iou_1', 0.9838142078614804), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9795267290080488), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7299, dtype=torch.float64))]), 91041.51878316235)
Entrei no test
Meio do test
Fim do test
[2024-12-07 15:51:51,450][flwr][INFO] - fit progress: (21, 0.0027130042467715925, OrderedDict([('ind_iou_0', 0.9790453675322541), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7350, dtype=torch.float64)), ('ind_iou_1', 0.9838142078614804), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6487, dtype=torch.float64)), ('all_iou', 0.9795267290080488), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7299, dtype=torch.float64))]), 91041.51878316235)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 15:51:51,454][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 15:52:58,505][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 15:52:58,506][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 15:52:58,506][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 15:52:58,507][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-12-07 15:52:58,507][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 15:52:58,507][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9879649771228671
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7761, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790292575777366
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7299, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9880329878811733
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7797, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790170169675363
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7386, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9881977840330164
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7813, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979103812554848
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7338, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 16:42:39,505][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.0027833415095679967, OrderedDict([('ind_iou_0', 0.9790634615414073), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7358, dtype=torch.float64)), ('ind_iou_1', 0.9838418780263609), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6494, dtype=torch.float64)), ('all_iou', 0.9795575630034379), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7308, dtype=torch.float64))]), 94269.13785352744)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9881633621016046
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7727, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790634615414073
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7358, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 16:45:39,069][flwr][INFO] - fit progress: (22, 0.0027833415095679967, OrderedDict([('ind_iou_0', 0.9790634615414073), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7358, dtype=torch.float64)), ('ind_iou_1', 0.9838418780263609), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6494, dtype=torch.float64)), ('all_iou', 0.9795575630034379), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7308, dtype=torch.float64))]), 94269.13785352744)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 16:45:39,073][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 16:46:46,182][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 16:46:46,182][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 16:46:46,182][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 16:46:46,182][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-12-07 16:46:46,183][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 16:46:46,183][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9878754507314699
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7786, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9791969133335144
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7343, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.988639674935958
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7799, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9792003213880413
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7357, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9885624992665096
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7814, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790017121678195
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7311, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9885068529476734
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7765, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9790626269585961
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 17:35:54,350][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.0027550396282174905, OrderedDict([('ind_iou_0', 0.9790626269585961), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7339, dtype=torch.float64)), ('ind_iou_1', 0.9836389842603372), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6466, dtype=torch.float64)), ('all_iou', 0.9795409902585651), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 97444.1142337136)
Entrei no test
Meio do test
Fim do test
[2024-12-07 17:38:34,046][flwr][INFO] - fit progress: (23, 0.0027550396282174905, OrderedDict([('ind_iou_0', 0.9790626269585961), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7339, dtype=torch.float64)), ('ind_iou_1', 0.9836389842603372), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6466, dtype=torch.float64)), ('all_iou', 0.9795409902585651), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 97444.1142337136)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 17:38:34,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 17:39:40,710][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 17:39:40,711][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 17:39:40,711][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 17:39:40,712][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-12-07 17:39:40,712][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 17:39:40,712][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9885780283908575
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7768, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9791077223762734
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7375, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9886713103273241
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7758, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9792161894217714
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7372, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.988716832381388
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7775, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9791406943041228
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7353, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 18:31:22,136][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.002696557874557663, OrderedDict([('ind_iou_0', 0.9789554558684999), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7351, dtype=torch.float64)), ('ind_iou_1', 0.9837265367281732), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6474, dtype=torch.float64)), ('all_iou', 0.97944512305301), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7298, dtype=torch.float64))]), 100770.27486142237)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.988509313410507
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7765, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9789554558684999
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7351, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 18:34:00,206][flwr][INFO] - fit progress: (24, 0.002696557874557663, OrderedDict([('ind_iou_0', 0.9789554558684999), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7351, dtype=torch.float64)), ('ind_iou_1', 0.9837265367281732), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6474, dtype=torch.float64)), ('all_iou', 0.97944512305301), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7298, dtype=torch.float64))]), 100770.27486142237)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 18:34:00,209][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 18:35:06,435][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 18:35:06,436][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 18:35:06,436][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 18:35:06,436][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-12-07 18:35:06,436][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 18:35:06,436][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.988621432433439
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7767, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9789500883845382
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7369, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.988465969355086
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7810, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795001881413463
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7388, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9889775512387459
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7766, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979117657016311
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7393, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 19:29:19,867][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.0027986210968575743, OrderedDict([('ind_iou_0', 0.9794564478593093), ('ind_dice_liver_0', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7390, dtype=torch.float64)), ('ind_iou_1', 0.9843485982633502), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6538, dtype=torch.float64)), ('all_iou', 0.9799637091602493), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7342, dtype=torch.float64))]), 104250.34743163735)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9888590189085766
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7750, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9794564478593093
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7390, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 19:32:00,279][flwr][INFO] - fit progress: (25, 0.0027986210968575743, OrderedDict([('ind_iou_0', 0.9794564478593093), ('ind_dice_liver_0', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7390, dtype=torch.float64)), ('ind_iou_1', 0.9843485982633502), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6538, dtype=torch.float64)), ('all_iou', 0.9799637091602493), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7342, dtype=torch.float64))]), 104250.34743163735)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 19:32:00,282][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 19:33:07,649][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 19:33:07,649][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 19:33:07,650][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 19:33:07,650][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-12-07 19:33:07,650][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 19:33:07,650][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9890341594275397
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7783, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979140499218528
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7392, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9890125164072071
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7757, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9791786788077056
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7356, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9891831069270733
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7737, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795042761555746
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7390, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9892661811872573
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7905, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9793763658892571
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7365, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 20:25:52,807][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.0028066831960660648, OrderedDict([('ind_iou_0', 0.9793763658892571), ('ind_dice_liver_0', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7365, dtype=torch.float64)), ('ind_iou_1', 0.9845516592021007), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.979912619095392), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7317, dtype=torch.float64))]), 107640.66558358539)
Entrei no test
Meio do test
Fim do test
[2024-12-07 20:28:30,597][flwr][INFO] - fit progress: (26, 0.0028066831960660648, OrderedDict([('ind_iou_0', 0.9793763658892571), ('ind_dice_liver_0', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7365, dtype=torch.float64)), ('ind_iou_1', 0.9845516592021007), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.979912619095392), ('all_dice_liver', tensor(0.9896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7317, dtype=torch.float64))]), 107640.66558358539)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 20:28:30,600][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 20:29:37,724][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 20:29:37,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 20:29:37,724][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 20:29:37,724][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-12-07 20:29:37,724][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 20:29:37,725][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9893353731296686
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7801, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9794564787276046
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7367, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9893582759192375
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7771, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795661401421762
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9894195055607672
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7808, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9794979827913303
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7382, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9894262240030862
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7827, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795746855469696
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7372, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-07 21:21:25,156][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.0028665998403545508, OrderedDict([('ind_iou_0', 0.9795746855469696), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.984807142675954), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6552, dtype=torch.float64)), ('all_iou', 0.9801183575041981), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 110974.39365733415)
Entrei no test
Meio do test
Fim do test
[2024-12-07 21:24:04,325][flwr][INFO] - fit progress: (27, 0.0028665998403545508, OrderedDict([('ind_iou_0', 0.9795746855469696), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.984807142675954), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6552, dtype=torch.float64)), ('all_iou', 0.9801183575041981), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 110974.39365733415)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 21:24:04,329][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 21:25:12,540][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 21:25:12,541][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 21:25:12,541][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 21:25:12,541][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-12-07 21:25:12,541][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 21:25:12,541][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9895131301390578
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7774, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9792737635797982
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7376, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9895919629912358
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7839, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9793636141713572
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7364, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9896608809349896
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7769, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9794414746597881
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7386, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 22:16:58,107][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.00290923725769885, OrderedDict([('ind_iou_0', 0.9795404318045612), ('ind_dice_liver_0', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7376, dtype=torch.float64)), ('ind_iou_1', 0.9849503680379583), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.9801005181305682), ('all_dice_liver', tensor(0.9899, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7330, dtype=torch.float64))]), 114304.6990551278)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9897293024968662
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7817, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795404318045612
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7376, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 22:19:34,630][flwr][INFO] - fit progress: (28, 0.00290923725769885, OrderedDict([('ind_iou_0', 0.9795404318045612), ('ind_dice_liver_0', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7376, dtype=torch.float64)), ('ind_iou_1', 0.9849503680379583), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.9801005181305682), ('all_dice_liver', tensor(0.9899, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7330, dtype=torch.float64))]), 114304.6990551278)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 22:19:34,634][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 22:20:41,018][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 22:20:41,018][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 22:20:41,019][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 22:20:41,019][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-12-07 22:20:41,019][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 22:20:41,019][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9897593602160533
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7809, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795485906487243
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7383, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9898602932038864
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9796378929975538
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7394, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9899210067998211
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9793604294943241
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7397, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.989921871703133
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[2024-12-07 23:10:43,520][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.002894408664279634, OrderedDict([('ind_iou_0', 0.9797201328403895), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7389, dtype=torch.float64)), ('ind_iou_1', 0.9851994370959137), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6478, dtype=torch.float64)), ('all_iou', 0.9802878185420908), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7343, dtype=torch.float64))]), 117532.21359448135)
[36m(ClientAppActor pid=1169962)[0m tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7809, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797201328403895
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7389, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-07 23:13:22,145][flwr][INFO] - fit progress: (29, 0.002894408664279634, OrderedDict([('ind_iou_0', 0.9797201328403895), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7389, dtype=torch.float64)), ('ind_iou_1', 0.9851994370959137), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6478, dtype=torch.float64)), ('all_iou', 0.9802878185420908), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7343, dtype=torch.float64))]), 117532.21359448135)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-07 23:13:22,149][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-07 23:14:30,665][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-07 23:14:30,665][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-07 23:14:30,665][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-07 23:14:30,666][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-12-07 23:14:30,666][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-07 23:14:30,666][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9899226520360832
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7836, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797306947666616
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7406, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9900519301794626
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7881, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797290216513322
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9897891500354781
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7842, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979425941168737
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7353, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 00:03:45,950][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.002979754988856029, OrderedDict([('ind_iou_0', 0.9796430157674957), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7398, dtype=torch.float64)), ('ind_iou_1', 0.9853922600985596), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6554, dtype=torch.float64)), ('all_iou', 0.9802307480568904), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7350, dtype=torch.float64))]), 120712.51071073394)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9900972694567562
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7893, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9796430157674957
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7398, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-08 00:06:22,442][flwr][INFO] - fit progress: (30, 0.002979754988856029, OrderedDict([('ind_iou_0', 0.9796430157674957), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7398, dtype=torch.float64)), ('ind_iou_1', 0.9853922600985596), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6554, dtype=torch.float64)), ('all_iou', 0.9802307480568904), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7350, dtype=torch.float64))]), 120712.51071073394)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 00:06:22,445][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 00:07:30,257][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 00:07:30,257][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 00:07:30,258][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 00:07:30,258][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-12-08 00:07:30,258][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 00:07:30,258][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9901099123621057
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7859, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979472321268473
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7395, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9895939209415893
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7811, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798328841703157
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7407, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9904969306455854
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7863, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798476297764639
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7414, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9902814252584357
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7831, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797874817343122
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7413, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 00:56:10,337][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.0028789388858873784, OrderedDict([('ind_iou_0', 0.9797874817343122), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7413, dtype=torch.float64)), ('ind_iou_1', 0.9854124107842427), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6568, dtype=torch.float64)), ('all_iou', 0.9803637261329388), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 123859.67411900032)
Entrei no test
Meio do test
Fim do test
[2024-12-08 00:58:49,605][flwr][INFO] - fit progress: (31, 0.0028789388858873784, OrderedDict([('ind_iou_0', 0.9797874817343122), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7413, dtype=torch.float64)), ('ind_iou_1', 0.9854124107842427), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6568, dtype=torch.float64)), ('all_iou', 0.9803637261329388), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 123859.67411900032)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 00:58:49,609][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 00:59:57,825][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 00:59:57,825][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 00:59:57,825][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 00:59:57,825][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-12-08 00:59:57,825][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 00:59:57,826][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9902204557480317
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7807, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797702255132456
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7413, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9904720017571599
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797514607147723
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7411, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9904301596969582
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7922, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795687887861372
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7411, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9904645651960745
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7887, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979656398800786
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7396, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 01:48:43,766][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.00295647671651073, OrderedDict([('ind_iou_0', 0.979656398800786), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7396, dtype=torch.float64)), ('ind_iou_1', 0.9851205092076245), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9802267698290927), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7351, dtype=torch.float64))]), 127011.47097146697)
Entrei no test
Meio do test
Fim do test
[2024-12-08 01:51:21,402][flwr][INFO] - fit progress: (32, 0.00295647671651073, OrderedDict([('ind_iou_0', 0.979656398800786), ('ind_dice_liver_0', tensor(0.9898, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7396, dtype=torch.float64)), ('ind_iou_1', 0.9851205092076245), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9802267698290927), ('all_dice_liver', tensor(0.9900, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7351, dtype=torch.float64))]), 127011.47097146697)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 01:51:21,406][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 01:52:29,459][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 01:52:29,459][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 01:52:29,460][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 01:52:29,461][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-12-08 01:52:29,461][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 01:52:29,461][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9905132598084387
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7814, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797993389477091
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9905480768480632
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7892, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9795489482704706
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7419, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9905462455907316
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7887, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798219408173892
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7404, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 02:41:21,632][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.003039774254455002, OrderedDict([('ind_iou_0', 0.9797891259747098), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7432, dtype=torch.float64)), ('ind_iou_1', 0.985465678610635), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9803753548903253), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7384, dtype=torch.float64))]), 130170.23668911867)
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9906282450245921
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7911, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797891259747098
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7432, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-08 02:44:00,168][flwr][INFO] - fit progress: (33, 0.003039774254455002, OrderedDict([('ind_iou_0', 0.9797891259747098), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7432, dtype=torch.float64)), ('ind_iou_1', 0.985465678610635), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9803753548903253), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7384, dtype=torch.float64))]), 130170.23668911867)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 02:44:00,172][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 02:45:07,857][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 02:45:07,857][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 02:45:07,858][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 02:45:07,858][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-12-08 02:45:07,858][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 02:45:07,858][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9907123307224607
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7876, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9796771861831527
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7398, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9906331533986329
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7852, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799505962462485
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9907311805523309
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7986, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799363650152307
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7431, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9907675027398888
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7993, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797882753908774
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7402, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 03:35:11,456][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.0029834910009087336, OrderedDict([('ind_iou_0', 0.9797882753908774), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7402, dtype=torch.float64)), ('ind_iou_1', 0.9854698693284877), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6534, dtype=torch.float64)), ('all_iou', 0.9803754467204353), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7359, dtype=torch.float64))]), 133400.89583543688)
Entrei no test
Meio do test
Fim do test
[2024-12-08 03:37:50,827][flwr][INFO] - fit progress: (34, 0.0029834910009087336, OrderedDict([('ind_iou_0', 0.9797882753908774), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7402, dtype=torch.float64)), ('ind_iou_1', 0.9854698693284877), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6534, dtype=torch.float64)), ('all_iou', 0.9803754467204353), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7359, dtype=torch.float64))]), 133400.89583543688)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 03:37:50,831][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 03:38:59,776][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 03:38:59,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 03:38:59,777][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 03:38:59,777][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-12-08 03:38:59,777][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 03:38:59,777][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9908617100585109
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7878, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798147686965988
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7417, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9908905201608484
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7897, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797990717018159
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7414, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9908525533575466
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7924, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798938186880614
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7416, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9909011641928736
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[2024-12-08 04:28:28,301][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.0030116278926236167, OrderedDict([('ind_iou_0', 0.9798289181488224), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7433, dtype=torch.float64)), ('ind_iou_1', 0.9855443333959065), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6573, dtype=torch.float64)), ('all_iou', 0.9804259809878312), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7390, dtype=torch.float64))]), 136597.34637936577)
[36m(ClientAppActor pid=1169962)[0m tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7929, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798289181488224
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7433, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-08 04:31:07,278][flwr][INFO] - fit progress: (35, 0.0030116278926236167, OrderedDict([('ind_iou_0', 0.9798289181488224), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7433, dtype=torch.float64)), ('ind_iou_1', 0.9855443333959065), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6573, dtype=torch.float64)), ('all_iou', 0.9804259809878312), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7390, dtype=torch.float64))]), 136597.34637936577)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 04:31:07,281][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 04:32:13,791][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 04:32:13,791][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 04:32:13,792][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 04:32:13,792][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-12-08 04:32:13,792][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 04:32:13,792][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9909783432926142
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7849, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798298138181462
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7421, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9909858820454805
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7911, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799713759613926
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7404, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9910695969706399
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7919, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799210122928371
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7426, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9910860248175998
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7903, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798462580624995
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7409, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 05:21:12,951][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.0030641575809845015, OrderedDict([('ind_iou_0', 0.9798462580624995), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7409, dtype=torch.float64)), ('ind_iou_1', 0.9857164943315954), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6589, dtype=torch.float64)), ('all_iou', 0.9804519074037951), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 139759.47539061215)
Entrei no test
Meio do test
Fim do test
[2024-12-08 05:23:49,407][flwr][INFO] - fit progress: (36, 0.0030641575809845015, OrderedDict([('ind_iou_0', 0.9798462580624995), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7409, dtype=torch.float64)), ('ind_iou_1', 0.9857164943315954), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6589, dtype=torch.float64)), ('all_iou', 0.9804519074037951), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7370, dtype=torch.float64))]), 139759.47539061215)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 05:23:49,410][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 05:24:57,117][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 05:24:57,118][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 05:24:57,118][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 05:24:57,118][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-12-08 05:24:57,118][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 05:24:57,118][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9911257783633646
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7880, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799520576686256
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7408, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912046802267885
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7906, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799705525331445
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7422, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912194414675577
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7953, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798247181154122
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7441, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912232484915846
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7932, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.979842656219177
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7425, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 06:13:50,269][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.003092004302817128, OrderedDict([('ind_iou_0', 0.979842656219177), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.9858599004004814), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9804579069346965), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7381, dtype=torch.float64))]), 142923.26499840152)
Entrei no test
Meio do test
Fim do test
[2024-12-08 06:16:33,196][flwr][INFO] - fit progress: (37, 0.003092004302817128, OrderedDict([('ind_iou_0', 0.979842656219177), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.9858599004004814), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9804579069346965), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7381, dtype=torch.float64))]), 142923.26499840152)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 06:16:33,200][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 06:17:39,748][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 06:17:39,748][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 06:17:39,748][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 06:17:39,748][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-12-08 06:17:39,749][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 06:17:39,749][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.991267704694135
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.8011, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.97967020604937
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7415, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912976670803685
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7913, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797706327417528
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7421, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9913381237081406
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7847, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799850107591591
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7429, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912446160415341
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7939, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800795344352587
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7441, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 07:06:21,012][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.003045855645327325, OrderedDict([('ind_iou_0', 0.9800795344352587), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7441, dtype=torch.float64)), ('ind_iou_1', 0.9863379229269827), ('ind_dice_liver_1', tensor(0.9924, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9807149252391373), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7400, dtype=torch.float64))]), 146069.97475559078)
Entrei no test
Meio do test
Fim do test
[2024-12-08 07:08:59,906][flwr][INFO] - fit progress: (38, 0.003045855645327325, OrderedDict([('ind_iou_0', 0.9800795344352587), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7441, dtype=torch.float64)), ('ind_iou_1', 0.9863379229269827), ('ind_dice_liver_1', tensor(0.9924, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6610, dtype=torch.float64)), ('all_iou', 0.9807149252391373), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7400, dtype=torch.float64))]), 146069.97475559078)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 07:08:59,910][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 07:10:07,907][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 07:10:07,907][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 07:10:07,907][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 07:10:07,908][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-12-08 07:10:07,908][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 07:10:07,908][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.991275027191784
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7863, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9798578950718808
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7448, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9912560679037156
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7991, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800067364973882
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7419, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.99142025912816
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7863, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9799742155398015
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9914653456164114
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7933, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800059208989179
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7406, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 07:58:49,211][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.0031410919373919223, OrderedDict([('ind_iou_0', 0.9800059208989179), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7406, dtype=torch.float64)), ('ind_iou_1', 0.9861322037831943), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6604, dtype=torch.float64)), ('all_iou', 0.9806324348295402), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7366, dtype=torch.float64))]), 149219.9221066255)
Entrei no test
Meio do test
Fim do test
[2024-12-08 08:01:29,853][flwr][INFO] - fit progress: (39, 0.0031410919373919223, OrderedDict([('ind_iou_0', 0.9800059208989179), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7406, dtype=torch.float64)), ('ind_iou_1', 0.9861322037831943), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6604, dtype=torch.float64)), ('all_iou', 0.9806324348295402), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7366, dtype=torch.float64))]), 149219.9221066255)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 08:01:29,857][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 08:02:36,327][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 08:02:36,327][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 08:02:36,327][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 08:02:36,328][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-12-08 08:02:36,328][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-08 08:02:36,328][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  0
[36m(ClientAppActor pid=1169962)[0m train ious:  0.99141913922342
[36m(ClientAppActor pid=1169962)[0m train dice liver:  
[36m(ClientAppActor pid=1169962)[0m tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7896, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9797853176955381
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7403, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  0
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  1
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9911372849884875
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7900, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800297171292822
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7434, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  1
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  2
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9917573683426734
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7935, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800150319756136
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7425, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  2
[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1169962)[0m epoch:  3
[36m(ClientAppActor pid=1169962)[0m train ious:  0.9916292690149738
[36m(ClientAppActor pid=1169962)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m train dice tumour:  tensor(0.7940, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation ious:  0.9800636531130459
[36m(ClientAppActor pid=1169962)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m validation dice tumour:  tensor(0.7426, dtype=torch.float64)
[36m(ClientAppActor pid=1169962)[0m => new best model:  3
[2024-12-08 08:51:36,817][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.003119647732850576, OrderedDict([('ind_iou_0', 0.9800636531130459), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7426, dtype=torch.float64)), ('ind_iou_1', 0.9864739679748924), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6612, dtype=torch.float64)), ('all_iou', 0.9807121977125179), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7388, dtype=torch.float64))]), 152388.9916230878)
Entrei no test
Meio do test
Fim do test
[2024-12-08 08:54:18,923][flwr][INFO] - fit progress: (40, 0.003119647732850576, OrderedDict([('ind_iou_0', 0.9800636531130459), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7426, dtype=torch.float64)), ('ind_iou_1', 0.9864739679748924), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6612, dtype=torch.float64)), ('all_iou', 0.9807121977125179), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7388, dtype=torch.float64))]), 152388.9916230878)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-08 08:54:18,926][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1169962)[0m Entrei no validation 1 3
[2024-12-08 08:55:26,575][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-08 08:55:26,575][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1169962, ip=172.18.62.8, actor_id=50b62edafb160d58a659925701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1518a0eea430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-08 08:55:26,576][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-08 08:55:26,576][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-12-08 08:55:26,576][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 152456.64s
[2024-12-08 08:55:26,577][flwr][INFO] - Run finished 40 round(s) in 152456.64s
[92mINFO [0m:      	History (loss, centralized):
[2024-12-08 08:55:26,698][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.5985886103899952
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 0: 0.5985886103899952
[92mINFO [0m:      		round 1: 0.006515936818700306
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 1: 0.006515936818700306
[92mINFO [0m:      		round 2: 0.004542783957847375
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 2: 0.004542783957847375
[92mINFO [0m:      		round 3: 0.0038253379100324602
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 3: 0.0038253379100324602
[92mINFO [0m:      		round 4: 0.003386278392848925
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 4: 0.003386278392848925
[92mINFO [0m:      		round 5: 0.00328210132444603
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 5: 0.00328210132444603
[92mINFO [0m:      		round 6: 0.003092431255442386
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 6: 0.003092431255442386
[92mINFO [0m:      		round 7: 0.0029623138369476326
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 7: 0.0029623138369476326
[92mINFO [0m:      		round 8: 0.003743882500372747
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 8: 0.003743882500372747
[92mINFO [0m:      		round 9: 0.0027589487033706783
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 9: 0.0027589487033706783
[92mINFO [0m:      		round 10: 0.0027761022886981152
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 10: 0.0027761022886981152
[92mINFO [0m:      		round 11: 0.0027208725230792687
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 11: 0.0027208725230792687
[92mINFO [0m:      		round 12: 0.0026659904490806403
[2024-12-08 08:55:26,698][flwr][INFO] - 		round 12: 0.0026659904490806403
[92mINFO [0m:      		round 13: 0.002692050085094061
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 13: 0.002692050085094061
[92mINFO [0m:      		round 14: 0.002670248093661563
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 14: 0.002670248093661563
[92mINFO [0m:      		round 15: 0.0026509145685603376
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 15: 0.0026509145685603376
[92mINFO [0m:      		round 16: 0.0027665300903549498
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 16: 0.0027665300903549498
[92mINFO [0m:      		round 17: 0.002657527722059511
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 17: 0.002657527722059511
[92mINFO [0m:      		round 18: 0.002664060774314639
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 18: 0.002664060774314639
[92mINFO [0m:      		round 19: 0.002807504808426116
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 19: 0.002807504808426116
[92mINFO [0m:      		round 20: 0.002668962113345518
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 20: 0.002668962113345518
[92mINFO [0m:      		round 21: 0.0027130042467715925
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 21: 0.0027130042467715925
[92mINFO [0m:      		round 22: 0.0027833415095679967
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 22: 0.0027833415095679967
[92mINFO [0m:      		round 23: 0.0027550396282174905
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 23: 0.0027550396282174905
[92mINFO [0m:      		round 24: 0.002696557874557663
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 24: 0.002696557874557663
[92mINFO [0m:      		round 25: 0.0027986210968575743
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 25: 0.0027986210968575743
[92mINFO [0m:      		round 26: 0.0028066831960660648
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 26: 0.0028066831960660648
[92mINFO [0m:      		round 27: 0.0028665998403545508
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 27: 0.0028665998403545508
[92mINFO [0m:      		round 28: 0.00290923725769885
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 28: 0.00290923725769885
[92mINFO [0m:      		round 29: 0.002894408664279634
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 29: 0.002894408664279634
[92mINFO [0m:      		round 30: 0.002979754988856029
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 30: 0.002979754988856029
[92mINFO [0m:      		round 31: 0.0028789388858873784
[2024-12-08 08:55:26,699][flwr][INFO] - 		round 31: 0.0028789388858873784
[92mINFO [0m:      		round 32: 0.00295647671651073
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 32: 0.00295647671651073
[92mINFO [0m:      		round 33: 0.003039774254455002
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 33: 0.003039774254455002
[92mINFO [0m:      		round 34: 0.0029834910009087336
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 34: 0.0029834910009087336
[92mINFO [0m:      		round 35: 0.0030116278926236167
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 35: 0.0030116278926236167
[92mINFO [0m:      		round 36: 0.0030641575809845015
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 36: 0.0030641575809845015
[92mINFO [0m:      		round 37: 0.003092004302817128
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 37: 0.003092004302817128
[92mINFO [0m:      		round 38: 0.003045855645327325
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 38: 0.003045855645327325
[92mINFO [0m:      		round 39: 0.0031410919373919223
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 39: 0.0031410919373919223
[92mINFO [0m:      		round 40: 0.003119647732850576
[2024-12-08 08:55:26,700][flwr][INFO] - 		round 40: 0.003119647732850576
[92mINFO [0m:      	History (metrics, centralized):
[2024-12-08 08:55:26,700][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1483, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1483, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.9636, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (1, tensor(0.9636, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.9734, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (2, tensor(0.9734, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.9788, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (3, tensor(0.9788, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.9812, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (4, tensor(0.9812, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.9822, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (5, tensor(0.9822, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.9837, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (6, tensor(0.9837, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.9851, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (7, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (8, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.9864, dtype=torch.float64)),
[2024-12-08 08:55:26,700][flwr][INFO] - 	                    (9, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.9865, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (10, tensor(0.9865, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.9869, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (11, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (12, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.9878, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (13, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.9878, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (14, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.9883, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (15, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (16, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.9886, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (17, tensor(0.9886, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.9886, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (18, tensor(0.9886, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (19, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (20, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (21, tensor(0.9891, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.9893, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (22, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.9893, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (23, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.9890, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (24, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (25, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (26, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (27, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (28, tensor(0.9899, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,701][flwr][INFO] - 	                    (29, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (30, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (31, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (32, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (33, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (34, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (35, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.9903, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (36, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.9903, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (37, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.9904, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (38, tensor(0.9904, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.9905, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (39, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.9905, dtype=torch.float64))],
[2024-12-08 08:55:26,702][flwr][INFO] - 	                    (40, tensor(0.9905, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0081, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0081, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.5416, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (1, tensor(0.5416, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.6260, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (2, tensor(0.6260, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.6512, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (3, tensor(0.6512, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.6713, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (4, tensor(0.6713, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.6738, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (5, tensor(0.6738, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.6885, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (6, tensor(0.6885, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.7001, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (7, tensor(0.7001, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.7039, dtype=torch.float64)),
[2024-12-08 08:55:26,702][flwr][INFO] - 	                     (8, tensor(0.7039, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.7085, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (9, tensor(0.7085, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.7065, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (10, tensor(0.7065, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.7129, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (11, tensor(0.7129, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.7139, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (12, tensor(0.7139, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.7181, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (13, tensor(0.7181, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.7180, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (14, tensor(0.7180, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.7237, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (15, tensor(0.7237, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.7253, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (16, tensor(0.7253, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.7228, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (17, tensor(0.7228, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.7269, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (18, tensor(0.7269, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.7273, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (19, tensor(0.7273, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.7303, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (20, tensor(0.7303, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.7299, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (21, tensor(0.7299, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.7308, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (22, tensor(0.7308, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.7283, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (23, tensor(0.7283, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.7298, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (24, tensor(0.7298, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.7342, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (25, tensor(0.7342, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.7317, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (26, tensor(0.7317, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.7325, dtype=torch.float64)),
[2024-12-08 08:55:26,703][flwr][INFO] - 	                     (27, tensor(0.7325, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.7330, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (28, tensor(0.7330, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.7343, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (29, tensor(0.7343, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.7350, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (30, tensor(0.7350, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.7370, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (31, tensor(0.7370, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.7351, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (32, tensor(0.7351, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.7384, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (33, tensor(0.7384, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.7359, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (34, tensor(0.7359, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.7390, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (35, tensor(0.7390, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.7370, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (36, tensor(0.7370, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.7381, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (37, tensor(0.7381, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.7400, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (38, tensor(0.7400, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.7366, dtype=torch.float64)),
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (39, tensor(0.7366, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.7388, dtype=torch.float64))],
[2024-12-08 08:55:26,704][flwr][INFO] - 	                     (40, tensor(0.7388, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 3.5429014830725577e-06),
[2024-12-08 08:55:26,704][flwr][INFO] - 	 'all_iou': [(0, 3.5429014830725577e-06),
[92mINFO [0m:      	             (1, 0.9447089926663125),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (1, 0.9447089926663125),
[92mINFO [0m:      	             (2, 0.9596553870736655),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (2, 0.9596553870736655),
[92mINFO [0m:      	             (3, 0.9659072714310327),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (3, 0.9659072714310327),
[92mINFO [0m:      	             (4, 0.9695892983599778),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (4, 0.9695892983599778),
[92mINFO [0m:      	             (5, 0.9707688675862118),
[2024-12-08 08:55:26,704][flwr][INFO] - 	             (5, 0.9707688675862118),
[92mINFO [0m:      	             (6, 0.9727340808641882),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (6, 0.9727340808641882),
[92mINFO [0m:      	             (7, 0.9745154583346163),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (7, 0.9745154583346163),
[92mINFO [0m:      	             (8, 0.9757239311601605),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (8, 0.9757239311601605),
[92mINFO [0m:      	             (9, 0.9762132838668383),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (9, 0.9762132838668383),
[92mINFO [0m:      	             (10, 0.9760647841186957),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (10, 0.9760647841186957),
[92mINFO [0m:      	             (11, 0.9768700987301548),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (11, 0.9768700987301548),
[92mINFO [0m:      	             (12, 0.9775351606448185),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (12, 0.9775351606448185),
[92mINFO [0m:      	             (13, 0.9779167073957651),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (13, 0.9779167073957651),
[92mINFO [0m:      	             (14, 0.9780978023952315),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (14, 0.9780978023952315),
[92mINFO [0m:      	             (15, 0.9785602852185126),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (15, 0.9785602852185126),
[92mINFO [0m:      	             (16, 0.9782469663226757),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (16, 0.9782469663226757),
[92mINFO [0m:      	             (17, 0.9790202192190148),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (17, 0.9790202192190148),
[92mINFO [0m:      	             (18, 0.9789001887134726),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (18, 0.9789001887134726),
[92mINFO [0m:      	             (19, 0.9788785868476619),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (19, 0.9788785868476619),
[92mINFO [0m:      	             (20, 0.9794348383022707),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (20, 0.9794348383022707),
[92mINFO [0m:      	             (21, 0.9795267290080488),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (21, 0.9795267290080488),
[92mINFO [0m:      	             (22, 0.9795575630034379),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (22, 0.9795575630034379),
[92mINFO [0m:      	             (23, 0.9795409902585651),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (23, 0.9795409902585651),
[92mINFO [0m:      	             (24, 0.97944512305301),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (24, 0.97944512305301),
[92mINFO [0m:      	             (25, 0.9799637091602493),
[2024-12-08 08:55:26,705][flwr][INFO] - 	             (25, 0.9799637091602493),
[92mINFO [0m:      	             (26, 0.979912619095392),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (26, 0.979912619095392),
[92mINFO [0m:      	             (27, 0.9801183575041981),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (27, 0.9801183575041981),
[92mINFO [0m:      	             (28, 0.9801005181305682),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (28, 0.9801005181305682),
[92mINFO [0m:      	             (29, 0.9802878185420908),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (29, 0.9802878185420908),
[92mINFO [0m:      	             (30, 0.9802307480568904),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (30, 0.9802307480568904),
[92mINFO [0m:      	             (31, 0.9803637261329388),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (31, 0.9803637261329388),
[92mINFO [0m:      	             (32, 0.9802267698290927),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (32, 0.9802267698290927),
[92mINFO [0m:      	             (33, 0.9803753548903253),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (33, 0.9803753548903253),
[92mINFO [0m:      	             (34, 0.9803754467204353),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (34, 0.9803754467204353),
[92mINFO [0m:      	             (35, 0.9804259809878312),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (35, 0.9804259809878312),
[92mINFO [0m:      	             (36, 0.9804519074037951),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (36, 0.9804519074037951),
[92mINFO [0m:      	             (37, 0.9804579069346965),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (37, 0.9804579069346965),
[92mINFO [0m:      	             (38, 0.9807149252391373),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (38, 0.9807149252391373),
[92mINFO [0m:      	             (39, 0.9806324348295402),
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (39, 0.9806324348295402),
[92mINFO [0m:      	             (40, 0.9807121977125179)],
[2024-12-08 08:55:26,706][flwr][INFO] - 	             (40, 0.9807121977125179)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1485, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1485, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9641, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (1, tensor(0.9641, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9738, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (2, tensor(0.9738, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9790, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (3, tensor(0.9790, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9813, dtype=torch.float64)),
[2024-12-08 08:55:26,706][flwr][INFO] - 	                      (4, tensor(0.9813, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9823, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (5, tensor(0.9823, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9838, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (6, tensor(0.9838, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9851, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (7, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (8, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9863, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (9, tensor(0.9863, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9864, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (10, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9869, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (11, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (12, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9877, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (13, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9877, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (14, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9881, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (15, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9883, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (16, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (17, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9884, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (18, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9887, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (19, tensor(0.9887, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9888, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (20, tensor(0.9888, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9890, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (21, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (22, tensor(0.9891, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9891, dtype=torch.float64)),
[2024-12-08 08:55:26,707][flwr][INFO] - 	                      (23, tensor(0.9891, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9889, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (24, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9895, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (25, tensor(0.9895, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9894, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (26, tensor(0.9894, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (27, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9897, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (28, tensor(0.9897, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (29, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (30, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (31, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9898, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (32, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (33, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (34, tensor(0.9899, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (35, tensor(0.9899, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (36, tensor(0.9901, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (37, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9901, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (38, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (39, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9902, dtype=torch.float64))],
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (40, tensor(0.9902, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1468, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1468, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9583, dtype=torch.float64)),
[2024-12-08 08:55:26,708][flwr][INFO] - 	                      (1, tensor(0.9583, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9697, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (2, tensor(0.9697, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9767, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (3, tensor(0.9767, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9800, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (4, tensor(0.9800, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9817, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (5, tensor(0.9817, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9826, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (6, tensor(0.9826, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9850, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (7, tensor(0.9850, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9860, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (8, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9866, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (9, tensor(0.9866, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9870, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (10, tensor(0.9870, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9873, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (11, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9879, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (12, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9885, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (13, tensor(0.9885, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9885, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (14, tensor(0.9885, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (15, tensor(0.9892, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (16, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9892, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9896, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (17, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9897, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (18, tensor(0.9897, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9900, dtype=torch.float64)),
[2024-12-08 08:55:26,709][flwr][INFO] - 	                      (19, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9902, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (20, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9905, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (21, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9907, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (22, tensor(0.9907, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9906, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (23, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9904, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (24, tensor(0.9904, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9911, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (25, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9911, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (26, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9914, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (27, tensor(0.9914, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9915, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (28, tensor(0.9915, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9917, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (29, tensor(0.9917, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9919, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (30, tensor(0.9919, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9917, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (31, tensor(0.9917, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9918, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (32, tensor(0.9918, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9920, dtype=torch.float64)),
[2024-12-08 08:55:26,710][flwr][INFO] - 	                      (33, tensor(0.9920, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9919, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (34, tensor(0.9919, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9920, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (35, tensor(0.9920, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9922, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (36, tensor(0.9922, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9922, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (37, tensor(0.9922, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9924, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (38, tensor(0.9924, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9925, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (39, tensor(0.9925, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9926, dtype=torch.float64))],
[2024-12-08 08:55:26,711][flwr][INFO] - 	                      (40, tensor(0.9926, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0082, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0082, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.5483, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (1, tensor(0.5483, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.6324, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (2, tensor(0.6324, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.6580, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (3, tensor(0.6580, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.6779, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (4, tensor(0.6779, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.6799, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (5, tensor(0.6799, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.6955, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (6, tensor(0.6955, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.7058, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (7, tensor(0.7058, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.7099, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (8, tensor(0.7099, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.7142, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (9, tensor(0.7142, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.7121, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (10, tensor(0.7121, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.7181, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (11, tensor(0.7181, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.7202, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (12, tensor(0.7202, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.7239, dtype=torch.float64)),
[2024-12-08 08:55:26,711][flwr][INFO] - 	                       (13, tensor(0.7239, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.7237, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (14, tensor(0.7237, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.7290, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (15, tensor(0.7290, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.7309, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (16, tensor(0.7309, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.7285, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (17, tensor(0.7285, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.7327, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (18, tensor(0.7327, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.7320, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (19, tensor(0.7320, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.7354, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (20, tensor(0.7354, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.7350, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (21, tensor(0.7350, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.7358, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (22, tensor(0.7358, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.7339, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (23, tensor(0.7339, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.7351, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (24, tensor(0.7351, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.7390, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (25, tensor(0.7390, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.7365, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (26, tensor(0.7365, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.7372, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (27, tensor(0.7372, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.7376, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (28, tensor(0.7376, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.7389, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (29, tensor(0.7389, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.7398, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (30, tensor(0.7398, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.7413, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (31, tensor(0.7413, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.7396, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (32, tensor(0.7396, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.7432, dtype=torch.float64)),
[2024-12-08 08:55:26,712][flwr][INFO] - 	                       (33, tensor(0.7432, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.7402, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (34, tensor(0.7402, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.7433, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (35, tensor(0.7433, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.7409, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (36, tensor(0.7409, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.7425, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (37, tensor(0.7425, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.7441, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (38, tensor(0.7441, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.7406, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (39, tensor(0.7406, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.7426, dtype=torch.float64))],
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (40, tensor(0.7426, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0074, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0074, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.4506, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (1, tensor(0.4506, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.5436, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (2, tensor(0.5436, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.5628, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (3, tensor(0.5628, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.5855, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (4, tensor(0.5855, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (5, tensor(0.5871, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (6, tensor(0.5990, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (7, tensor(0.6167, dtype=torch.float64)),
[2024-12-08 08:55:26,713][flwr][INFO] - 	                       (8, tensor(0.6200, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.5871, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.5990, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.6167, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.6200, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.6229, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (9, tensor(0.6229, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.6230, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (10, tensor(0.6230, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.6306, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (11, tensor(0.6306, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.6268, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (12, tensor(0.6268, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.6281, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (13, tensor(0.6281, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.6342, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (14, tensor(0.6342, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.6418, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (15, tensor(0.6418, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.6436, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (16, tensor(0.6436, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.6405, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (17, tensor(0.6405, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.6432, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (18, tensor(0.6432, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.6481, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (19, tensor(0.6481, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.6487, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (20, tensor(0.6487, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.6487, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (21, tensor(0.6487, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.6494, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (22, tensor(0.6494, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.6466, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (23, tensor(0.6466, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.6474, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (24, tensor(0.6474, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.6538, dtype=torch.float64)),
[2024-12-08 08:55:26,714][flwr][INFO] - 	                       (25, tensor(0.6538, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.6522, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (26, tensor(0.6522, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.6552, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (27, tensor(0.6552, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.6544, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (28, tensor(0.6544, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.6478, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (29, tensor(0.6478, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.6554, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (30, tensor(0.6554, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.6568, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (31, tensor(0.6568, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.6540, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (32, tensor(0.6540, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (33, tensor(0.6610, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.6534, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (34, tensor(0.6534, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.6573, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (35, tensor(0.6573, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.6589, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (36, tensor(0.6589, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (37, tensor(0.6610, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.6610, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (38, tensor(0.6610, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.6604, dtype=torch.float64)),
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (39, tensor(0.6604, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.6612, dtype=torch.float64))],
[2024-12-08 08:55:26,715][flwr][INFO] - 	                       (40, tensor(0.6612, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 2.4740422930434125e-06),
[2024-12-08 08:55:26,715][flwr][INFO] - 	 'ind_iou_0': [(0, 2.4740422930434125e-06),
[92mINFO [0m:      	               (1, 0.9454902448352747),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (1, 0.9454902448352747),
[92mINFO [0m:      	               (2, 0.95992076545512),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (2, 0.95992076545512),
[92mINFO [0m:      	               (3, 0.9660292266965136),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (3, 0.9660292266965136),
[92mINFO [0m:      	               (4, 0.9695533655348568),
[2024-12-08 08:55:26,715][flwr][INFO] - 	               (4, 0.9695533655348568),
[92mINFO [0m:      	               (5, 0.9706108669626013),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (5, 0.9706108669626013),
[92mINFO [0m:      	               (6, 0.9727171410860056),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (6, 0.9727171410860056),
[92mINFO [0m:      	               (7, 0.9743037021487023),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (7, 0.9743037021487023),
[92mINFO [0m:      	               (8, 0.9755247023773171),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (8, 0.9755247023773171),
[92mINFO [0m:      	               (9, 0.9759608166970313),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (9, 0.9759608166970313),
[92mINFO [0m:      	               (10, 0.9757961870136389),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (10, 0.9757961870136389),
[92mINFO [0m:      	               (11, 0.9765727632331487),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (11, 0.9765727632331487),
[92mINFO [0m:      	               (12, 0.9772283303190545),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (12, 0.9772283303190545),
[92mINFO [0m:      	               (13, 0.9775635246919407),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (13, 0.9775635246919407),
[92mINFO [0m:      	               (14, 0.977727889992489),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (14, 0.977727889992489),
[92mINFO [0m:      	               (15, 0.9781627865393916),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (15, 0.9781627865393916),
[92mINFO [0m:      	               (16, 0.9778573106078782),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (16, 0.9778573106078782),
[92mINFO [0m:      	               (17, 0.9786050378058706),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (17, 0.9786050378058706),
[92mINFO [0m:      	               (18, 0.9784739443537188),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (18, 0.9784739443537188),
[92mINFO [0m:      	               (19, 0.97844934473799),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (19, 0.97844934473799),
[92mINFO [0m:      	               (20, 0.9789663994278827),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (20, 0.9789663994278827),
[92mINFO [0m:      	               (21, 0.9790453675322541),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (21, 0.9790453675322541),
[92mINFO [0m:      	               (22, 0.9790634615414073),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (22, 0.9790634615414073),
[92mINFO [0m:      	               (23, 0.9790626269585961),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (23, 0.9790626269585961),
[92mINFO [0m:      	               (24, 0.9789554558684999),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (24, 0.9789554558684999),
[92mINFO [0m:      	               (25, 0.9794564478593093),
[2024-12-08 08:55:26,716][flwr][INFO] - 	               (25, 0.9794564478593093),
[92mINFO [0m:      	               (26, 0.9793763658892571),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (26, 0.9793763658892571),
[92mINFO [0m:      	               (27, 0.9795746855469696),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (27, 0.9795746855469696),
[92mINFO [0m:      	               (28, 0.9795404318045612),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (28, 0.9795404318045612),
[92mINFO [0m:      	               (29, 0.9797201328403895),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (29, 0.9797201328403895),
[92mINFO [0m:      	               (30, 0.9796430157674957),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (30, 0.9796430157674957),
[92mINFO [0m:      	               (31, 0.9797874817343122),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (31, 0.9797874817343122),
[92mINFO [0m:      	               (32, 0.979656398800786),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (32, 0.979656398800786),
[92mINFO [0m:      	               (33, 0.9797891259747098),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (33, 0.9797891259747098),
[92mINFO [0m:      	               (34, 0.9797882753908774),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (34, 0.9797882753908774),
[92mINFO [0m:      	               (35, 0.9798289181488224),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (35, 0.9798289181488224),
[92mINFO [0m:      	               (36, 0.9798462580624995),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (36, 0.9798462580624995),
[92mINFO [0m:      	               (37, 0.979842656219177),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (37, 0.979842656219177),
[92mINFO [0m:      	               (38, 0.9800795344352587),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (38, 0.9800795344352587),
[92mINFO [0m:      	               (39, 0.9800059208989179),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (39, 0.9800059208989179),
[92mINFO [0m:      	               (40, 0.9800636531130459)],
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (40, 0.9800636531130459)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 1.365228672907438e-05),
[2024-12-08 08:55:26,717][flwr][INFO] - 	 'ind_iou_1': [(0, 1.365228672907438e-05),
[92mINFO [0m:      	               (1, 0.9364330953567215),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (1, 0.9364330953567215),
[92mINFO [0m:      	               (2, 0.9570659249348098),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (2, 0.9570659249348098),
[92mINFO [0m:      	               (3, 0.9644579211706455),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (3, 0.9644579211706455),
[92mINFO [0m:      	               (4, 0.9696835670861041),
[2024-12-08 08:55:26,717][flwr][INFO] - 	               (4, 0.9696835670861041),
[92mINFO [0m:      	               (5, 0.9719631157032752),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (5, 0.9719631157032752),
[92mINFO [0m:      	               (6, 0.9726723388748973),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (6, 0.9726723388748973),
[92mINFO [0m:      	               (7, 0.9761668574626706),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (7, 0.9761668574626706),
[92mINFO [0m:      	               (8, 0.9774988066479126),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (8, 0.9774988066479126),
[92mINFO [0m:      	               (9, 0.9784240195732182),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (9, 0.9784240195732182),
[92mINFO [0m:      	               (10, 0.9784249133721511),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (10, 0.9784249133721511),
[92mINFO [0m:      	               (11, 0.97917922335383),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (11, 0.97917922335383),
[92mINFO [0m:      	               (12, 0.9802178397265098),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (12, 0.9802178397265098),
[92mINFO [0m:      	               (13, 0.9808919068721229),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (13, 0.9808919068721229),
[92mINFO [0m:      	               (14, 0.981350302711466),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (14, 0.981350302711466),
[92mINFO [0m:      	               (15, 0.9820824311422482),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (15, 0.9820824311422482),
[92mINFO [0m:      	               (16, 0.9816082032900846),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (16, 0.9816082032900846),
[92mINFO [0m:      	               (17, 0.982670458207204),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (17, 0.982670458207204),
[92mINFO [0m:      	               (18, 0.9827090311587),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (18, 0.9827090311587),
[92mINFO [0m:      	               (19, 0.9825954428977627),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (19, 0.9825954428977627),
[92mINFO [0m:      	               (20, 0.98351758765733),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (20, 0.98351758765733),
[92mINFO [0m:      	               (21, 0.9838142078614804),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (21, 0.9838142078614804),
[92mINFO [0m:      	               (22, 0.9838418780263609),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (22, 0.9838418780263609),
[92mINFO [0m:      	               (23, 0.9836389842603372),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (23, 0.9836389842603372),
[92mINFO [0m:      	               (24, 0.9837265367281732),
[2024-12-08 08:55:26,718][flwr][INFO] - 	               (24, 0.9837265367281732),
[92mINFO [0m:      	               (25, 0.9843485982633502),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (25, 0.9843485982633502),
[92mINFO [0m:      	               (26, 0.9845516592021007),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (26, 0.9845516592021007),
[92mINFO [0m:      	               (27, 0.984807142675954),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (27, 0.984807142675954),
[92mINFO [0m:      	               (28, 0.9849503680379583),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (28, 0.9849503680379583),
[92mINFO [0m:      	               (29, 0.9851994370959137),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (29, 0.9851994370959137),
[92mINFO [0m:      	               (30, 0.9853922600985596),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (30, 0.9853922600985596),
[92mINFO [0m:      	               (31, 0.9854124107842427),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (31, 0.9854124107842427),
[92mINFO [0m:      	               (32, 0.9851205092076245),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (32, 0.9851205092076245),
[92mINFO [0m:      	               (33, 0.985465678610635),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (33, 0.985465678610635),
[92mINFO [0m:      	               (34, 0.9854698693284877),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (34, 0.9854698693284877),
[92mINFO [0m:      	               (35, 0.9855443333959065),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (35, 0.9855443333959065),
[92mINFO [0m:      	               (36, 0.9857164943315954),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (36, 0.9857164943315954),
[92mINFO [0m:      	               (37, 0.9858599004004814),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (37, 0.9858599004004814),
[92mINFO [0m:      	               (38, 0.9863379229269827),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (38, 0.9863379229269827),
[92mINFO [0m:      	               (39, 0.9861322037831943),
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (39, 0.9861322037831943),
[92mINFO [0m:      	               (40, 0.9864739679748924)]}
[2024-12-08 08:55:26,719][flwr][INFO] - 	               (40, 0.9864739679748924)]}
[92mINFO [0m:      
[2024-12-08 08:55:26,719][flwr][INFO] - 
