/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.sepnet.U_net
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 15165
3 3791
3 414
3 4205
cuda:0
[2024-11-26 17:56:32,127][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-11-26 17:56:35,223	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'node:172.18.62.4': 1.0, 'object_store_memory': 200000000000.0, 'memory': 850095004672.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[2024-11-26 17:56:54,828][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'node:172.18.62.4': 1.0, 'object_store_memory': 200000000000.0, 'memory': 850095004672.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-26 17:56:54,828][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-26 17:56:54,828][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-26 17:56:54,851][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-11-26 17:56:54,852][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-11-26 17:56:54,852][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-11-26 17:56:58,367][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-11-26 17:56:58,368][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.7043031710932003, OrderedDict([('ind_iou_0', 0.0654708156290535), ('ind_dice_liver_0', tensor(0.1688, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0653650756211594), ('ind_dice_liver_1', tensor(0.1675, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0076, dtype=torch.float64)), ('all_iou', 0.06546496448727193), ('all_dice_liver', tensor(0.1687, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-11-26 18:02:03,006][flwr][INFO] - initial parameters (loss, other metrics): 0.7043031710932003, OrderedDict([('ind_iou_0', 0.0654708156290535), ('ind_dice_liver_0', tensor(0.1688, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0653650756211594), ('ind_dice_liver_1', tensor(0.1675, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0076, dtype=torch.float64)), ('all_iou', 0.06546496448727193), ('all_dice_liver', tensor(0.1687, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
[92mINFO [0m:      
[2024-11-26 18:02:03,010][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-11-26 18:02:03,010][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 18:02:03,011][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.8618001389962573
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9076, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.2373, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9172429102770532
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9516, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.3515, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9247195687423788
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9537, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.4451, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9355891268433357
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9573, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.4646, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9360201634760722
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9599, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.5064, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9425922502842429
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9654, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.5301, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9435850178636308
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9645, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.5467, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9457119029730147
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9678, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.5714, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-26 18:58:14,608][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-11-26 18:58:14,651][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.006403941509627275, OrderedDict([('ind_iou_0', 0.9457119029730147), ('ind_dice_liver_0', tensor(0.9678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5714, dtype=torch.float64)), ('ind_iou_1', 0.9412999127239885), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4677, dtype=torch.float64)), ('all_iou', 0.9454104017544205), ('all_dice_liver', tensor(0.9675, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5643, dtype=torch.float64))]), 3604.595059569925)
Entrei no test
Meio do test
Fim do test
[2024-11-26 19:02:07,605][flwr][INFO] - fit progress: (1, 0.006403941509627275, OrderedDict([('ind_iou_0', 0.9457119029730147), ('ind_dice_liver_0', tensor(0.9678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5714, dtype=torch.float64)), ('ind_iou_1', 0.9412999127239885), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4677, dtype=torch.float64)), ('all_iou', 0.9454104017544205), ('all_dice_liver', tensor(0.9675, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5643, dtype=torch.float64))]), 3604.595059569925)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 19:02:07,613][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 19:03:51,270][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 19:03:51,270][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 19:03:51,271][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-26 19:03:51,271][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-11-26 19:03:51,271][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 19:03:51,272][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9465874413126576
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9661, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.5686, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9495167858380246
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9669, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.5818, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9504738042648149
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9689, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.5773, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9529652883499495
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9697, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.5984, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9521133872230709
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9695, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6005, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9532037223812504
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9698, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6020, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9557865644952266
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9719, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6186, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9558546715981541
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9731, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6164, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-26 19:58:19,338][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.0050533997839567, OrderedDict([('ind_iou_0', 0.9558546715981541), ('ind_dice_liver_0', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6164, dtype=torch.float64)), ('ind_iou_1', 0.9546260626172512), ('ind_dice_liver_1', tensor(0.9706, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5241, dtype=torch.float64)), ('all_iou', 0.9558033147938135), ('all_dice_liver', tensor(0.9729, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6097, dtype=torch.float64))]), 7225.589760400355)
Entrei no test
Meio do test
Fim do test
[2024-11-26 20:02:28,599][flwr][INFO] - fit progress: (2, 0.0050533997839567, OrderedDict([('ind_iou_0', 0.9558546715981541), ('ind_dice_liver_0', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6164, dtype=torch.float64)), ('ind_iou_1', 0.9546260626172512), ('ind_dice_liver_1', tensor(0.9706, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5241, dtype=torch.float64)), ('all_iou', 0.9558033147938135), ('all_dice_liver', tensor(0.9729, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6097, dtype=torch.float64))]), 7225.589760400355)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 20:02:28,604][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 20:04:07,765][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 20:04:07,766][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 20:04:07,766][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-26 20:04:07,767][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-11-26 20:04:07,767][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 20:04:07,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9566988378990214
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6212, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9569178250008483
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9734, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6068, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9595696833115819
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9743, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6341, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.955787598498821
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9718, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6074, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.959985128981784
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9745, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6389, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9581455264339637
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9741, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6143, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9628975388746276
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9765, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6596, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9611622124712068
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9759, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6428, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-26 20:58:46,301][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.004342904730891536, OrderedDict([('ind_iou_0', 0.9611622124712068), ('ind_dice_liver_0', tensor(0.9759, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6428, dtype=torch.float64)), ('ind_iou_1', 0.9613343719006978), ('ind_dice_liver_1', tensor(0.9740, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5480, dtype=torch.float64)), ('all_iou', 0.9612137366980711), ('all_dice_liver', tensor(0.9757, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6363, dtype=torch.float64))]), 10818.82154962048)
Entrei no test
Meio do test
Fim do test
[2024-11-26 21:02:21,831][flwr][INFO] - fit progress: (3, 0.004342904730891536, OrderedDict([('ind_iou_0', 0.9611622124712068), ('ind_dice_liver_0', tensor(0.9759, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6428, dtype=torch.float64)), ('ind_iou_1', 0.9613343719006978), ('ind_dice_liver_1', tensor(0.9740, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5480, dtype=torch.float64)), ('all_iou', 0.9612137366980711), ('all_dice_liver', tensor(0.9757, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6363, dtype=torch.float64))]), 10818.82154962048)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 21:02:21,835][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 21:04:00,481][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 21:04:00,482][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 21:04:00,482][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-26 21:04:00,482][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-11-26 21:04:00,482][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 21:04:00,483][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9625262136957611
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9763, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6558, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9586730628160505
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9744, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6350, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9660986961472885
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9786, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6690, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9629256526289146
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9779, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6552, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9678506261425536
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9797, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6811, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9611890760233568
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9768, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6370, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9669983237536286
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9791, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6802, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.961981781158944
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9766, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6504, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-26 21:59:01,692][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.00428442600560812, OrderedDict([('ind_iou_0', 0.961981781158944), ('ind_dice_liver_0', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6504, dtype=torch.float64)), ('ind_iou_1', 0.9631077033224844), ('ind_dice_liver_1', tensor(0.9753, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5672, dtype=torch.float64)), ('all_iou', 0.9621756644492357), ('all_dice_liver', tensor(0.9765, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6444, dtype=torch.float64))]), 14470.985487732105)
Entrei no test
Meio do test
Fim do test
[2024-11-26 22:03:13,995][flwr][INFO] - fit progress: (4, 0.00428442600560812, OrderedDict([('ind_iou_0', 0.961981781158944), ('ind_dice_liver_0', tensor(0.9766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6504, dtype=torch.float64)), ('ind_iou_1', 0.9631077033224844), ('ind_dice_liver_1', tensor(0.9753, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5672, dtype=torch.float64)), ('all_iou', 0.9621756644492357), ('all_dice_liver', tensor(0.9765, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6444, dtype=torch.float64))]), 14470.985487732105)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 22:03:13,999][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 22:04:54,292][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 22:04:54,292][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 22:04:54,293][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-26 22:04:54,293][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-11-26 22:04:54,293][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 22:04:54,293][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9682656584426494
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9798, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6857, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9653496491905343
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9782, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6728, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9707019531368587
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9815, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6988, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9656348199213024
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9795, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6725, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9703816663410051
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9670038452761879
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9802, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6707, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9729755736056586
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7018, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.965663195835508
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9797, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6696, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-26 22:59:35,495][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.0038780910125739794, OrderedDict([('ind_iou_0', 0.965663195835508), ('ind_dice_liver_0', tensor(0.9797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6696, dtype=torch.float64)), ('ind_iou_1', 0.9674989241556511), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5793, dtype=torch.float64)), ('all_iou', 0.9658667418898235), ('all_dice_liver', tensor(0.9796, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6634, dtype=torch.float64))]), 18096.037496413104)
Entrei no test
Meio do test
Fim do test
[2024-11-26 23:03:39,047][flwr][INFO] - fit progress: (5, 0.0038780910125739794, OrderedDict([('ind_iou_0', 0.965663195835508), ('ind_dice_liver_0', tensor(0.9797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6696, dtype=torch.float64)), ('ind_iou_1', 0.9674989241556511), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5793, dtype=torch.float64)), ('all_iou', 0.9658667418898235), ('all_dice_liver', tensor(0.9796, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6634, dtype=torch.float64))]), 18096.037496413104)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-26 23:03:39,051][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 23:05:22,229][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-26 23:05:22,229][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-26 23:05:22,230][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-26 23:05:22,230][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-11-26 23:05:22,230][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-26 23:05:22,231][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9730466028691168
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9831, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7044, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9681975349987727
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6863, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9726381090289066
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9828, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6986, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9689203875532466
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9738529915660645
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7121, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9688665617758748
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9819, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6922, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-26 23:59:31,556][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.0034814376804831477, OrderedDict([('ind_iou_0', 0.969225818066841), ('ind_dice_liver_0', tensor(0.9819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6857, dtype=torch.float64)), ('ind_iou_1', 0.9708177589102281), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5941, dtype=torch.float64)), ('all_iou', 0.9694482975683638), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 21692.05340414215)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9733531891100764
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9835, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.6955, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.969225818066841
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9819, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6857, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 00:03:35,063][flwr][INFO] - fit progress: (6, 0.0034814376804831477, OrderedDict([('ind_iou_0', 0.969225818066841), ('ind_dice_liver_0', tensor(0.9819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6857, dtype=torch.float64)), ('ind_iou_1', 0.9708177589102281), ('ind_dice_liver_1', tensor(0.9817, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5941, dtype=torch.float64)), ('all_iou', 0.9694482975683638), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 21692.05340414215)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 00:03:35,067][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 00:05:11,466][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 00:05:11,466][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 00:05:11,467][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 00:05:11,467][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-11-27 00:05:11,467][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 00:05:11,468][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9739980269591728
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7010, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9698683892886522
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9824, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6959, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9764345105311857
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7126, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9693249857704659
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9817, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.974879869946972
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9842, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7127, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9710332764118688
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6965, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.977360028926998
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7238, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9702473909970715
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6928, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 00:59:47,791][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.00341646312508958, OrderedDict([('ind_iou_0', 0.9702473909970715), ('ind_dice_liver_0', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6928, dtype=torch.float64)), ('ind_iou_1', 0.9722542917346813), ('ind_dice_liver_1', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.970521052330803), ('all_dice_liver', tensor(0.9831, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6866, dtype=torch.float64))]), 25306.564948599786)
Entrei no test
Meio do test
Fim do test
[2024-11-27 01:03:49,575][flwr][INFO] - fit progress: (7, 0.00341646312508958, OrderedDict([('ind_iou_0', 0.9702473909970715), ('ind_dice_liver_0', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6928, dtype=torch.float64)), ('ind_iou_1', 0.9722542917346813), ('ind_dice_liver_1', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6000, dtype=torch.float64)), ('all_iou', 0.970521052330803), ('all_dice_liver', tensor(0.9831, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6866, dtype=torch.float64))]), 25306.564948599786)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 01:03:49,578][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 01:05:19,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 01:05:19,867][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 01:05:19,868][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 01:05:19,868][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-11-27 01:05:19,868][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 01:05:19,868][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9762339216617102
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7178, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9706564633927837
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6979, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9787278336918565
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7336, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9710148905608618
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6926, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9769794556037354
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7273, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.970919402269014
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6968, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.979157134585435
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7320, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9713154943676034
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6961, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 02:00:14,356][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.0033416935203953533, OrderedDict([('ind_iou_0', 0.9713154943676034), ('ind_dice_liver_0', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6961, dtype=torch.float64)), ('ind_iou_1', 0.9739228376175606), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6105, dtype=torch.float64)), ('all_iou', 0.9716201160878497), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6911, dtype=torch.float64))]), 28910.801945668645)
Entrei no test
Meio do test
Fim do test
[2024-11-27 02:03:53,812][flwr][INFO] - fit progress: (8, 0.0033416935203953533, OrderedDict([('ind_iou_0', 0.9713154943676034), ('ind_dice_liver_0', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6961, dtype=torch.float64)), ('ind_iou_1', 0.9739228376175606), ('ind_dice_liver_1', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6105, dtype=torch.float64)), ('all_iou', 0.9716201160878497), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6911, dtype=torch.float64))]), 28910.801945668645)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 02:03:53,815][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 02:05:30,070][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 02:05:30,072][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 02:05:30,073][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 02:05:30,073][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-11-27 02:05:30,074][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 02:05:30,074][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9793442225195516
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7292, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9718345200411573
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9839, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6989, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9795766464814489
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7289, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9715016524385289
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9838, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7060, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.977923849187218
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7218, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9731392195818013
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7094, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.98054132849991
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7387, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9726674898525501
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7034, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 02:59:35,329][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.0031887487254208496, OrderedDict([('ind_iou_0', 0.9726674898525501), ('ind_dice_liver_0', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7034, dtype=torch.float64)), ('ind_iou_1', 0.9764959335030695), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6155, dtype=torch.float64)), ('all_iou', 0.9730584856279966), ('all_dice_liver', tensor(0.9846, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6977, dtype=torch.float64))]), 32469.747321762145)
Entrei no test
Meio do test
Fim do test
[2024-11-27 03:03:12,757][flwr][INFO] - fit progress: (9, 0.0031887487254208496, OrderedDict([('ind_iou_0', 0.9726674898525501), ('ind_dice_liver_0', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7034, dtype=torch.float64)), ('ind_iou_1', 0.9764959335030695), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6155, dtype=torch.float64)), ('all_iou', 0.9730584856279966), ('all_dice_liver', tensor(0.9846, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6977, dtype=torch.float64))]), 32469.747321762145)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 03:03:12,761][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 03:04:35,924][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 03:04:35,924][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 03:04:35,925][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 03:04:35,925][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-11-27 03:04:35,925][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 03:04:35,925][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9796601056806724
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7384, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9621904977163128
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9762, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6714, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9802073940272105
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7321, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.972970847646913
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7044, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9806611826313588
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7475, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9731334423838185
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7052, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.981027845154841
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7455, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9731415026687117
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7059, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 03:59:06,795][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.0031744974584503633, OrderedDict([('ind_iou_0', 0.9731415026687117), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7059, dtype=torch.float64)), ('ind_iou_1', 0.9769288572292162), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6213, dtype=torch.float64)), ('all_iou', 0.9735583709284229), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7007, dtype=torch.float64))]), 36022.39226648584)
Entrei no test
Meio do test
Fim do test
[2024-11-27 04:02:25,402][flwr][INFO] - fit progress: (10, 0.0031744974584503633, OrderedDict([('ind_iou_0', 0.9731415026687117), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7059, dtype=torch.float64)), ('ind_iou_1', 0.9769288572292162), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6213, dtype=torch.float64)), ('all_iou', 0.9735583709284229), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7007, dtype=torch.float64))]), 36022.39226648584)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 04:02:25,405][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 04:03:55,829][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 04:03:55,830][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 04:03:55,830][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 04:03:55,831][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-11-27 04:03:55,831][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 04:03:55,831][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9808331508007643
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7315, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9727824832864419
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6988, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.981388674210561
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7402, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9734914150864005
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7094, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9820911619933658
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7485, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9739651728185711
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7122, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9821031747012192
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7464, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9733371411296339
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7114, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 04:58:38,289][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.0032392938357227517, OrderedDict([('ind_iou_0', 0.9733371411296339), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7114, dtype=torch.float64)), ('ind_iou_1', 0.9759590171282189), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6226, dtype=torch.float64)), ('all_iou', 0.9736761676674213), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7062, dtype=torch.float64))]), 39637.93171007)
Entrei no test
Meio do test
Fim do test
[2024-11-27 05:02:40,941][flwr][INFO] - fit progress: (11, 0.0032392938357227517, OrderedDict([('ind_iou_0', 0.9733371411296339), ('ind_dice_liver_0', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7114, dtype=torch.float64)), ('ind_iou_1', 0.9759590171282189), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6226, dtype=torch.float64)), ('all_iou', 0.9736761676674213), ('all_dice_liver', tensor(0.9854, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7062, dtype=torch.float64))]), 39637.93171007)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 05:02:40,945][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 05:04:32,374][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 05:04:32,374][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 05:04:32,374][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 05:04:32,375][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-11-27 05:04:32,375][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 05:04:32,375][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9822767545525132
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7509, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9739007742360569
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7111, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9817194928573474
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7468, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9744222654022767
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7167, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9822459142136992
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7436, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9735253540211896
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7108, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 05:59:10,847][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.003113147121766642, OrderedDict([('ind_iou_0', 0.9743088004215644), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7159, dtype=torch.float64)), ('ind_iou_1', 0.9789127333155198), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6292, dtype=torch.float64)), ('all_iou', 0.9747876703321112), ('all_dice_liver', tensor(0.9862, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7105, dtype=torch.float64))]), 43256.399252084084)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9831133727552535
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7449, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9743088004215644
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7159, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 06:02:59,409][flwr][INFO] - fit progress: (12, 0.003113147121766642, OrderedDict([('ind_iou_0', 0.9743088004215644), ('ind_dice_liver_0', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7159, dtype=torch.float64)), ('ind_iou_1', 0.9789127333155198), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6292, dtype=torch.float64)), ('all_iou', 0.9747876703321112), ('all_dice_liver', tensor(0.9862, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7105, dtype=torch.float64))]), 43256.399252084084)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 06:02:59,414][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 06:04:37,888][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 06:04:37,889][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 06:04:37,889][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 06:04:37,890][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-11-27 06:04:37,890][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 06:04:37,890][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9828218876400863
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7491, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9741027918799585
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7187, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9816285435083494
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7434, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9728400609681522
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7087, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9840473313515337
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7571, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9748655372991258
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7162, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9837629907897005
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7562, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9744859314952669
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7177, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 06:58:56,351][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.003114633645040651, OrderedDict([('ind_iou_0', 0.9744859314952669), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7177, dtype=torch.float64)), ('ind_iou_1', 0.978323456236889), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6329, dtype=torch.float64)), ('all_iou', 0.9749266880949851), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7132, dtype=torch.float64))]), 46836.769941624254)
Entrei no test
Meio do test
Fim do test
[2024-11-27 07:02:39,780][flwr][INFO] - fit progress: (13, 0.003114633645040651, OrderedDict([('ind_iou_0', 0.9744859314952669), ('ind_dice_liver_0', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7177, dtype=torch.float64)), ('ind_iou_1', 0.978323456236889), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6329, dtype=torch.float64)), ('all_iou', 0.9749266880949851), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7132, dtype=torch.float64))]), 46836.769941624254)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 07:02:39,783][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 07:04:14,097][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 07:04:14,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 07:04:14,098][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 07:04:14,098][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-11-27 07:04:14,099][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 07:04:14,099][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9836517806844969
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7528, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9737557314687547
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7049, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9837527162842682
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7574, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9667392225647815
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.6816, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9829054807832378
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7508, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9750755676862627
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7174, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9845977369022296
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7570, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9744850239653781
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7182, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 07:58:47,159][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.003128955120444475, OrderedDict([('ind_iou_0', 0.9744850239653781), ('ind_dice_liver_0', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7182, dtype=torch.float64)), ('ind_iou_1', 0.9787596868650466), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6331, dtype=torch.float64)), ('all_iou', 0.9749733388701632), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7135, dtype=torch.float64))]), 50452.67399511486)
Entrei no test
Meio do test
Fim do test
[2024-11-27 08:02:55,684][flwr][INFO] - fit progress: (14, 0.003128955120444475, OrderedDict([('ind_iou_0', 0.9744850239653781), ('ind_dice_liver_0', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7182, dtype=torch.float64)), ('ind_iou_1', 0.9787596868650466), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6331, dtype=torch.float64)), ('all_iou', 0.9749733388701632), ('all_dice_liver', tensor(0.9864, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7135, dtype=torch.float64))]), 50452.67399511486)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 08:02:55,687][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 08:04:30,178][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-27 08:04:30,178][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 08:04:30,179][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 08:04:30,180][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-11-27 08:04:30,180][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 08:04:30,182][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9840401882538712
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7530, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.975213681072388
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7188, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9848060386877986
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7668, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9745002815862293
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7194, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9840213958106466
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7610, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9753707481662279
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7196, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 08:59:33,819][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.003097495119675427, OrderedDict([('ind_iou_0', 0.9750988712910427), ('ind_dice_liver_0', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7184, dtype=torch.float64)), ('ind_iou_1', 0.9801168821024651), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6361, dtype=torch.float64)), ('all_iou', 0.9756268551453247), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7142, dtype=torch.float64))]), 54120.284065227956)
Entrei no test
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9851329512313658
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7688, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9750988712910427
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7184, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Meio do test
Fim do test
[2024-11-27 09:04:03,294][flwr][INFO] - fit progress: (15, 0.003097495119675427, OrderedDict([('ind_iou_0', 0.9750988712910427), ('ind_dice_liver_0', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7184, dtype=torch.float64)), ('ind_iou_1', 0.9801168821024651), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6361, dtype=torch.float64)), ('all_iou', 0.9756268551453247), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7142, dtype=torch.float64))]), 54120.284065227956)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 09:04:03,297][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 09:05:36,425][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 09:05:36,425][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 09:05:36,426][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 09:05:36,426][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-11-27 09:05:36,426][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 09:05:36,426][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9850013830871254
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7590, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9750496616866682
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7174, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9834802131592622
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7550, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9755860347341367
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7224, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9856848174678827
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7576, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9752109548724619
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 09:59:52,761][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.003077752173487341, OrderedDict([('ind_iou_0', 0.975376872640335), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9801341479914036), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6383, dtype=torch.float64)), ('all_iou', 0.9759010390385884), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7162, dtype=torch.float64))]), 57709.06129354425)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9853564929144748
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7595, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.975376872640335
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7204, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 10:03:52,071][flwr][INFO] - fit progress: (16, 0.003077752173487341, OrderedDict([('ind_iou_0', 0.975376872640335), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9801341479914036), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6383, dtype=torch.float64)), ('all_iou', 0.9759010390385884), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7162, dtype=torch.float64))]), 57709.06129354425)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 10:03:52,075][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 10:05:24,367][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 10:05:24,367][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 10:05:24,368][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 10:05:24,368][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-11-27 10:05:24,368][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 10:05:24,368][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9845460141133769
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7673, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9759223507458469
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7224, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9860584206720603
[36m(ClientAppActor pid=1358008)[0m train dice liver:  
[36m(ClientAppActor pid=1358008)[0m tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7661, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9756813132322052
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7205, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9854878366662834
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7651, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9755659514440932
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 11:03:13,490][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.003101708240503629, OrderedDict([('ind_iou_0', 0.9754605427624762), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7245, dtype=torch.float64)), ('ind_iou_1', 0.9803693830912049), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6384, dtype=torch.float64)), ('all_iou', 0.9759901091540316), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7200, dtype=torch.float64))]), 61484.03571880702)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9859367409429106
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7639, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9754605427624762
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7245, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 11:06:47,045][flwr][INFO] - fit progress: (17, 0.003101708240503629, OrderedDict([('ind_iou_0', 0.9754605427624762), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7245, dtype=torch.float64)), ('ind_iou_1', 0.9803693830912049), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6384, dtype=torch.float64)), ('all_iou', 0.9759901091540316), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7200, dtype=torch.float64))]), 61484.03571880702)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 11:06:47,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 11:08:24,873][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 11:08:24,874][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 11:08:24,875][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 11:08:24,875][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-11-27 11:08:24,876][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 11:08:24,876][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9849691164849878
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7490, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763569467440619
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7221, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9865001432116629
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7710, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9759219751626717
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7189, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9861593615280924
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7564, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9760944525679713
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7233, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9862949185943636
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7626, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9759720405646746
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7252, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 12:03:32,511][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.0030500399148120465, OrderedDict([('ind_iou_0', 0.9759720405646746), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7252, dtype=torch.float64)), ('ind_iou_1', 0.9812195080396462), ('ind_dice_liver_1', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6340, dtype=torch.float64)), ('all_iou', 0.9765187778575708), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7197, dtype=torch.float64))]), 65139.46501265466)
Entrei no test
Meio do test
Fim do test
[2024-11-27 12:07:42,475][flwr][INFO] - fit progress: (18, 0.0030500399148120465, OrderedDict([('ind_iou_0', 0.9759720405646746), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7252, dtype=torch.float64)), ('ind_iou_1', 0.9812195080396462), ('ind_dice_liver_1', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6340, dtype=torch.float64)), ('all_iou', 0.9765187778575708), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7197, dtype=torch.float64))]), 65139.46501265466)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 12:07:42,478][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 12:09:13,289][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 12:09:13,294][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 12:09:13,294][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 12:09:13,295][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-11-27 12:09:13,295][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 12:09:13,295][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.98612804219866
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7656, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9757723396344928
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7211, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9867605215725499
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  
[36m(ClientAppActor pid=1358008)[0m tensor(0.7673, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9761878885208183
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7209, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9866070784003312
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7659, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9755813050651292
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7211, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9864778986803542
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7714, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9747182211406173
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7186, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 13:03:48,603][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.0031872902655759195, OrderedDict([('ind_iou_0', 0.9747182211406173), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7186, dtype=torch.float64)), ('ind_iou_1', 0.9795783950002596), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6344, dtype=torch.float64)), ('all_iou', 0.9752275279538544), ('all_dice_liver', tensor(0.9867, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 68727.85286227334)
Entrei no test
Meio do test
Fim do test
[2024-11-27 13:07:30,862][flwr][INFO] - fit progress: (19, 0.0031872902655759195, OrderedDict([('ind_iou_0', 0.9747182211406173), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7186, dtype=torch.float64)), ('ind_iou_1', 0.9795783950002596), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6344, dtype=torch.float64)), ('all_iou', 0.9752275279538544), ('all_dice_liver', tensor(0.9867, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7139, dtype=torch.float64))]), 68727.85286227334)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 13:07:30,866][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 13:08:58,624][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 13:08:58,625][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 13:08:58,625][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 13:08:58,626][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-11-27 13:08:58,626][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 13:08:58,626][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9866759996598696
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7681, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9762503085047176
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9860589339762466
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7629, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.975952728885674
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7212, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9872080008093541
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7776, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763752624585251
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7240, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9871449418130921
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7740, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763184793903508
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7267, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 14:04:13,112][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.0030948775219116426, OrderedDict([('ind_iou_0', 0.9763184793903508), ('ind_dice_liver_0', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7267, dtype=torch.float64)), ('ind_iou_1', 0.9814863108263304), ('ind_dice_liver_1', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6410, dtype=torch.float64)), ('all_iou', 0.9768614437893962), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7222, dtype=torch.float64))]), 72395.00679384638)
Entrei no test
Meio do test
Fim do test
[2024-11-27 14:08:38,016][flwr][INFO] - fit progress: (20, 0.0030948775219116426, OrderedDict([('ind_iou_0', 0.9763184793903508), ('ind_dice_liver_0', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7267, dtype=torch.float64)), ('ind_iou_1', 0.9814863108263304), ('ind_dice_liver_1', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6410, dtype=torch.float64)), ('all_iou', 0.9768614437893962), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7222, dtype=torch.float64))]), 72395.00679384638)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 14:08:38,020][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 14:10:23,436][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 14:10:23,437][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 14:10:23,437][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 14:10:23,437][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-11-27 14:10:23,437][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 14:10:23,437][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9871258182594714
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7715, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9762198918102164
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7257, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9872775078499815
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7767, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9762800647021495
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7249, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9873685535182629
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7720, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9764588871619178
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7264, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 15:06:42,329][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.0031354548059089396, OrderedDict([('ind_iou_0', 0.9763531444778881), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7259, dtype=torch.float64)), ('ind_iou_1', 0.9822307635014473), ('ind_dice_liver_1', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6343, dtype=torch.float64)), ('all_iou', 0.9769643321446412), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7208, dtype=torch.float64))]), 76104.83306309488)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9875339571115171
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7694, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763531444778881
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7259, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 15:10:27,843][flwr][INFO] - fit progress: (21, 0.0031354548059089396, OrderedDict([('ind_iou_0', 0.9763531444778881), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7259, dtype=torch.float64)), ('ind_iou_1', 0.9822307635014473), ('ind_dice_liver_1', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6343, dtype=torch.float64)), ('all_iou', 0.9769643321446412), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7208, dtype=torch.float64))]), 76104.83306309488)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 15:10:27,847][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m 
[2024-11-27 15:12:12,420][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 15:12:12,420][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 15:12:12,421][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 15:12:12,421][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-11-27 15:12:12,421][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 15:12:12,422][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9875859365288268
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7677, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9762497632633665
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7256, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.98762224628912
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7758, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763013629411535
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7239, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.987810354818745
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7720, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9766199359817811
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7288, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9865286557600285
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7649, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9766949693617846
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7261, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 16:07:17,375][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.003127146368695691, OrderedDict([('ind_iou_0', 0.9766949693617846), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7261, dtype=torch.float64)), ('ind_iou_1', 0.9824695692320257), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6472, dtype=torch.float64)), ('all_iou', 0.9773331726056703), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7223, dtype=torch.float64))]), 79721.40822484065)
Entrei no test
Meio do test
Fim do test
[2024-11-27 16:10:44,418][flwr][INFO] - fit progress: (22, 0.003127146368695691, OrderedDict([('ind_iou_0', 0.9766949693617846), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7261, dtype=torch.float64)), ('ind_iou_1', 0.9824695692320257), ('ind_dice_liver_1', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6472, dtype=torch.float64)), ('all_iou', 0.9773331726056703), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7223, dtype=torch.float64))]), 79721.40822484065)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 16:10:44,421][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 16:12:10,733][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 16:12:10,733][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 16:12:10,733][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 16:12:10,734][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-11-27 16:12:10,734][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 16:12:10,734][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9879684652973901
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7791, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9765763430034778
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7281, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9878925755512187
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7792, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9764778683079398
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7272, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9879260738262439
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7733, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9765835070113905
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7290, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9881040673159424
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7764, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9765998676573923
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7298, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 17:06:38,314][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.0031902870739168986, OrderedDict([('ind_iou_0', 0.9765998676573923), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7298, dtype=torch.float64)), ('ind_iou_1', 0.9818668819528756), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6507, dtype=torch.float64)), ('all_iou', 0.9771830425257341), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7261, dtype=torch.float64))]), 83312.55548828561)
Entrei no test
Meio do test
Fim do test
[2024-11-27 17:10:35,565][flwr][INFO] - fit progress: (23, 0.0031902870739168986, OrderedDict([('ind_iou_0', 0.9765998676573923), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7298, dtype=torch.float64)), ('ind_iou_1', 0.9818668819528756), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6507, dtype=torch.float64)), ('all_iou', 0.9771830425257341), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7261, dtype=torch.float64))]), 83312.55548828561)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 17:10:35,568][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 17:12:12,612][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 17:12:12,613][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 17:12:12,614][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 17:12:12,614][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-11-27 17:12:12,614][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 17:12:12,614][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9881993467419531
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7787, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9765010503042509
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7205, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9883082854236862
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7778, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9758570862584405
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7276, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9882754146993735
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7760, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9766137197868784
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7278, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9884436773473763
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7774, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9765716768931899
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7253, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 18:08:26,860][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.0032035952562678885, OrderedDict([('ind_iou_0', 0.9765716768931899), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7253, dtype=torch.float64)), ('ind_iou_1', 0.9823264104283586), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6457, dtype=torch.float64)), ('all_iou', 0.9771847812712986), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7214, dtype=torch.float64))]), 87013.55242092162)
Entrei no test
Meio do test
Fim do test
[2024-11-27 18:12:16,562][flwr][INFO] - fit progress: (24, 0.0032035952562678885, OrderedDict([('ind_iou_0', 0.9765716768931899), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7253, dtype=torch.float64)), ('ind_iou_1', 0.9823264104283586), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6457, dtype=torch.float64)), ('all_iou', 0.9771847812712986), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7214, dtype=torch.float64))]), 87013.55242092162)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 18:12:16,566][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 18:14:08,907][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 18:14:08,908][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 18:14:08,908][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 18:14:08,909][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-11-27 18:14:08,909][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 18:14:08,909][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9885017861842423
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7815, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9767355064325209
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7278, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9885515155401161
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7812, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9767686415749499
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7281, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9886211709199626
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7720, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9767641259587005
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7274, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 19:08:36,159][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.003220780934904803, OrderedDict([('ind_iou_0', 0.9768842555751251), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7334, dtype=torch.float64)), ('ind_iou_1', 0.9826953341122924), ('ind_dice_liver_1', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.9775215141593329), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7292, dtype=torch.float64))]), 90645.11069815606)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9887334824606981
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7793, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9768842555751251
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7334, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 19:12:48,120][flwr][INFO] - fit progress: (25, 0.003220780934904803, OrderedDict([('ind_iou_0', 0.9768842555751251), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7334, dtype=torch.float64)), ('ind_iou_1', 0.9826953341122924), ('ind_dice_liver_1', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.9775215141593329), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7292, dtype=torch.float64))]), 90645.11069815606)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 19:12:48,124][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 19:14:15,703][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 19:14:15,703][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 19:14:15,704][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 19:14:15,704][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-11-27 19:14:15,704][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 19:14:15,704][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9890409368293192
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7839, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771640116495914
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7296, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9875876626184374
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7715, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9769950995451328
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7310, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9891725533000671
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7784, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771632398267485
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7340, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9891631376125396
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7741, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.977081121955697
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7326, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 20:08:50,956][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.0032055707557312922, OrderedDict([('ind_iou_0', 0.977081121955697), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7326, dtype=torch.float64)), ('ind_iou_1', 0.9832299150543478), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9777226295561737), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 94235.23493678123)
Entrei no test
Meio do test
Fim do test
[2024-11-27 20:12:38,245][flwr][INFO] - fit progress: (26, 0.0032055707557312922, OrderedDict([('ind_iou_0', 0.977081121955697), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7326, dtype=torch.float64)), ('ind_iou_1', 0.9832299150543478), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9777226295561737), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7283, dtype=torch.float64))]), 94235.23493678123)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 20:12:38,248][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 20:14:18,734][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 20:14:18,734][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 20:14:18,735][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 20:14:18,735][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-11-27 20:14:18,735][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 20:14:18,736][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9888393400793732
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7790, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9768600912828433
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7306, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.988686578237082
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7857, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763374430582522
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7277, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.988186995312173
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7808, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.977183756548746
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7311, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9893092859619292
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7814, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9770779384077869
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 21:09:11,126][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.003180830807986533, OrderedDict([('ind_iou_0', 0.9770779384077869), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9829497834094191), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6463, dtype=torch.float64)), ('all_iou', 0.9777096114753222), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7285, dtype=torch.float64))]), 97882.37020867411)
Entrei no test
Meio do test
Fim do test
[2024-11-27 21:13:25,380][flwr][INFO] - fit progress: (27, 0.003180830807986533, OrderedDict([('ind_iou_0', 0.9770779384077869), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9829497834094191), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6463, dtype=torch.float64)), ('all_iou', 0.9777096114753222), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7285, dtype=torch.float64))]), 97882.37020867411)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 21:13:25,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 21:15:22,562][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 21:15:22,563][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 21:15:22,564][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 21:15:22,564][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-11-27 21:15:22,564][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 21:15:22,564][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9889226653365055
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7788, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9757631209010071
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7264, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9892638778153986
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.976868846809992
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7307, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9891108963382357
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7843, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771525213291632
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7313, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 22:09:38,958][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.0030749148139109952, OrderedDict([('ind_iou_0', 0.9766038663891664), ('ind_dice_liver_0', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7274, dtype=torch.float64)), ('ind_iou_1', 0.9829444883558459), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6450, dtype=torch.float64)), ('all_iou', 0.9772533363148271), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7235, dtype=torch.float64))]), 101456.89081193227)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9881281787329554
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7769, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9766038663891664
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7274, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-27 22:12:59,900][flwr][INFO] - fit progress: (28, 0.0030749148139109952, OrderedDict([('ind_iou_0', 0.9766038663891664), ('ind_dice_liver_0', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7274, dtype=torch.float64)), ('ind_iou_1', 0.9829444883558459), ('ind_dice_liver_1', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6450, dtype=torch.float64)), ('all_iou', 0.9772533363148271), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7235, dtype=torch.float64))]), 101456.89081193227)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 22:12:59,904][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 22:14:47,192][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 22:14:47,193][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 22:14:47,194][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 22:14:47,195][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-11-27 22:14:47,195][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 22:14:47,195][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9874338749541318
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7757, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9763744083179178
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7297, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9892465426246735
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7861, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9773907385750974
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7326, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9893472063068789
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7779, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9769928414545759
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7337, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.989372393522789
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7792, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771579020015174
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7362, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-27 23:11:28,310][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.003239431041685973, OrderedDict([('ind_iou_0', 0.9771579020015174), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7362, dtype=torch.float64)), ('ind_iou_1', 0.9827492238639275), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6519, dtype=torch.float64)), ('all_iou', 0.9777782367369191), ('all_dice_liver', tensor(0.9887, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7318, dtype=torch.float64))]), 105199.22395419516)
Entrei no test
Meio do test
Fim do test
[2024-11-27 23:15:22,234][flwr][INFO] - fit progress: (29, 0.003239431041685973, OrderedDict([('ind_iou_0', 0.9771579020015174), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7362, dtype=torch.float64)), ('ind_iou_1', 0.9827492238639275), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6519, dtype=torch.float64)), ('all_iou', 0.9777782367369191), ('all_dice_liver', tensor(0.9887, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7318, dtype=torch.float64))]), 105199.22395419516)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-27 23:15:22,237][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-27 23:16:57,081][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-27 23:16:57,083][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-27 23:16:57,084][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-27 23:16:57,084][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-11-27 23:16:57,084][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-27 23:16:57,084][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9893011668968134
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7752, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771097932757369
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7289, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9895564237961197
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7815, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771900134794896
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7303, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9896200603186184
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7859, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772023587364965
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7309, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 00:11:27,163][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.003128368396275454, OrderedDict([('ind_iou_0', 0.9770598963066148), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7300, dtype=torch.float64)), ('ind_iou_1', 0.9834096667568272), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6469, dtype=torch.float64)), ('all_iou', 0.9777167415541976), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7257, dtype=torch.float64))]), 108760.83885056339)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9884596064639353
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7689, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9770598963066148
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7300, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 00:14:43,848][flwr][INFO] - fit progress: (30, 0.003128368396275454, OrderedDict([('ind_iou_0', 0.9770598963066148), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7300, dtype=torch.float64)), ('ind_iou_1', 0.9834096667568272), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6469, dtype=torch.float64)), ('all_iou', 0.9777167415541976), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7257, dtype=torch.float64))]), 108760.83885056339)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 00:14:43,852][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 00:16:18,600][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 00:16:18,601][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 00:16:18,602][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 00:16:18,602][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-11-28 00:16:18,602][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 00:16:18,602][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9893140121251095
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7787, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9769844538189932
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7292, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9897011674850407
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7752, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9770869121804127
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7319, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9897565827291823
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7803, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772733527501491
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7294, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9897725417331222
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7807, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772058546250926
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7340, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 01:11:06,538][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.0033036262822956483, OrderedDict([('ind_iou_0', 0.9772058546250926), ('ind_dice_liver_0', tensor(0.9886, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7340, dtype=torch.float64)), ('ind_iou_1', 0.98373459356043), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6515, dtype=torch.float64)), ('all_iou', 0.9778886283113024), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7296, dtype=torch.float64))]), 112401.62685490958)
Entrei no test
Meio do test
Fim do test
[2024-11-28 01:15:24,636][flwr][INFO] - fit progress: (31, 0.0033036262822956483, OrderedDict([('ind_iou_0', 0.9772058546250926), ('ind_dice_liver_0', tensor(0.9886, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7340, dtype=torch.float64)), ('ind_iou_1', 0.98373459356043), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6515, dtype=torch.float64)), ('all_iou', 0.9778886283113024), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7296, dtype=torch.float64))]), 112401.62685490958)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 01:15:24,640][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 01:17:12,764][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 01:17:12,765][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 01:17:12,766][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 01:17:12,766][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-11-28 01:17:12,766][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 01:17:12,767][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9899150254252155
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7884, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772755262476693
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7322, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9899406533777699
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7846, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772607774057808
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7337, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.988515964892073
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7819, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775566057401072
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7357, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.990393171617949
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7847, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9771013596485085
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7292, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 02:11:56,394][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.0033247283091226, OrderedDict([('ind_iou_0', 0.9771013596485085), ('ind_dice_liver_0', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7292, dtype=torch.float64)), ('ind_iou_1', 0.9831964486404262), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6499, dtype=torch.float64)), ('all_iou', 0.9777682028722582), ('all_dice_liver', tensor(0.9888, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7252, dtype=torch.float64))]), 116021.10767742898)
Entrei no test
Meio do test
Fim do test
[2024-11-28 02:15:44,117][flwr][INFO] - fit progress: (32, 0.0033247283091226, OrderedDict([('ind_iou_0', 0.9771013596485085), ('ind_dice_liver_0', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7292, dtype=torch.float64)), ('ind_iou_1', 0.9831964486404262), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6499, dtype=torch.float64)), ('all_iou', 0.9777682028722582), ('all_dice_liver', tensor(0.9888, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7252, dtype=torch.float64))]), 116021.10767742898)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 02:15:44,121][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 02:17:19,706][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 02:17:19,706][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 02:17:19,707][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 02:17:19,707][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-11-28 02:17:19,708][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 02:17:19,708][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9900706394120409
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7840, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.977338139279457
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7310, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9900333732214218
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7865, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772650784603211
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7342, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.990202485034919
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.977529245029781
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7338, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9902849583057811
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7870, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775453114911077
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 03:12:02,975][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.003349078092535827, OrderedDict([('ind_iou_0', 0.9775453114911077), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9834223331254398), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.9781960487068289), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7288, dtype=torch.float64))]), 119612.85828338284)
Entrei no test
Meio do test
Fim do test
[2024-11-28 03:15:35,868][flwr][INFO] - fit progress: (33, 0.003349078092535827, OrderedDict([('ind_iou_0', 0.9775453114911077), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7329, dtype=torch.float64)), ('ind_iou_1', 0.9834223331254398), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6522, dtype=torch.float64)), ('all_iou', 0.9781960487068289), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7288, dtype=torch.float64))]), 119612.85828338284)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 03:15:35,872][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 03:17:13,073][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 03:17:13,073][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 03:17:13,073][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 03:17:13,074][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-11-28 03:17:13,074][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 03:17:13,074][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9902969728931815
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7892, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775369868312177
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9903555713764697
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7804, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775231792436191
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7333, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904043919162123
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7926, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9770357484889182
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7301, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904215254292567
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7885, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9772829394300393
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7308, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 04:11:32,218][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.003353211362724382, OrderedDict([('ind_iou_0', 0.9772829394300393), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7308, dtype=torch.float64)), ('ind_iou_1', 0.9833995105342614), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9779637942300693), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7276, dtype=torch.float64))]), 123194.32335294224)
Entrei no test
Meio do test
Fim do test
[2024-11-28 04:15:17,333][flwr][INFO] - fit progress: (34, 0.003353211362724382, OrderedDict([('ind_iou_0', 0.9772829394300393), ('ind_dice_liver_0', tensor(0.9887, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7308, dtype=torch.float64)), ('ind_iou_1', 0.9833995105342614), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9779637942300693), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7276, dtype=torch.float64))]), 123194.32335294224)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 04:15:17,341][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 04:16:44,373][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 04:16:44,373][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 04:16:44,373][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 04:16:44,374][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-11-28 04:16:44,374][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 04:16:44,375][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904789052809875
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7915, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9773642933750898
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7292, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904586968494858
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7900, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.977418378988227
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7268, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904965035125143
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7807, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9773231847518139
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7321, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 05:11:44,497][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.0033571563036802286, OrderedDict([('ind_iou_0', 0.9775531473892802), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7342, dtype=torch.float64)), ('ind_iou_1', 0.9837240287323227), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6542, dtype=torch.float64)), ('all_iou', 0.9782252014943089), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 126820.95278156735)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9906024927687436
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7861, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775531473892802
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7342, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 05:15:43,962][flwr][INFO] - fit progress: (35, 0.0033571563036802286, OrderedDict([('ind_iou_0', 0.9775531473892802), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7342, dtype=torch.float64)), ('ind_iou_1', 0.9837240287323227), ('ind_dice_liver_1', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6542, dtype=torch.float64)), ('all_iou', 0.9782252014943089), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 126820.95278156735)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 05:15:43,966][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 05:17:15,049][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 05:17:15,049][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 05:17:15,050][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 05:17:15,050][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-11-28 05:17:15,050][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 05:17:15,050][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9906075504206998
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7914, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.97750654456794
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7342, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9906537955673997
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9692321535745549
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9839, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7181, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9899376697736787
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7812, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9778921506537733
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7333, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 06:11:15,259][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.0033593382400390775, OrderedDict([('ind_iou_0', 0.9776834292482883), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7344, dtype=torch.float64)), ('ind_iou_1', 0.9844340170053905), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.978415033148792), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 130350.91049361695)
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9909454119684736
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7916, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776834292482883
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7344, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 06:14:33,920][flwr][INFO] - fit progress: (36, 0.0033593382400390775, OrderedDict([('ind_iou_0', 0.9776834292482883), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7344, dtype=torch.float64)), ('ind_iou_1', 0.9844340170053905), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6544, dtype=torch.float64)), ('all_iou', 0.978415033148792), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7307, dtype=torch.float64))]), 130350.91049361695)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 06:14:33,924][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 06:16:16,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 06:16:16,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 06:16:16,554][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 06:16:16,554][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-11-28 06:16:16,554][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 06:16:16,555][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9904324562012201
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7846, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776216105141525
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.990910586825798
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7887, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9774976096951907
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7326, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9908029206065406
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7878, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776316685603802
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7323, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9906274994596845
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7899, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.975856935517315
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7284, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 07:10:59,145][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.003391125607282127, OrderedDict([('ind_iou_0', 0.975856935517315), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7284, dtype=torch.float64)), ('ind_iou_1', 0.9812323215621994), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.976485285706244), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 133987.3654365111)
Entrei no test
Meio do test
Fim do test
[2024-11-28 07:15:10,375][flwr][INFO] - fit progress: (37, 0.003391125607282127, OrderedDict([('ind_iou_0', 0.975856935517315), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7284, dtype=torch.float64)), ('ind_iou_1', 0.9812323215621994), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6486, dtype=torch.float64)), ('all_iou', 0.976485285706244), ('all_dice_liver', tensor(0.9879, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 133987.3654365111)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 07:15:10,378][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 07:16:56,084][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 07:16:56,084][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 07:16:56,084][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 07:16:56,085][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-11-28 07:16:56,085][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 07:16:56,085][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9906392180361083
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7936, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775814866543614
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7337, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9908941728548255
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7937, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9775931510927529
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7325, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9909566061560025
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7927, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9778113122635966
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7319, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9909958444047372
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7878, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9777797292241379
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7314, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 08:11:42,953][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.003389941358093868, OrderedDict([('ind_iou_0', 0.9777797292241379), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7314, dtype=torch.float64)), ('ind_iou_1', 0.9840722890283032), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6513, dtype=torch.float64)), ('all_iou', 0.9784804151009112), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7279, dtype=torch.float64))]), 137590.71143726725)
Entrei no test
Meio do test
Fim do test
[2024-11-28 08:15:13,721][flwr][INFO] - fit progress: (38, 0.003389941358093868, OrderedDict([('ind_iou_0', 0.9777797292241379), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7314, dtype=torch.float64)), ('ind_iou_1', 0.9840722890283032), ('ind_dice_liver_1', tensor(0.9914, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6513, dtype=torch.float64)), ('all_iou', 0.9784804151009112), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7279, dtype=torch.float64))]), 137590.71143726725)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 08:15:13,725][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 08:16:58,880][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 08:16:58,881][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 08:16:58,891][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 08:16:58,891][flwr][INFO] - 
[2024-11-28 08:16:58,891][flwr][INFO] - [ROUND 39]
[2024-11-28 08:16:58,892][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.991060430797625
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7920, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9777205677803095
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7358, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.991101315929054
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7955, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776810844597515
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7331, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9911085605694547
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7863, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9778158201839525
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7335, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9911260303682
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7886, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776902596651321
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7346, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 09:11:24,664][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.0034429413905449203, OrderedDict([('ind_iou_0', 0.9776902596651321), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7346, dtype=torch.float64)), ('ind_iou_1', 0.9846206547509245), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6562, dtype=torch.float64)), ('all_iou', 0.9784404527758714), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7311, dtype=torch.float64))]), 141192.36931552086)
Entrei no test
Meio do test
Fim do test
[2024-11-28 09:15:15,379][flwr][INFO] - fit progress: (39, 0.0034429413905449203, OrderedDict([('ind_iou_0', 0.9776902596651321), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7346, dtype=torch.float64)), ('ind_iou_1', 0.9846206547509245), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6562, dtype=torch.float64)), ('all_iou', 0.9784404527758714), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7311, dtype=torch.float64))]), 141192.36931552086)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 09:15:15,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 09:16:47,538][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 09:16:47,539][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 09:16:47,539][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 09:16:47,539][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-11-28 09:16:47,539][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 09:16:47,540][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  0
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9912496176273274
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7925, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9777126446684831
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  0
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  1
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9912203799763952
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7964, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9773769019015502
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7361, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  1
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  2
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9912579833623459
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7949, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9776871199466232
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7323, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  2
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1358008)[0m epoch:  3
[36m(ClientAppActor pid=1358008)[0m train ious:  0.9913352893108627
[36m(ClientAppActor pid=1358008)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m train dice tumour:  tensor(0.7845, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation ious:  0.9777814739801413
[36m(ClientAppActor pid=1358008)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m validation dice tumour:  tensor(0.7363, dtype=torch.float64)
[36m(ClientAppActor pid=1358008)[0m => new best model:  3
[2024-11-28 10:11:08,447][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.003396845251481258, OrderedDict([('ind_iou_0', 0.9777814739801413), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7363, dtype=torch.float64)), ('ind_iou_1', 0.984919181733902), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6555, dtype=torch.float64)), ('all_iou', 0.9785395152780921), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7326, dtype=torch.float64))]), 144760.12871477474)
Entrei no test
Meio do test
Fim do test
[2024-11-28 10:14:43,138][flwr][INFO] - fit progress: (40, 0.003396845251481258, OrderedDict([('ind_iou_0', 0.9777814739801413), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7363, dtype=torch.float64)), ('ind_iou_1', 0.984919181733902), ('ind_dice_liver_1', tensor(0.9918, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6555, dtype=torch.float64)), ('all_iou', 0.9785395152780921), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7326, dtype=torch.float64))]), 144760.12871477474)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 10:14:43,143][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1358008)[0m Entrei no validation 1 3
[2024-11-28 10:16:27,543][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 10:16:27,543][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1358008, ip=172.18.62.4, actor_id=034c690fae22c998160e95c801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1551440b9490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 10:16:27,543][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 10:16:27,543][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-11-28 10:16:27,543][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 144864.53s
[2024-11-28 10:16:27,543][flwr][INFO] - Run finished 40 round(s) in 144864.53s
[92mINFO [0m:      	History (loss, centralized):
[2024-11-28 10:16:27,660][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.7043031710932003
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 0: 0.7043031710932003
[92mINFO [0m:      		round 1: 0.006403941509627275
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 1: 0.006403941509627275
[92mINFO [0m:      		round 2: 0.0050533997839567
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 2: 0.0050533997839567
[92mINFO [0m:      		round 3: 0.004342904730891536
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 3: 0.004342904730891536
[92mINFO [0m:      		round 4: 0.00428442600560812
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 4: 0.00428442600560812
[92mINFO [0m:      		round 5: 0.0038780910125739794
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 5: 0.0038780910125739794
[92mINFO [0m:      		round 6: 0.0034814376804831477
[2024-11-28 10:16:27,660][flwr][INFO] - 		round 6: 0.0034814376804831477
[92mINFO [0m:      		round 7: 0.00341646312508958
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 7: 0.00341646312508958
[92mINFO [0m:      		round 8: 0.0033416935203953533
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 8: 0.0033416935203953533
[92mINFO [0m:      		round 9: 0.0031887487254208496
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 9: 0.0031887487254208496
[92mINFO [0m:      		round 10: 0.0031744974584503633
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 10: 0.0031744974584503633
[92mINFO [0m:      		round 11: 0.0032392938357227517
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 11: 0.0032392938357227517
[92mINFO [0m:      		round 12: 0.003113147121766642
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 12: 0.003113147121766642
[92mINFO [0m:      		round 13: 0.003114633645040651
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 13: 0.003114633645040651
[92mINFO [0m:      		round 14: 0.003128955120444475
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 14: 0.003128955120444475
[92mINFO [0m:      		round 15: 0.003097495119675427
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 15: 0.003097495119675427
[92mINFO [0m:      		round 16: 0.003077752173487341
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 16: 0.003077752173487341
[92mINFO [0m:      		round 17: 0.003101708240503629
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 17: 0.003101708240503629
[92mINFO [0m:      		round 18: 0.0030500399148120465
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 18: 0.0030500399148120465
[92mINFO [0m:      		round 19: 0.0031872902655759195
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 19: 0.0031872902655759195
[92mINFO [0m:      		round 20: 0.0030948775219116426
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 20: 0.0030948775219116426
[92mINFO [0m:      		round 21: 0.0031354548059089396
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 21: 0.0031354548059089396
[92mINFO [0m:      		round 22: 0.003127146368695691
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 22: 0.003127146368695691
[92mINFO [0m:      		round 23: 0.0031902870739168986
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 23: 0.0031902870739168986
[92mINFO [0m:      		round 24: 0.0032035952562678885
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 24: 0.0032035952562678885
[92mINFO [0m:      		round 25: 0.003220780934904803
[2024-11-28 10:16:27,661][flwr][INFO] - 		round 25: 0.003220780934904803
[92mINFO [0m:      		round 26: 0.0032055707557312922
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 26: 0.0032055707557312922
[92mINFO [0m:      		round 27: 0.003180830807986533
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 27: 0.003180830807986533
[92mINFO [0m:      		round 28: 0.0030749148139109952
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 28: 0.0030749148139109952
[92mINFO [0m:      		round 29: 0.003239431041685973
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 29: 0.003239431041685973
[92mINFO [0m:      		round 30: 0.003128368396275454
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 30: 0.003128368396275454
[92mINFO [0m:      		round 31: 0.0033036262822956483
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 31: 0.0033036262822956483
[92mINFO [0m:      		round 32: 0.0033247283091226
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 32: 0.0033247283091226
[92mINFO [0m:      		round 33: 0.003349078092535827
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 33: 0.003349078092535827
[92mINFO [0m:      		round 34: 0.003353211362724382
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 34: 0.003353211362724382
[92mINFO [0m:      		round 35: 0.0033571563036802286
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 35: 0.0033571563036802286
[92mINFO [0m:      		round 36: 0.0033593382400390775
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 36: 0.0033593382400390775
[92mINFO [0m:      		round 37: 0.003391125607282127
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 37: 0.003391125607282127
[92mINFO [0m:      		round 38: 0.003389941358093868
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 38: 0.003389941358093868
[92mINFO [0m:      		round 39: 0.0034429413905449203
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 39: 0.0034429413905449203
[92mINFO [0m:      		round 40: 0.003396845251481258
[2024-11-28 10:16:27,662][flwr][INFO] - 		round 40: 0.003396845251481258
[92mINFO [0m:      	History (metrics, centralized):
[2024-11-28 10:16:27,662][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1687, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1687, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.9675, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (1, tensor(0.9675, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.9729, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (2, tensor(0.9729, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.9757, dtype=torch.float64)),
[2024-11-28 10:16:27,662][flwr][INFO] - 	                    (3, tensor(0.9757, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.9765, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (4, tensor(0.9765, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.9796, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (5, tensor(0.9796, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.9819, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (6, tensor(0.9819, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.9831, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (7, tensor(0.9831, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.9840, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (8, tensor(0.9840, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.9846, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (9, tensor(0.9846, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.9854, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (10, tensor(0.9854, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.9854, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (11, tensor(0.9854, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.9862, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (12, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.9864, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (13, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.9864, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (14, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (15, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.9871, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (16, tensor(0.9871, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.9871, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (17, tensor(0.9871, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.9874, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (18, tensor(0.9874, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.9867, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (19, tensor(0.9867, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.9878, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (20, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (21, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,663][flwr][INFO] - 	                    (22, tensor(0.9882, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (23, tensor(0.9882, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.9881, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (24, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (25, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (26, tensor(0.9886, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (27, tensor(0.9886, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.9881, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (28, tensor(0.9881, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.9887, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (29, tensor(0.9887, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (30, tensor(0.9885, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.9889, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (31, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (32, tensor(0.9888, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (33, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.9889, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (34, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.9891, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (35, tensor(0.9891, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (36, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (37, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (38, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.9893, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (39, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.9894, dtype=torch.float64))],
[2024-11-28 10:16:27,664][flwr][INFO] - 	                    (40, tensor(0.9894, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.5643, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                     (1, tensor(0.5643, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.6097, dtype=torch.float64)),
[2024-11-28 10:16:27,664][flwr][INFO] - 	                     (2, tensor(0.6097, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.6363, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (3, tensor(0.6363, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.6444, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (4, tensor(0.6444, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.6634, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (5, tensor(0.6634, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.6793, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (6, tensor(0.6793, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.6866, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (7, tensor(0.6866, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.6911, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (8, tensor(0.6911, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.6977, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (9, tensor(0.6977, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.7007, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (10, tensor(0.7007, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.7062, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (11, tensor(0.7062, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.7105, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (12, tensor(0.7105, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.7132, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (13, tensor(0.7132, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.7135, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (14, tensor(0.7135, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.7142, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (15, tensor(0.7142, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.7162, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (16, tensor(0.7162, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.7200, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (17, tensor(0.7200, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.7197, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (18, tensor(0.7197, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.7139, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (19, tensor(0.7139, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.7222, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (20, tensor(0.7222, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.7208, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (21, tensor(0.7208, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.7223, dtype=torch.float64)),
[2024-11-28 10:16:27,665][flwr][INFO] - 	                     (22, tensor(0.7223, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.7261, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (23, tensor(0.7261, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (24, tensor(0.7214, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.7214, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.7292, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (25, tensor(0.7292, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.7283, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (26, tensor(0.7283, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.7285, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (27, tensor(0.7285, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.7235, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (28, tensor(0.7235, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.7318, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (29, tensor(0.7318, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.7257, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (30, tensor(0.7257, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.7296, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (31, tensor(0.7296, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.7252, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (32, tensor(0.7252, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.7288, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (33, tensor(0.7288, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.7276, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (34, tensor(0.7276, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.7307, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (35, tensor(0.7307, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.7307, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (36, tensor(0.7307, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.7243, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (37, tensor(0.7243, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.7279, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (38, tensor(0.7279, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.7311, dtype=torch.float64)),
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (39, tensor(0.7311, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.7326, dtype=torch.float64))],
[2024-11-28 10:16:27,666][flwr][INFO] - 	                     (40, tensor(0.7326, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 0.06546496448727193),
[2024-11-28 10:16:27,666][flwr][INFO] - 	 'all_iou': [(0, 0.06546496448727193),
[92mINFO [0m:      	             (1, 0.9454104017544205),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (1, 0.9454104017544205),
[92mINFO [0m:      	             (2, 0.9558033147938135),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (2, 0.9558033147938135),
[92mINFO [0m:      	             (3, 0.9612137366980711),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (3, 0.9612137366980711),
[92mINFO [0m:      	             (4, 0.9621756644492357),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (4, 0.9621756644492357),
[92mINFO [0m:      	             (5, 0.9658667418898235),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (5, 0.9658667418898235),
[92mINFO [0m:      	             (6, 0.9694482975683638),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (6, 0.9694482975683638),
[92mINFO [0m:      	             (7, 0.970521052330803),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (7, 0.970521052330803),
[92mINFO [0m:      	             (8, 0.9716201160878497),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (8, 0.9716201160878497),
[92mINFO [0m:      	             (9, 0.9730584856279966),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (9, 0.9730584856279966),
[92mINFO [0m:      	             (10, 0.9735583709284229),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (10, 0.9735583709284229),
[92mINFO [0m:      	             (11, 0.9736761676674213),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (11, 0.9736761676674213),
[92mINFO [0m:      	             (12, 0.9747876703321112),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (12, 0.9747876703321112),
[92mINFO [0m:      	             (13, 0.9749266880949851),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (13, 0.9749266880949851),
[92mINFO [0m:      	             (14, 0.9749733388701632),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (14, 0.9749733388701632),
[92mINFO [0m:      	             (15, 0.9756268551453247),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (15, 0.9756268551453247),
[92mINFO [0m:      	             (16, 0.9759010390385884),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (16, 0.9759010390385884),
[92mINFO [0m:      	             (17, 0.9759901091540316),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (17, 0.9759901091540316),
[92mINFO [0m:      	             (18, 0.9765187778575708),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (18, 0.9765187778575708),
[92mINFO [0m:      	             (19, 0.9752275279538544),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (19, 0.9752275279538544),
[92mINFO [0m:      	             (20, 0.9768614437893962),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (20, 0.9768614437893962),
[92mINFO [0m:      	             (21, 0.9769643321446412),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (21, 0.9769643321446412),
[92mINFO [0m:      	             (22, 0.9773331726056703),
[2024-11-28 10:16:27,667][flwr][INFO] - 	             (22, 0.9773331726056703),
[92mINFO [0m:      	             (23, 0.9771830425257341),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (23, 0.9771830425257341),
[92mINFO [0m:      	             (24, 0.9771847812712986),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (24, 0.9771847812712986),
[92mINFO [0m:      	             (25, 0.9775215141593329),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (25, 0.9775215141593329),
[92mINFO [0m:      	             (26, 0.9777226295561737),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (26, 0.9777226295561737),
[92mINFO [0m:      	             (27, 0.9777096114753222),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (27, 0.9777096114753222),
[92mINFO [0m:      	             (28, 0.9772533363148271),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (28, 0.9772533363148271),
[92mINFO [0m:      	             (29, 0.9777782367369191),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (29, 0.9777782367369191),
[92mINFO [0m:      	             (30, 0.9777167415541976),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (30, 0.9777167415541976),
[92mINFO [0m:      	             (31, 0.9778886283113024),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (31, 0.9778886283113024),
[92mINFO [0m:      	             (32, 0.9777682028722582),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (32, 0.9777682028722582),
[92mINFO [0m:      	             (33, 0.9781960487068289),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (33, 0.9781960487068289),
[92mINFO [0m:      	             (34, 0.9779637942300693),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (34, 0.9779637942300693),
[92mINFO [0m:      	             (35, 0.9782252014943089),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (35, 0.9782252014943089),
[92mINFO [0m:      	             (36, 0.978415033148792),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (36, 0.978415033148792),
[92mINFO [0m:      	             (37, 0.976485285706244),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (37, 0.976485285706244),
[92mINFO [0m:      	             (38, 0.9784804151009112),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (38, 0.9784804151009112),
[92mINFO [0m:      	             (39, 0.9784404527758714),
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (39, 0.9784404527758714),
[92mINFO [0m:      	             (40, 0.9785395152780921)],
[2024-11-28 10:16:27,668][flwr][INFO] - 	             (40, 0.9785395152780921)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1688, dtype=torch.float64)),
[2024-11-28 10:16:27,668][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1688, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9678, dtype=torch.float64)),
[2024-11-28 10:16:27,668][flwr][INFO] - 	                      (1, tensor(0.9678, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9731, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (2, tensor(0.9731, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9759, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (3, tensor(0.9759, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9766, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (4, tensor(0.9766, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9797, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (5, tensor(0.9797, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9819, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (6, tensor(0.9819, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9830, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (7, tensor(0.9830, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9840, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (8, tensor(0.9840, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9845, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (9, tensor(0.9845, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9853, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (10, tensor(0.9853, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9853, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (11, tensor(0.9853, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9860, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (12, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9863, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (13, tensor(0.9863, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9862, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (14, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9867, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (15, tensor(0.9867, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (16, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9869, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (17, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9872, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (18, tensor(0.9872, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9865, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (19, tensor(0.9865, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9876, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (20, tensor(0.9876, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9877, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (21, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (22, tensor(0.9880, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,669][flwr][INFO] - 	                      (23, tensor(0.9880, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9879, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (24, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9882, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (25, tensor(0.9882, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9883, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (26, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (27, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9878, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (28, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (29, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9883, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (30, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9886, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (31, tensor(0.9886, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (32, tensor(0.9885, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (33, tensor(0.9888, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9887, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (34, tensor(0.9887, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9888, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (35, tensor(0.9888, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (36, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9877, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (37, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (38, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (39, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9891, dtype=torch.float64))],
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (40, tensor(0.9891, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1675, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1675, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9641, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (1, tensor(0.9641, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9706, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (2, tensor(0.9706, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9740, dtype=torch.float64)),
[2024-11-28 10:16:27,670][flwr][INFO] - 	                      (3, tensor(0.9740, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9753, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (4, tensor(0.9753, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9791, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (5, tensor(0.9791, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9817, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (6, tensor(0.9817, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9830, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (7, tensor(0.9830, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9842, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (8, tensor(0.9842, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9855, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (9, tensor(0.9855, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9863, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (10, tensor(0.9863, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9856, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (11, tensor(0.9856, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9875, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (12, tensor(0.9875, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9873, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (13, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9875, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (14, tensor(0.9875, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (15, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9884, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (16, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9885, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (17, tensor(0.9885, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (18, tensor(0.9890, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (19, tensor(0.9880, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (20, tensor(0.9894, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (21, tensor(0.9899, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (22, tensor(0.9900, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (23, tensor(0.9897, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (24, tensor(0.9901, dtype=torch.float64)),
[2024-11-28 10:16:27,671][flwr][INFO] - 	                      (25, tensor(0.9903, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (26, tensor(0.9906, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (27, tensor(0.9906, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (28, tensor(0.9901, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (29, tensor(0.9905, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (30, tensor(0.9907, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (31, tensor(0.9911, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (32, tensor(0.9907, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (33, tensor(0.9909, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (34, tensor(0.9909, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (35, tensor(0.9911, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (36, tensor(0.9915, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (37, tensor(0.9895, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (38, tensor(0.9914, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (39, tensor(0.9917, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                      (40, tensor(0.9918, dtype=torch.float64))],
[2024-11-28 10:16:27,672][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (1, tensor(0.5714, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (2, tensor(0.6164, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (3, tensor(0.6428, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (4, tensor(0.6504, dtype=torch.float64)),
[2024-11-28 10:16:27,672][flwr][INFO] - 	                       (5, tensor(0.6696, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (6, tensor(0.6857, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (7, tensor(0.6928, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (8, tensor(0.6961, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (9, tensor(0.7034, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (10, tensor(0.7059, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (11, tensor(0.7114, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (12, tensor(0.7159, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (13, tensor(0.7177, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (14, tensor(0.7182, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (15, tensor(0.7184, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9880, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9894, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9899, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9897, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9907, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9907, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9915, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9895, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9914, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9917, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9918, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.5714, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.6164, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.6428, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.6504, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.6696, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.6857, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.6928, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.6961, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.7034, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.7059, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.7114, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.7159, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.7177, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.7182, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.7184, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.7204, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.7245, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.7252, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.7186, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.7267, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.7259, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.7261, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.7298, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (16, tensor(0.7204, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (17, tensor(0.7245, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (18, tensor(0.7252, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (19, tensor(0.7186, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (20, tensor(0.7267, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (21, tensor(0.7259, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (22, tensor(0.7261, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (23, tensor(0.7298, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (24, tensor(0.7253, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (25, tensor(0.7334, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.7253, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.7334, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (26, tensor(0.7326, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.7326, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.7329, dtype=torch.float64)),
[2024-11-28 10:16:27,673][flwr][INFO] - 	                       (27, tensor(0.7329, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.7274, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (28, tensor(0.7274, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.7362, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (29, tensor(0.7362, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.7300, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (30, tensor(0.7300, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.7340, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (31, tensor(0.7340, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.7292, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (32, tensor(0.7292, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.7329, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (33, tensor(0.7329, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.7308, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (34, tensor(0.7308, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.7342, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (35, tensor(0.7342, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.7344, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (36, tensor(0.7344, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.7284, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (37, tensor(0.7284, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.7314, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (38, tensor(0.7314, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.7346, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (39, tensor(0.7346, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.7363, dtype=torch.float64))],
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (40, tensor(0.7363, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0076, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0076, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.4677, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (1, tensor(0.4677, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.5241, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (2, tensor(0.5241, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.5480, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (3, tensor(0.5480, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.5672, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (4, tensor(0.5672, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.5793, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (5, tensor(0.5793, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.5941, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (6, tensor(0.5941, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.6000, dtype=torch.float64)),
[2024-11-28 10:16:27,674][flwr][INFO] - 	                       (7, tensor(0.6000, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.6105, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (8, tensor(0.6105, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.6155, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (9, tensor(0.6155, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.6213, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (10, tensor(0.6213, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.6226, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (11, tensor(0.6226, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.6292, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (12, tensor(0.6292, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.6329, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (13, tensor(0.6329, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.6331, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (14, tensor(0.6331, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.6361, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (15, tensor(0.6361, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.6383, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (16, tensor(0.6383, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.6384, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (17, tensor(0.6384, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.6340, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (18, tensor(0.6340, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.6344, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (19, tensor(0.6344, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.6410, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (20, tensor(0.6410, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.6343, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (21, tensor(0.6343, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.6472, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (22, tensor(0.6472, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.6507, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (23, tensor(0.6507, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.6457, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (24, tensor(0.6457, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.6486, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (25, tensor(0.6486, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.6481, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (26, tensor(0.6481, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.6463, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (27, tensor(0.6463, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.6450, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (28, tensor(0.6450, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.6519, dtype=torch.float64)),
[2024-11-28 10:16:27,675][flwr][INFO] - 	                       (29, tensor(0.6519, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.6469, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (30, tensor(0.6469, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.6515, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (31, tensor(0.6515, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.6499, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (32, tensor(0.6499, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.6522, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (33, tensor(0.6522, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.6540, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (34, tensor(0.6540, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.6542, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (35, tensor(0.6542, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.6544, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (36, tensor(0.6544, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.6486, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (37, tensor(0.6486, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.6513, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (38, tensor(0.6513, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.6562, dtype=torch.float64)),
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (39, tensor(0.6562, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.6555, dtype=torch.float64))],
[2024-11-28 10:16:27,676][flwr][INFO] - 	                       (40, tensor(0.6555, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 0.0654708156290535),
[2024-11-28 10:16:27,676][flwr][INFO] - 	 'ind_iou_0': [(0, 0.0654708156290535),
[92mINFO [0m:      	               (1, 0.9457119029730147),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (1, 0.9457119029730147),
[92mINFO [0m:      	               (2, 0.9558546715981541),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (2, 0.9558546715981541),
[92mINFO [0m:      	               (3, 0.9611622124712068),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (3, 0.9611622124712068),
[92mINFO [0m:      	               (4, 0.961981781158944),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (4, 0.961981781158944),
[92mINFO [0m:      	               (5, 0.965663195835508),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (5, 0.965663195835508),
[92mINFO [0m:      	               (6, 0.969225818066841),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (6, 0.969225818066841),
[92mINFO [0m:      	               (7, 0.9702473909970715),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (7, 0.9702473909970715),
[92mINFO [0m:      	               (8, 0.9713154943676034),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (8, 0.9713154943676034),
[92mINFO [0m:      	               (9, 0.9726674898525501),
[2024-11-28 10:16:27,676][flwr][INFO] - 	               (9, 0.9726674898525501),
[92mINFO [0m:      	               (10, 0.9731415026687117),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (10, 0.9731415026687117),
[92mINFO [0m:      	               (11, 0.9733371411296339),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (11, 0.9733371411296339),
[92mINFO [0m:      	               (12, 0.9743088004215644),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (12, 0.9743088004215644),
[92mINFO [0m:      	               (13, 0.9744859314952669),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (13, 0.9744859314952669),
[92mINFO [0m:      	               (14, 0.9744850239653781),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (14, 0.9744850239653781),
[92mINFO [0m:      	               (15, 0.9750988712910427),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (15, 0.9750988712910427),
[92mINFO [0m:      	               (16, 0.975376872640335),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (16, 0.975376872640335),
[92mINFO [0m:      	               (17, 0.9754605427624762),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (17, 0.9754605427624762),
[92mINFO [0m:      	               (18, 0.9759720405646746),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (18, 0.9759720405646746),
[92mINFO [0m:      	               (19, 0.9747182211406173),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (19, 0.9747182211406173),
[92mINFO [0m:      	               (20, 0.9763184793903508),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (20, 0.9763184793903508),
[92mINFO [0m:      	               (21, 0.9763531444778881),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (21, 0.9763531444778881),
[92mINFO [0m:      	               (22, 0.9766949693617846),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (22, 0.9766949693617846),
[92mINFO [0m:      	               (23, 0.9765998676573923),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (23, 0.9765998676573923),
[92mINFO [0m:      	               (24, 0.9765716768931899),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (24, 0.9765716768931899),
[92mINFO [0m:      	               (25, 0.9768842555751251),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (25, 0.9768842555751251),
[92mINFO [0m:      	               (26, 0.977081121955697),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (26, 0.977081121955697),
[92mINFO [0m:      	               (27, 0.9770779384077869),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (27, 0.9770779384077869),
[92mINFO [0m:      	               (28, 0.9766038663891664),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (28, 0.9766038663891664),
[92mINFO [0m:      	               (29, 0.9771579020015174),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (29, 0.9771579020015174),
[92mINFO [0m:      	               (30, 0.9770598963066148),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (30, 0.9770598963066148),
[92mINFO [0m:      	               (31, 0.9772058546250926),
[2024-11-28 10:16:27,677][flwr][INFO] - 	               (31, 0.9772058546250926),
[92mINFO [0m:      	               (32, 0.9771013596485085),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (32, 0.9771013596485085),
[92mINFO [0m:      	               (33, 0.9775453114911077),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (33, 0.9775453114911077),
[92mINFO [0m:      	               (34, 0.9772829394300393),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (34, 0.9772829394300393),
[92mINFO [0m:      	               (35, 0.9775531473892802),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (35, 0.9775531473892802),
[92mINFO [0m:      	               (36, 0.9776834292482883),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (36, 0.9776834292482883),
[92mINFO [0m:      	               (37, 0.975856935517315),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (37, 0.975856935517315),
[92mINFO [0m:      	               (38, 0.9777797292241379),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (38, 0.9777797292241379),
[92mINFO [0m:      	               (39, 0.9776902596651321),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (39, 0.9776902596651321),
[92mINFO [0m:      	               (40, 0.9777814739801413)],
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (40, 0.9777814739801413)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 0.0653650756211594),
[2024-11-28 10:16:27,678][flwr][INFO] - 	 'ind_iou_1': [(0, 0.0653650756211594),
[92mINFO [0m:      	               (1, 0.9412999127239885),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (1, 0.9412999127239885),
[92mINFO [0m:      	               (2, 0.9546260626172512),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (2, 0.9546260626172512),
[92mINFO [0m:      	               (3, 0.9613343719006978),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (3, 0.9613343719006978),
[92mINFO [0m:      	               (4, 0.9631077033224844),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (4, 0.9631077033224844),
[92mINFO [0m:      	               (5, 0.9674989241556511),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (5, 0.9674989241556511),
[92mINFO [0m:      	               (6, 0.9708177589102281),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (6, 0.9708177589102281),
[92mINFO [0m:      	               (7, 0.9722542917346813),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (7, 0.9722542917346813),
[92mINFO [0m:      	               (8, 0.9739228376175606),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (8, 0.9739228376175606),
[92mINFO [0m:      	               (9, 0.9764959335030695),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (9, 0.9764959335030695),
[92mINFO [0m:      	               (10, 0.9769288572292162),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (10, 0.9769288572292162),
[92mINFO [0m:      	               (11, 0.9759590171282189),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (11, 0.9759590171282189),
[92mINFO [0m:      	               (12, 0.9789127333155198),
[2024-11-28 10:16:27,678][flwr][INFO] - 	               (12, 0.9789127333155198),
[92mINFO [0m:      	               (13, 0.978323456236889),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (13, 0.978323456236889),
[92mINFO [0m:      	               (14, 0.9787596868650466),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (14, 0.9787596868650466),
[92mINFO [0m:      	               (15, 0.9801168821024651),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (15, 0.9801168821024651),
[92mINFO [0m:      	               (16, 0.9801341479914036),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (16, 0.9801341479914036),
[92mINFO [0m:      	               (17, 0.9803693830912049),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (17, 0.9803693830912049),
[92mINFO [0m:      	               (18, 0.9812195080396462),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (18, 0.9812195080396462),
[92mINFO [0m:      	               (19, 0.9795783950002596),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (19, 0.9795783950002596),
[92mINFO [0m:      	               (20, 0.9814863108263304),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (20, 0.9814863108263304),
[92mINFO [0m:      	               (21, 0.9822307635014473),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (21, 0.9822307635014473),
[92mINFO [0m:      	               (22, 0.9824695692320257),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (22, 0.9824695692320257),
[92mINFO [0m:      	               (23, 0.9818668819528756),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (23, 0.9818668819528756),
[92mINFO [0m:      	               (24, 0.9823264104283586),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (24, 0.9823264104283586),
[92mINFO [0m:      	               (25, 0.9826953341122924),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (25, 0.9826953341122924),
[92mINFO [0m:      	               (26, 0.9832299150543478),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (26, 0.9832299150543478),
[92mINFO [0m:      	               (27, 0.9829497834094191),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (27, 0.9829497834094191),
[92mINFO [0m:      	               (28, 0.9829444883558459),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (28, 0.9829444883558459),
[92mINFO [0m:      	               (29, 0.9827492238639275),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (29, 0.9827492238639275),
[92mINFO [0m:      	               (30, 0.9834096667568272),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (30, 0.9834096667568272),
[92mINFO [0m:      	               (31, 0.98373459356043),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (31, 0.98373459356043),
[92mINFO [0m:      	               (32, 0.9831964486404262),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (32, 0.9831964486404262),
[92mINFO [0m:      	               (33, 0.9834223331254398),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (33, 0.9834223331254398),
[92mINFO [0m:      	               (34, 0.9833995105342614),
[2024-11-28 10:16:27,679][flwr][INFO] - 	               (34, 0.9833995105342614),
[92mINFO [0m:      	               (35, 0.9837240287323227),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (35, 0.9837240287323227),
[92mINFO [0m:      	               (36, 0.9844340170053905),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (36, 0.9844340170053905),
[92mINFO [0m:      	               (37, 0.9812323215621994),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (37, 0.9812323215621994),
[92mINFO [0m:      	               (38, 0.9840722890283032),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (38, 0.9840722890283032),
[92mINFO [0m:      	               (39, 0.9846206547509245),
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (39, 0.9846206547509245),
[92mINFO [0m:      	               (40, 0.984919181733902)]}
[2024-11-28 10:16:27,680][flwr][INFO] - 	               (40, 0.984919181733902)]}
[92mINFO [0m:      
[2024-11-28 10:16:27,680][flwr][INFO] - 
