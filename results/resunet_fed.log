/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.res_unet_plus.ResUnetPlusPlus
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 2
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 2
num_clients_per_round_eval: 2
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

/home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  2
2 15165
2 1658
3 3791
3 414
3 4205
cuda:0
[2024-11-19 03:48:00,104][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-11-19 03:48:03,049	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'GPU': 3.0, 'object_store_memory': 200000000000.0, 'node:172.18.62.10': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 826033560576.0, 'node:__internal_head__': 1.0}
[2024-11-19 03:48:23,326][flwr][INFO] - Flower VCE: Ray initialized with resources: {'GPU': 3.0, 'object_store_memory': 200000000000.0, 'node:172.18.62.10': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 826033560576.0, 'node:__internal_head__': 1.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-19 03:48:23,327][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-19 03:48:23,327][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-19 03:48:23,336][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-11-19 03:48:23,343][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-11-19 03:48:23,343][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-11-19 03:48:26,904][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-11-19 03:48:26,904][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.6405578968074177, OrderedDict([('ind_iou_0', 0.045347963619816585), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0584883726406545), ('ind_dice_liver_1', tensor(0.1508, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0076, dtype=torch.float64)), ('all_iou', 0.04664898041352644), ('all_dice_liver', tensor(0.1520, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-11-19 03:53:20,251][flwr][INFO] - initial parameters (loss, other metrics): 0.6405578968074177, OrderedDict([('ind_iou_0', 0.045347963619816585), ('ind_dice_liver_0', tensor(0.1523, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0584883726406545), ('ind_dice_liver_1', tensor(0.1508, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0076, dtype=torch.float64)), ('all_iou', 0.04664898041352644), ('all_dice_liver', tensor(0.1520, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
[92mINFO [0m:      
[2024-11-19 03:53:20,364][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-11-19 03:53:20,364][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 03:53:20,364][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.6643170521478875
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.6095, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.0088, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.8663161720163095
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.8290, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.0100, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.8681566614939069
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.8767, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.0496, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9080443219058965
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.8984, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.1354, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.913537466187166
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9321, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.1876, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9199873556892705
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9430, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.1953, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9365172275122008
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9533, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.2987, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9371975912819831
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9542, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.3328, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.8291622941575983
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.8560, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.1811, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9110215150472583
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9423, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.3504, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9204641197004789
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9494, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.4403, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9314171553811758
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9541, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.4554, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9372312722658777
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9602, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5195, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.945581689428003
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9661, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5539, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9452339885613342
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9653, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5605, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9506430332615811
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9675, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5713, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 05:12:31,652][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-11-19 05:12:31,784][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.007695515565164432, OrderedDict([('ind_iou_0', 0.9383278083270113), ('ind_dice_liver_0', tensor(0.9509, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.4655, dtype=torch.float64)), ('ind_iou_1', 0.9252327753955707), ('ind_dice_liver_1', tensor(0.9429, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3707, dtype=torch.float64)), ('all_iou', 0.9364238685711042), ('all_dice_liver', tensor(0.9498, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4638, dtype=torch.float64))]), 5003.076798993163)
Entrei no test
Meio do test
Fim do test
[2024-11-19 05:16:43,441][flwr][INFO] - fit progress: (1, 0.007695515565164432, OrderedDict([('ind_iou_0', 0.9383278083270113), ('ind_dice_liver_0', tensor(0.9509, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.4655, dtype=torch.float64)), ('ind_iou_1', 0.9252327753955707), ('ind_dice_liver_1', tensor(0.9429, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3707, dtype=torch.float64)), ('all_iou', 0.9364238685711042), ('all_dice_liver', tensor(0.9498, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4638, dtype=torch.float64))]), 5003.076798993163)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 05:16:43,449][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 05:16:58,303][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 05:16:58,303][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 05:18:33,859][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 05:18:33,859][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 05:18:33,860][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 05:18:33,860][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-11-19 05:18:33,860][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 05:18:33,860][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9485918125395638
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9664, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.4838, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9516914424126551
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9687, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.4752, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9560686950359487
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9709, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5207, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9593506585268688
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9735, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5138, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9611201479477783
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9744, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5386, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.959203125888006
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9731, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5267, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9652245209255392
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5429, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9637074727780532
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9766, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5461, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9476587983290656
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9668, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5675, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9546643636464369
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9712, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5936, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.953979921468297
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9710, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6072, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9559807877366248
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9722, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6005, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9565448293729328
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9727, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6160, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9580875040340828
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6147, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9585245372226454
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9737, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6260, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9608340699984558
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9748, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6375, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-19 06:39:38,516][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.004415483337159265, OrderedDict([('ind_iou_0', 0.9610052681647172), ('ind_dice_liver_0', tensor(0.9744, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6330, dtype=torch.float64)), ('ind_iou_1', 0.959605695059962), ('ind_dice_liver_1', tensor(0.9716, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5383, dtype=torch.float64)), ('all_iou', 0.9607029247167751), ('all_dice_liver', tensor(0.9740, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6325, dtype=torch.float64))]), 10223.061936871149)
Entrei no test
Meio do test
Fim do test
[2024-11-19 06:43:43,426][flwr][INFO] - fit progress: (2, 0.004415483337159265, OrderedDict([('ind_iou_0', 0.9610052681647172), ('ind_dice_liver_0', tensor(0.9744, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6330, dtype=torch.float64)), ('ind_iou_1', 0.959605695059962), ('ind_dice_liver_1', tensor(0.9716, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5383, dtype=torch.float64)), ('all_iou', 0.9607029247167751), ('all_dice_liver', tensor(0.9740, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6325, dtype=torch.float64))]), 10223.061936871149)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 06:43:43,429][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[2024-11-19 06:43:55,818][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 06:43:55,818][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 06:46:25,808][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 06:46:25,808][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 06:46:25,808][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 06:46:25,808][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-11-19 06:46:25,809][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 06:46:25,809][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9615178098341053
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9750, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5456, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9638401224605297
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9758, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5491, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9668814901299759
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9781, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5604, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9646979804704873
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5652, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9650019920439037
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5668, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9653795394613987
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9777, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5510, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.971893124616059
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5761, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9698932994340498
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9811, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5812, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9611956566242473
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9757, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6394, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9612932349431974
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9758, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6227, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9623393697447118
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9764, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6447, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9614106421867397
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9749, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6373, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9657855311699731
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6665, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9657919979823553
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9787, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6623, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9659597065517258
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9786, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6648, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9621837655656044
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9772, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6371, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 08:05:45,847][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.004228472346996426, OrderedDict([('ind_iou_0', 0.9630056289222647), ('ind_dice_liver_0', tensor(0.9777, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6425, dtype=torch.float64)), ('ind_iou_1', 0.9614547816224879), ('ind_dice_liver_1', tensor(0.9754, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5158, dtype=torch.float64)), ('all_iou', 0.9627558264231478), ('all_dice_liver', tensor(0.9774, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6382, dtype=torch.float64))]), 15372.213623914868)
Entrei no test
Meio do test
Fim do test
[2024-11-19 08:09:32,577][flwr][INFO] - fit progress: (3, 0.004228472346996426, OrderedDict([('ind_iou_0', 0.9630056289222647), ('ind_dice_liver_0', tensor(0.9777, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6425, dtype=torch.float64)), ('ind_iou_1', 0.9614547816224879), ('ind_dice_liver_1', tensor(0.9754, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5158, dtype=torch.float64)), ('all_iou', 0.9627558264231478), ('all_dice_liver', tensor(0.9774, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6382, dtype=torch.float64))]), 15372.213623914868)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 08:09:32,581][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 08:09:45,187][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 08:09:45,187][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 08:11:01,891][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 08:11:01,892][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 08:11:01,893][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 08:11:01,893][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-11-19 08:11:01,893][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 08:11:01,893][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9675334940798075
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9788, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5786, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9678266353911474
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9794, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5732, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9713018891527686
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5711, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9696073973037294
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9806, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5738, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.974215367409377
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9831, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5760, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.969430133925883
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9814, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5854, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9748975061605524
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5825, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9709823028452056
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5821, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9673350508398455
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9796, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6680, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.966515801678505
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9794, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6692, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9687426996803534
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9804, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6754, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9677264059977257
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9802, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6738, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9707025192438953
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6919, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9680550600347054
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6587, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.971100451879907
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6788, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9697502710919501
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6778, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 09:33:05,615][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.003334052249383376, OrderedDict([('ind_iou_0', 0.970061746461106), ('ind_dice_liver_0', tensor(0.9815, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6781, dtype=torch.float64)), ('ind_iou_1', 0.9711598504327614), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5886, dtype=torch.float64)), ('all_iou', 0.9700263027982723), ('all_dice_liver', tensor(0.9813, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6769, dtype=torch.float64))]), 20709.703393450007)
Entrei no test
Meio do test
Fim do test
[2024-11-19 09:38:30,067][flwr][INFO] - fit progress: (4, 0.003334052249383376, OrderedDict([('ind_iou_0', 0.970061746461106), ('ind_dice_liver_0', tensor(0.9815, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6781, dtype=torch.float64)), ('ind_iou_1', 0.9711598504327614), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5886, dtype=torch.float64)), ('all_iou', 0.9700263027982723), ('all_dice_liver', tensor(0.9813, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6769, dtype=torch.float64))]), 20709.703393450007)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 09:38:30,106][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 09:38:43,062][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 09:38:43,063][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 09:39:55,839][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 09:39:55,839][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 09:39:55,839][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 09:39:55,840][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-11-19 09:39:55,840][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 09:39:55,840][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9720220798577408
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5628, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9706436135245805
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9809, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5812, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9748770301703242
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5985, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9727193778422626
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5940, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9757830376902851
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9841, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6069, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9740907715859553
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9835, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6057, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9783005189666936
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6068, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9735498481339868
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.5903, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9712778835679985
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6830, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9696233208036978
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9816, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6836, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9736151969188415
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6927, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9697723009372224
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9817, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6727, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9740615978680741
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9839, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7005, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9707536291733512
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9827, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6834, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9746345705229075
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7014, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9714010411140565
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9827, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6928, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 11:16:11,274][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.0031257430155729425, OrderedDict([('ind_iou_0', 0.971949678136263), ('ind_dice_liver_0', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6943, dtype=torch.float64)), ('ind_iou_1', 0.9736644694104369), ('ind_dice_liver_1', tensor(0.9826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5966, dtype=torch.float64)), ('all_iou', 0.97207470303096), ('all_dice_liver', tensor(0.9829, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6927, dtype=torch.float64))]), 27031.475164800882)
Entrei no test
Meio do test
Fim do test
[2024-11-19 11:23:51,839][flwr][INFO] - fit progress: (5, 0.0031257430155729425, OrderedDict([('ind_iou_0', 0.971949678136263), ('ind_dice_liver_0', tensor(0.9830, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6943, dtype=torch.float64)), ('ind_iou_1', 0.9736644694104369), ('ind_dice_liver_1', tensor(0.9826, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5966, dtype=torch.float64)), ('all_iou', 0.97207470303096), ('all_dice_liver', tensor(0.9829, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6927, dtype=torch.float64))]), 27031.475164800882)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 11:23:51,925][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 11:24:04,570][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 11:24:04,571][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 11:25:11,712][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 11:25:11,713][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 11:25:11,713][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 11:25:11,713][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-11-19 11:25:11,713][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 11:25:11,714][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9748192971180143
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5880, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9729197934366387
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9828, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6071, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9772141478637026
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6091, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9745805728471661
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9842, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.5992, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9789284021631102
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6166, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9757971347587349
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6140, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9803388954392711
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5953, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.975704855461172
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6046, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9749356582062293
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7015, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9695226084017265
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9816, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6760, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9761061380359976
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7104, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9726190001741699
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9835, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6922, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.976168524683065
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7124, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9726538294599097
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9837, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6909, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9770292920480658
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7134, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9732087089282219
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9841, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6957, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-19 12:54:07,414][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.0029582380884555118, OrderedDict([('ind_iou_0', 0.973718626096793), ('ind_dice_liver_0', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6980, dtype=torch.float64)), ('ind_iou_1', 0.9745106515591554), ('ind_dice_liver_1', tensor(0.9837, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5987, dtype=torch.float64)), ('all_iou', 0.9737318685548441), ('all_dice_liver', tensor(0.9843, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6949, dtype=torch.float64))]), 32681.0425112159)
Entrei no test
Meio do test
Fim do test
[2024-11-19 12:58:01,406][flwr][INFO] - fit progress: (6, 0.0029582380884555118, OrderedDict([('ind_iou_0', 0.973718626096793), ('ind_dice_liver_0', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6980, dtype=torch.float64)), ('ind_iou_1', 0.9745106515591554), ('ind_dice_liver_1', tensor(0.9837, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5987, dtype=torch.float64)), ('all_iou', 0.9737318685548441), ('all_dice_liver', tensor(0.9843, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6949, dtype=torch.float64))]), 32681.0425112159)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 12:58:01,498][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 12:58:15,435][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 12:58:15,435][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 12:59:18,954][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 12:59:18,954][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 12:59:18,954][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 12:59:18,954][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-11-19 12:59:18,954][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 12:59:18,955][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9774088671860262
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.5981, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.975272725977151
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9837, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6086, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9791086764011172
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6117, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9768538207413333
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6132, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9802834355383941
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6150, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9764908225395428
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6027, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9810004890143587
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6286, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9766907455863705
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6106, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9774251840536258
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7154, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.972907936625842
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6984, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9779735815914133
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7163, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9733935973813529
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6991, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9784762122888628
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7228, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9739195851868758
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6981, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.97893114580692
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7261, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9740555512336246
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.7047, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 14:35:23,504][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0028640073523790257, OrderedDict([('ind_iou_0', 0.974645813472185), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7063, dtype=torch.float64)), ('ind_iou_1', 0.9760662797419374), ('ind_dice_liver_1', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6140, dtype=torch.float64)), ('all_iou', 0.9747742406541853), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7038, dtype=torch.float64))]), 38846.651787661016)
Entrei no test
Meio do test
Fim do test
[2024-11-19 14:40:47,016][flwr][INFO] - fit progress: (7, 0.0028640073523790257, OrderedDict([('ind_iou_0', 0.974645813472185), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7063, dtype=torch.float64)), ('ind_iou_1', 0.9760662797419374), ('ind_dice_liver_1', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6140, dtype=torch.float64)), ('all_iou', 0.9747742406541853), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7038, dtype=torch.float64))]), 38846.651787661016)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 14:40:47,105][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 14:41:00,707][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-19 14:41:00,707][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 14:42:01,340][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 14:42:01,340][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 14:42:01,341][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 14:42:01,341][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-11-19 14:42:01,341][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 14:42:01,341][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9783116874735293
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5821, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9770950761334154
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6155, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9804791380501194
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6148, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.977228941442213
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6108, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9822122502356873
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6005, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9774923063389018
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6161, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.983191925581213
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6051, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9774690774791437
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6215, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9784447163951768
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7233, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9748942461382151
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7030, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9800758714614999
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7313, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9747067500214058
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7043, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9800325786612697
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7336, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9744790736666599
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7074, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9802281146107383
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7324, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9753317018222945
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7078, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-19 16:12:46,589][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.00274532812431025, OrderedDict([('ind_iou_0', 0.9757962106482816), ('ind_dice_liver_0', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7096, dtype=torch.float64)), ('ind_iou_1', 0.9776659066643174), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6187, dtype=torch.float64)), ('all_iou', 0.9759077240218176), ('all_dice_liver', tensor(0.9858, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7077, dtype=torch.float64))]), 44852.43440984888)
Entrei no test
Meio do test
Fim do test
[2024-11-19 16:20:52,798][flwr][INFO] - fit progress: (8, 0.00274532812431025, OrderedDict([('ind_iou_0', 0.9757962106482816), ('ind_dice_liver_0', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7096, dtype=torch.float64)), ('ind_iou_1', 0.9776659066643174), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6187, dtype=torch.float64)), ('all_iou', 0.9759077240218176), ('all_dice_liver', tensor(0.9858, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7077, dtype=torch.float64))]), 44852.43440984888)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 16:20:52,872][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 16:21:04,056][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 16:21:04,056][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 16:22:05,372][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 16:22:05,372][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 16:22:05,372][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 16:22:05,373][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-11-19 16:22:05,373][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 16:22:05,373][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9793042183079758
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6007, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9764433219723542
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6115, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9814321217446937
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6111, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9778405745388606
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6160, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.982815468676271
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6237, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9777046485423297
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6242, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9837724353888302
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6146, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9782571825641199
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6302, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9806670502675694
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7383, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9750830390263008
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7069, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9810143385879466
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7345, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.975662517361118
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7113, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9807853110588427
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7424, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9734150617398484
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9842, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6953, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9816911565263864
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7430, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9758695613989129
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7088, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-19 17:56:23,834][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.0027128699784888027, OrderedDict([('ind_iou_0', 0.9763154280698806), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7110, dtype=torch.float64)), ('ind_iou_1', 0.9781862605911298), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6183, dtype=torch.float64)), ('all_iou', 0.976472567265117), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7098, dtype=torch.float64))]), 51003.32619315805)
Entrei no test
Meio do test
Fim do test
[2024-11-19 18:03:23,690][flwr][INFO] - fit progress: (9, 0.0027128699784888027, OrderedDict([('ind_iou_0', 0.9763154280698806), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7110, dtype=torch.float64)), ('ind_iou_1', 0.9781862605911298), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6183, dtype=torch.float64)), ('all_iou', 0.976472567265117), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7098, dtype=torch.float64))]), 51003.32619315805)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 18:03:23,799][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 18:03:35,906][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 18:03:35,906][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 18:04:36,735][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 18:04:36,735][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 18:04:36,735][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 18:04:36,736][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-11-19 18:04:36,736][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 18:04:36,736][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9805736248051854
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6426, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.97948958387836
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6278, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.982702675151828
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6409, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.979490970837543
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6276, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.983186348914914
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6036, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9785703005710941
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6286, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9844221667571329
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6160, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9788839125464889
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6264, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9816571380737064
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7451, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9757197701748487
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7049, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9819628104981702
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7415, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9759605639009914
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7112, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9822712389697861
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7445, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9761892483211224
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7140, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9825464238680474
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7378, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9758996537120077
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7149, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 19:36:48,907][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.002697558805839835, OrderedDict([('ind_iou_0', 0.9765002080726257), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7167, dtype=torch.float64)), ('ind_iou_1', 0.9789854204600466), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6234, dtype=torch.float64)), ('all_iou', 0.9766880941880899), ('all_dice_liver', tensor(0.9866, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7143, dtype=torch.float64))]), 57046.15102909412)
Entrei no test
Meio do test
Fim do test
[2024-11-19 19:44:06,515][flwr][INFO] - fit progress: (10, 0.002697558805839835, OrderedDict([('ind_iou_0', 0.9765002080726257), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7167, dtype=torch.float64)), ('ind_iou_1', 0.9789854204600466), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6234, dtype=torch.float64)), ('all_iou', 0.9766880941880899), ('all_dice_liver', tensor(0.9866, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7143, dtype=torch.float64))]), 57046.15102909412)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 19:44:06,703][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 19:44:20,733][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 19:44:20,733][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 19:45:21,084][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 19:45:21,084][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 19:45:21,085][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 19:45:21,085][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-11-19 19:45:21,085][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 19:45:21,085][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9815855865996989
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6043, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9800284102521049
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6150, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9809886431126624
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6219, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9791754557883912
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6274, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9844453704700556
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6340, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9805678280139389
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6380, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9857498571407739
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6185, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9806134044407978
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6410, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9827340010352912
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7495, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9766384030420598
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7093, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9829797381875943
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7414, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9760897842206984
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7143, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9827396636299373
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7462, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9747739749575123
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7108, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9819199842289884
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7466, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9774582155955646
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7233, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-19 21:29:29,075][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.0026223485966159893, OrderedDict([('ind_iou_0', 0.9777543580302691), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7242, dtype=torch.float64)), ('ind_iou_1', 0.9811611529874593), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6351, dtype=torch.float64)), ('all_iou', 0.978086005678795), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7224, dtype=torch.float64))]), 64058.77010383224)
Entrei no test
Meio do test
Fim do test
[2024-11-19 21:40:59,134][flwr][INFO] - fit progress: (11, 0.0026223485966159893, OrderedDict([('ind_iou_0', 0.9777543580302691), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7242, dtype=torch.float64)), ('ind_iou_1', 0.9811611529874593), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6351, dtype=torch.float64)), ('all_iou', 0.978086005678795), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7224, dtype=torch.float64))]), 64058.77010383224)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-19 21:40:59,203][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-19 21:41:12,727][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 21:41:12,727][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-19 21:42:13,342][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-19 21:42:13,343][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-19 21:42:13,343][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-19 21:42:13,343][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-11-19 21:42:13,343][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-19 21:42:13,343][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9821569869711714
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6194, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9787786002899536
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6311, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9832131261510448
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6335, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9804686882957682
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6317, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9847904608976186
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6332, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9800742543330441
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6385, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9853766641698685
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6140, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9807171309529791
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6375, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9833394035706617
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7496, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9769486538012768
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7181, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.982481061303354
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7453, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9759369141217521
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7119, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9835517363017685
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7489, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9770123815108143
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7188, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9839884659237935
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7597, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9766711939526895
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7193, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 00:06:46,632][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.002672465636927023, OrderedDict([('ind_iou_0', 0.9771721315120689), ('ind_dice_liver_0', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7206, dtype=torch.float64)), ('ind_iou_1', 0.9799470227381354), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6299, dtype=torch.float64)), ('all_iou', 0.9774610308262369), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7199, dtype=torch.float64))]), 73427.05303544924)
Entrei no test
Meio do test
Fim do test
[2024-11-20 00:17:07,417][flwr][INFO] - fit progress: (12, 0.002672465636927023, OrderedDict([('ind_iou_0', 0.9771721315120689), ('ind_dice_liver_0', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7206, dtype=torch.float64)), ('ind_iou_1', 0.9799470227381354), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6299, dtype=torch.float64)), ('all_iou', 0.9774610308262369), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7199, dtype=torch.float64))]), 73427.05303544924)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 00:17:07,511][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[2024-11-20 00:17:20,138][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 00:17:20,138][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 00:18:21,357][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 00:18:21,357][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 00:18:21,357][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 00:18:21,357][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-11-20 00:18:21,357][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 00:18:21,357][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9826462064812123
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6146, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9806864683465405
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6315, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9847210495360732
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6223, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9805482288847619
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6282, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9853905289392724
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6285, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9812476870838539
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6312, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.985962522023313
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6351, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9812640265608475
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6385, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9839953655681973
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7465, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9767538546058975
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7117, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9841120988245944
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7473, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9771716301271465
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7232, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9843617084423075
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7544, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9773913343502075
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7247, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9845794979053684
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7547, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9771115493224171
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7159, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 02:41:34,977][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.002655985914270408, OrderedDict([('ind_iou_0', 0.977576778217918), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7186, dtype=torch.float64)), ('ind_iou_1', 0.9806752851062722), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6249, dtype=torch.float64)), ('all_iou', 0.9778644865206911), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7173, dtype=torch.float64))]), 82683.32609965187)
Entrei no test
Meio do test
Fim do test
[2024-11-20 02:51:23,690][flwr][INFO] - fit progress: (13, 0.002655985914270408, OrderedDict([('ind_iou_0', 0.977576778217918), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7186, dtype=torch.float64)), ('ind_iou_1', 0.9806752851062722), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6249, dtype=torch.float64)), ('all_iou', 0.9778644865206911), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7173, dtype=torch.float64))]), 82683.32609965187)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 02:51:23,948][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 02:51:36,472][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 02:51:36,473][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 02:52:36,776][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 02:52:36,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 02:52:36,777][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 02:52:36,777][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-11-20 02:52:36,777][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 02:52:36,777][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9829816110500372
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6110, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.981266578408962
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6314, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9848337945958191
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6274, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9818398818105292
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6320, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9853517252121692
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6488, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9818345695912178
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6330, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9868344031594644
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6337, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9818312984454685
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6374, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.984694165911384
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7533, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.977689859204691
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7239, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9848086949645759
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7498, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9775896914650533
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7249, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9850230187898752
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7624, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.977996239858833
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7219, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9839751934362091
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7531, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9781021360455473
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7279, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 05:28:27,758][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.002601440981867658, OrderedDict([('ind_iou_0', 0.9784757024616388), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9821304536174122), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6401, dtype=torch.float64)), ('all_iou', 0.9788256306058882), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7276, dtype=torch.float64))]), 92785.55115118623)
Entrei no test
Meio do test
Fim do test
[2024-11-20 05:39:45,915][flwr][INFO] - fit progress: (14, 0.002601440981867658, OrderedDict([('ind_iou_0', 0.9784757024616388), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9821304536174122), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6401, dtype=torch.float64)), ('all_iou', 0.9788256306058882), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7276, dtype=torch.float64))]), 92785.55115118623)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 05:39:46,029][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 05:39:58,336][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 05:39:58,336][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 05:40:58,171][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 05:40:58,171][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 05:40:58,172][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 05:40:58,172][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-11-20 05:40:58,172][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 05:40:58,172][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9837884367990932
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6230, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9819894957201284
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6437, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9853796277650523
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.5959, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.981841119898704
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6430, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9861621048379414
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6539, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9816674128352539
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6465, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9870833411404286
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6464, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9817633028822986
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6449, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9848051756368085
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7613, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.978079536863299
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7275, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9857325954181192
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7627, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.97800159146557
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7217, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.984715582937273
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7594, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9780197612817041
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7255, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9856018496650587
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7588, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9780489007924048
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7263, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 07:59:47,534][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.002612782110638394, OrderedDict([('ind_iou_0', 0.9784885593656866), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7276, dtype=torch.float64)), ('ind_iou_1', 0.9818305802635675), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9788050795669959), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7251, dtype=torch.float64))]), 101743.76936403895)
Entrei no test
Meio do test
Fim do test
[2024-11-20 08:09:04,133][flwr][INFO] - fit progress: (15, 0.002612782110638394, OrderedDict([('ind_iou_0', 0.9784885593656866), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7276, dtype=torch.float64)), ('ind_iou_1', 0.9818305802635675), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9788050795669959), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7251, dtype=torch.float64))]), 101743.76936403895)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 08:09:04,231][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 08:09:16,587][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 08:09:16,588][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 08:10:18,512][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 08:10:18,512][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 08:10:18,513][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 08:10:18,513][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-11-20 08:10:18,513][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 08:10:18,513][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.983648723791072
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6091, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9819809434581788
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6377, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9857766482143472
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6375, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9803216490745668
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6391, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9864545753406672
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6475, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.982340513101852
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6396, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9876245648378692
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6466, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9819883000606306
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6448, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9857428061140435
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7565, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9781778489134167
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7270, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9857480917939571
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7580, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9782483781506403
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7265, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9858637104948753
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7576, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.978383337808487
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7256, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9860481979357789
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7650, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.97826485609949
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7237, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-20 10:36:22,710][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.0025902165175004732, OrderedDict([('ind_iou_0', 0.978707156035307), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7255, dtype=torch.float64)), ('ind_iou_1', 0.9822135116479853), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6361, dtype=torch.float64)), ('all_iou', 0.9790484378526946), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 111392.72157688905)
Entrei no test
Meio do test
Fim do test
[2024-11-20 10:49:53,085][flwr][INFO] - fit progress: (16, 0.0025902165175004732, OrderedDict([('ind_iou_0', 0.978707156035307), ('ind_dice_liver_0', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7255, dtype=torch.float64)), ('ind_iou_1', 0.9822135116479853), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6361, dtype=torch.float64)), ('all_iou', 0.9790484378526946), ('all_dice_liver', tensor(0.9885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7243, dtype=torch.float64))]), 111392.72157688905)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 10:49:53,170][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 10:50:05,120][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 10:50:05,120][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 10:51:05,785][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 10:51:05,785][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 10:51:05,785][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 10:51:05,786][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-11-20 10:51:05,786][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 10:51:05,786][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.984246444186407
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6257, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.981273174169938
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6372, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9863218062127291
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6403, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9822183658434325
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6410, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9856210915315609
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6392, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9817482850793225
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6405, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9876885407008604
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6385, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9823996740961
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6472, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9862556346912659
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7650, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.978183398869463
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7262, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9862292970526129
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7682, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9784843864770706
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7297, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9865384588149325
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7690, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9783122198780927
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7265, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9855182340958253
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7609, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9778096758398206
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7237, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 13:22:03,140][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.002623076949146212, OrderedDict([('ind_iou_0', 0.9783182356765089), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7256, dtype=torch.float64)), ('ind_iou_1', 0.9813294111110576), ('ind_dice_liver_1', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6357, dtype=torch.float64)), ('all_iou', 0.9785436012029229), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7261, dtype=torch.float64))]), 121173.40506566828)
Entrei no test
Meio do test
Fim do test
[2024-11-20 13:32:53,769][flwr][INFO] - fit progress: (17, 0.002623076949146212, OrderedDict([('ind_iou_0', 0.9783182356765089), ('ind_dice_liver_0', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7256, dtype=torch.float64)), ('ind_iou_1', 0.9813294111110576), ('ind_dice_liver_1', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6357, dtype=torch.float64)), ('all_iou', 0.9785436012029229), ('all_dice_liver', tensor(0.9881, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7261, dtype=torch.float64))]), 121173.40506566828)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 13:32:53,861][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 13:33:05,760][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 13:33:05,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 13:34:07,179][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 13:34:07,179][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 13:34:07,180][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 13:34:07,180][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-11-20 13:34:07,180][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 13:34:07,180][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9838863533320249
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6463, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9817257610925458
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6414, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9860570505245775
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6343, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9824532189107493
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6434, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9874879534508455
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6326, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.98224291445613
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6441, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9878536887301224
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6341, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9823588797167118
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6460, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9863938153533836
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7585, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9785676994386453
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7280, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9868050169288185
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7624, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9784195736574929
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7246, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9866998854131758
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7632, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9787532795226389
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7274, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.987042151898099
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7696, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.978463047166615
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7288, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-20 15:47:49,624][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.0026633387340972473, OrderedDict([('ind_iou_0', 0.9788749113949018), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7301, dtype=torch.float64)), ('ind_iou_1', 0.982923798752476), ('ind_dice_liver_1', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6448, dtype=torch.float64)), ('all_iou', 0.9792610636373621), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7293, dtype=torch.float64))]), 129892.8010210623)
Entrei no test
Meio do test
Fim do test
[2024-11-20 15:58:13,165][flwr][INFO] - fit progress: (18, 0.0026633387340972473, OrderedDict([('ind_iou_0', 0.9788749113949018), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7301, dtype=torch.float64)), ('ind_iou_1', 0.982923798752476), ('ind_dice_liver_1', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6448, dtype=torch.float64)), ('all_iou', 0.9792610636373621), ('all_dice_liver', tensor(0.9889, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7293, dtype=torch.float64))]), 129892.8010210623)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 15:58:13,270][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 15:58:25,578][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 15:58:25,578][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 15:59:26,721][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 15:59:26,721][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 15:59:26,721][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 15:59:26,722][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-11-20 15:59:26,722][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 15:59:26,722][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9854770268686472
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6101, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9827541812890573
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6403, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9870721640715049
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6263, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9826834394086015
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6451, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9871934801828763
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6350, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9828916440752293
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6436, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9879248836251984
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6275, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.982791209453151
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6385, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9870490671713652
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7659, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9787231161038156
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7302, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9868443472357122
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7661, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9755692194426828
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7149, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9871890132043529
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7714, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.978555708782736
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7305, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9874594679094421
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7732, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9788328130940556
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7285, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 18:28:49,322][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.0026701109580873923, OrderedDict([('ind_iou_0', 0.9791853123369592), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7301, dtype=torch.float64)), ('ind_iou_1', 0.9833905695676514), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6434, dtype=torch.float64)), ('all_iou', 0.9795776606650595), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7289, dtype=torch.float64))]), 139590.86466128612)
Entrei no test
Meio do test
Fim do test
[2024-11-20 18:39:51,228][flwr][INFO] - fit progress: (19, 0.0026701109580873923, OrderedDict([('ind_iou_0', 0.9791853123369592), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7301, dtype=torch.float64)), ('ind_iou_1', 0.9833905695676514), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6434, dtype=torch.float64)), ('all_iou', 0.9795776606650595), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7289, dtype=torch.float64))]), 139590.86466128612)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 18:39:51,440][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[2024-11-20 18:40:02,858][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 18:40:02,858][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 18:41:03,785][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 18:41:03,785][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 18:41:03,789][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 18:41:03,789][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-11-20 18:41:03,789][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 18:41:03,789][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9855964264527177
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6303, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9830905750563892
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6403, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9870943042280877
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6293, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9834833585279885
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6516, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9874608883946615
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6313, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9829237454634463
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6548, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9886277058633981
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6512, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9832764368513822
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6524, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.987456302256373
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7756, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9789110767942252
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7287, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9875198391173591
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7755, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9789496293712228
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7322, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9876204197969793
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7675, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9784347794739269
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7320, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.987671552373062
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7710, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9788658817601742
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7301, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-20 21:06:01,037][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.002663827750817446, OrderedDict([('ind_iou_0', 0.9792405873655515), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7314, dtype=torch.float64)), ('ind_iou_1', 0.9833528376765398), ('ind_dice_liver_1', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6424, dtype=torch.float64)), ('all_iou', 0.9796204978095878), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7299, dtype=torch.float64))]), 148939.4725576439)
Entrei no test
Meio do test
Fim do test
[2024-11-20 21:15:39,836][flwr][INFO] - fit progress: (20, 0.002663827750817446, OrderedDict([('ind_iou_0', 0.9792405873655515), ('ind_dice_liver_0', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7314, dtype=torch.float64)), ('ind_iou_1', 0.9833528376765398), ('ind_dice_liver_1', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6424, dtype=torch.float64)), ('all_iou', 0.9796204978095878), ('all_dice_liver', tensor(0.9891, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7299, dtype=torch.float64))]), 148939.4725576439)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 21:15:39,943][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 21:15:51,877][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 21:15:51,878][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 21:16:52,040][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 21:16:52,041][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 21:16:52,041][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-20 21:16:52,041][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-11-20 21:16:52,041][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-20 21:16:52,041][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.985793361540814
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6193, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9831061265370459
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6394, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9877108651909378
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6496, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9838915191817215
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6488, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9882923547397626
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6601, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9835822975803356
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6448, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9884744754759149
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6466, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.982528861760219
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6497, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9878585249236315
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7747, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9790232519294777
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7319, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9878833102748716
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7716, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9790201406962566
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7322, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9879141941269569
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7673, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9790004601551546
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9880850987076634
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7724, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9791530475972492
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7335, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-20 23:25:52,915][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.00266982118068119, OrderedDict([('ind_iou_0', 0.9794792082043801), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7348, dtype=torch.float64)), ('ind_iou_1', 0.9836978862288728), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6479, dtype=torch.float64)), ('all_iou', 0.9798679648740428), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7327, dtype=torch.float64))]), 157235.60071748216)
Entrei no test
Meio do test
Fim do test
[2024-11-20 23:33:55,964][flwr][INFO] - fit progress: (21, 0.00266982118068119, OrderedDict([('ind_iou_0', 0.9794792082043801), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7348, dtype=torch.float64)), ('ind_iou_1', 0.9836978862288728), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6479, dtype=torch.float64)), ('all_iou', 0.9798679648740428), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7327, dtype=torch.float64))]), 157235.60071748216)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-20 23:33:56,079][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-20 23:34:07,823][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-20 23:34:07,823][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-20 23:35:09,446][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 23:35:09,446][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-20 23:35:09,447][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-20 23:35:09,447][flwr][INFO] - 
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 22]
[2024-11-20 23:35:09,447][flwr][INFO] - [ROUND 22]
[2024-11-20 23:35:09,448][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.985982111039283
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6403, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9839814577223445
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6474, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9878905496963076
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6226, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9842487685574259
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6486, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9885283380516976
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6594, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9834999834566959
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6499, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9868617460730807
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.6734, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9807060948169879
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.6337, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9880480483402583
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7734, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9792539791933706
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7304, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9881725529744606
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7739, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9790921549871022
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7302, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9883091328432652
[36m(ClientAppActor pid=1735069)[0m train dice liver:  
[36m(ClientAppActor pid=1735069)[0m tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7716, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9790983952947875
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7321, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  
[36m(ClientAppActor pid=1735069)[0m 0.9883248721792673
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.7707, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9791846290028713
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.7327, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[2024-11-21 01:33:00,673][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.0026505490802903966, OrderedDict([('ind_iou_0', 0.9795240144247275), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7338, dtype=torch.float64)), ('ind_iou_1', 0.9840293294600192), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9799520423702929), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7322, dtype=torch.float64))]), 164883.71445536986)
Entrei no test
Meio do test
Fim do test
[2024-11-21 01:41:24,078][flwr][INFO] - fit progress: (22, 0.0026505490802903966, OrderedDict([('ind_iou_0', 0.9795240144247275), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7338, dtype=torch.float64)), ('ind_iou_1', 0.9840293294600192), ('ind_dice_liver_1', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9799520423702929), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7322, dtype=torch.float64))]), 164883.71445536986)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-21 01:41:24,197][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-21 01:41:35,940][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-21 01:41:35,940][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-21 01:42:37,140][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-21 01:42:37,140][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-21 01:42:37,140][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-21 01:42:37,141][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-11-21 01:42:37,141][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-21 01:42:37,141][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=1735069)[0m epoch:  0
[36m(ClientAppActor pid=1735069)[0m train ious:  0.98657872056989
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6442, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9829759201981719
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6503, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  0
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  1
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9879284264103144
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6281, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9837823413864123
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6458, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  1
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  2
[36m(ClientAppActor pid=1735069)[0m train ious:  0.988890309128847
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6392, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9833513167366534
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6480, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  2
[36m(ClientAppActor pid=1735069)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735069)[0m epoch:  3
[36m(ClientAppActor pid=1735069)[0m train ious:  0.9884717987140499
[36m(ClientAppActor pid=1735069)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m train dice tumour:  tensor(0.6452, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation ious:  0.9826041159307766
[36m(ClientAppActor pid=1735069)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m validation dice tumour:  tensor(0.6534, dtype=torch.float64)
[36m(ClientAppActor pid=1735069)[0m => new best model:  3
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  0
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9885113402054804
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7789, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9791231099235651
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7349, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  0
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  1
[36m(ClientAppActor pid=1735068)[0m train ious:  0.9885098159309835
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7747, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9791406708178816
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7330, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  1
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  2
[36m(ClientAppActor pid=1735068)[0m train ious:  
[36m(ClientAppActor pid=1735068)[0m 0.9885832455255298
[36m(ClientAppActor pid=1735068)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7755, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9790236938404031
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7296, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  2
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=1735068)[0m epoch:  3
[36m(ClientAppActor pid=1735068)[0m train ious:  0.988700810671108
[36m(ClientAppActor pid=1735068)[0m train dice liver:  
[36m(ClientAppActor pid=1735068)[0m tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m train dice tumour:  tensor(0.7657, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation ious:  0.9788852883550174
[36m(ClientAppActor pid=1735068)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m validation dice tumour:  tensor(0.7340, dtype=torch.float64)
[36m(ClientAppActor pid=1735068)[0m => new best model:  3
[2024-11-21 03:23:50,523][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.002731934036227889, OrderedDict([('ind_iou_0', 0.9793125278209482), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7351, dtype=torch.float64)), ('ind_iou_1', 0.9834546942721965), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9797046433681009), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7332, dtype=torch.float64))]), 171324.59235699894)
Entrei no test
Meio do test
Fim do test
[2024-11-21 03:28:44,956][flwr][INFO] - fit progress: (23, 0.002731934036227889, OrderedDict([('ind_iou_0', 0.9793125278209482), ('ind_dice_liver_0', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7351, dtype=torch.float64)), ('ind_iou_1', 0.9834546942721965), ('ind_dice_liver_1', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9797046433681009), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7332, dtype=torch.float64))]), 171324.59235699894)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-21 03:28:45,002][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=1735068)[0m Entrei no validation 1 3
[2024-11-21 03:28:56,277][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-21 03:28:56,277][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735068, ip=172.18.62.10, actor_id=50436988c78f2085c924662001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14765c357490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-21 03:29:58,383][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-21 03:29:58,384][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=1735069, ip=172.18.62.10, actor_id=ae70933442fa05cf6527767c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1509fc298550>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-21 03:29:58,384][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-21 03:29:58,384][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-11-21 03:29:58,384][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-21 03:29:58,384][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 11083235.0 ON paula10 CANCELLED AT 2024-11-21T03:47:45 DUE TO TIME LIMIT ***
