/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.unet.UNet
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 1658
3 3791
3 414
3 4205
cuda:0
[2024-11-29 23:34:16,190][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-11-29 23:34:18,435	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'node:172.18.62.12': 1.0, 'node:__internal_head__': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 830590827520.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0}
[2024-11-29 23:34:38,074][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:172.18.62.12': 1.0, 'node:__internal_head__': 1.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'memory': 830590827520.0, 'object_store_memory': 200000000000.0, 'GPU': 3.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-29 23:34:38,074][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-29 23:34:38,074][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-29 23:34:38,112][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-29 23:34:38,113][flwr][INFO] - [INIT]
[2024-11-29 23:34:38,113][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-11-29 23:34:42,364][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-11-29 23:34:42,365][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.7414753399337515, OrderedDict([('ind_iou_0', 0.04766415833322114), ('ind_dice_liver_0', tensor(0.1516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.04694000668968212), ('ind_dice_liver_1', tensor(0.1499, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.0475928625471509), ('all_dice_liver', tensor(0.1514, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-11-29 23:38:23,012][flwr][INFO] - initial parameters (loss, other metrics): 0.7414753399337515, OrderedDict([('ind_iou_0', 0.04766415833322114), ('ind_dice_liver_0', tensor(0.1516, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.04694000668968212), ('ind_dice_liver_1', tensor(0.1499, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.0475928625471509), ('all_dice_liver', tensor(0.1514, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[92mINFO [0m:      
[2024-11-29 23:38:23,119][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-11-29 23:38:23,119][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 23:38:23,120][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.7138671842307222
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.4178, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.0071, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.725904531292486
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.5465, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0095, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.8441320445999614
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.6984, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.0093, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7417542772651968
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.7106, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0122, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.8736732812434576
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.8255, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.0223, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7507046062626546
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.7943, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0353, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.8810417694138815
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.8785, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.0507, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.6316875723875005
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.7563, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0358, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-29 23:44:51,950][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-11-29 23:44:51,975][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.05303550318379606, OrderedDict([('ind_iou_0', 0.6316875723875005), ('ind_dice_liver_0', tensor(0.7563, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0358, dtype=torch.float64)), ('ind_iou_1', 0.8362033455466258), ('ind_dice_liver_1', tensor(0.8752, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0395, dtype=torch.float64)), ('all_iou', 0.6519288082394075), ('all_dice_liver', tensor(0.7681, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0362, dtype=torch.float64))]), 494.6069231880829)
Entrei no test
Meio do test
Fim do test
[2024-11-29 23:46:37,726][flwr][INFO] - fit progress: (1, 0.05303550318379606, OrderedDict([('ind_iou_0', 0.6316875723875005), ('ind_dice_liver_0', tensor(0.7563, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0358, dtype=torch.float64)), ('ind_iou_1', 0.8362033455466258), ('ind_dice_liver_1', tensor(0.8752, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0395, dtype=torch.float64)), ('all_iou', 0.6519288082394075), ('all_dice_liver', tensor(0.7681, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0362, dtype=torch.float64))]), 494.6069231880829)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 23:46:37,730][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-29 23:47:34,381][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 23:47:34,381][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 23:47:34,382][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-29 23:47:34,382][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-11-29 23:47:34,382][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 23:47:34,382][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.8910129294791479
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9194, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.1124, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7434847352914995
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8445, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0775, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9121513191394715
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9426, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.2154, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7670601147396451
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8691, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.1841, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9134795995801368
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9424, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.2457, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.6840971696829832
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8250, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.1449, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-29 23:53:55,169][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.04925278463045425, OrderedDict([('ind_iou_0', 0.7536420464594646), ('ind_dice_liver_0', tensor(0.8644, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1785, dtype=torch.float64)), ('ind_iou_1', 0.9295314235185855), ('ind_dice_liver_1', tensor(0.9542, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3130, dtype=torch.float64)), ('all_iou', 0.7711695907460727), ('all_dice_liver', tensor(0.8734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1950, dtype=torch.float64))]), 1038.9403722900897)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9308229880673402
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9545, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.3202, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7536420464594646
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8644, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.1785, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-29 23:55:42,060][flwr][INFO] - fit progress: (2, 0.04925278463045425, OrderedDict([('ind_iou_0', 0.7536420464594646), ('ind_dice_liver_0', tensor(0.8644, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1785, dtype=torch.float64)), ('ind_iou_1', 0.9295314235185855), ('ind_dice_liver_1', tensor(0.9542, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3130, dtype=torch.float64)), ('all_iou', 0.7711695907460727), ('all_dice_liver', tensor(0.8734, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1950, dtype=torch.float64))]), 1038.9403722900897)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 23:55:42,063][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-29 23:56:36,915][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 23:56:36,915][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 23:56:36,915][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-29 23:56:36,915][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-11-29 23:56:36,916][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-29 23:56:36,916][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9340070374783723
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9570, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.3579, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7364484656047232
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8573, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2155, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9368156302474323
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9584, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.3896, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.762696951636958
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8698, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2407, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9470248840854547
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9653, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4556, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7799951275592087
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8800, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2396, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9401805310850438
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9609, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4120, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7820151522242209
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8861, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2361, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 00:02:58,194][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.04922053228518909, OrderedDict([('ind_iou_0', 0.7820151522242209), ('ind_dice_liver_0', tensor(0.8861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2361, dtype=torch.float64)), ('ind_iou_1', 0.9447122111257642), ('ind_dice_liver_1', tensor(0.9657, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4101, dtype=torch.float64)), ('all_iou', 0.7981788571034795), ('all_dice_liver', tensor(0.8940, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2571, dtype=torch.float64))]), 1582.3382836207747)
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:04:45,458][flwr][INFO] - fit progress: (3, 0.04922053228518909, OrderedDict([('ind_iou_0', 0.7820151522242209), ('ind_dice_liver_0', tensor(0.8861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2361, dtype=torch.float64)), ('ind_iou_1', 0.9447122111257642), ('ind_dice_liver_1', tensor(0.9657, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4101, dtype=torch.float64)), ('all_iou', 0.7981788571034795), ('all_dice_liver', tensor(0.8940, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2571, dtype=torch.float64))]), 1582.3382836207747)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:04:45,461][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:05:40,535][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:05:40,535][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:05:40,540][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:05:40,540][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-11-30 00:05:40,540][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:05:40,540][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9457205825759532
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9650, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4565, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7655840770313959
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8722, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2465, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9458379542246531
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9644, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4741, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7563464466081394
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8735, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2389, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9489277938690998
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9667, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4817, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.6370106516867254
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.7686, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.0462, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9474616756169166
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9654, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4734, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7452841414649035
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8673, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2178, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 00:11:59,466][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.05813819540068773, OrderedDict([('ind_iou_0', 0.7452841414649035), ('ind_dice_liver_0', tensor(0.8673, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2178, dtype=torch.float64)), ('ind_iou_1', 0.9479294328973502), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4632, dtype=torch.float64)), ('all_iou', 0.7654355161020596), ('all_dice_liver', tensor(0.8769, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2460, dtype=torch.float64))]), 2123.461986010894)
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:13:46,581][flwr][INFO] - fit progress: (4, 0.05813819540068773, OrderedDict([('ind_iou_0', 0.7452841414649035), ('ind_dice_liver_0', tensor(0.8673, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2178, dtype=torch.float64)), ('ind_iou_1', 0.9479294328973502), ('ind_dice_liver_1', tensor(0.9641, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4632, dtype=torch.float64)), ('all_iou', 0.7654355161020596), ('all_dice_liver', tensor(0.8769, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2460, dtype=torch.float64))]), 2123.461986010894)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:13:46,585][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:14:40,916][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:14:40,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:14:40,917][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:14:40,917][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-11-30 00:14:40,917][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:14:40,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9517594793720608
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9687, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4889, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.78547150449293
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8891, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2002, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9531266148879903
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9692, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5121, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7521465705585638
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8760, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2069, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9566132440935845
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9718, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5074, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7916378788700534
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8893, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2945, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:21:01,357][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.05193330802911545, OrderedDict([('ind_iou_0', 0.7720739542713111), ('ind_dice_liver_0', tensor(0.8854, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2104, dtype=torch.float64)), ('ind_iou_1', 0.9514002418093063), ('ind_dice_liver_1', tensor(0.9693, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4751, dtype=torch.float64)), ('all_iou', 0.789865516286173), ('all_dice_liver', tensor(0.8937, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2404, dtype=torch.float64))]), 2665.6525636278093)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9478235114086395
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9663, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.4563, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7720739542713111
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8854, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2104, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:22:48,772][flwr][INFO] - fit progress: (5, 0.05193330802911545, OrderedDict([('ind_iou_0', 0.7720739542713111), ('ind_dice_liver_0', tensor(0.8854, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2104, dtype=torch.float64)), ('ind_iou_1', 0.9514002418093063), ('ind_dice_liver_1', tensor(0.9693, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4751, dtype=torch.float64)), ('all_iou', 0.789865516286173), ('all_dice_liver', tensor(0.8937, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2404, dtype=torch.float64))]), 2665.6525636278093)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:22:48,776][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:23:44,149][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:23:44,149][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:23:44,150][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:23:44,150][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-11-30 00:23:44,150][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:23:44,150][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9540527872923296
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9696, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5019, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7558559405048025
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8716, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2456, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9586244477473516
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9728, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5197, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7718944192778118
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8808, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2429, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9606697426879559
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9739, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5726, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7620630931005639
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8758, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2720, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:30:03,238][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.0595124055107659, OrderedDict([('ind_iou_0', 0.7108457075431956), ('ind_dice_liver_0', tensor(0.8347, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1899, dtype=torch.float64)), ('ind_iou_1', 0.9380788168094929), ('ind_dice_liver_1', tensor(0.9552, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4111, dtype=torch.float64)), ('all_iou', 0.7334295273680683), ('all_dice_liver', tensor(0.8466, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2149, dtype=torch.float64))]), 3206.573595240712)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9566401598934512
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9710, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5265, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7108457075431956
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8347, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.1899, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:31:49,693][flwr][INFO] - fit progress: (6, 0.0595124055107659, OrderedDict([('ind_iou_0', 0.7108457075431956), ('ind_dice_liver_0', tensor(0.8347, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1899, dtype=torch.float64)), ('ind_iou_1', 0.9380788168094929), ('ind_dice_liver_1', tensor(0.9552, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4111, dtype=torch.float64)), ('all_iou', 0.7334295273680683), ('all_dice_liver', tensor(0.8466, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2149, dtype=torch.float64))]), 3206.573595240712)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:31:49,696][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:32:45,975][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:32:45,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:32:45,975][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:32:45,975][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-11-30 00:32:45,975][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:32:45,975][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9571030121227574
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9715, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5313, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7774370196023895
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8871, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2647, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9620422823124716
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9748, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5539, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.773640404239478
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8825, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2511, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9633928701457082
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9757, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5538, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7921945890214515
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8916, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2903, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9596885397380802
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9736, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5425, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7999996553181479
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8957, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2720, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 00:39:02,556][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.054658803450969115, OrderedDict([('ind_iou_0', 0.7999996553181479), ('ind_dice_liver_0', tensor(0.8957, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2720, dtype=torch.float64)), ('ind_iou_1', 0.9566744201094628), ('ind_dice_liver_1', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4873, dtype=torch.float64)), ('all_iou', 0.8155179756401552), ('all_dice_liver', tensor(0.9034, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2978, dtype=torch.float64))]), 3745.8684603897855)
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:40:48,988][flwr][INFO] - fit progress: (7, 0.054658803450969115, OrderedDict([('ind_iou_0', 0.7999996553181479), ('ind_dice_liver_0', tensor(0.8957, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2720, dtype=torch.float64)), ('ind_iou_1', 0.9566744201094628), ('ind_dice_liver_1', tensor(0.9731, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4873, dtype=torch.float64)), ('all_iou', 0.8155179756401552), ('all_dice_liver', tensor(0.9034, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2978, dtype=torch.float64))]), 3745.8684603897855)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:40:48,991][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:41:43,369][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:41:43,369][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:41:43,369][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:41:43,370][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-11-30 00:41:43,370][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:41:43,370][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9624556774225288
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9753, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5733, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7958863910528654
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8945, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2474, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9650267055464032
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9769, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5702, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7820658738742847
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8865, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2579, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9607027960372387
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9740, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5318, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7659061669684547
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8821, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2247, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9663504576187322
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9777, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5594, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7929387574260767
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8929, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2976, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 00:48:01,261][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.06094796382606153, OrderedDict([('ind_iou_0', 0.7929387574260767), ('ind_dice_liver_0', tensor(0.8929, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2976, dtype=torch.float64)), ('ind_iou_1', 0.9635342443527264), ('ind_dice_liver_1', tensor(0.9769, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5541, dtype=torch.float64)), ('all_iou', 0.8098240228808102), ('all_dice_liver', tensor(0.9012, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3270, dtype=torch.float64))]), 4284.743214330636)
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:49:47,863][flwr][INFO] - fit progress: (8, 0.06094796382606153, OrderedDict([('ind_iou_0', 0.7929387574260767), ('ind_dice_liver_0', tensor(0.8929, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2976, dtype=torch.float64)), ('ind_iou_1', 0.9635342443527264), ('ind_dice_liver_1', tensor(0.9769, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5541, dtype=torch.float64)), ('all_iou', 0.8098240228808102), ('all_dice_liver', tensor(0.9012, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3270, dtype=torch.float64))]), 4284.743214330636)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:49:47,866][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:50:42,638][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:50:42,638][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:50:42,638][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:50:42,639][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-11-30 00:50:42,639][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:50:42,639][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9664669300702582
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9779, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5749, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7966578427616544
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8937, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3212, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.968390098853941
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9790, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5737, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7927298878093715
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8967, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2860, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9671159672128263
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5717, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7613668327922759
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8761, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2035, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9609115854931382
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9746, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5134, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7895828309521433
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8920, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2845, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 00:57:01,492][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.06346101352466574, OrderedDict([('ind_iou_0', 0.7895828309521433), ('ind_dice_liver_0', tensor(0.8920, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2845, dtype=torch.float64)), ('ind_iou_1', 0.9633393220798547), ('ind_dice_liver_1', tensor(0.9778, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.8068082440479202), ('all_dice_liver', tensor(0.9005, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3150, dtype=torch.float64))]), 4825.251417716965)
Entrei no test
Meio do test
Fim do test
[2024-11-30 00:58:48,371][flwr][INFO] - fit progress: (9, 0.06346101352466574, OrderedDict([('ind_iou_0', 0.7895828309521433), ('ind_dice_liver_0', tensor(0.8920, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2845, dtype=torch.float64)), ('ind_iou_1', 0.9633393220798547), ('ind_dice_liver_1', tensor(0.9778, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.8068082440479202), ('all_dice_liver', tensor(0.9005, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3150, dtype=torch.float64))]), 4825.251417716965)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 00:58:48,374][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 00:59:42,552][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 00:59:42,552][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 00:59:42,552][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 00:59:42,553][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-11-30 00:59:42,553][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 00:59:42,553][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9686557892700666
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9794, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5883, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.785361258724515
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8904, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2882, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9705188732694483
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5919, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7857027424255469
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8900, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2579, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.971500231604858
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5946, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.8008567728335647
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8962, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3000, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9716580636729151
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5975, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7930287733831317
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8941, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2796, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 01:06:04,182][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.06813601635963469, OrderedDict([('ind_iou_0', 0.7930287733831317), ('ind_dice_liver_0', tensor(0.8941, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2796, dtype=torch.float64)), ('ind_iou_1', 0.9650760878658963), ('ind_dice_liver_1', tensor(0.9786, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.8100800327081573), ('all_dice_liver', tensor(0.9025, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3109, dtype=torch.float64))]), 5367.833003301173)
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:07:50,952][flwr][INFO] - fit progress: (10, 0.06813601635963469, OrderedDict([('ind_iou_0', 0.7930287733831317), ('ind_dice_liver_0', tensor(0.8941, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2796, dtype=torch.float64)), ('ind_iou_1', 0.9650760878658963), ('ind_dice_liver_1', tensor(0.9786, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.8100800327081573), ('all_dice_liver', tensor(0.9025, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3109, dtype=torch.float64))]), 5367.833003301173)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:07:50,956][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:08:44,893][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:08:44,894][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:08:44,895][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:08:44,895][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-11-30 01:08:44,895][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:08:44,895][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9728620324878444
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5877, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7922089247411771
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8919, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2923, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9735368786556567
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9825, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5789, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7814131758616214
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8873, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3009, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9742163904300356
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9831, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5937, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7878866457371703
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8932, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2501, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9745382023913104
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6147, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7778061268448617
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8856, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2821, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 01:15:03,463][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.07734067768553952, OrderedDict([('ind_iou_0', 0.7778061268448617), ('ind_dice_liver_0', tensor(0.8856, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2821, dtype=torch.float64)), ('ind_iou_1', 0.9669066646043755), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.7965341836797774), ('all_dice_liver', tensor(0.8950, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3134, dtype=torch.float64))]), 5906.826113084331)
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:16:49,945][flwr][INFO] - fit progress: (11, 0.07734067768553952, OrderedDict([('ind_iou_0', 0.7778061268448617), ('ind_dice_liver_0', tensor(0.8856, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2821, dtype=torch.float64)), ('ind_iou_1', 0.9669066646043755), ('ind_dice_liver_1', tensor(0.9804, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5540, dtype=torch.float64)), ('all_iou', 0.7965341836797774), ('all_dice_liver', tensor(0.8950, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3134, dtype=torch.float64))]), 5906.826113084331)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:16:49,949][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:17:45,491][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:17:45,491][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:17:45,491][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:17:45,492][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-11-30 01:17:45,492][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:17:45,492][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9742220999142848
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6111, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7795871269314271
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8846, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2380, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9768920442636716
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6049, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7841484507206157
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8912, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2740, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9778919056652622
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6000, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7857614017179222
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8893, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2651, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:24:03,087][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.06587269239606032, OrderedDict([('ind_iou_0', 0.7561715069928102), ('ind_dice_liver_0', tensor(0.8651, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2997, dtype=torch.float64)), ('ind_iou_1', 0.9513818242415281), ('ind_dice_liver_1', tensor(0.9709, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5340, dtype=torch.float64)), ('all_iou', 0.7754728091344196), ('all_dice_liver', tensor(0.8756, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3275, dtype=torch.float64))]), 6446.8068203460425)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9771592943616145
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5804, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7561715069928102
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8651, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2997, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:25:49,926][flwr][INFO] - fit progress: (12, 0.06587269239606032, OrderedDict([('ind_iou_0', 0.7561715069928102), ('ind_dice_liver_0', tensor(0.8651, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2997, dtype=torch.float64)), ('ind_iou_1', 0.9513818242415281), ('ind_dice_liver_1', tensor(0.9709, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5340, dtype=torch.float64)), ('all_iou', 0.7754728091344196), ('all_dice_liver', tensor(0.8756, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3275, dtype=torch.float64))]), 6446.8068203460425)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:25:49,930][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:26:45,794][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:26:45,794][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:26:45,794][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:26:45,795][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-11-30 01:26:45,795][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:26:45,795][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.977467040450528
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6418, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7983346920968437
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8959, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3168, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9784723582099544
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5879, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.792975771197981
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8938, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2760, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9758212949583226
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9842, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6120, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7198342787765032
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8436, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2049, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9761030749093568
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6161, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7836245416784494
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8878, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2786, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 01:33:02,457][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.07295164013592643, OrderedDict([('ind_iou_0', 0.7836245416784494), ('ind_dice_liver_0', tensor(0.8878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2786, dtype=torch.float64)), ('ind_iou_1', 0.9697805119168175), ('ind_dice_liver_1', tensor(0.9825, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5662, dtype=torch.float64)), ('all_iou', 0.8020391622400234), ('all_dice_liver', tensor(0.8971, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3114, dtype=torch.float64))]), 6986.14476177562)
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:34:49,264][flwr][INFO] - fit progress: (13, 0.07295164013592643, OrderedDict([('ind_iou_0', 0.7836245416784494), ('ind_dice_liver_0', tensor(0.8878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2786, dtype=torch.float64)), ('ind_iou_1', 0.9697805119168175), ('ind_dice_liver_1', tensor(0.9825, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5662, dtype=torch.float64)), ('all_iou', 0.8020391622400234), ('all_dice_liver', tensor(0.8971, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3114, dtype=torch.float64))]), 6986.14476177562)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:34:49,268][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:35:43,808][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:35:43,808][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:35:43,809][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:35:43,809][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-11-30 01:35:43,809][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:35:43,809][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9779037034503186
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6183, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7933647631173518
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8937, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2994, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9785789055097892
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6140, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7958801101338868
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3144, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9792300385867024
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6015, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.782322406121894
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8898, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2768, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:42:03,152][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.0805002936439458, OrderedDict([('ind_iou_0', 0.7826007748222609), ('ind_dice_liver_0', tensor(0.8892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2870, dtype=torch.float64)), ('ind_iou_1', 0.9702681002816052), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.801182400148261), ('all_dice_liver', tensor(0.8985, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3194, dtype=torch.float64))]), 7525.829721639864)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9799149396970813
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6148, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7826007748222609
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8892, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2870, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:43:48,949][flwr][INFO] - fit progress: (14, 0.0805002936439458, OrderedDict([('ind_iou_0', 0.7826007748222609), ('ind_dice_liver_0', tensor(0.8892, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2870, dtype=torch.float64)), ('ind_iou_1', 0.9702681002816052), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.801182400148261), ('all_dice_liver', tensor(0.8985, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3194, dtype=torch.float64))]), 7525.829721639864)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:43:48,953][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:44:44,122][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 01:44:44,122][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:44:44,122][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:44:44,122][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-11-30 01:44:44,122][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:44:44,122][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9804050441593791
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6097, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7937360516061253
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3251, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9802115625148208
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6116, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7812013755460714
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8886, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2992, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9810867904384202
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6107, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7938101046578332
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8952, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:51:03,429][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.07781547019468547, OrderedDict([('ind_iou_0', 0.7925253756492625), ('ind_dice_liver_0', tensor(0.8946, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2974, dtype=torch.float64)), ('ind_iou_1', 0.9715224074084938), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8102602849777714), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3293, dtype=torch.float64))]), 8066.1102245152)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9793901872899164
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6031, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7925253756492625
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8946, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2974, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 01:52:49,230][flwr][INFO] - fit progress: (15, 0.07781547019468547, OrderedDict([('ind_iou_0', 0.7925253756492625), ('ind_dice_liver_0', tensor(0.8946, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2974, dtype=torch.float64)), ('ind_iou_1', 0.9715224074084938), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8102602849777714), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3293, dtype=torch.float64))]), 8066.1102245152)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 01:52:49,233][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 01:53:44,194][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 01:53:44,194][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 01:53:44,194][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 01:53:44,195][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-11-30 01:53:44,195][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 01:53:44,195][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9809739568812541
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6362, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7974786437632151
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8971, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3140, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9821787692960037
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6176, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7936589403061227
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8950, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3087, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9821590254641722
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.5912, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7930004022714681
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3087, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9821495341592497
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6156, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.794770611049503
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8947, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3189, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 02:00:02,909][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.07666210907707423, OrderedDict([('ind_iou_0', 0.794770611049503), ('ind_dice_liver_0', tensor(0.8947, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3189, dtype=torch.float64)), ('ind_iou_1', 0.9700779992206202), ('ind_dice_liver_1', tensor(0.9834, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5808, dtype=torch.float64)), ('all_iou', 0.8121368422383726), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3487, dtype=torch.float64))]), 8606.85745873116)
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:01:49,977][flwr][INFO] - fit progress: (16, 0.07666210907707423, OrderedDict([('ind_iou_0', 0.794770611049503), ('ind_dice_liver_0', tensor(0.8947, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3189, dtype=torch.float64)), ('ind_iou_1', 0.9700779992206202), ('ind_dice_liver_1', tensor(0.9834, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5808, dtype=torch.float64)), ('all_iou', 0.8121368422383726), ('all_dice_liver', tensor(0.9035, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3487, dtype=torch.float64))]), 8606.85745873116)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:01:49,980][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:02:43,519][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:02:43,519][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:02:43,520][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 02:02:43,520][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-11-30 02:02:43,520][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:02:43,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9827340697384892
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6405, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7904864531094246
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8934, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2970, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9832322670376179
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6213, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7949999749171357
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8962, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3156, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9836485517719515
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6388, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7936186908546798
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8949, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3258, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9830125308200913
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6296, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7917326566061946
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3016, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 02:09:01,052][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.07800370926689688, OrderedDict([('ind_iou_0', 0.7917326566061946), ('ind_dice_liver_0', tensor(0.8930, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3016, dtype=torch.float64)), ('ind_iou_1', 0.9706330449831999), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5683, dtype=torch.float64)), ('all_iou', 0.8094801036365123), ('all_dice_liver', tensor(0.9020, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3319, dtype=torch.float64))]), 9144.394592504948)
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:10:47,514][flwr][INFO] - fit progress: (17, 0.07800370926689688, OrderedDict([('ind_iou_0', 0.7917326566061946), ('ind_dice_liver_0', tensor(0.8930, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3016, dtype=torch.float64)), ('ind_iou_1', 0.9706330449831999), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5683, dtype=torch.float64)), ('all_iou', 0.8094801036365123), ('all_dice_liver', tensor(0.9020, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3319, dtype=torch.float64))]), 9144.394592504948)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:10:47,517][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:11:41,749][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:11:41,750][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:11:41,751][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 02:11:41,751][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-11-30 02:11:41,751][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:11:41,751][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.983821563733833
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6186, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7953531171624855
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8959, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3129, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9840708823631495
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6100, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7894186432696285
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8923, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3032, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9843277736497758
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6262, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7917890450455858
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3294, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.984201360622697
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6144, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7958701546502802
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8966, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3283, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 02:17:58,942][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.08207932139296133, OrderedDict([('ind_iou_0', 0.7958701546502802), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3283, dtype=torch.float64)), ('ind_iou_1', 0.9721577140487381), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8133492611987482), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3571, dtype=torch.float64))]), 9682.216391171329)
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:19:45,336][flwr][INFO] - fit progress: (18, 0.08207932139296133, OrderedDict([('ind_iou_0', 0.7958701546502802), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3283, dtype=torch.float64)), ('ind_iou_1', 0.9721577140487381), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8133492611987482), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3571, dtype=torch.float64))]), 9682.216391171329)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:19:45,339][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:20:39,288][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:20:39,289][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:20:39,289][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:20:39,289][flwr][INFO] - 
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 19]
[2024-11-30 02:20:39,289][flwr][INFO] - [ROUND 19]
[2024-11-30 02:20:39,290][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.984635924531588
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6401, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7888629209243482
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8939, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3016, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9848767419641012
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6328, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.790283472083863
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8929, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2997, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9853682126117536
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6114, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7992779344144871
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8982, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3244, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:26:58,403][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.08346623614592108, OrderedDict([('ind_iou_0', 0.7907357953627282), ('ind_dice_liver_0', tensor(0.8933, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3057, dtype=torch.float64)), ('ind_iou_1', 0.9726733307368213), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5879, dtype=torch.float64)), ('all_iou', 0.8087580004949835), ('all_dice_liver', tensor(0.9024, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3373, dtype=torch.float64))]), 10221.655718009919)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9854412082880999
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6503, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7907357953627282
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8933, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3057, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:28:44,775][flwr][INFO] - fit progress: (19, 0.08346623614592108, OrderedDict([('ind_iou_0', 0.7907357953627282), ('ind_dice_liver_0', tensor(0.8933, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3057, dtype=torch.float64)), ('ind_iou_1', 0.9726733307368213), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5879, dtype=torch.float64)), ('all_iou', 0.8087580004949835), ('all_dice_liver', tensor(0.9024, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3373, dtype=torch.float64))]), 10221.655718009919)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:28:44,779][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:29:38,875][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:29:38,876][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:29:38,883][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 02:29:38,883][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-11-30 02:29:38,883][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:29:38,884][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9852897419925227
[36m(ClientAppActor pid=3592861)[0m train dice liver:  
[36m(ClientAppActor pid=3592861)[0m tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6387, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7939686809967555
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8957, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2969, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9859304697840798
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6606, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7878286667542395
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8911, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9801157575175339
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6148, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7601202347251144
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8778, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2419, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9827889957358161
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6230, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7751670209418916
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8846, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2775, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 02:35:57,511][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.08608568779925962, OrderedDict([('ind_iou_0', 0.7751670209418916), ('ind_dice_liver_0', tensor(0.8846, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2775, dtype=torch.float64)), ('ind_iou_1', 0.9726740116184747), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5825, dtype=torch.float64)), ('all_iou', 0.7947234413923687), ('all_dice_liver', tensor(0.8946, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3115, dtype=torch.float64))]), 10760.569711542688)
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:37:43,689][flwr][INFO] - fit progress: (20, 0.08608568779925962, OrderedDict([('ind_iou_0', 0.7751670209418916), ('ind_dice_liver_0', tensor(0.8846, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2775, dtype=torch.float64)), ('ind_iou_1', 0.9726740116184747), ('ind_dice_liver_1', tensor(0.9852, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5825, dtype=torch.float64)), ('all_iou', 0.7947234413923687), ('all_dice_liver', tensor(0.8946, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3115, dtype=torch.float64))]), 10760.569711542688)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:37:43,692][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:38:38,589][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:38:38,589][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:38:38,590][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:38:38,590][flwr][INFO] - 
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 21]
[2024-11-30 02:38:38,590][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:38:38,590][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9850216672252595
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6402, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7856313060120536
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8900, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3009, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9859922156331784
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6303, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7922533550875374
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8943, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  
[36m(ClientAppActor pid=3592861)[0m tensor(0.3212, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9862097142101586
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6448, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7937848138995054
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8958, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3042, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9866501762500144
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6597, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7885281167213914
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8915, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3152, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 02:44:54,867][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.09094283431768417, OrderedDict([('ind_iou_0', 0.7885281167213914), ('ind_dice_liver_0', tensor(0.8915, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3152, dtype=torch.float64)), ('ind_iou_1', 0.972346415571436), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8067385506169092), ('all_dice_liver', tensor(0.9008, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3455, dtype=torch.float64))]), 11298.64030539617)
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:46:41,760][flwr][INFO] - fit progress: (21, 0.09094283431768417, OrderedDict([('ind_iou_0', 0.7885281167213914), ('ind_dice_liver_0', tensor(0.8915, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3152, dtype=torch.float64)), ('ind_iou_1', 0.972346415571436), ('ind_dice_liver_1', tensor(0.9855, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8067385506169092), ('all_dice_liver', tensor(0.9008, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3455, dtype=torch.float64))]), 11298.64030539617)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:46:41,763][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:47:34,279][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 02:47:34,280][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:47:34,281][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 02:47:34,281][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-11-30 02:47:34,281][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:47:34,281][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9867877470808372
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6380, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7886247517758137
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8942, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3017, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9868842325972724
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6431, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.793727054114788
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8963, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3154, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9870768301924847
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6075, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.795442929248514
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8966, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3287, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:53:52,374][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.08323826869190022, OrderedDict([('ind_iou_0', 0.794820627088442), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3324, dtype=torch.float64)), ('ind_iou_1', 0.9726798593246316), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.8124173732077967), ('all_dice_liver', tensor(0.9055, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3602, dtype=torch.float64))]), 11834.552490278147)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9873320593114921
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6274, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.794820627088442
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8966, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3324, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 02:55:37,672][flwr][INFO] - fit progress: (22, 0.08323826869190022, OrderedDict([('ind_iou_0', 0.794820627088442), ('ind_dice_liver_0', tensor(0.8966, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3324, dtype=torch.float64)), ('ind_iou_1', 0.9726798593246316), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.8124173732077967), ('all_dice_liver', tensor(0.9055, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3602, dtype=torch.float64))]), 11834.552490278147)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 02:55:37,675][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 02:56:30,798][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 02:56:30,798][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 02:56:30,798][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 02:56:30,799][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-11-30 02:56:30,799][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 02:56:30,799][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9873556556966797
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6234, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7892170811368727
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3035, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9876935691617822
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6436, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7959949535645703
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8974, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3013, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9877622151321207
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6490, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7972743266345176
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8988, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3221, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9804797090272207
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6118, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7748129285735644
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8838, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2660, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 03:02:47,111][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.06475172791968893, OrderedDict([('ind_iou_0', 0.7748129285735644), ('ind_dice_liver_0', tensor(0.8838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2660, dtype=torch.float64)), ('ind_iou_1', 0.9660274418780755), ('ind_dice_liver_1', tensor(0.9801, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5345, dtype=torch.float64)), ('all_iou', 0.7937778530542612), ('all_dice_liver', tensor(0.8934, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2959, dtype=torch.float64))]), 12369.649744211696)
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:04:32,769][flwr][INFO] - fit progress: (23, 0.06475172791968893, OrderedDict([('ind_iou_0', 0.7748129285735644), ('ind_dice_liver_0', tensor(0.8838, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2660, dtype=torch.float64)), ('ind_iou_1', 0.9660274418780755), ('ind_dice_liver_1', tensor(0.9801, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5345, dtype=torch.float64)), ('all_iou', 0.7937778530542612), ('all_dice_liver', tensor(0.8934, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2959, dtype=torch.float64))]), 12369.649744211696)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:04:32,773][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:05:26,754][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 03:05:26,755][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:05:26,755][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:05:26,755][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-11-30 03:05:26,756][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:05:26,756][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9849900104493062
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6050, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7970372156213874
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8969, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3320, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.987733082238874
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6326, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7977861761574501
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8975, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3200, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9879366608614822
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6633, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7950579565119145
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8972, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3190, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9880421233174055
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6593, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.8003105445286044
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8987, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3331, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 03:11:43,990][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.08459392053116109, OrderedDict([('ind_iou_0', 0.8003105445286044), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3331, dtype=torch.float64)), ('ind_iou_1', 0.9732658740725458), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5921, dtype=torch.float64)), ('all_iou', 0.8174465570904365), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 12905.934644649737)
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:13:29,054][flwr][INFO] - fit progress: (24, 0.08459392053116109, OrderedDict([('ind_iou_0', 0.8003105445286044), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3331, dtype=torch.float64)), ('ind_iou_1', 0.9732658740725458), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5921, dtype=torch.float64)), ('all_iou', 0.8174465570904365), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 12905.934644649737)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:13:29,057][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:14:23,096][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:14:23,096][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:14:23,097][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:14:23,098][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-11-30 03:14:23,098][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:14:23,098][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9881818222064283
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6342, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7981802061404751
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8977, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3275, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9883987950517028
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6408, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7878192942934548
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8919, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3189, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9884939430733318
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6406, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7974711108033321
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8986, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3247, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9888683111865277
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6450, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.799241978213032
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8987, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3296, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 03:20:39,355][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.08802219089104016, OrderedDict([('ind_iou_0', 0.799241978213032), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3296, dtype=torch.float64)), ('ind_iou_1', 0.973483713650208), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5766, dtype=torch.float64)), ('all_iou', 0.8164982508230381), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3576, dtype=torch.float64))]), 13441.97280604206)
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:22:25,092][flwr][INFO] - fit progress: (25, 0.08802219089104016, OrderedDict([('ind_iou_0', 0.799241978213032), ('ind_dice_liver_0', tensor(0.8987, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3296, dtype=torch.float64)), ('ind_iou_1', 0.973483713650208), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5766, dtype=torch.float64)), ('all_iou', 0.8164982508230381), ('all_dice_liver', tensor(0.9074, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3576, dtype=torch.float64))]), 13441.97280604206)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:22:25,095][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:23:18,462][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:23:18,462][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:23:18,463][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:23:18,463][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-11-30 03:23:18,463][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:23:18,463][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9887743826021297
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6434, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7952457297524914
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8954, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3355, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9891710781110198
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6871, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7982892385649335
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8984, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3318, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9891136629683247
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6540, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7955629598170909
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8967, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3272, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9890794977809416
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6422, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7994760698614096
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8981, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3401, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 03:29:34,850][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.09048079585005372, OrderedDict([('ind_iou_0', 0.7994760698614096), ('ind_dice_liver_0', tensor(0.8981, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3401, dtype=torch.float64)), ('ind_iou_1', 0.974029525142851), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8167572368705338), ('all_dice_liver', tensor(0.9069, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3679, dtype=torch.float64))]), 13977.413542283699)
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:31:20,533][flwr][INFO] - fit progress: (26, 0.09048079585005372, OrderedDict([('ind_iou_0', 0.7994760698614096), ('ind_dice_liver_0', tensor(0.8981, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3401, dtype=torch.float64)), ('ind_iou_1', 0.974029525142851), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5820, dtype=torch.float64)), ('all_iou', 0.8167572368705338), ('all_dice_liver', tensor(0.9069, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3679, dtype=torch.float64))]), 13977.413542283699)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:31:20,536][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:32:14,957][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:32:14,957][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:32:14,958][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:32:14,958][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-11-30 03:32:14,958][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:32:14,958][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9891100367678551
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6425, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.8024202188971087
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.9008, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3394, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9896807132782272
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6580, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7981204378096229
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8984, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3237, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9898091315186829
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6412, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7978619393343658
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8985, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3294, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9896869073660973
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6278, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7950781061937892
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8972, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3347, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 03:38:32,237][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.09174106121982374, OrderedDict([('ind_iou_0', 0.7950781061937892), ('ind_dice_liver_0', tensor(0.8972, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3347, dtype=torch.float64)), ('ind_iou_1', 0.9732923978943294), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8127388122800211), ('all_dice_liver', tensor(0.9061, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3632, dtype=torch.float64))]), 14514.731176161207)
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:40:17,851][flwr][INFO] - fit progress: (27, 0.09174106121982374, OrderedDict([('ind_iou_0', 0.7950781061937892), ('ind_dice_liver_0', tensor(0.8972, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3347, dtype=torch.float64)), ('ind_iou_1', 0.9732923978943294), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.8127388122800211), ('all_dice_liver', tensor(0.9061, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3632, dtype=torch.float64))]), 14514.731176161207)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:40:17,854][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:41:10,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:41:10,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:41:10,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:41:10,922][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-11-30 03:41:10,922][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:41:10,922][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9895586110271143
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6340, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7947290906015666
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8974, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3293, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9896569896166995
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6555, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7943350951320044
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8963, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3084, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9865376053692395
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6535, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7586096324791792
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8702, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2498, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:47:27,063][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.08486959324921531, OrderedDict([('ind_iou_0', 0.7817250958420316), ('ind_dice_liver_0', tensor(0.8875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2869, dtype=torch.float64)), ('ind_iou_1', 0.9729190181656941), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5764, dtype=torch.float64)), ('all_iou', 0.8006589862704299), ('all_dice_liver', tensor(0.8973, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3193, dtype=torch.float64))]), 15049.270671334118)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9824391015134274
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6100, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7817250958420316
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8875, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.2869, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:49:12,390][flwr][INFO] - fit progress: (28, 0.08486959324921531, OrderedDict([('ind_iou_0', 0.7817250958420316), ('ind_dice_liver_0', tensor(0.8875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2869, dtype=torch.float64)), ('ind_iou_1', 0.9729190181656941), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5764, dtype=torch.float64)), ('all_iou', 0.8006589862704299), ('all_dice_liver', tensor(0.8973, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3193, dtype=torch.float64))]), 15049.270671334118)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:49:12,394][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:50:06,680][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:50:06,680][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:50:06,681][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:50:06,681][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-11-30 03:50:06,681][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:50:06,681][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9885998470671653
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6322, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7953387689750733
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8962, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3216, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9898768269787298
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6282, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7921897758376838
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3178, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9902389537136054
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6399, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7892282252597963
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8926, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3319, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:56:26,277][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.0934941541902969, OrderedDict([('ind_iou_0', 0.7935916451200561), ('ind_dice_liver_0', tensor(0.8952, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3251, dtype=torch.float64)), ('ind_iou_1', 0.9736055323068126), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5795, dtype=torch.float64)), ('all_iou', 0.8114353229454422), ('all_dice_liver', tensor(0.9043, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3537, dtype=torch.float64))]), 15590.198030388914)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9902679944396008
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6369, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7935916451200561
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8952, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3251, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 03:58:13,317][flwr][INFO] - fit progress: (29, 0.0934941541902969, OrderedDict([('ind_iou_0', 0.7935916451200561), ('ind_dice_liver_0', tensor(0.8952, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3251, dtype=torch.float64)), ('ind_iou_1', 0.9736055323068126), ('ind_dice_liver_1', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5795, dtype=torch.float64)), ('all_iou', 0.8114353229454422), ('all_dice_liver', tensor(0.9043, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3537, dtype=torch.float64))]), 15590.198030388914)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 03:58:13,321][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 03:59:07,868][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 03:59:07,868][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 03:59:07,868][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 03:59:07,869][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-11-30 03:59:07,869][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 03:59:07,869][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9905856277934506
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6459, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7968881324494829
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8971, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3264, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9904803421192545
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6699, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7927687417320707
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8958, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3036, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9905882057281646
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6398, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7976603520404832
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8976, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3340, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:05:26,673][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.09592473836832732, OrderedDict([('ind_iou_0', 0.794403298223325), ('ind_dice_liver_0', tensor(0.8953, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3323, dtype=torch.float64)), ('ind_iou_1', 0.973732716093236), ('ind_dice_liver_1', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8121628868551101), ('all_dice_liver', tensor(0.9044, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3611, dtype=torch.float64))]), 16129.434625338763)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9906248234592839
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6414, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.794403298223325
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8953, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3323, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:07:12,554][flwr][INFO] - fit progress: (30, 0.09592473836832732, OrderedDict([('ind_iou_0', 0.794403298223325), ('ind_dice_liver_0', tensor(0.8953, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3323, dtype=torch.float64)), ('ind_iou_1', 0.973732716093236), ('ind_dice_liver_1', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5823, dtype=torch.float64)), ('all_iou', 0.8121628868551101), ('all_dice_liver', tensor(0.9044, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3611, dtype=torch.float64))]), 16129.434625338763)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:07:12,558][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:08:06,363][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:08:06,363][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:08:06,363][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:08:06,363][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-11-30 04:08:06,363][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:08:06,364][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.990791309150068
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6263, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.795218313836022
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8970, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3103, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9908874376862391
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6525, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7956528073321996
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8965, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3344, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9910443032241796
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6531, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.79842091874025
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8979, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3455, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9911210620348638
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6612, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7931324133784465
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3119, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 04:14:24,674][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.0962061827771441, OrderedDict([('ind_iou_0', 0.7931324133784465), ('ind_dice_liver_0', tensor(0.8956, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3119, dtype=torch.float64)), ('ind_iou_1', 0.9741346940386385), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5846, dtype=torch.float64)), ('all_iou', 0.8110572377033446), ('all_dice_liver', tensor(0.9046, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3424, dtype=torch.float64))]), 16667.378705914132)
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:16:10,498][flwr][INFO] - fit progress: (31, 0.0962061827771441, OrderedDict([('ind_iou_0', 0.7931324133784465), ('ind_dice_liver_0', tensor(0.8956, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3119, dtype=torch.float64)), ('ind_iou_1', 0.9741346940386385), ('ind_dice_liver_1', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5846, dtype=torch.float64)), ('all_iou', 0.8110572377033446), ('all_dice_liver', tensor(0.9046, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3424, dtype=torch.float64))]), 16667.378705914132)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:16:10,502][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:17:04,526][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:17:04,527][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:17:04,527][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:17:04,527][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-11-30 04:17:04,527][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:17:04,528][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.991238136468712
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6683, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7959675413838202
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8963, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3436, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9908706903422098
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6775, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7965584321344876
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8976, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3281, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9913151892298062
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6504, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7959695098666921
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8972, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3429, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:23:22,228][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.0961772500061708, OrderedDict([('ind_iou_0', 0.7950077196435238), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3223, dtype=torch.float64)), ('ind_iou_1', 0.9741582306300837), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5819, dtype=torch.float64)), ('all_iou', 0.8127452166952082), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3514, dtype=torch.float64))]), 17203.92630218342)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9914189211907797
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6539, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7950077196435238
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8960, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3223, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:25:07,046][flwr][INFO] - fit progress: (32, 0.0961772500061708, OrderedDict([('ind_iou_0', 0.7950077196435238), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3223, dtype=torch.float64)), ('ind_iou_1', 0.9741582306300837), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5819, dtype=torch.float64)), ('all_iou', 0.8127452166952082), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3514, dtype=torch.float64))]), 17203.92630218342)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:25:07,049][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:26:00,052][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:26:00,052][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:26:00,052][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:26:00,052][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-11-30 04:26:00,053][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:26:00,053][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9913925798551606
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6500, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7953137077057812
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8966, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3352, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9915695302584424
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6271, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7950771653409955
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8967, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3343, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9918364935635807
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6606, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7946925476869817
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8970, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3235, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:32:15,296][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.09608880142414418, OrderedDict([('ind_iou_0', 0.7991970050149196), ('ind_dice_liver_0', tensor(0.8999, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3430, dtype=torch.float64)), ('ind_iou_1', 0.9737154709765082), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5867, dtype=torch.float64)), ('all_iou', 0.8164878841193062), ('all_dice_liver', tensor(0.9086, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3707, dtype=torch.float64))]), 17736.89665346779)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9917266890858664
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6630, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7991970050149196
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8999, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3430, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:34:00,016][flwr][INFO] - fit progress: (33, 0.09608880142414418, OrderedDict([('ind_iou_0', 0.7991970050149196), ('ind_dice_liver_0', tensor(0.8999, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3430, dtype=torch.float64)), ('ind_iou_1', 0.9737154709765082), ('ind_dice_liver_1', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5867, dtype=torch.float64)), ('all_iou', 0.8164878841193062), ('all_dice_liver', tensor(0.9086, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3707, dtype=torch.float64))]), 17736.89665346779)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:34:00,019][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:34:53,922][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:34:53,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:34:53,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:34:53,922][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-11-30 04:34:53,922][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:34:53,922][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9917011045338608
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6456, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.792476735650279
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8950, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3264, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9918928172777923
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6440, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7969578569096784
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8976, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3291, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9919266429833397
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6276, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.8000415483177746
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8995, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3446, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9920131294913329
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6498, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7969106231438474
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8975, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3388, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 04:41:10,222][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.098250433641312, OrderedDict([('ind_iou_0', 0.7969106231438474), ('ind_dice_liver_0', tensor(0.8975, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3388, dtype=torch.float64)), ('ind_iou_1', 0.974259399170424), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5876, dtype=torch.float64)), ('all_iou', 0.8144782037544025), ('all_dice_liver', tensor(0.9065, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3672, dtype=torch.float64))]), 18271.255173244514)
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:42:54,375][flwr][INFO] - fit progress: (34, 0.098250433641312, OrderedDict([('ind_iou_0', 0.7969106231438474), ('ind_dice_liver_0', tensor(0.8975, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3388, dtype=torch.float64)), ('ind_iou_1', 0.974259399170424), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5876, dtype=torch.float64)), ('all_iou', 0.8144782037544025), ('all_dice_liver', tensor(0.9065, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3672, dtype=torch.float64))]), 18271.255173244514)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:42:54,378][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:43:49,887][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:43:49,887][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:43:49,887][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:43:49,888][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-11-30 04:43:49,888][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:43:49,888][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.992084996285396
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6509, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.783930877653811
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8896, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3180, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9920298492646752
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6486, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7969464559179166
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8977, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3382, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.992165716238195
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6345, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7951408337515514
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8967, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3294, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9922439390549049
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6613, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7953932442769412
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8963, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3371, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 04:50:07,618][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.10414930166799562, OrderedDict([('ind_iou_0', 0.7953932442769412), ('ind_dice_liver_0', tensor(0.8963, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3371, dtype=torch.float64)), ('ind_iou_1', 0.9742189859794027), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5844, dtype=torch.float64)), ('all_iou', 0.813090732472662), ('all_dice_liver', tensor(0.9053, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3653, dtype=torch.float64))]), 18809.17090769671)
Entrei no test
Meio do test
Fim do test
[2024-11-30 04:51:52,290][flwr][INFO] - fit progress: (35, 0.10414930166799562, OrderedDict([('ind_iou_0', 0.7953932442769412), ('ind_dice_liver_0', tensor(0.8963, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3371, dtype=torch.float64)), ('ind_iou_1', 0.9742189859794027), ('ind_dice_liver_1', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5844, dtype=torch.float64)), ('all_iou', 0.813090732472662), ('all_dice_liver', tensor(0.9053, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3653, dtype=torch.float64))]), 18809.17090769671)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 04:51:52,294][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:52:47,999][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 04:52:47,999][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 04:52:48,000][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 04:52:48,000][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-11-30 04:52:48,000][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 04:52:48,001][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9922935616634427
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6575, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7975171402397729
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8983, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3391, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9922467276378645
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6434, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7963024714312026
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8973, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3300, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9924441584225638
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6599, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7905696745154991
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8948, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3297, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 04:59:03,725][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.10581186685365637, OrderedDict([('ind_iou_0', 0.7938275326122274), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3285, dtype=torch.float64)), ('ind_iou_1', 0.9742970206234295), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5926, dtype=torch.float64)), ('all_iou', 0.8116919335533389), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3585, dtype=torch.float64))]), 19346.84276806377)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9926320148973363
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6818, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7938275326122274
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8964, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3285, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 05:00:49,962][flwr][INFO] - fit progress: (36, 0.10581186685365637, OrderedDict([('ind_iou_0', 0.7938275326122274), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3285, dtype=torch.float64)), ('ind_iou_1', 0.9742970206234295), ('ind_dice_liver_1', tensor(0.9876, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5926, dtype=torch.float64)), ('all_iou', 0.8116919335533389), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3585, dtype=torch.float64))]), 19346.84276806377)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:00:49,966][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:01:44,454][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:01:44,454][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:01:44,455][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 05:01:44,455][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-11-30 05:01:44,455][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:01:44,455][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9925609972801205
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6860, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7942825424872512
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8960, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3307, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9926239168941902
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6589, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7953942591668425
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8969, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3274, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.992731454326772
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6689, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7975104521450115
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8974, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3490, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:08:01,392][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.10754595931323731, OrderedDict([('ind_iou_0', 0.7938397296356953), ('ind_dice_liver_0', tensor(0.8959, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3308, dtype=torch.float64)), ('ind_iou_1', 0.9748234992278885), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5886, dtype=torch.float64)), ('all_iou', 0.8117460209383668), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3603, dtype=torch.float64))]), 19884.076712256297)
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9928341142373633
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6566, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7938397296356953
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8959, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3308, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-30 05:09:47,196][flwr][INFO] - fit progress: (37, 0.10754595931323731, OrderedDict([('ind_iou_0', 0.7938397296356953), ('ind_dice_liver_0', tensor(0.8959, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3308, dtype=torch.float64)), ('ind_iou_1', 0.9748234992278885), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5886, dtype=torch.float64)), ('all_iou', 0.8117460209383668), ('all_dice_liver', tensor(0.9050, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3603, dtype=torch.float64))]), 19884.076712256297)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:09:47,199][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:10:40,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:10:40,867][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:10:40,867][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 05:10:40,867][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-11-30 05:10:40,867][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:10:40,867][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9929047035647
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6502, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7918530929509618
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8949, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3221, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9928475543439615
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6481, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7952388922368453
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8975, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3353, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9929454839557204
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6435, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7913862066672354
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8964, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3208, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9931439919059587
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6409, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7931336049239085
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8960, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3334, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 05:16:57,951][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.10519228303803886, OrderedDict([('ind_iou_0', 0.7931336049239085), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3334, dtype=torch.float64)), ('ind_iou_1', 0.9745480935375148), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.8110971479071926), ('all_dice_liver', tensor(0.9051, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 20420.2604021905)
Entrei no test
Meio do test
Fim do test
[2024-11-30 05:18:43,380][flwr][INFO] - fit progress: (38, 0.10519228303803886, OrderedDict([('ind_iou_0', 0.7931336049239085), ('ind_dice_liver_0', tensor(0.8960, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3334, dtype=torch.float64)), ('ind_iou_1', 0.9745480935375148), ('ind_dice_liver_1', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.8110971479071926), ('all_dice_liver', tensor(0.9051, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3621, dtype=torch.float64))]), 20420.2604021905)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:18:43,383][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:19:37,760][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:19:37,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:19:37,761][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 05:19:37,761][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-11-30 05:19:37,761][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:19:37,761][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.993154814389103
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6406, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7905982772798736
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8945, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3277, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9931213330447056
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6820, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7978458356617938
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8981, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3478, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9931088054484032
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6477, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7905990119415383
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8947, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3199, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.993284528999163
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6492, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7940132921480715
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8964, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3374, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 05:25:52,489][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.10713021535222617, OrderedDict([('ind_iou_0', 0.7940132921480715), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3374, dtype=torch.float64)), ('ind_iou_1', 0.9745763808735843), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.811889422667287), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3662, dtype=torch.float64))]), 20953.80361468997)
Entrei no test
Meio do test
Fim do test
[2024-11-30 05:27:36,923][flwr][INFO] - fit progress: (39, 0.10713021535222617, OrderedDict([('ind_iou_0', 0.7940132921480715), ('ind_dice_liver_0', tensor(0.8964, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3374, dtype=torch.float64)), ('ind_iou_1', 0.9745763808735843), ('ind_dice_liver_1', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5858, dtype=torch.float64)), ('all_iou', 0.811889422667287), ('all_dice_liver', tensor(0.9054, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3662, dtype=torch.float64))]), 20953.80361468997)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:27:36,926][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:28:31,556][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-30 05:28:31,556][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:28:31,556][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 05:28:31,557][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-11-30 05:28:31,557][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-30 05:28:31,557][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  0
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9933507262710529
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6542, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7956775978567945
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8974, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3418, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  0
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  1
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9930971795920928
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6551, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7990766526482621
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8988, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3341, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  1
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  2
[36m(ClientAppActor pid=3592861)[0m train ious:  0.993285026352541
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6807, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7950566763175718
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8970, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3406, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  2
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3592861)[0m epoch:  3
[36m(ClientAppActor pid=3592861)[0m train ious:  0.9891557081312968
[36m(ClientAppActor pid=3592861)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m train dice tumour:  tensor(0.6519, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation ious:  0.7820696327087762
[36m(ClientAppActor pid=3592861)[0m validation dice liver:  tensor(0.8882, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m validation dice tumour:  tensor(0.3127, dtype=torch.float64)
[36m(ClientAppActor pid=3592861)[0m => new best model:  3
[2024-11-30 05:34:50,303][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.0988124312408264, OrderedDict([('ind_iou_0', 0.7820696327087762), ('ind_dice_liver_0', tensor(0.8882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3127, dtype=torch.float64)), ('ind_iou_1', 0.9745350741360002), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.8011189139020328), ('all_dice_liver', tensor(0.8980, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3440, dtype=torch.float64))]), 21492.32689800393)
Entrei no test
Meio do test
Fim do test
[2024-11-30 05:36:35,446][flwr][INFO] - fit progress: (40, 0.0988124312408264, OrderedDict([('ind_iou_0', 0.7820696327087762), ('ind_dice_liver_0', tensor(0.8882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3127, dtype=torch.float64)), ('ind_iou_1', 0.9745350741360002), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.8011189139020328), ('all_dice_liver', tensor(0.8980, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3440, dtype=torch.float64))]), 21492.32689800393)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-30 05:36:35,450][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3592861)[0m Entrei no validation 1 3
[2024-11-30 05:37:29,420][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-30 05:37:29,420][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3592861, ip=172.18.62.12, actor_id=0736ffb88514dba740cd4ae301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1511cd6bf520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-30 05:37:29,421][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-30 05:37:29,421][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-11-30 05:37:29,421][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 21546.30s
[2024-11-30 05:37:29,421][flwr][INFO] - Run finished 40 round(s) in 21546.30s
[92mINFO [0m:      	History (loss, centralized):
[2024-11-30 05:37:29,540][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.7414753399337515
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 0: 0.7414753399337515
[92mINFO [0m:      		round 1: 0.05303550318379606
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 1: 0.05303550318379606
[92mINFO [0m:      		round 2: 0.04925278463045425
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 2: 0.04925278463045425
[92mINFO [0m:      		round 3: 0.04922053228518909
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 3: 0.04922053228518909
[92mINFO [0m:      		round 4: 0.05813819540068773
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 4: 0.05813819540068773
[92mINFO [0m:      		round 5: 0.05193330802911545
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 5: 0.05193330802911545
[92mINFO [0m:      		round 6: 0.0595124055107659
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 6: 0.0595124055107659
[92mINFO [0m:      		round 7: 0.054658803450969115
[2024-11-30 05:37:29,540][flwr][INFO] - 		round 7: 0.054658803450969115
[92mINFO [0m:      		round 8: 0.06094796382606153
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 8: 0.06094796382606153
[92mINFO [0m:      		round 9: 0.06346101352466574
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 9: 0.06346101352466574
[92mINFO [0m:      		round 10: 0.06813601635963469
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 10: 0.06813601635963469
[92mINFO [0m:      		round 11: 0.07734067768553952
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 11: 0.07734067768553952
[92mINFO [0m:      		round 12: 0.06587269239606032
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 12: 0.06587269239606032
[92mINFO [0m:      		round 13: 0.07295164013592643
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 13: 0.07295164013592643
[92mINFO [0m:      		round 14: 0.0805002936439458
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 14: 0.0805002936439458
[92mINFO [0m:      		round 15: 0.07781547019468547
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 15: 0.07781547019468547
[92mINFO [0m:      		round 16: 0.07666210907707423
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 16: 0.07666210907707423
[92mINFO [0m:      		round 17: 0.07800370926689688
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 17: 0.07800370926689688
[92mINFO [0m:      		round 18: 0.08207932139296133
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 18: 0.08207932139296133
[92mINFO [0m:      		round 19: 0.08346623614592108
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 19: 0.08346623614592108
[92mINFO [0m:      		round 20: 0.08608568779925962
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 20: 0.08608568779925962
[92mINFO [0m:      		round 21: 0.09094283431768417
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 21: 0.09094283431768417
[92mINFO [0m:      		round 22: 0.08323826869190022
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 22: 0.08323826869190022
[92mINFO [0m:      		round 23: 0.06475172791968893
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 23: 0.06475172791968893
[92mINFO [0m:      		round 24: 0.08459392053116109
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 24: 0.08459392053116109
[92mINFO [0m:      		round 25: 0.08802219089104016
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 25: 0.08802219089104016
[92mINFO [0m:      		round 26: 0.09048079585005372
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 26: 0.09048079585005372
[92mINFO [0m:      		round 27: 0.09174106121982374
[2024-11-30 05:37:29,541][flwr][INFO] - 		round 27: 0.09174106121982374
[92mINFO [0m:      		round 28: 0.08486959324921531
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 28: 0.08486959324921531
[92mINFO [0m:      		round 29: 0.0934941541902969
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 29: 0.0934941541902969
[92mINFO [0m:      		round 30: 0.09592473836832732
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 30: 0.09592473836832732
[92mINFO [0m:      		round 31: 0.0962061827771441
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 31: 0.0962061827771441
[92mINFO [0m:      		round 32: 0.0961772500061708
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 32: 0.0961772500061708
[92mINFO [0m:      		round 33: 0.09608880142414418
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 33: 0.09608880142414418
[92mINFO [0m:      		round 34: 0.098250433641312
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 34: 0.098250433641312
[92mINFO [0m:      		round 35: 0.10414930166799562
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 35: 0.10414930166799562
[92mINFO [0m:      		round 36: 0.10581186685365637
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 36: 0.10581186685365637
[92mINFO [0m:      		round 37: 0.10754595931323731
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 37: 0.10754595931323731
[92mINFO [0m:      		round 38: 0.10519228303803886
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 38: 0.10519228303803886
[92mINFO [0m:      		round 39: 0.10713021535222617
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 39: 0.10713021535222617
[92mINFO [0m:      		round 40: 0.0988124312408264
[2024-11-30 05:37:29,542][flwr][INFO] - 		round 40: 0.0988124312408264
[92mINFO [0m:      	History (metrics, centralized):
[2024-11-30 05:37:29,542][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1514, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1514, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.7681, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (1, tensor(0.7681, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.8734, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (2, tensor(0.8734, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.8940, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (3, tensor(0.8940, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.8769, dtype=torch.float64)),
[2024-11-30 05:37:29,542][flwr][INFO] - 	                    (4, tensor(0.8769, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.8937, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (5, tensor(0.8937, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.8466, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (6, tensor(0.8466, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.9034, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (7, tensor(0.9034, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.9012, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (8, tensor(0.9012, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.9005, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (9, tensor(0.9005, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.9025, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (10, tensor(0.9025, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.8950, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (11, tensor(0.8950, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.8756, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (12, tensor(0.8756, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.8971, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (13, tensor(0.8971, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.8985, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (14, tensor(0.8985, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.9035, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (15, tensor(0.9035, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.9035, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (16, tensor(0.9035, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.9020, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (17, tensor(0.9020, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (18, tensor(0.9054, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.9024, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (19, tensor(0.9024, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.8946, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (20, tensor(0.8946, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.9008, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (21, tensor(0.9008, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.9055, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (22, tensor(0.9055, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.8934, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (23, tensor(0.8934, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.9074, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (24, tensor(0.9074, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.9074, dtype=torch.float64)),
[2024-11-30 05:37:29,543][flwr][INFO] - 	                    (25, tensor(0.9074, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.9069, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (26, tensor(0.9069, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.9061, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (27, tensor(0.9061, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.8973, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (28, tensor(0.8973, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.9043, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (29, tensor(0.9043, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.9044, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (30, tensor(0.9044, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.9046, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (31, tensor(0.9046, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.9050, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (32, tensor(0.9050, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.9086, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (33, tensor(0.9086, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.9065, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (34, tensor(0.9065, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.9053, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (35, tensor(0.9053, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (36, tensor(0.9054, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.9050, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (37, tensor(0.9050, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.9051, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (38, tensor(0.9051, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.9054, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (39, tensor(0.9054, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.8980, dtype=torch.float64))],
[2024-11-30 05:37:29,544][flwr][INFO] - 	                    (40, tensor(0.8980, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0085, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.0362, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (1, tensor(0.0362, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.1950, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (2, tensor(0.1950, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.2571, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (3, tensor(0.2571, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.2460, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (4, tensor(0.2460, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.2404, dtype=torch.float64)),
[2024-11-30 05:37:29,544][flwr][INFO] - 	                     (5, tensor(0.2404, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.2149, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (6, tensor(0.2149, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.2978, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (7, tensor(0.2978, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.3270, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (8, tensor(0.3270, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.3150, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (9, tensor(0.3150, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.3109, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (10, tensor(0.3109, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.3134, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (11, tensor(0.3134, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.3275, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (12, tensor(0.3275, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.3114, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (13, tensor(0.3114, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.3194, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (14, tensor(0.3194, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.3293, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (15, tensor(0.3293, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.3487, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (16, tensor(0.3487, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.3319, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (17, tensor(0.3319, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.3571, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (18, tensor(0.3571, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.3373, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (19, tensor(0.3373, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.3115, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (20, tensor(0.3115, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.3455, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (21, tensor(0.3455, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.3602, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (22, tensor(0.3602, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.2959, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (23, tensor(0.2959, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.3621, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (24, tensor(0.3621, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.3576, dtype=torch.float64)),
[2024-11-30 05:37:29,545][flwr][INFO] - 	                     (25, tensor(0.3576, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.3679, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (26, tensor(0.3679, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.3632, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (27, tensor(0.3632, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.3193, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (28, tensor(0.3193, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.3537, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (29, tensor(0.3537, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.3611, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (30, tensor(0.3611, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.3424, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (31, tensor(0.3424, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.3514, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (32, tensor(0.3514, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.3707, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (33, tensor(0.3707, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.3672, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (34, tensor(0.3672, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.3653, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (35, tensor(0.3653, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.3585, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (36, tensor(0.3585, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.3603, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (37, tensor(0.3603, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.3621, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (38, tensor(0.3621, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.3662, dtype=torch.float64)),
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (39, tensor(0.3662, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.3440, dtype=torch.float64))],
[2024-11-30 05:37:29,546][flwr][INFO] - 	                     (40, tensor(0.3440, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 0.0475928625471509),
[2024-11-30 05:37:29,546][flwr][INFO] - 	 'all_iou': [(0, 0.0475928625471509),
[92mINFO [0m:      	             (1, 0.6519288082394075),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (1, 0.6519288082394075),
[92mINFO [0m:      	             (2, 0.7711695907460727),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (2, 0.7711695907460727),
[92mINFO [0m:      	             (3, 0.7981788571034795),
[2024-11-30 05:37:29,546][flwr][INFO] - 	             (3, 0.7981788571034795),
[92mINFO [0m:      	             (4, 0.7654355161020596),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (4, 0.7654355161020596),
[92mINFO [0m:      	             (5, 0.789865516286173),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (5, 0.789865516286173),
[92mINFO [0m:      	             (6, 0.7334295273680683),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (6, 0.7334295273680683),
[92mINFO [0m:      	             (7, 0.8155179756401552),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (7, 0.8155179756401552),
[92mINFO [0m:      	             (8, 0.8098240228808102),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (8, 0.8098240228808102),
[92mINFO [0m:      	             (9, 0.8068082440479202),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (9, 0.8068082440479202),
[92mINFO [0m:      	             (10, 0.8100800327081573),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (10, 0.8100800327081573),
[92mINFO [0m:      	             (11, 0.7965341836797774),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (11, 0.7965341836797774),
[92mINFO [0m:      	             (12, 0.7754728091344196),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (12, 0.7754728091344196),
[92mINFO [0m:      	             (13, 0.8020391622400234),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (13, 0.8020391622400234),
[92mINFO [0m:      	             (14, 0.801182400148261),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (14, 0.801182400148261),
[92mINFO [0m:      	             (15, 0.8102602849777714),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (15, 0.8102602849777714),
[92mINFO [0m:      	             (16, 0.8121368422383726),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (16, 0.8121368422383726),
[92mINFO [0m:      	             (17, 0.8094801036365123),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (17, 0.8094801036365123),
[92mINFO [0m:      	             (18, 0.8133492611987482),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (18, 0.8133492611987482),
[92mINFO [0m:      	             (19, 0.8087580004949835),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (19, 0.8087580004949835),
[92mINFO [0m:      	             (20, 0.7947234413923687),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (20, 0.7947234413923687),
[92mINFO [0m:      	             (21, 0.8067385506169092),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (21, 0.8067385506169092),
[92mINFO [0m:      	             (22, 0.8124173732077967),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (22, 0.8124173732077967),
[92mINFO [0m:      	             (23, 0.7937778530542612),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (23, 0.7937778530542612),
[92mINFO [0m:      	             (24, 0.8174465570904365),
[2024-11-30 05:37:29,547][flwr][INFO] - 	             (24, 0.8174465570904365),
[92mINFO [0m:      	             (25, 0.8164982508230381),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (25, 0.8164982508230381),
[92mINFO [0m:      	             (26, 0.8167572368705338),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (26, 0.8167572368705338),
[92mINFO [0m:      	             (27, 0.8127388122800211),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (27, 0.8127388122800211),
[92mINFO [0m:      	             (28, 0.8006589862704299),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (28, 0.8006589862704299),
[92mINFO [0m:      	             (29, 0.8114353229454422),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (29, 0.8114353229454422),
[92mINFO [0m:      	             (30, 0.8121628868551101),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (30, 0.8121628868551101),
[92mINFO [0m:      	             (31, 0.8110572377033446),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (31, 0.8110572377033446),
[92mINFO [0m:      	             (32, 0.8127452166952082),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (32, 0.8127452166952082),
[92mINFO [0m:      	             (33, 0.8164878841193062),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (33, 0.8164878841193062),
[92mINFO [0m:      	             (34, 0.8144782037544025),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (34, 0.8144782037544025),
[92mINFO [0m:      	             (35, 0.813090732472662),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (35, 0.813090732472662),
[92mINFO [0m:      	             (36, 0.8116919335533389),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (36, 0.8116919335533389),
[92mINFO [0m:      	             (37, 0.8117460209383668),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (37, 0.8117460209383668),
[92mINFO [0m:      	             (38, 0.8110971479071926),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (38, 0.8110971479071926),
[92mINFO [0m:      	             (39, 0.811889422667287),
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (39, 0.811889422667287),
[92mINFO [0m:      	             (40, 0.8011189139020328)],
[2024-11-30 05:37:29,548][flwr][INFO] - 	             (40, 0.8011189139020328)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1516, dtype=torch.float64)),
[2024-11-30 05:37:29,548][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1516, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.7563, dtype=torch.float64)),
[2024-11-30 05:37:29,548][flwr][INFO] - 	                      (1, tensor(0.7563, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.8644, dtype=torch.float64)),
[2024-11-30 05:37:29,548][flwr][INFO] - 	                      (2, tensor(0.8644, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.8861, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (3, tensor(0.8861, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.8673, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (4, tensor(0.8673, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.8854, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (5, tensor(0.8854, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.8347, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (6, tensor(0.8347, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.8957, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (7, tensor(0.8957, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.8929, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (8, tensor(0.8929, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.8920, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (9, tensor(0.8920, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.8941, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (10, tensor(0.8941, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.8856, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (11, tensor(0.8856, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.8651, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (12, tensor(0.8651, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.8878, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (13, tensor(0.8878, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.8892, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (14, tensor(0.8892, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.8946, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (15, tensor(0.8946, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.8947, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (16, tensor(0.8947, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.8930, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (17, tensor(0.8930, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.8966, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (18, tensor(0.8966, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.8933, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (19, tensor(0.8933, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.8846, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (20, tensor(0.8846, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.8915, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (21, tensor(0.8915, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.8966, dtype=torch.float64)),
[2024-11-30 05:37:29,549][flwr][INFO] - 	                      (22, tensor(0.8966, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.8838, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (23, tensor(0.8838, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.8987, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (24, tensor(0.8987, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.8987, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (25, tensor(0.8987, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.8981, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (26, tensor(0.8981, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.8972, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (27, tensor(0.8972, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.8875, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (28, tensor(0.8875, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.8952, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (29, tensor(0.8952, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.8953, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (30, tensor(0.8953, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.8956, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (31, tensor(0.8956, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.8960, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (32, tensor(0.8960, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.8999, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (33, tensor(0.8999, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.8975, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (34, tensor(0.8975, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.8963, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (35, tensor(0.8963, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.8964, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (36, tensor(0.8964, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.8959, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (37, tensor(0.8959, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.8960, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (38, tensor(0.8960, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.8964, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (39, tensor(0.8964, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.8882, dtype=torch.float64))],
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (40, tensor(0.8882, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1499, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1499, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.8752, dtype=torch.float64)),
[2024-11-30 05:37:29,550][flwr][INFO] - 	                      (1, tensor(0.8752, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9542, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (2, tensor(0.9542, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9657, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (3, tensor(0.9657, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9641, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (4, tensor(0.9641, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9693, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (5, tensor(0.9693, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9552, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (6, tensor(0.9552, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9731, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (7, tensor(0.9731, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9769, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (8, tensor(0.9769, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9778, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (9, tensor(0.9778, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9786, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (10, tensor(0.9786, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9804, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (11, tensor(0.9804, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9709, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (12, tensor(0.9709, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9825, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (13, tensor(0.9825, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9832, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (14, tensor(0.9832, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9843, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (15, tensor(0.9843, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9834, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (16, tensor(0.9834, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9838, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (17, tensor(0.9838, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9851, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (18, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9853, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (19, tensor(0.9853, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9852, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (20, tensor(0.9852, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9855, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (21, tensor(0.9855, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9859, dtype=torch.float64)),
[2024-11-30 05:37:29,551][flwr][INFO] - 	                      (22, tensor(0.9859, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9801, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (23, tensor(0.9801, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9862, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (24, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9865, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (25, tensor(0.9865, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9869, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (26, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9866, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (27, tensor(0.9866, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9862, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (28, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9869, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (29, tensor(0.9869, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9871, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (30, tensor(0.9871, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9872, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (31, tensor(0.9872, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9873, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (32, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9873, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (33, tensor(0.9873, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9876, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (34, tensor(0.9876, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9877, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (35, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9876, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (36, tensor(0.9876, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9879, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (37, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9879, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (38, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9878, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (39, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9875, dtype=torch.float64))],
[2024-11-30 05:37:29,552][flwr][INFO] - 	                      (40, tensor(0.9875, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.0358, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                       (1, tensor(0.0358, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.1785, dtype=torch.float64)),
[2024-11-30 05:37:29,552][flwr][INFO] - 	                       (2, tensor(0.1785, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.2361, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (3, tensor(0.2361, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.2178, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (4, tensor(0.2178, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.2104, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (5, tensor(0.2104, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.1899, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (6, tensor(0.1899, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.2720, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (7, tensor(0.2720, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.2976, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (8, tensor(0.2976, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.2845, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (9, tensor(0.2845, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.2796, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (10, tensor(0.2796, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.2821, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (11, tensor(0.2821, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.2997, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (12, tensor(0.2997, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.2786, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (13, tensor(0.2786, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.2870, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (14, tensor(0.2870, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.2974, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (15, tensor(0.2974, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.3189, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (16, tensor(0.3189, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.3016, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (17, tensor(0.3016, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.3283, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (18, tensor(0.3283, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.3057, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (19, tensor(0.3057, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.2775, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (20, tensor(0.2775, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.3152, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (21, tensor(0.3152, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.3324, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (22, tensor(0.3324, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.2660, dtype=torch.float64)),
[2024-11-30 05:37:29,553][flwr][INFO] - 	                       (23, tensor(0.2660, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.3331, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (24, tensor(0.3331, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.3296, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (25, tensor(0.3296, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.3401, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (26, tensor(0.3401, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.3347, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (27, tensor(0.3347, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.2869, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (28, tensor(0.2869, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.3251, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (29, tensor(0.3251, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.3323, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (30, tensor(0.3323, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.3119, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (31, tensor(0.3119, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.3223, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (32, tensor(0.3223, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.3430, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (33, tensor(0.3430, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.3388, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (34, tensor(0.3388, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.3371, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (35, tensor(0.3371, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.3285, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (36, tensor(0.3285, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.3308, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (37, tensor(0.3308, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.3334, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (38, tensor(0.3334, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.3374, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (39, tensor(0.3374, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.3127, dtype=torch.float64))],
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (40, tensor(0.3127, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.0395, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (1, tensor(0.0395, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.3130, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (2, tensor(0.3130, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.4101, dtype=torch.float64)),
[2024-11-30 05:37:29,554][flwr][INFO] - 	                       (3, tensor(0.4101, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.4632, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (4, tensor(0.4632, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.4751, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (5, tensor(0.4751, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.4111, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (6, tensor(0.4111, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.4873, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (7, tensor(0.4873, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.5541, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (8, tensor(0.5541, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.5497, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (9, tensor(0.5497, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.5540, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (10, tensor(0.5540, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.5540, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (11, tensor(0.5540, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.5340, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (12, tensor(0.5340, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.5662, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (13, tensor(0.5662, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.5759, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (14, tensor(0.5759, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.5823, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (15, tensor(0.5823, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.5808, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (16, tensor(0.5808, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.5683, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (17, tensor(0.5683, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.5850, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (18, tensor(0.5850, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.5879, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (19, tensor(0.5879, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.5825, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (20, tensor(0.5825, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.5820, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (21, tensor(0.5820, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.5806, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (22, tensor(0.5806, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.5345, dtype=torch.float64)),
[2024-11-30 05:37:29,555][flwr][INFO] - 	                       (23, tensor(0.5345, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.5921, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (24, tensor(0.5921, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.5766, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (25, tensor(0.5766, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.5820, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (26, tensor(0.5820, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.5850, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (27, tensor(0.5850, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.5764, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (28, tensor(0.5764, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.5795, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (29, tensor(0.5795, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.5823, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (30, tensor(0.5823, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.5846, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (31, tensor(0.5846, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.5819, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (32, tensor(0.5819, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.5867, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (33, tensor(0.5867, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.5876, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (34, tensor(0.5876, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.5844, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (35, tensor(0.5844, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.5926, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (36, tensor(0.5926, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.5886, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (37, tensor(0.5886, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.5858, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (38, tensor(0.5858, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.5858, dtype=torch.float64)),
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (39, tensor(0.5858, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.5901, dtype=torch.float64))],
[2024-11-30 05:37:29,556][flwr][INFO] - 	                       (40, tensor(0.5901, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 0.04766415833322114),
[2024-11-30 05:37:29,556][flwr][INFO] - 	 'ind_iou_0': [(0, 0.04766415833322114),
[92mINFO [0m:      	               (1, 0.6316875723875005),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (1, 0.6316875723875005),
[92mINFO [0m:      	               (2, 0.7536420464594646),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (2, 0.7536420464594646),
[92mINFO [0m:      	               (3, 0.7820151522242209),
[2024-11-30 05:37:29,556][flwr][INFO] - 	               (3, 0.7820151522242209),
[92mINFO [0m:      	               (4, 0.7452841414649035),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (4, 0.7452841414649035),
[92mINFO [0m:      	               (5, 0.7720739542713111),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (5, 0.7720739542713111),
[92mINFO [0m:      	               (6, 0.7108457075431956),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (6, 0.7108457075431956),
[92mINFO [0m:      	               (7, 0.7999996553181479),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (7, 0.7999996553181479),
[92mINFO [0m:      	               (8, 0.7929387574260767),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (8, 0.7929387574260767),
[92mINFO [0m:      	               (9, 0.7895828309521433),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (9, 0.7895828309521433),
[92mINFO [0m:      	               (10, 0.7930287733831317),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (10, 0.7930287733831317),
[92mINFO [0m:      	               (11, 0.7778061268448617),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (11, 0.7778061268448617),
[92mINFO [0m:      	               (12, 0.7561715069928102),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (12, 0.7561715069928102),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (13, 0.7836245416784494),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (14, 0.7826007748222609),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (15, 0.7925253756492625),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (16, 0.794770611049503),
[2024-11-30 05:37:29,557][flwr][INFO] - 	               (17, 0.7917326566061946),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (18, 0.7958701546502802),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (19, 0.7907357953627282),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (20, 0.7751670209418916),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (21, 0.7885281167213914),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (22, 0.794820627088442),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (23, 0.7748129285735644),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (24, 0.8003105445286044),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (25, 0.799241978213032),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (26, 0.7994760698614096),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (27, 0.7950781061937892),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (28, 0.7817250958420316),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (29, 0.7935916451200561),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (30, 0.794403298223325),
[2024-11-30 05:37:29,558][flwr][INFO] - 	               (31, 0.7931324133784465),
[92mINFO [0m:      	               (13, 0.7836245416784494),
[92mINFO [0m:      	               (14, 0.7826007748222609),
[92mINFO [0m:      	               (15, 0.7925253756492625),
[92mINFO [0m:      	               (16, 0.794770611049503),
[92mINFO [0m:      	               (17, 0.7917326566061946),
[92mINFO [0m:      	               (18, 0.7958701546502802),
[92mINFO [0m:      	               (19, 0.7907357953627282),
[92mINFO [0m:      	               (20, 0.7751670209418916),
[92mINFO [0m:      	               (21, 0.7885281167213914),
[92mINFO [0m:      	               (22, 0.794820627088442),
[92mINFO [0m:      	               (23, 0.7748129285735644),
[92mINFO [0m:      	               (24, 0.8003105445286044),
[92mINFO [0m:      	               (25, 0.799241978213032),
[92mINFO [0m:      	               (26, 0.7994760698614096),
[92mINFO [0m:      	               (27, 0.7950781061937892),
[92mINFO [0m:      	               (28, 0.7817250958420316),
[92mINFO [0m:      	               (29, 0.7935916451200561),
[92mINFO [0m:      	               (30, 0.794403298223325),
[92mINFO [0m:      	               (31, 0.7931324133784465),
[92mINFO [0m:      	               (32, 0.7950077196435238),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (32, 0.7950077196435238),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (33, 0.7991970050149196),
[92mINFO [0m:      	               (33, 0.7991970050149196),
[92mINFO [0m:      	               (34, 0.7969106231438474),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (34, 0.7969106231438474),
[92mINFO [0m:      	               (35, 0.7953932442769412),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (35, 0.7953932442769412),
[92mINFO [0m:      	               (36, 0.7938275326122274),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (36, 0.7938275326122274),
[92mINFO [0m:      	               (37, 0.7938397296356953),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (37, 0.7938397296356953),
[92mINFO [0m:      	               (38, 0.7931336049239085),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (38, 0.7931336049239085),
[92mINFO [0m:      	               (39, 0.7940132921480715),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (39, 0.7940132921480715),
[92mINFO [0m:      	               (40, 0.7820696327087762)],
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (40, 0.7820696327087762)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 0.04694000668968212),
[2024-11-30 05:37:29,559][flwr][INFO] - 	 'ind_iou_1': [(0, 0.04694000668968212),
[92mINFO [0m:      	               (1, 0.8362033455466258),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (1, 0.8362033455466258),
[92mINFO [0m:      	               (2, 0.9295314235185855),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (2, 0.9295314235185855),
[92mINFO [0m:      	               (3, 0.9447122111257642),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (3, 0.9447122111257642),
[92mINFO [0m:      	               (4, 0.9479294328973502),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (4, 0.9479294328973502),
[92mINFO [0m:      	               (5, 0.9514002418093063),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (5, 0.9514002418093063),
[92mINFO [0m:      	               (6, 0.9380788168094929),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (6, 0.9380788168094929),
[92mINFO [0m:      	               (7, 0.9566744201094628),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (7, 0.9566744201094628),
[92mINFO [0m:      	               (8, 0.9635342443527264),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (8, 0.9635342443527264),
[92mINFO [0m:      	               (9, 0.9633393220798547),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (9, 0.9633393220798547),
[92mINFO [0m:      	               (10, 0.9650760878658963),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (10, 0.9650760878658963),
[92mINFO [0m:      	               (11, 0.9669066646043755),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (11, 0.9669066646043755),
[92mINFO [0m:      	               (12, 0.9513818242415281),
[2024-11-30 05:37:29,559][flwr][INFO] - 	               (12, 0.9513818242415281),
[92mINFO [0m:      	               (13, 0.9697805119168175),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (13, 0.9697805119168175),
[92mINFO [0m:      	               (14, 0.9702681002816052),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (14, 0.9702681002816052),
[92mINFO [0m:      	               (15, 0.9715224074084938),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (15, 0.9715224074084938),
[92mINFO [0m:      	               (16, 0.9700779992206202),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (16, 0.9700779992206202),
[92mINFO [0m:      	               (17, 0.9706330449831999),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (17, 0.9706330449831999),
[92mINFO [0m:      	               (18, 0.9721577140487381),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (18, 0.9721577140487381),
[92mINFO [0m:      	               (19, 0.9726733307368213),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (19, 0.9726733307368213),
[92mINFO [0m:      	               (20, 0.9726740116184747),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (20, 0.9726740116184747),
[92mINFO [0m:      	               (21, 0.972346415571436),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (21, 0.972346415571436),
[92mINFO [0m:      	               (22, 0.9726798593246316),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (22, 0.9726798593246316),
[92mINFO [0m:      	               (23, 0.9660274418780755),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (23, 0.9660274418780755),
[92mINFO [0m:      	               (24, 0.9732658740725458),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (24, 0.9732658740725458),
[92mINFO [0m:      	               (25, 0.973483713650208),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (25, 0.973483713650208),
[92mINFO [0m:      	               (26, 0.974029525142851),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (26, 0.974029525142851),
[92mINFO [0m:      	               (27, 0.9732923978943294),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (27, 0.9732923978943294),
[92mINFO [0m:      	               (28, 0.9729190181656941),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (28, 0.9729190181656941),
[92mINFO [0m:      	               (29, 0.9736055323068126),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (29, 0.9736055323068126),
[92mINFO [0m:      	               (30, 0.973732716093236),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (30, 0.973732716093236),
[92mINFO [0m:      	               (31, 0.9741346940386385),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (31, 0.9741346940386385),
[92mINFO [0m:      	               (32, 0.9741582306300837),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (32, 0.9741582306300837),
[92mINFO [0m:      	               (33, 0.9737154709765082),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (33, 0.9737154709765082),
[92mINFO [0m:      	               (34, 0.974259399170424),
[2024-11-30 05:37:29,560][flwr][INFO] - 	               (34, 0.974259399170424),
[92mINFO [0m:      	               (35, 0.9742189859794027),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (35, 0.9742189859794027),
[92mINFO [0m:      	               (36, 0.9742970206234295),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (36, 0.9742970206234295),
[92mINFO [0m:      	               (37, 0.9748234992278885),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (37, 0.9748234992278885),
[92mINFO [0m:      	               (38, 0.9745480935375148),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (38, 0.9745480935375148),
[92mINFO [0m:      	               (39, 0.9745763808735843),
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (39, 0.9745763808735843),
[92mINFO [0m:      	               (40, 0.9745350741360002)]}
[2024-11-30 05:37:29,561][flwr][INFO] - 	               (40, 0.9745350741360002)]}
[92mINFO [0m:      
[2024-11-30 05:37:29,561][flwr][INFO] - 
