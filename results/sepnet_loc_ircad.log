/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.sepnet.U_net
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 1658
3 3791
3 414
3 4205
cuda:0
[2024-11-28 14:44:38,951][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-11-28 14:44:42,424	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'memory': 851385838592.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.11': 1.0, 'object_store_memory': 200000000000.0}
[2024-11-28 14:45:03,038][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 3.0, 'memory': 851385838592.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.11': 1.0, 'object_store_memory': 200000000000.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-28 14:45:03,038][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-28 14:45:03,038][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-28 14:45:03,067][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-11-28 14:45:03,068][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-11-28 14:45:03,068][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-11-28 14:45:06,534][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-11-28 14:45:06,534][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.715662351530599, OrderedDict([('ind_iou_0', 0.055350935347940645), ('ind_dice_liver_0', tensor(0.1616, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0084, dtype=torch.float64)), ('ind_iou_1', 0.0544219739757796), ('ind_dice_liver_1', tensor(0.1601, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0075, dtype=torch.float64)), ('all_iou', 0.0552537034326727), ('all_dice_liver', tensor(0.1615, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0083, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-11-28 14:50:50,900][flwr][INFO] - initial parameters (loss, other metrics): 0.715662351530599, OrderedDict([('ind_iou_0', 0.055350935347940645), ('ind_dice_liver_0', tensor(0.1616, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0084, dtype=torch.float64)), ('ind_iou_1', 0.0544219739757796), ('ind_dice_liver_1', tensor(0.1601, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0075, dtype=torch.float64)), ('all_iou', 0.0552537034326727), ('all_dice_liver', tensor(0.1615, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0083, dtype=torch.float64))])
[92mINFO [0m:      
[2024-11-28 14:50:51,014][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-11-28 14:50:51,014][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 14:50:51,014][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.7733711814947427
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.8250, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.0169, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.706460887189619
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8169, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.0191, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.8952909397213925
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9441, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.0270, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7130433462995375
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8307, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.0442, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.922225839877096
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9583, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.2310, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7133934501080328
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8305, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1324, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:00:58,339][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-11-28 15:00:58,360][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.07443603277527566, OrderedDict([('ind_iou_0', 0.712552454365834), ('ind_dice_liver_0', tensor(0.8323, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1462, dtype=torch.float64)), ('ind_iou_1', 0.9363470532395185), ('ind_dice_liver_1', tensor(0.9629, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4041, dtype=torch.float64)), ('all_iou', 0.7347268002805437), ('all_dice_liver', tensor(0.8452, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1745, dtype=torch.float64))]), 763.9130717804655)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9451792013778904
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9664, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.3996, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.712552454365834
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8323, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1462, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 15:03:34,927][flwr][INFO] - fit progress: (1, 0.07443603277527566, OrderedDict([('ind_iou_0', 0.712552454365834), ('ind_dice_liver_0', tensor(0.8323, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1462, dtype=torch.float64)), ('ind_iou_1', 0.9363470532395185), ('ind_dice_liver_1', tensor(0.9629, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4041, dtype=torch.float64)), ('all_iou', 0.7347268002805437), ('all_dice_liver', tensor(0.8452, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1745, dtype=torch.float64))]), 763.9130717804655)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:03:34,930][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:04:48,802][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:04:48,802][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:04:48,803][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 15:04:48,803][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-11-28 15:04:48,803][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:04:48,803][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.949142454800667
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9680, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.4733, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7437486714391167
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8538, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1729, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9523701862505862
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9700, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.4884, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.766902352695162
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8721, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1986, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9566931343719199
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9722, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5155, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7496473391449623
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8609, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1250, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9625894954078271
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9762, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  
[36m(ClientAppActor pid=2099841)[0m tensor(0.5191, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7579797242080624
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8676, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1842, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 15:14:47,723][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.06621678943594078, OrderedDict([('ind_iou_0', 0.7579797242080624), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1842, dtype=torch.float64)), ('ind_iou_1', 0.9558406180921017), ('ind_dice_liver_1', tensor(0.9741, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4880, dtype=torch.float64)), ('all_iou', 0.7774996329864332), ('all_dice_liver', tensor(0.8781, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2180, dtype=torch.float64))]), 1594.9255293365568)
Entrei no test
Meio do test
Fim do test
[2024-11-28 15:17:25,939][flwr][INFO] - fit progress: (2, 0.06621678943594078, OrderedDict([('ind_iou_0', 0.7579797242080624), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1842, dtype=torch.float64)), ('ind_iou_1', 0.9558406180921017), ('ind_dice_liver_1', tensor(0.9741, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4880, dtype=torch.float64)), ('all_iou', 0.7774996329864332), ('all_dice_liver', tensor(0.8781, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2180, dtype=torch.float64))]), 1594.9255293365568)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:17:25,943][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:18:40,218][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:18:40,219][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:18:40,219][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 15:18:40,219][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-11-28 15:18:40,219][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:18:40,219][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9603522687819596
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9746, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5293, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7453256594482156
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8584, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1905, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9691282188782003
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9803, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5477, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7488753187527438
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8608, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  
[36m(ClientAppActor pid=2099841)[0m tensor(0.1945, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9559388820503302
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9738, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.4708, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7620913761824698
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8698, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2337, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9710196270145525
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5806, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7643732397895705
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8726, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2168, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 15:28:40,483][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.06865566397245251, OrderedDict([('ind_iou_0', 0.7643732397895705), ('ind_dice_liver_0', tensor(0.8726, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2168, dtype=torch.float64)), ('ind_iou_1', 0.962627727510885), ('ind_dice_liver_1', tensor(0.9776, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5402, dtype=torch.float64)), ('all_iou', 0.7839677781051207), ('all_dice_liver', tensor(0.8830, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2521, dtype=torch.float64))]), 2425.107115917839)
Entrei no test
Meio do test
Fim do test
[2024-11-28 15:31:16,121][flwr][INFO] - fit progress: (3, 0.06865566397245251, OrderedDict([('ind_iou_0', 0.7643732397895705), ('ind_dice_liver_0', tensor(0.8726, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2168, dtype=torch.float64)), ('ind_iou_1', 0.962627727510885), ('ind_dice_liver_1', tensor(0.9776, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5402, dtype=torch.float64)), ('all_iou', 0.7839677781051207), ('all_dice_liver', tensor(0.8830, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2521, dtype=torch.float64))]), 2425.107115917839)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:31:16,125][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:32:29,158][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 15:32:29,158][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:32:29,159][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 15:32:29,159][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-11-28 15:32:29,159][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:32:29,159][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9695944239801533
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5433, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7489433982229566
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8624, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2245, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.96687504701143
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9788, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5635, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7520194433619319
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8618, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1866, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9670130479441341
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5625, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7351302703767724
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8516, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1745, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:42:30,679][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.07220220158848907, OrderedDict([('ind_iou_0', 0.7637307008884832), ('ind_dice_liver_0', tensor(0.8717, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2065, dtype=torch.float64)), ('ind_iou_1', 0.9638895096143001), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5430, dtype=torch.float64)), ('all_iou', 0.7835131862503123), ('all_dice_liver', tensor(0.8823, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2431, dtype=torch.float64))]), 3255.861802579835)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9758188408501511
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5909, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7637307008884832
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8717, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2065, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 15:45:06,876][flwr][INFO] - fit progress: (4, 0.07220220158848907, OrderedDict([('ind_iou_0', 0.7637307008884832), ('ind_dice_liver_0', tensor(0.8717, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2065, dtype=torch.float64)), ('ind_iou_1', 0.9638895096143001), ('ind_dice_liver_1', tensor(0.9791, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5430, dtype=torch.float64)), ('all_iou', 0.7835131862503123), ('all_dice_liver', tensor(0.8823, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2431, dtype=torch.float64))]), 3255.861802579835)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:45:06,879][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:46:22,379][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 15:46:22,379][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 15:46:22,379][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 15:46:22,379][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-11-28 15:46:22,379][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 15:46:22,380][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9740959666085239
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9835, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6125, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.756036213583172
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8662, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1940, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9747105766385588
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9838, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6016, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7485026455567969
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8627, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2004, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9701426817720649
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9814, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5614, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7110813739988662
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8241, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.0701, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 15:56:20,050][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.07423258427094212, OrderedDict([('ind_iou_0', 0.758287771922533), ('ind_dice_liver_0', tensor(0.8685, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2155, dtype=torch.float64)), ('ind_iou_1', 0.9642580501099705), ('ind_dice_liver_1', tensor(0.9792, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5488, dtype=torch.float64)), ('all_iou', 0.7786731242725865), ('all_dice_liver', tensor(0.8795, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2516, dtype=torch.float64))]), 4086.59319454059)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9668231363336132
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9792, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5333, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.758287771922533
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8685, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2155, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 15:58:57,607][flwr][INFO] - fit progress: (5, 0.07423258427094212, OrderedDict([('ind_iou_0', 0.758287771922533), ('ind_dice_liver_0', tensor(0.8685, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2155, dtype=torch.float64)), ('ind_iou_1', 0.9642580501099705), ('ind_dice_liver_1', tensor(0.9792, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5488, dtype=torch.float64)), ('all_iou', 0.7786731242725865), ('all_dice_liver', tensor(0.8795, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2516, dtype=torch.float64))]), 4086.59319454059)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 15:58:57,611][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:00:11,649][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:00:11,649][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:00:11,649][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 16:00:11,650][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-11-28 16:00:11,650][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:00:11,650][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9732506586847072
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9831, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5795, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7193638200948637
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8416, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.0969, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9745373893669179
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9833, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6007, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7630678636806504
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8733, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2171, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9753447322340458
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5979, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7566618351523675
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8686, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1756, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9798607015275148
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6141, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7662208933661147
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8750, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2234, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 16:10:11,694][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.08224540647948725, OrderedDict([('ind_iou_0', 0.7662208933661147), ('ind_dice_liver_0', tensor(0.8750, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2234, dtype=torch.float64)), ('ind_iou_1', 0.9664889241229515), ('ind_dice_liver_1', tensor(0.9815, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5675, dtype=torch.float64)), ('all_iou', 0.7860492738157198), ('all_dice_liver', tensor(0.8855, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2607, dtype=torch.float64))]), 4918.856065923348)
Entrei no test
Meio do test
Fim do test
[2024-11-28 16:12:49,870][flwr][INFO] - fit progress: (6, 0.08224540647948725, OrderedDict([('ind_iou_0', 0.7662208933661147), ('ind_dice_liver_0', tensor(0.8750, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2234, dtype=torch.float64)), ('ind_iou_1', 0.9664889241229515), ('ind_dice_liver_1', tensor(0.9815, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5675, dtype=torch.float64)), ('all_iou', 0.7860492738157198), ('all_dice_liver', tensor(0.8855, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2607, dtype=torch.float64))]), 4918.856065923348)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:12:49,873][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:14:03,067][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:14:03,067][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:14:03,068][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 16:14:03,068][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-11-28 16:14:03,068][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:14:03,068][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9793455267911514
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6088, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7697579054260619
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8776, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2160, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9792609010938812
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6162, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7856378315391662
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8879, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2384, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9806858541610158
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6101, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7566357341911623
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8690, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2061, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:24:06,485][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0923315126133261, OrderedDict([('ind_iou_0', 0.6996046718008183), ('ind_dice_liver_0', tensor(0.8284, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1512, dtype=torch.float64)), ('ind_iou_1', 0.9415039251310271), ('ind_dice_liver_1', tensor(0.9648, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5380, dtype=torch.float64)), ('all_iou', 0.7236299974434878), ('all_dice_liver', tensor(0.8419, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1928, dtype=torch.float64))]), 5751.669715480879)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.980451134121487
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6277, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.6996046718008183
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8284, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1512, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 16:26:42,684][flwr][INFO] - fit progress: (7, 0.0923315126133261, OrderedDict([('ind_iou_0', 0.6996046718008183), ('ind_dice_liver_0', tensor(0.8284, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1512, dtype=torch.float64)), ('ind_iou_1', 0.9415039251310271), ('ind_dice_liver_1', tensor(0.9648, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5380, dtype=torch.float64)), ('all_iou', 0.7236299974434878), ('all_dice_liver', tensor(0.8419, dtype=torch.float64)), ('all_dice_tumour', tensor(0.1928, dtype=torch.float64))]), 5751.669715480879)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:26:42,687][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:27:56,521][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 16:27:56,521][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:27:56,522][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 16:27:56,522][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-11-28 16:27:56,522][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:27:56,522][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9811492266753198
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6004, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7650065260910598
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8746, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2240, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9839567089522182
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6356, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7670449863859431
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8773, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2279, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9838099902456002
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6550, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.758140674696038
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8701, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2207, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9842021574978045
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6302, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7613247276423324
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8729, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2251, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 16:37:57,956][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.0907434412464278, OrderedDict([('ind_iou_0', 0.7613247276423324), ('ind_dice_liver_0', tensor(0.8729, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2251, dtype=torch.float64)), ('ind_iou_1', 0.9677161197452596), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5615, dtype=torch.float64)), ('all_iou', 0.7817302678896291), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2617, dtype=torch.float64))]), 6584.009546761401)
Entrei no test
Meio do test
Fim do test
[2024-11-28 16:40:35,023][flwr][INFO] - fit progress: (8, 0.0907434412464278, OrderedDict([('ind_iou_0', 0.7613247276423324), ('ind_dice_liver_0', tensor(0.8729, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2251, dtype=torch.float64)), ('ind_iou_1', 0.9677161197452596), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5615, dtype=torch.float64)), ('all_iou', 0.7817302678896291), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2617, dtype=torch.float64))]), 6584.009546761401)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:40:35,027][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:41:47,690][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:41:47,691][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:41:47,691][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 16:41:47,691][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-11-28 16:41:47,691][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:41:47,691][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9840639265710852
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6439, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7598774831268083
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8720, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2322, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9830271539085714
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6204, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7216071096664858
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8445, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.0797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9694054139043022
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5610, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7700195987467486
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8778, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2397, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9850430875307374
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6351, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7732596355094269
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8812, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2463, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 16:51:47,220][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.07856722062472453, OrderedDict([('ind_iou_0', 0.7732596355094269), ('ind_dice_liver_0', tensor(0.8812, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2463, dtype=torch.float64)), ('ind_iou_1', 0.9685413997652824), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5695, dtype=torch.float64)), ('all_iou', 0.7925540655485465), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2813, dtype=torch.float64))]), 7413.522378798574)
Entrei no test
Meio do test
Fim do test
[2024-11-28 16:54:24,536][flwr][INFO] - fit progress: (9, 0.07856722062472453, OrderedDict([('ind_iou_0', 0.7732596355094269), ('ind_dice_liver_0', tensor(0.8812, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2463, dtype=torch.float64)), ('ind_iou_1', 0.9685413997652824), ('ind_dice_liver_1', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5695, dtype=torch.float64)), ('all_iou', 0.7925540655485465), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2813, dtype=torch.float64))]), 7413.522378798574)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 16:54:24,540][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 16:55:38,519][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 16:55:38,519][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 16:55:38,519][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 16:55:38,520][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-11-28 16:55:38,520][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 16:55:38,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9841204781219285
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6350, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7766944196416216
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8837, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2405, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9840079270280897
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6124, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7729930325268222
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8815, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2443, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9849527566409831
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6348, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7713035391432932
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8793, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2181, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:05:41,219][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.07680942672387864, OrderedDict([('ind_iou_0', 0.7564357428331301), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2210, dtype=torch.float64)), ('ind_iou_1', 0.9636035958188761), ('ind_dice_liver_1', tensor(0.9803, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5423, dtype=torch.float64)), ('all_iou', 0.7769691511570678), ('all_dice_liver', tensor(0.8788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2568, dtype=torch.float64))]), 8245.991883210838)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9760801070371329
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5808, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7564357428331301
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8676, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2210, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 17:08:17,006][flwr][INFO] - fit progress: (10, 0.07680942672387864, OrderedDict([('ind_iou_0', 0.7564357428331301), ('ind_dice_liver_0', tensor(0.8676, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2210, dtype=torch.float64)), ('ind_iou_1', 0.9636035958188761), ('ind_dice_liver_1', tensor(0.9803, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5423, dtype=torch.float64)), ('all_iou', 0.7769691511570678), ('all_dice_liver', tensor(0.8788, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2568, dtype=torch.float64))]), 8245.991883210838)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:08:17,009][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:09:30,744][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:09:30,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:09:30,745][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 17:09:30,745][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-11-28 17:09:30,745][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:09:30,745][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9813669172606938
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6327, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7590811255263131
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8710, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2271, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9859743209862323
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6411, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7565853301872894
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8700, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2169, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9873344101489617
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6464, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7581442142514436
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8706, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2198, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.987349726802537
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6552, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7571424297913529
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8703, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2043, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 17:19:32,020][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.09875393717690381, OrderedDict([('ind_iou_0', 0.7571424297913529), ('ind_dice_liver_0', tensor(0.8703, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2043, dtype=torch.float64)), ('ind_iou_1', 0.968959024391846), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.7780622947412319), ('all_dice_liver', tensor(0.8815, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2446, dtype=torch.float64))]), 9077.059656611644)
Entrei no test
Meio do test
Fim do test
[2024-11-28 17:22:08,074][flwr][INFO] - fit progress: (11, 0.09875393717690381, OrderedDict([('ind_iou_0', 0.7571424297913529), ('ind_dice_liver_0', tensor(0.8703, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2043, dtype=torch.float64)), ('ind_iou_1', 0.968959024391846), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5759, dtype=torch.float64)), ('all_iou', 0.7780622947412319), ('all_dice_liver', tensor(0.8815, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2446, dtype=torch.float64))]), 9077.059656611644)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:22:08,077][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:23:22,336][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:23:22,336][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:23:22,336][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 17:23:22,336][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-11-28 17:23:22,336][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:23:22,336][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9863989000849166
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6313, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7690845794728352
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8781, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2319, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9868454797567704
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6462, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7556662991212808
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8702, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2451, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9834731420900693
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6475, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7528091512404343
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8652, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2073, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:33:20,853][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.09895184948601883, OrderedDict([('ind_iou_0', 0.7605632316312407), ('ind_dice_liver_0', tensor(0.8727, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2069, dtype=torch.float64)), ('ind_iou_1', 0.968552975884231), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5614, dtype=torch.float64)), ('all_iou', 0.7811500604052574), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2455, dtype=torch.float64))]), 9906.853962482885)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9852351138453164
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6453, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7605632316312407
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8727, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2069, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 17:35:57,868][flwr][INFO] - fit progress: (12, 0.09895184948601883, OrderedDict([('ind_iou_0', 0.7605632316312407), ('ind_dice_liver_0', tensor(0.8727, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2069, dtype=torch.float64)), ('ind_iou_1', 0.968552975884231), ('ind_dice_liver_1', tensor(0.9838, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5614, dtype=torch.float64)), ('all_iou', 0.7811500604052574), ('all_dice_liver', tensor(0.8837, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2455, dtype=torch.float64))]), 9906.853962482885)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:35:57,871][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:37:10,549][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:37:10,549][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:37:10,549][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 17:37:10,550][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-11-28 17:37:10,550][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:37:10,550][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9868703794660024
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6499, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.760571106237427
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8731, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1575, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9865654905585849
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6435, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7471520236671068
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8626, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2326, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9750201969123755
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5668, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7541790523202563
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8667, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2237, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9872188070928819
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6524, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7744203668029485
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8820, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2102, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 17:47:11,551][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.0916708467039861, OrderedDict([('ind_iou_0', 0.7744203668029485), ('ind_dice_liver_0', tensor(0.8820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2102, dtype=torch.float64)), ('ind_iou_1', 0.9693645472229383), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5794, dtype=torch.float64)), ('all_iou', 0.7937431357837128), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2503, dtype=torch.float64))]), 10736.148427525535)
Entrei no test
Meio do test
Fim do test
[2024-11-28 17:49:47,162][flwr][INFO] - fit progress: (13, 0.0916708467039861, OrderedDict([('ind_iou_0', 0.7744203668029485), ('ind_dice_liver_0', tensor(0.8820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2102, dtype=torch.float64)), ('ind_iou_1', 0.9693645472229383), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5794, dtype=torch.float64)), ('all_iou', 0.7937431357837128), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2503, dtype=torch.float64))]), 10736.148427525535)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 17:49:47,166][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 17:51:00,565][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 17:51:00,566][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 17:51:00,566][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 17:51:00,566][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-11-28 17:51:00,566][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 17:51:00,566][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9868323876486615
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6450, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7727389830121076
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8811, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2202, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9866915975164823
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6339, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7795588535794312
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8864, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2027, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9880656790144212
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6493, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7587613942526328
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8840, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1757, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9784659774223771
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.5923, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7565210455645685
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8684, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2326, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 18:01:00,232][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.09412276032425056, OrderedDict([('ind_iou_0', 0.7565210455645685), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2326, dtype=torch.float64)), ('ind_iou_1', 0.9676086916927787), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5833, dtype=torch.float64)), ('all_iou', 0.777421477216883), ('all_dice_liver', tensor(0.8797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2708, dtype=torch.float64))]), 11564.533236309886)
Entrei no test
Meio do test
Fim do test
[2024-11-28 18:03:35,547][flwr][INFO] - fit progress: (14, 0.09412276032425056, OrderedDict([('ind_iou_0', 0.7565210455645685), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2326, dtype=torch.float64)), ('ind_iou_1', 0.9676086916927787), ('ind_dice_liver_1', tensor(0.9829, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5833, dtype=torch.float64)), ('all_iou', 0.777421477216883), ('all_dice_liver', tensor(0.8797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2708, dtype=torch.float64))]), 11564.533236309886)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:03:35,551][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 18:04:48,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:04:48,517][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:04:48,518][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 18:04:48,518][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-11-28 18:04:48,518][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:04:48,518][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9864213866528959
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6471, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7631741346871133
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8736, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2395, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9880668252466699
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6313, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7669369969724282
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8768, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2213, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9889975830433001
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6367, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7640729379405377
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8747, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2232, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 18:14:47,982][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.0956628250950387, OrderedDict([('ind_iou_0', 0.770708533190624), ('ind_dice_liver_0', tensor(0.8792, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2278, dtype=torch.float64)), ('ind_iou_1', 0.9694128355500067), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5881, dtype=torch.float64)), ('all_iou', 0.790384034811225), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 12392.442374197766)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9894004569809173
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6421, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.770708533190624
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8792, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2278, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 18:17:23,456][flwr][INFO] - fit progress: (15, 0.0956628250950387, OrderedDict([('ind_iou_0', 0.770708533190624), ('ind_dice_liver_0', tensor(0.8792, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2278, dtype=torch.float64)), ('ind_iou_1', 0.9694128355500067), ('ind_dice_liver_1', tensor(0.9843, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5881, dtype=torch.float64)), ('all_iou', 0.790384034811225), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 12392.442374197766)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:17:23,460][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 18:18:36,534][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:18:36,534][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:18:36,534][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 18:18:36,535][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-11-28 18:18:36,535][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:18:36,535][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9894451800564311
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6410, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7554628942129743
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8692, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2218, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9890743457138338
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6418, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7672810867378806
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8776, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2391, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9894909410962369
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6560, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.763259655896828
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8748, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2136, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9900141463192056
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6750, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7684722004336086
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8787, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2075, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 18:28:38,398][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.1082670263277741, OrderedDict([('ind_iou_0', 0.7684722004336086), ('ind_dice_liver_0', tensor(0.8787, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2075, dtype=torch.float64)), ('ind_iou_1', 0.9698940083572806), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5697, dtype=torch.float64)), ('all_iou', 0.7883912432417878), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2470, dtype=torch.float64))]), 13222.509861147031)
Entrei no test
Meio do test
Fim do test
[2024-11-28 18:31:13,524][flwr][INFO] - fit progress: (16, 0.1082670263277741, OrderedDict([('ind_iou_0', 0.7684722004336086), ('ind_dice_liver_0', tensor(0.8787, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2075, dtype=torch.float64)), ('ind_iou_1', 0.9698940083572806), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5697, dtype=torch.float64)), ('all_iou', 0.7883912432417878), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2470, dtype=torch.float64))]), 13222.509861147031)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:31:13,528][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 18:32:26,332][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:32:26,332][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:32:26,332][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 18:32:26,333][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-11-28 18:32:26,333][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:32:26,333][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9902835229614209
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6933, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7595990846607188
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8725, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2096, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9876236326907358
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6599, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7605386067574536
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8729, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1968, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9877104810025347
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6441, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7726532973508854
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8811, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2232, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9915696556564387
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6570, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7771052388513635
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8843, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2236, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 18:42:26,555][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.1055956416061828, OrderedDict([('ind_iou_0', 0.7771052388513635), ('ind_dice_liver_0', tensor(0.8843, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2236, dtype=torch.float64)), ('ind_iou_1', 0.9708628761125967), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5834, dtype=torch.float64)), ('all_iou', 0.7962606165871388), ('all_dice_liver', tensor(0.8943, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2631, dtype=torch.float64))]), 14051.14952831529)
Entrei no test
Meio do test
Fim do test
[2024-11-28 18:45:02,163][flwr][INFO] - fit progress: (17, 0.1055956416061828, OrderedDict([('ind_iou_0', 0.7771052388513635), ('ind_dice_liver_0', tensor(0.8843, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2236, dtype=torch.float64)), ('ind_iou_1', 0.9708628761125967), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5834, dtype=torch.float64)), ('all_iou', 0.7962606165871388), ('all_dice_liver', tensor(0.8943, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2631, dtype=torch.float64))]), 14051.14952831529)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:45:02,167][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 18:46:15,471][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 18:46:15,471][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 18:46:15,472][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 18:46:15,472][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-11-28 18:46:15,472][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 18:46:15,472][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9909750817783706
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6544, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7697973136820733
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8798, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1804, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9900516866432908
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6658, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7781983893459734
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8855, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1968, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9851883197549355
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6478, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7538537314353232
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8684, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1913, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9895959025269601
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6395, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7522642680075069
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8678, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1806, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 18:56:13,776][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.11536282600101867, OrderedDict([('ind_iou_0', 0.7522642680075069), ('ind_dice_liver_0', tensor(0.8678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1806, dtype=torch.float64)), ('ind_iou_1', 0.9695829823694017), ('ind_dice_liver_1', tensor(0.9849, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5710, dtype=torch.float64)), ('all_iou', 0.7737839785962827), ('all_dice_liver', tensor(0.8794, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2232, dtype=torch.float64))]), 14878.358792735264)
Entrei no test
Meio do test
Fim do test
[2024-11-28 18:58:49,373][flwr][INFO] - fit progress: (18, 0.11536282600101867, OrderedDict([('ind_iou_0', 0.7522642680075069), ('ind_dice_liver_0', tensor(0.8678, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1806, dtype=torch.float64)), ('ind_iou_1', 0.9695829823694017), ('ind_dice_liver_1', tensor(0.9849, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5710, dtype=torch.float64)), ('all_iou', 0.7737839785962827), ('all_dice_liver', tensor(0.8794, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2232, dtype=torch.float64))]), 14878.358792735264)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 18:58:49,376][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:00:02,819][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:00:02,820][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:00:02,822][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 19:00:02,823][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-11-28 19:00:02,823][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:00:02,824][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9904662808907677
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6425, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7630458242746422
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8754, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2103, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9852483855065309
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6076, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7623444189588925
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8731, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2308, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9910464410782075
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6463, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.754923725035957
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8688, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1892, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9924466272873763
[36m(ClientAppActor pid=2099841)[0m train dice liver:  
[36m(ClientAppActor pid=2099841)[0m tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6639, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7654243613263407
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8766, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2004, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 19:10:04,396][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.11725688536256092, OrderedDict([('ind_iou_0', 0.7654243613263407), ('ind_dice_liver_0', tensor(0.8766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2004, dtype=torch.float64)), ('ind_iou_1', 0.9704836987993137), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5809, dtype=torch.float64)), ('all_iou', 0.7857084723258861), ('all_dice_liver', tensor(0.8874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 15709.32337746676)
Entrei no test
Meio do test
Fim do test
[2024-11-28 19:12:40,337][flwr][INFO] - fit progress: (19, 0.11725688536256092, OrderedDict([('ind_iou_0', 0.7654243613263407), ('ind_dice_liver_0', tensor(0.8766, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2004, dtype=torch.float64)), ('ind_iou_1', 0.9704836987993137), ('ind_dice_liver_1', tensor(0.9856, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5809, dtype=torch.float64)), ('all_iou', 0.7857084723258861), ('all_dice_liver', tensor(0.8874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 15709.32337746676)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:12:40,341][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:13:53,893][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:13:53,893][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:13:53,894][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:13:53,894][flwr][INFO] - 
[2024-11-28 19:13:53,894][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:13:53,894][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9915285203725542
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6551, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7656442514150117
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8767, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2032, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9904926453621685
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6731, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7718731842817413
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8806, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2214, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9915400042812885
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6773, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7647401266781482
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8758, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2157, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9917017336908186
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6753, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7670865709172475
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8779, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2030, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 19:23:55,631][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.10818198132323152, OrderedDict([('ind_iou_0', 0.7670865709172475), ('ind_dice_liver_0', tensor(0.8779, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2030, dtype=torch.float64)), ('ind_iou_1', 0.9702928639021118), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5904, dtype=torch.float64)), ('all_iou', 0.7871855795761015), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2449, dtype=torch.float64))]), 16540.682569286786)
Entrei no test
Meio do test
Fim do test
[2024-11-28 19:26:31,696][flwr][INFO] - fit progress: (20, 0.10818198132323152, OrderedDict([('ind_iou_0', 0.7670865709172475), ('ind_dice_liver_0', tensor(0.8779, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2030, dtype=torch.float64)), ('ind_iou_1', 0.9702928639021118), ('ind_dice_liver_1', tensor(0.9853, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5904, dtype=torch.float64)), ('all_iou', 0.7871855795761015), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2449, dtype=torch.float64))]), 16540.682569286786)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:26:31,700][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:27:44,553][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:27:44,553][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:27:44,553][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 19:27:44,553][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-11-28 19:27:44,553][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:27:44,554][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.99181970796988
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6822, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7696625395224167
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2024, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9916839640790346
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6574, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7661482868426226
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8761, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2401, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9919141741112547
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6666, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7680675082578118
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8782, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2084, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:37:44,170][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.09548499851092236, OrderedDict([('ind_iou_0', 0.7463972191302203), ('ind_dice_liver_0', tensor(0.8623, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1907, dtype=torch.float64)), ('ind_iou_1', 0.9699164123215347), ('ind_dice_liver_1', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5689, dtype=torch.float64)), ('all_iou', 0.7684518888134513), ('all_dice_liver', tensor(0.8743, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2317, dtype=torch.float64))]), 17369.2336540604)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9837573169834269
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6207, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7463972191302203
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8623, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1907, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 19:40:20,248][flwr][INFO] - fit progress: (21, 0.09548499851092236, OrderedDict([('ind_iou_0', 0.7463972191302203), ('ind_dice_liver_0', tensor(0.8623, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1907, dtype=torch.float64)), ('ind_iou_1', 0.9699164123215347), ('ind_dice_liver_1', tensor(0.9845, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5689, dtype=torch.float64)), ('all_iou', 0.7684518888134513), ('all_dice_liver', tensor(0.8743, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2317, dtype=torch.float64))]), 17369.2336540604)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:40:20,251][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:41:33,639][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:41:33,640][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:41:33,640][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 19:41:33,640][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-11-28 19:41:33,640][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:41:33,640][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9901750909928653
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6695, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7600311639697342
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8726, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2089, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9919835234310033
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6550, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7636385016782901
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8752, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2075, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.991884653568686
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6448, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7635787311640235
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8746, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1990, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:51:34,802][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.11363655565966554, OrderedDict([('ind_iou_0', 0.769198741560112), ('ind_dice_liver_0', tensor(0.8791, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2152, dtype=torch.float64)), ('ind_iou_1', 0.9710813877522105), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5847, dtype=torch.float64)), ('all_iou', 0.789136069427251), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2553, dtype=torch.float64))]), 18200.036591612734)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9920874432704779
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6589, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.769198741560112
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8791, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2152, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 19:54:11,050][flwr][INFO] - fit progress: (22, 0.11363655565966554, OrderedDict([('ind_iou_0', 0.769198741560112), ('ind_dice_liver_0', tensor(0.8791, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2152, dtype=torch.float64)), ('ind_iou_1', 0.9710813877522105), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5847, dtype=torch.float64)), ('all_iou', 0.789136069427251), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2553, dtype=torch.float64))]), 18200.036591612734)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 19:54:11,055][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 19:55:25,770][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 19:55:25,770][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 19:55:25,770][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 19:55:25,770][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-11-28 19:55:25,770][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 19:55:25,771][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9924267789144405
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6871, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7690965756925083
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1935, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9922564221588835
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6697, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7729978629541271
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8815, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2136, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9928339452292345
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6804, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7703191694188317
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2282, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 20:05:28,247][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.11046344046375751, OrderedDict([('ind_iou_0', 0.7715669423305815), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2220, dtype=torch.float64)), ('ind_iou_1', 0.970867874093388), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.7912430017422938), ('all_dice_liver', tensor(0.8912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2616, dtype=torch.float64))]), 19034.543136804365)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9930433301961126
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6546, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7715669423305815
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8809, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2220, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 20:08:05,557][flwr][INFO] - fit progress: (23, 0.11046344046375751, OrderedDict([('ind_iou_0', 0.7715669423305815), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2220, dtype=torch.float64)), ('ind_iou_1', 0.970867874093388), ('ind_dice_liver_1', tensor(0.9859, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5850, dtype=torch.float64)), ('all_iou', 0.7912430017422938), ('all_dice_liver', tensor(0.8912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2616, dtype=torch.float64))]), 19034.543136804365)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:08:05,561][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 20:09:19,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-28 20:09:19,917][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:09:19,917][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 20:09:19,918][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-11-28 20:09:19,918][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:09:19,918][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9930604346872803
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6766, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7709274878744945
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8804, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2313, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9931800178098134
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6803, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7695061292017497
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2285, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9933771319171475
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6665, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7636269246572952
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8758, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2305, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9934674644733069
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6487, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7742741367330938
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8822, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2339, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 20:19:21,884][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.10772077271185469, OrderedDict([('ind_iou_0', 0.7742741367330938), ('ind_dice_liver_0', tensor(0.8822, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2339, dtype=torch.float64)), ('ind_iou_1', 0.9708346582909262), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5830, dtype=torch.float64)), ('all_iou', 0.7936848174378953), ('all_dice_liver', tensor(0.8925, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2722, dtype=torch.float64))]), 19867.900271561928)
Entrei no test
Meio do test
Fim do test
[2024-11-28 20:21:58,914][flwr][INFO] - fit progress: (24, 0.10772077271185469, OrderedDict([('ind_iou_0', 0.7742741367330938), ('ind_dice_liver_0', tensor(0.8822, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2339, dtype=torch.float64)), ('ind_iou_1', 0.9708346582909262), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5830, dtype=torch.float64)), ('all_iou', 0.7936848174378953), ('all_dice_liver', tensor(0.8925, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2722, dtype=torch.float64))]), 19867.900271561928)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:21:58,918][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 20:23:11,612][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:23:11,612][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:23:11,613][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 20:23:11,613][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-11-28 20:23:11,613][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:23:11,613][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9935382064181573
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6721, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7697571551565234
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8801, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1936, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9936121807959343
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6650, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7669296857034317
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8777, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1973, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9938218300195504
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6714, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7716488183378194
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8811, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2318, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9939027551231877
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6678, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7726833734040778
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8818, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2145, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 20:33:11,292][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.11614256223262809, OrderedDict([('ind_iou_0', 0.7726833734040778), ('ind_dice_liver_0', tensor(0.8818, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2145, dtype=torch.float64)), ('ind_iou_1', 0.9709504306561927), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7922776095026193), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2550, dtype=torch.float64))]), 20697.290118445642)
Entrei no test
Meio do test
Fim do test
[2024-11-28 20:35:48,304][flwr][INFO] - fit progress: (25, 0.11614256223262809, OrderedDict([('ind_iou_0', 0.7726833734040778), ('ind_dice_liver_0', tensor(0.8818, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2145, dtype=torch.float64)), ('ind_iou_1', 0.9709504306561927), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7922776095026193), ('all_dice_liver', tensor(0.8921, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2550, dtype=torch.float64))]), 20697.290118445642)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:35:48,307][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 20:37:02,500][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:37:02,500][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:37:02,500][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 20:37:02,500][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-11-28 20:37:02,501][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:37:02,501][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9940049799380855
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6691, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7759890115025431
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8840, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2021, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9942113283715651
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6767, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7770012217446421
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8847, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2171, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9942291022528994
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6717, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.766745449725462
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8778, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2131, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9943746688648224
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6659, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.771086743552114
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8810, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2003, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 20:47:05,995][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.12841296592875695, OrderedDict([('ind_iou_0', 0.771086743552114), ('ind_dice_liver_0', tensor(0.8810, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2003, dtype=torch.float64)), ('ind_iou_1', 0.9706609580223797), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.7907984205515001), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 21530.857695921324)
Entrei no test
Meio do test
Fim do test
[2024-11-28 20:49:41,872][flwr][INFO] - fit progress: (26, 0.12841296592875695, OrderedDict([('ind_iou_0', 0.771086743552114), ('ind_dice_liver_0', tensor(0.8810, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2003, dtype=torch.float64)), ('ind_iou_1', 0.9706609580223797), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5806, dtype=torch.float64)), ('all_iou', 0.7907984205515001), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2416, dtype=torch.float64))]), 21530.857695921324)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 20:49:41,875][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 20:50:55,273][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 20:50:55,273][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 20:50:55,278][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 20:50:55,278][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-11-28 20:50:55,278][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 20:50:55,279][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9945203575615165
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6812, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7731235202332198
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8818, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2244, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9943317161289156
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6726, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7746997906561515
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8834, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2287, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9946355498839157
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6776, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7769299030033386
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8848, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2196, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:00:58,996][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.13277795339749593, OrderedDict([('ind_iou_0', 0.7669883314203613), ('ind_dice_liver_0', tensor(0.8777, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2276, dtype=torch.float64)), ('ind_iou_1', 0.9709532617555235), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5939, dtype=torch.float64)), ('all_iou', 0.787135171253952), ('all_dice_liver', tensor(0.8884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2675, dtype=torch.float64))]), 22364.131741349585)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9948506755893631
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9966, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6606, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7669883314203613
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8777, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2276, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 21:03:35,146][flwr][INFO] - fit progress: (27, 0.13277795339749593, OrderedDict([('ind_iou_0', 0.7669883314203613), ('ind_dice_liver_0', tensor(0.8777, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2276, dtype=torch.float64)), ('ind_iou_1', 0.9709532617555235), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5939, dtype=torch.float64)), ('all_iou', 0.787135171253952), ('all_dice_liver', tensor(0.8884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2675, dtype=torch.float64))]), 22364.131741349585)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:03:35,149][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:04:48,042][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:04:48,042][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:04:48,042][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 21:04:48,042][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-11-28 21:04:48,043][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:04:48,043][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.994934606058273
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9966, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6890, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.770949667999786
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8809, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1983, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9949015339435962
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9966, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6816, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7784702684375967
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8858, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2185, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9949869170785001
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9966, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6782, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.773883100506734
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8831, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1971, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:14:47,614][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.1332433878505042, OrderedDict([('ind_iou_0', 0.7720390323189054), ('ind_dice_liver_0', tensor(0.8819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2189, dtype=torch.float64)), ('ind_iou_1', 0.9706655447215863), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5924, dtype=torch.float64)), ('all_iou', 0.7916867519343511), ('all_dice_liver', tensor(0.8922, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2594, dtype=torch.float64))]), 23193.05067597609)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9949432144074407
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9966, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6837, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7720390323189054
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8819, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2189, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 21:17:24,065][flwr][INFO] - fit progress: (28, 0.1332433878505042, OrderedDict([('ind_iou_0', 0.7720390323189054), ('ind_dice_liver_0', tensor(0.8819, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2189, dtype=torch.float64)), ('ind_iou_1', 0.9706655447215863), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5924, dtype=torch.float64)), ('all_iou', 0.7916867519343511), ('all_dice_liver', tensor(0.8922, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2594, dtype=torch.float64))]), 23193.05067597609)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:17:24,068][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:18:37,497][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:18:37,497][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:18:37,497][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 21:18:37,498][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-11-28 21:18:37,498][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:18:37,498][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9951449294056984
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9967, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6612, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7689849241673243
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8798, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2221, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9950729322808779
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9967, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6664, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7711276360957408
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8812, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1903, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9952465228743892
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9968, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6682, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.763927459662323
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8760, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2119, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:28:38,184][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.14011135144972028, OrderedDict([('ind_iou_0', 0.765970638461008), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2070, dtype=torch.float64)), ('ind_iou_1', 0.9700831757658472), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5776, dtype=torch.float64)), ('all_iou', 0.78616398340562), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2478, dtype=torch.float64))]), 24024.058558891527)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9955215835054824
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6764, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.765970638461008
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8776, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2070, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 21:31:15,072][flwr][INFO] - fit progress: (29, 0.14011135144972028, OrderedDict([('ind_iou_0', 0.765970638461008), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2070, dtype=torch.float64)), ('ind_iou_1', 0.9700831757658472), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5776, dtype=torch.float64)), ('all_iou', 0.78616398340562), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2478, dtype=torch.float64))]), 24024.058558891527)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:31:15,076][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:32:28,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:32:28,605][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:32:28,608][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 21:32:28,608][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-11-28 21:32:28,609][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:32:28,609][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9955615765221603
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6721, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7654474605426296
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8775, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1839, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9898664121582755
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6635, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7602528056030421
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8715, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2427, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9944819663896732
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6678, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7592386654180907
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8718, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2305, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:42:29,675][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.13483934702349473, OrderedDict([('ind_iou_0', 0.7700878354963548), ('ind_dice_liver_0', tensor(0.8797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2285, dtype=torch.float64)), ('ind_iou_1', 0.9703503673549448), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5758, dtype=torch.float64)), ('all_iou', 0.7899095518702021), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 24854.599972893484)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9966240741059466
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9975, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6785, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7700878354963548
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2285, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 21:45:05,614][flwr][INFO] - fit progress: (30, 0.13483934702349473, OrderedDict([('ind_iou_0', 0.7700878354963548), ('ind_dice_liver_0', tensor(0.8797, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2285, dtype=torch.float64)), ('ind_iou_1', 0.9703503673549448), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5758, dtype=torch.float64)), ('all_iou', 0.7899095518702021), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2670, dtype=torch.float64))]), 24854.599972893484)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:45:05,618][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:46:19,388][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 21:46:19,388][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 21:46:19,389][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 21:46:19,389][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-11-28 21:46:19,389][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 21:46:19,389][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9956431899853703
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9971, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6897, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7755651046154199
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8836, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2217, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.994808963193676
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9965, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6781, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.763068978364865
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8752, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2127, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9954360614231391
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9969, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6792, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7673009336778657
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8781, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2326, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 21:56:17,335][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.13663863938248647, OrderedDict([('ind_iou_0', 0.7681046176590351), ('ind_dice_liver_0', tensor(0.8785, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2378, dtype=torch.float64)), ('ind_iou_1', 0.9703306016666302), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7880993554804232), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2761, dtype=torch.float64))]), 25683.47064110916)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9957544413931356
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9971, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6843, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7681046176590351
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8785, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2378, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 21:58:54,485][flwr][INFO] - fit progress: (31, 0.13663863938248647, OrderedDict([('ind_iou_0', 0.7681046176590351), ('ind_dice_liver_0', tensor(0.8785, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2378, dtype=torch.float64)), ('ind_iou_1', 0.9703306016666302), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7880993554804232), ('all_dice_liver', tensor(0.8892, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2761, dtype=torch.float64))]), 25683.47064110916)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 21:58:54,488][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:00:07,655][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:00:07,656][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:00:07,656][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 22:00:07,657][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-11-28 22:00:07,657][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:00:07,657][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9956250130961529
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6612, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7651551839858672
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8768, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2186, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9955459311814925
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6663, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7733427356633121
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8823, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2051, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9959514975921023
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9972, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6510, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7712957571359261
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8814, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:10:07,504][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.14786821875143155, OrderedDict([('ind_iou_0', 0.7687338322864983), ('ind_dice_liver_0', tensor(0.8796, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2117, dtype=torch.float64)), ('ind_iou_1', 0.9703174980328881), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5885, dtype=torch.float64)), ('all_iou', 0.7886923548737353), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2526, dtype=torch.float64))]), 26511.845588230528)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9960972391399797
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9973, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6836, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7687338322864983
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8796, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2117, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 22:12:42,859][flwr][INFO] - fit progress: (32, 0.14786821875143155, OrderedDict([('ind_iou_0', 0.7687338322864983), ('ind_dice_liver_0', tensor(0.8796, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2117, dtype=torch.float64)), ('ind_iou_1', 0.9703174980328881), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5885, dtype=torch.float64)), ('all_iou', 0.7886923548737353), ('all_dice_liver', tensor(0.8902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2526, dtype=torch.float64))]), 26511.845588230528)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:12:42,863][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:13:56,285][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:13:56,285][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:13:56,286][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 22:13:56,286][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-11-28 22:13:56,286][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:13:56,286][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9960683543154298
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9973, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6970, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7678080879206022
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8786, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2308, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9960628228737936
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9973, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6820, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7686563987070606
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8793, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2355, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9962282827801702
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9974, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6868, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7666562976976091
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8783, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1949, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9963679704394754
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9975, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6828, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7707304914837289
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8809, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2193, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 22:23:57,780][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.14874713046345572, OrderedDict([('ind_iou_0', 0.7707304914837289), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2193, dtype=torch.float64)), ('ind_iou_1', 0.9705246390896934), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5790, dtype=torch.float64)), ('all_iou', 0.7904772705042659), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2592, dtype=torch.float64))]), 27343.77785969246)
Entrei no test
Meio do test
Fim do test
[2024-11-28 22:26:34,792][flwr][INFO] - fit progress: (33, 0.14874713046345572, OrderedDict([('ind_iou_0', 0.7707304914837289), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2193, dtype=torch.float64)), ('ind_iou_1', 0.9705246390896934), ('ind_dice_liver_1', tensor(0.9863, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5790, dtype=torch.float64)), ('all_iou', 0.7904772705042659), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2592, dtype=torch.float64))]), 27343.77785969246)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:26:34,795][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:27:48,596][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:27:48,596][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:27:48,596][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 22:27:48,597][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-11-28 22:27:48,597][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:27:48,597][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9963589560317542
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9975, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7640214655376721
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8767, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9962323562574241
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9975, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6607, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7705432883831436
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8808, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2126, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.996472641306117
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9976, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6642, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7694176325524424
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8799, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2316, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9965715209154082
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9976, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.7134, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7675377406205277
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8790, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1976, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 22:37:48,166][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.15816043266621235, OrderedDict([('ind_iou_0', 0.7675377406205277), ('ind_dice_liver_0', tensor(0.8790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1976, dtype=torch.float64)), ('ind_iou_1', 0.9697600748511228), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5838, dtype=torch.float64)), ('all_iou', 0.7875382294160379), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2399, dtype=torch.float64))]), 28174.457255250774)
Entrei no test
Meio do test
Fim do test
[2024-11-28 22:40:25,471][flwr][INFO] - fit progress: (34, 0.15816043266621235, OrderedDict([('ind_iou_0', 0.7675377406205277), ('ind_dice_liver_0', tensor(0.8790, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1976, dtype=torch.float64)), ('ind_iou_1', 0.9697600748511228), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5838, dtype=torch.float64)), ('all_iou', 0.7875382294160379), ('all_dice_liver', tensor(0.8896, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2399, dtype=torch.float64))]), 28174.457255250774)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:40:25,475][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:41:38,716][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:41:38,717][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:41:38,717][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 22:41:38,717][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-11-28 22:41:38,717][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:41:38,717][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9940164684785755
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9967, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6541, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7691709478706115
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2218, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9963187157254272
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9974, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6722, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7692597921017368
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8800, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2120, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9981539565810763
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9986, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6838, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7703717383531046
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8810, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2175, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.998409162109585
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9988, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6713, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.771242961908685
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8816, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2158, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 22:51:38,566][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.2012213706260372, OrderedDict([('ind_iou_0', 0.771242961908685), ('ind_dice_liver_0', tensor(0.8816, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2158, dtype=torch.float64)), ('ind_iou_1', 0.9707749966443409), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5936, dtype=torch.float64)), ('all_iou', 0.7909655883623893), ('all_dice_liver', tensor(0.8920, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2567, dtype=torch.float64))]), 29004.992661375552)
Entrei no test
Meio do test
Fim do test
[2024-11-28 22:54:16,007][flwr][INFO] - fit progress: (35, 0.2012213706260372, OrderedDict([('ind_iou_0', 0.771242961908685), ('ind_dice_liver_0', tensor(0.8816, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2158, dtype=torch.float64)), ('ind_iou_1', 0.9707749966443409), ('ind_dice_liver_1', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5936, dtype=torch.float64)), ('all_iou', 0.7909655883623893), ('all_dice_liver', tensor(0.8920, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2567, dtype=torch.float64))]), 29004.992661375552)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 22:54:16,010][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 22:55:29,392][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 22:55:29,392][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 22:55:29,393][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 22:55:29,393][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-11-28 22:55:29,393][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 22:55:29,393][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9972130232573818
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9981, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6809, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7696187157591728
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8803, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2157, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9963001598496048
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9975, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6723, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7652567140096223
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8772, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2048, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9968203502815627
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9978, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6840, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7722179923392047
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8822, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2239, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:05:31,629][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.16302331476134563, OrderedDict([('ind_iou_0', 0.7656138182430955), ('ind_dice_liver_0', tensor(0.8778, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1935, dtype=torch.float64)), ('ind_iou_1', 0.9698532945503832), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5770, dtype=torch.float64)), ('all_iou', 0.7858185503568491), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2357, dtype=torch.float64))]), 29837.569651234895)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9968139317499665
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9978, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6730, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7656138182430955
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8778, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1935, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 23:08:08,584][flwr][INFO] - fit progress: (36, 0.16302331476134563, OrderedDict([('ind_iou_0', 0.7656138182430955), ('ind_dice_liver_0', tensor(0.8778, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1935, dtype=torch.float64)), ('ind_iou_1', 0.9698532945503832), ('ind_dice_liver_1', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5770, dtype=torch.float64)), ('all_iou', 0.7858185503568491), ('all_dice_liver', tensor(0.8885, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2357, dtype=torch.float64))]), 29837.569651234895)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:08:08,587][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:09:21,565][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:09:21,565][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:09:21,565][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 23:09:21,566][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-11-28 23:09:21,566][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:09:21,566][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9968205992666367
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9978, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6960, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7722642111157719
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8821, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2275, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9967440846230268
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9978, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6803, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7686416527907906
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8797, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2312, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.996924895484527
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9979, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6812, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7674226693611208
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8788, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2170, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:19:22,189][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.1683240080846963, OrderedDict([('ind_iou_0', 0.7706449587034582), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2225, dtype=torch.float64)), ('ind_iou_1', 0.9695113228799984), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7903434077975025), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2624, dtype=torch.float64))]), 30667.527550118975)
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.997087331514238
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9980, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6802, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7706449587034582
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8809, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2225, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-28 23:21:58,541][flwr][INFO] - fit progress: (37, 0.1683240080846963, OrderedDict([('ind_iou_0', 0.7706449587034582), ('ind_dice_liver_0', tensor(0.8809, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2225, dtype=torch.float64)), ('ind_iou_1', 0.9695113228799984), ('ind_dice_liver_1', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5897, dtype=torch.float64)), ('all_iou', 0.7903434077975025), ('all_dice_liver', tensor(0.8913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2624, dtype=torch.float64))]), 30667.527550118975)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:21:58,545][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:23:11,858][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:23:11,858][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:23:11,858][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 23:23:11,858][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-11-28 23:23:11,858][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:23:11,859][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9971906317595137
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9981, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6745, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7678120080884078
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1947, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9969817070183906
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9979, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6687, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7719182180452828
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8820, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2058, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.992360371988476
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6572, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7615079877159104
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8733, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1753, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9910140599982862
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6684, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.769737898766734
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8800, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2011, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 23:33:10,237][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.11067783057359662, OrderedDict([('ind_iou_0', 0.769737898766734), ('ind_dice_liver_0', tensor(0.8800, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2011, dtype=torch.float64)), ('ind_iou_1', 0.9688456325633542), ('ind_dice_liver_1', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.789450559846316), ('all_dice_liver', tensor(0.8904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2427, dtype=torch.float64))]), 31495.13896583114)
Entrei no test
Meio do test
Fim do test
[2024-11-28 23:35:46,153][flwr][INFO] - fit progress: (38, 0.11067783057359662, OrderedDict([('ind_iou_0', 0.769737898766734), ('ind_dice_liver_0', tensor(0.8800, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2011, dtype=torch.float64)), ('ind_iou_1', 0.9688456325633542), ('ind_dice_liver_1', tensor(0.9848, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5901, dtype=torch.float64)), ('all_iou', 0.789450559846316), ('all_dice_liver', tensor(0.8904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2427, dtype=torch.float64))]), 31495.13896583114)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:35:46,156][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:36:59,644][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:36:59,644][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:36:59,644][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 23:36:59,644][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-11-28 23:36:59,644][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:36:59,645][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9951754478558672
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9967, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6846, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7674956644556182
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8786, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2443, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.996276320209179
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9974, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6883, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7682882716691144
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8794, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1996, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9966416635978566
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9977, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6881, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.766562220916107
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8781, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2093, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9916927775936448
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6500, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7533686612691947
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8684, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.1940, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-28 23:47:03,932][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.11020690067427612, OrderedDict([('ind_iou_0', 0.7533686612691947), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1940, dtype=torch.float64)), ('ind_iou_1', 0.9672903772408662), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5561, dtype=torch.float64)), ('all_iou', 0.7745300620876229), ('all_dice_liver', tensor(0.8798, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2344, dtype=torch.float64))]), 32328.45601093024)
Entrei no test
Meio do test
Fim do test
[2024-11-28 23:49:39,470][flwr][INFO] - fit progress: (39, 0.11020690067427612, OrderedDict([('ind_iou_0', 0.7533686612691947), ('ind_dice_liver_0', tensor(0.8684, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.1940, dtype=torch.float64)), ('ind_iou_1', 0.9672903772408662), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5561, dtype=torch.float64)), ('all_iou', 0.7745300620876229), ('all_dice_liver', tensor(0.8798, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2344, dtype=torch.float64))]), 32328.45601093024)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-28 23:49:39,474][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-28 23:50:52,892][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-28 23:50:52,892][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-28 23:50:52,892][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-28 23:50:52,892][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-11-28 23:50:52,893][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-11-28 23:50:52,893][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  0
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9939745480474317
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6802, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7616204781581551
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8738, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2234, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  0
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  1
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9969526981606234
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9978, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6810, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7611308255840322
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8741, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2132, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  1
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  2
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9976992464020872
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9983, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6784, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7611986768805424
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8744, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2065, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  2
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2099841)[0m epoch:  3
[36m(ClientAppActor pid=2099841)[0m train ious:  0.9975276193440953
[36m(ClientAppActor pid=2099841)[0m train dice liver:  tensor(0.9983, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m train dice tumour:  tensor(0.6936, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation ious:  0.7659960521039098
[36m(ClientAppActor pid=2099841)[0m validation dice liver:  tensor(0.8776, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m validation dice tumour:  tensor(0.2218, dtype=torch.float64)
[36m(ClientAppActor pid=2099841)[0m => new best model:  3
[2024-11-29 00:00:54,669][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.1870419427602996, OrderedDict([('ind_iou_0', 0.7659960521039098), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2218, dtype=torch.float64)), ('ind_iou_1', 0.9705781890043212), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7861858678207541), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2621, dtype=torch.float64))]), 33160.02879369538)
Entrei no test
Meio do test
Fim do test
[2024-11-29 00:03:31,043][flwr][INFO] - fit progress: (40, 0.1870419427602996, OrderedDict([('ind_iou_0', 0.7659960521039098), ('ind_dice_liver_0', tensor(0.8776, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.2218, dtype=torch.float64)), ('ind_iou_1', 0.9705781890043212), ('ind_dice_liver_1', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5866, dtype=torch.float64)), ('all_iou', 0.7861858678207541), ('all_dice_liver', tensor(0.8883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.2621, dtype=torch.float64))]), 33160.02879369538)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-11-29 00:03:31,046][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2099841)[0m Entrei no validation 1 3
[2024-11-29 00:04:43,936][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-29 00:04:43,936][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2099841, ip=172.18.62.11, actor_id=ac6d4c1bd241e87023aac39201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15179e2f5490>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-11-29 00:04:43,937][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-11-29 00:04:43,937][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-11-29 00:04:43,937][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 33232.92s
[2024-11-29 00:04:43,937][flwr][INFO] - Run finished 40 round(s) in 33232.92s
[92mINFO [0m:      	History (loss, centralized):
[2024-11-29 00:04:44,056][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.715662351530599
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 0: 0.715662351530599
[92mINFO [0m:      		round 1: 0.07443603277527566
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 1: 0.07443603277527566
[92mINFO [0m:      		round 2: 0.06621678943594078
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 2: 0.06621678943594078
[92mINFO [0m:      		round 3: 0.06865566397245251
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 3: 0.06865566397245251
[92mINFO [0m:      		round 4: 0.07220220158848907
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 4: 0.07220220158848907
[92mINFO [0m:      		round 5: 0.07423258427094212
[2024-11-29 00:04:44,056][flwr][INFO] - 		round 5: 0.07423258427094212
[92mINFO [0m:      		round 6: 0.08224540647948725
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 6: 0.08224540647948725
[92mINFO [0m:      		round 7: 0.0923315126133261
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 7: 0.0923315126133261
[92mINFO [0m:      		round 8: 0.0907434412464278
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 8: 0.0907434412464278
[92mINFO [0m:      		round 9: 0.07856722062472453
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 9: 0.07856722062472453
[92mINFO [0m:      		round 10: 0.07680942672387864
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 10: 0.07680942672387864
[92mINFO [0m:      		round 11: 0.09875393717690381
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 11: 0.09875393717690381
[92mINFO [0m:      		round 12: 0.09895184948601883
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 12: 0.09895184948601883
[92mINFO [0m:      		round 13: 0.0916708467039861
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 13: 0.0916708467039861
[92mINFO [0m:      		round 14: 0.09412276032425056
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 14: 0.09412276032425056
[92mINFO [0m:      		round 15: 0.0956628250950387
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 15: 0.0956628250950387
[92mINFO [0m:      		round 16: 0.1082670263277741
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 16: 0.1082670263277741
[92mINFO [0m:      		round 17: 0.1055956416061828
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 17: 0.1055956416061828
[92mINFO [0m:      		round 18: 0.11536282600101867
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 18: 0.11536282600101867
[92mINFO [0m:      		round 19: 0.11725688536256092
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 19: 0.11725688536256092
[92mINFO [0m:      		round 20: 0.10818198132323152
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 20: 0.10818198132323152
[92mINFO [0m:      		round 21: 0.09548499851092236
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 21: 0.09548499851092236
[92mINFO [0m:      		round 22: 0.11363655565966554
[2024-11-29 00:04:44,057][flwr][INFO] - 		round 22: 0.11363655565966554
[92mINFO [0m:      		round 23: 0.11046344046375751
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 23: 0.11046344046375751
[92mINFO [0m:      		round 24: 0.10772077271185469
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 24: 0.10772077271185469
[92mINFO [0m:      		round 25: 0.11614256223262809
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 25: 0.11614256223262809
[92mINFO [0m:      		round 26: 0.12841296592875695
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 26: 0.12841296592875695
[92mINFO [0m:      		round 27: 0.13277795339749593
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 27: 0.13277795339749593
[92mINFO [0m:      		round 28: 0.1332433878505042
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 28: 0.1332433878505042
[92mINFO [0m:      		round 29: 0.14011135144972028
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 29: 0.14011135144972028
[92mINFO [0m:      		round 30: 0.13483934702349473
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 30: 0.13483934702349473
[92mINFO [0m:      		round 31: 0.13663863938248647
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 31: 0.13663863938248647
[92mINFO [0m:      		round 32: 0.14786821875143155
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 32: 0.14786821875143155
[92mINFO [0m:      		round 33: 0.14874713046345572
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 33: 0.14874713046345572
[92mINFO [0m:      		round 34: 0.15816043266621235
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 34: 0.15816043266621235
[92mINFO [0m:      		round 35: 0.2012213706260372
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 35: 0.2012213706260372
[92mINFO [0m:      		round 36: 0.16302331476134563
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 36: 0.16302331476134563
[92mINFO [0m:      		round 37: 0.1683240080846963
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 37: 0.1683240080846963
[92mINFO [0m:      		round 38: 0.11067783057359662
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 38: 0.11067783057359662
[92mINFO [0m:      		round 39: 0.11020690067427612
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 39: 0.11020690067427612
[92mINFO [0m:      		round 40: 0.1870419427602996
[2024-11-29 00:04:44,058][flwr][INFO] - 		round 40: 0.1870419427602996
[92mINFO [0m:      	History (metrics, centralized):
[2024-11-29 00:04:44,058][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1615, dtype=torch.float64)),
[2024-11-29 00:04:44,058][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1615, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.8452, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (1, tensor(0.8452, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.8781, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (2, tensor(0.8781, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.8830, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (3, tensor(0.8830, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.8823, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (4, tensor(0.8823, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.8795, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (5, tensor(0.8795, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.8855, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (6, tensor(0.8855, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.8419, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (7, tensor(0.8419, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.8837, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (8, tensor(0.8837, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (9, tensor(0.8913, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.8788, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (10, tensor(0.8788, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.8815, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (11, tensor(0.8815, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.8837, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (12, tensor(0.8837, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.8921, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (13, tensor(0.8921, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.8797, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (14, tensor(0.8797, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (15, tensor(0.8896, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.8892, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (16, tensor(0.8892, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.8943, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (17, tensor(0.8943, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.8794, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (18, tensor(0.8794, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.8874, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (19, tensor(0.8874, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.8885, dtype=torch.float64)),
[2024-11-29 00:04:44,059][flwr][INFO] - 	                    (20, tensor(0.8885, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.8743, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (21, tensor(0.8743, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (22, tensor(0.8896, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.8912, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (23, tensor(0.8912, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.8925, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (24, tensor(0.8925, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.8921, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (25, tensor(0.8921, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (26, tensor(0.8913, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.8884, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (27, tensor(0.8884, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.8922, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (28, tensor(0.8922, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.8883, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (29, tensor(0.8883, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.8902, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (30, tensor(0.8902, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.8892, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (31, tensor(0.8892, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.8902, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (32, tensor(0.8902, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (33, tensor(0.8913, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.8896, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (34, tensor(0.8896, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.8920, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (35, tensor(0.8920, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.8885, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (36, tensor(0.8885, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.8913, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (37, tensor(0.8913, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.8904, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (38, tensor(0.8904, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.8798, dtype=torch.float64)),
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (39, tensor(0.8798, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.8883, dtype=torch.float64))],
[2024-11-29 00:04:44,060][flwr][INFO] - 	                    (40, tensor(0.8883, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0083, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0083, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.1745, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (1, tensor(0.1745, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.2180, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (2, tensor(0.2180, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.2521, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (3, tensor(0.2521, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.2431, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (4, tensor(0.2431, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.2516, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (5, tensor(0.2516, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.2607, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (6, tensor(0.2607, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.1928, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (7, tensor(0.1928, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.2617, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (8, tensor(0.2617, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.2813, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (9, tensor(0.2813, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.2568, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (10, tensor(0.2568, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.2446, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (11, tensor(0.2446, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.2455, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (12, tensor(0.2455, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.2503, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (13, tensor(0.2503, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.2708, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (14, tensor(0.2708, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.2670, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (15, tensor(0.2670, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.2470, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (16, tensor(0.2470, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.2631, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (17, tensor(0.2631, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.2232, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (18, tensor(0.2232, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.2416, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (19, tensor(0.2416, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.2449, dtype=torch.float64)),
[2024-11-29 00:04:44,061][flwr][INFO] - 	                     (20, tensor(0.2449, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.2317, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (21, tensor(0.2317, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.2553, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (22, tensor(0.2553, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.2616, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (23, tensor(0.2616, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.2722, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (24, tensor(0.2722, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.2550, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (25, tensor(0.2550, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.2416, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (26, tensor(0.2416, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.2675, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (27, tensor(0.2675, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.2594, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (28, tensor(0.2594, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.2478, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (29, tensor(0.2478, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.2670, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (30, tensor(0.2670, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.2761, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (31, tensor(0.2761, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.2526, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (32, tensor(0.2526, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.2592, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (33, tensor(0.2592, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.2399, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (34, tensor(0.2399, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.2567, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (35, tensor(0.2567, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.2357, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (36, tensor(0.2357, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.2624, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (37, tensor(0.2624, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.2427, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (38, tensor(0.2427, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.2344, dtype=torch.float64)),
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (39, tensor(0.2344, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.2621, dtype=torch.float64))],
[2024-11-29 00:04:44,062][flwr][INFO] - 	                     (40, tensor(0.2621, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 0.0552537034326727),
[2024-11-29 00:04:44,063][flwr][INFO] - 	 'all_iou': [(0, 0.0552537034326727),
[92mINFO [0m:      	             (1, 0.7347268002805437),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (1, 0.7347268002805437),
[92mINFO [0m:      	             (2, 0.7774996329864332),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (2, 0.7774996329864332),
[92mINFO [0m:      	             (3, 0.7839677781051207),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (3, 0.7839677781051207),
[92mINFO [0m:      	             (4, 0.7835131862503123),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (4, 0.7835131862503123),
[92mINFO [0m:      	             (5, 0.7786731242725865),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (5, 0.7786731242725865),
[92mINFO [0m:      	             (6, 0.7860492738157198),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (6, 0.7860492738157198),
[92mINFO [0m:      	             (7, 0.7236299974434878),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (7, 0.7236299974434878),
[92mINFO [0m:      	             (8, 0.7817302678896291),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (8, 0.7817302678896291),
[92mINFO [0m:      	             (9, 0.7925540655485465),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (9, 0.7925540655485465),
[92mINFO [0m:      	             (10, 0.7769691511570678),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (10, 0.7769691511570678),
[92mINFO [0m:      	             (11, 0.7780622947412319),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (11, 0.7780622947412319),
[92mINFO [0m:      	             (12, 0.7811500604052574),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (12, 0.7811500604052574),
[92mINFO [0m:      	             (13, 0.7937431357837128),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (13, 0.7937431357837128),
[92mINFO [0m:      	             (14, 0.777421477216883),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (14, 0.777421477216883),
[92mINFO [0m:      	             (15, 0.790384034811225),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (15, 0.790384034811225),
[92mINFO [0m:      	             (16, 0.7883912432417878),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (16, 0.7883912432417878),
[92mINFO [0m:      	             (17, 0.7962606165871388),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (17, 0.7962606165871388),
[92mINFO [0m:      	             (18, 0.7737839785962827),
[2024-11-29 00:04:44,063][flwr][INFO] - 	             (18, 0.7737839785962827),
[92mINFO [0m:      	             (19, 0.7857084723258861),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (19, 0.7857084723258861),
[92mINFO [0m:      	             (20, 0.7871855795761015),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (20, 0.7871855795761015),
[92mINFO [0m:      	             (21, 0.7684518888134513),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (21, 0.7684518888134513),
[92mINFO [0m:      	             (22, 0.789136069427251),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (22, 0.789136069427251),
[92mINFO [0m:      	             (23, 0.7912430017422938),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (23, 0.7912430017422938),
[92mINFO [0m:      	             (24, 0.7936848174378953),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (24, 0.7936848174378953),
[92mINFO [0m:      	             (25, 0.7922776095026193),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (25, 0.7922776095026193),
[92mINFO [0m:      	             (26, 0.7907984205515001),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (26, 0.7907984205515001),
[92mINFO [0m:      	             (27, 0.787135171253952),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (27, 0.787135171253952),
[92mINFO [0m:      	             (28, 0.7916867519343511),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (28, 0.7916867519343511),
[92mINFO [0m:      	             (29, 0.78616398340562),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (29, 0.78616398340562),
[92mINFO [0m:      	             (30, 0.7899095518702021),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (30, 0.7899095518702021),
[92mINFO [0m:      	             (31, 0.7880993554804232),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (31, 0.7880993554804232),
[92mINFO [0m:      	             (32, 0.7886923548737353),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (32, 0.7886923548737353),
[92mINFO [0m:      	             (33, 0.7904772705042659),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (33, 0.7904772705042659),
[92mINFO [0m:      	             (34, 0.7875382294160379),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (34, 0.7875382294160379),
[92mINFO [0m:      	             (35, 0.7909655883623893),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (35, 0.7909655883623893),
[92mINFO [0m:      	             (36, 0.7858185503568491),
[2024-11-29 00:04:44,064][flwr][INFO] - 	             (36, 0.7858185503568491),
[92mINFO [0m:      	             (37, 0.7903434077975025),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (37, 0.7903434077975025),
[92mINFO [0m:      	             (38, 0.789450559846316),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (38, 0.789450559846316),
[92mINFO [0m:      	             (39, 0.7745300620876229),
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (39, 0.7745300620876229),
[92mINFO [0m:      	             (40, 0.7861858678207541)],
[2024-11-29 00:04:44,065][flwr][INFO] - 	             (40, 0.7861858678207541)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1616, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1616, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.8323, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (1, tensor(0.8323, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.8676, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (2, tensor(0.8676, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.8726, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (3, tensor(0.8726, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.8717, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (4, tensor(0.8717, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.8685, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (5, tensor(0.8685, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.8750, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (6, tensor(0.8750, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.8284, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (7, tensor(0.8284, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.8729, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (8, tensor(0.8729, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.8812, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (9, tensor(0.8812, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.8676, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (10, tensor(0.8676, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.8703, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (11, tensor(0.8703, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.8727, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (12, tensor(0.8727, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.8820, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (13, tensor(0.8820, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.8684, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (14, tensor(0.8684, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.8792, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (15, tensor(0.8792, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.8787, dtype=torch.float64)),
[2024-11-29 00:04:44,065][flwr][INFO] - 	                      (16, tensor(0.8787, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.8843, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (17, tensor(0.8843, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.8678, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (18, tensor(0.8678, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.8766, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (19, tensor(0.8766, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.8779, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (20, tensor(0.8779, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.8623, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (21, tensor(0.8623, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.8791, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (22, tensor(0.8791, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (23, tensor(0.8809, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.8822, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (24, tensor(0.8822, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.8818, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (25, tensor(0.8818, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.8810, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (26, tensor(0.8810, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.8777, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (27, tensor(0.8777, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.8819, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (28, tensor(0.8819, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.8776, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (29, tensor(0.8776, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.8797, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (30, tensor(0.8797, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.8785, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (31, tensor(0.8785, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.8796, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (32, tensor(0.8796, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (33, tensor(0.8809, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.8790, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (34, tensor(0.8790, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.8816, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (35, tensor(0.8816, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.8778, dtype=torch.float64)),
[2024-11-29 00:04:44,066][flwr][INFO] - 	                      (36, tensor(0.8778, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.8809, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (37, tensor(0.8809, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.8800, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (38, tensor(0.8800, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.8684, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (39, tensor(0.8684, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.8776, dtype=torch.float64))],
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (40, tensor(0.8776, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1601, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1601, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9629, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (1, tensor(0.9629, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9741, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (2, tensor(0.9741, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9776, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (3, tensor(0.9776, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9791, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (4, tensor(0.9791, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9792, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (5, tensor(0.9792, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9815, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (6, tensor(0.9815, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9648, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (7, tensor(0.9648, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9829, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (8, tensor(0.9829, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9832, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (9, tensor(0.9832, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9803, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (10, tensor(0.9803, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (11, tensor(0.9840, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9838, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (12, tensor(0.9838, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (13, tensor(0.9840, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9829, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (14, tensor(0.9829, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9843, dtype=torch.float64)),
[2024-11-29 00:04:44,067][flwr][INFO] - 	                      (15, tensor(0.9843, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9851, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (16, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9856, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (17, tensor(0.9856, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9849, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (18, tensor(0.9849, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9856, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (19, tensor(0.9856, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9853, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (20, tensor(0.9853, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9845, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (21, tensor(0.9845, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9859, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (22, tensor(0.9859, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9859, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (23, tensor(0.9859, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (24, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (25, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (26, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9862, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (27, tensor(0.9862, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (28, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (29, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (30, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (31, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (32, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9863, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (33, tensor(0.9863, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9860, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (34, tensor(0.9860, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9866, dtype=torch.float64)),
[2024-11-29 00:04:44,068][flwr][INFO] - 	                      (35, tensor(0.9866, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9861, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (36, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9858, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (37, tensor(0.9858, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9848, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (38, tensor(0.9848, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9840, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (39, tensor(0.9840, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9865, dtype=torch.float64))],
[2024-11-29 00:04:44,069][flwr][INFO] - 	                      (40, tensor(0.9865, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0084, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.1462, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (1, tensor(0.1462, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.1842, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (2, tensor(0.1842, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.2168, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (3, tensor(0.2168, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.2065, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (4, tensor(0.2065, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.2155, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (5, tensor(0.2155, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.2234, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (6, tensor(0.2234, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.1512, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (7, tensor(0.1512, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.2251, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (8, tensor(0.2251, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.2463, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (9, tensor(0.2463, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.2210, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (10, tensor(0.2210, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.2043, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (11, tensor(0.2043, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.2069, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (12, tensor(0.2069, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.2102, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (13, tensor(0.2102, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.2326, dtype=torch.float64)),
[2024-11-29 00:04:44,069][flwr][INFO] - 	                       (14, tensor(0.2326, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.2278, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (15, tensor(0.2278, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.2075, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (16, tensor(0.2075, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.2236, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (17, tensor(0.2236, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.1806, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (18, tensor(0.1806, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.2004, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (19, tensor(0.2004, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.2030, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (20, tensor(0.2030, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.1907, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (21, tensor(0.1907, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.2152, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (22, tensor(0.2152, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.2220, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (23, tensor(0.2220, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.2339, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (24, tensor(0.2339, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.2145, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (25, tensor(0.2145, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.2003, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (26, tensor(0.2003, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.2276, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (27, tensor(0.2276, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.2189, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (28, tensor(0.2189, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.2070, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (29, tensor(0.2070, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.2285, dtype=torch.float64)),
[2024-11-29 00:04:44,070][flwr][INFO] - 	                       (30, tensor(0.2285, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.2378, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (31, tensor(0.2378, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.2117, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (32, tensor(0.2117, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.2193, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (33, tensor(0.2193, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.1976, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (34, tensor(0.1976, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.2158, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (35, tensor(0.2158, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.1935, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (36, tensor(0.1935, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.2225, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (37, tensor(0.2225, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.2011, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (38, tensor(0.2011, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.1940, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (39, tensor(0.1940, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.2218, dtype=torch.float64))],
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (40, tensor(0.2218, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0075, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0075, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.4041, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (1, tensor(0.4041, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.4880, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (2, tensor(0.4880, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.5402, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (3, tensor(0.5402, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.5430, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (4, tensor(0.5430, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.5488, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (5, tensor(0.5488, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.5675, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (6, tensor(0.5675, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.5380, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (7, tensor(0.5380, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.5615, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (8, tensor(0.5615, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.5695, dtype=torch.float64)),
[2024-11-29 00:04:44,071][flwr][INFO] - 	                       (9, tensor(0.5695, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.5423, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (10, tensor(0.5423, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.5759, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (11, tensor(0.5759, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.5614, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (12, tensor(0.5614, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.5794, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (13, tensor(0.5794, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.5833, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (14, tensor(0.5833, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.5881, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (15, tensor(0.5881, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.5697, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (16, tensor(0.5697, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.5834, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (17, tensor(0.5834, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.5710, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (18, tensor(0.5710, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.5809, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (19, tensor(0.5809, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.5904, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (20, tensor(0.5904, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.5689, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (21, tensor(0.5689, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.5847, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (22, tensor(0.5847, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.5850, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (23, tensor(0.5850, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.5830, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (24, tensor(0.5830, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.5897, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (25, tensor(0.5897, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.5806, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (26, tensor(0.5806, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.5939, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (27, tensor(0.5939, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.5924, dtype=torch.float64)),
[2024-11-29 00:04:44,072][flwr][INFO] - 	                       (28, tensor(0.5924, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.5776, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (29, tensor(0.5776, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.5758, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (30, tensor(0.5758, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.5866, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (31, tensor(0.5866, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.5885, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (32, tensor(0.5885, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.5790, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (33, tensor(0.5790, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.5838, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (34, tensor(0.5838, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.5936, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (35, tensor(0.5936, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.5770, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (36, tensor(0.5770, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.5897, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (37, tensor(0.5897, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.5901, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (38, tensor(0.5901, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.5561, dtype=torch.float64)),
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (39, tensor(0.5561, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.5866, dtype=torch.float64))],
[2024-11-29 00:04:44,073][flwr][INFO] - 	                       (40, tensor(0.5866, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 0.055350935347940645),
[2024-11-29 00:04:44,073][flwr][INFO] - 	 'ind_iou_0': [(0, 0.055350935347940645),
[92mINFO [0m:      	               (1, 0.712552454365834),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (1, 0.712552454365834),
[92mINFO [0m:      	               (2, 0.7579797242080624),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (2, 0.7579797242080624),
[92mINFO [0m:      	               (3, 0.7643732397895705),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (3, 0.7643732397895705),
[92mINFO [0m:      	               (4, 0.7637307008884832),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (4, 0.7637307008884832),
[92mINFO [0m:      	               (5, 0.758287771922533),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (5, 0.758287771922533),
[92mINFO [0m:      	               (6, 0.7662208933661147),
[2024-11-29 00:04:44,073][flwr][INFO] - 	               (6, 0.7662208933661147),
[92mINFO [0m:      	               (7, 0.6996046718008183),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (7, 0.6996046718008183),
[92mINFO [0m:      	               (8, 0.7613247276423324),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (8, 0.7613247276423324),
[92mINFO [0m:      	               (9, 0.7732596355094269),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (9, 0.7732596355094269),
[92mINFO [0m:      	               (10, 0.7564357428331301),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (10, 0.7564357428331301),
[92mINFO [0m:      	               (11, 0.7571424297913529),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (11, 0.7571424297913529),
[92mINFO [0m:      	               (12, 0.7605632316312407),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (12, 0.7605632316312407),
[92mINFO [0m:      	               (13, 0.7744203668029485),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (13, 0.7744203668029485),
[92mINFO [0m:      	               (14, 0.7565210455645685),
[2024-11-29 00:04:44,074][flwr][INFO] - 	               (14, 0.7565210455645685),
[92mINFO [0m:      	               (15, 0.770708533190624),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (15, 0.770708533190624),
[92mINFO [0m:      	               (16, 0.7684722004336086),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (16, 0.7684722004336086),
[92mINFO [0m:      	               (17, 0.7771052388513635),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (17, 0.7771052388513635),
[92mINFO [0m:      	               (18, 0.7522642680075069),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (18, 0.7522642680075069),
[92mINFO [0m:      	               (19, 0.7654243613263407),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (19, 0.7654243613263407),
[92mINFO [0m:      	               (20, 0.7670865709172475),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (20, 0.7670865709172475),
[92mINFO [0m:      	               (21, 0.7463972191302203),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (21, 0.7463972191302203),
[92mINFO [0m:      	               (22, 0.769198741560112),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (22, 0.769198741560112),
[92mINFO [0m:      	               (23, 0.7715669423305815),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (23, 0.7715669423305815),
[92mINFO [0m:      	               (24, 0.7742741367330938),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (24, 0.7742741367330938),
[92mINFO [0m:      	               (25, 0.7726833734040778),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (25, 0.7726833734040778),
[92mINFO [0m:      	               (26, 0.771086743552114),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (26, 0.771086743552114),
[92mINFO [0m:      	               (27, 0.7669883314203613),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (27, 0.7669883314203613),
[92mINFO [0m:      	               (28, 0.7720390323189054),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (28, 0.7720390323189054),
[92mINFO [0m:      	               (29, 0.765970638461008),
[2024-11-29 00:04:44,075][flwr][INFO] - 	               (29, 0.765970638461008),
[92mINFO [0m:      	               (30, 0.7700878354963548),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (30, 0.7700878354963548),
[92mINFO [0m:      	               (31, 0.7681046176590351),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (31, 0.7681046176590351),
[92mINFO [0m:      	               (32, 0.7687338322864983),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (32, 0.7687338322864983),
[92mINFO [0m:      	               (33, 0.7707304914837289),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (33, 0.7707304914837289),
[92mINFO [0m:      	               (34, 0.7675377406205277),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (34, 0.7675377406205277),
[92mINFO [0m:      	               (35, 0.771242961908685),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (35, 0.771242961908685),
[92mINFO [0m:      	               (36, 0.7656138182430955),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (36, 0.7656138182430955),
[92mINFO [0m:      	               (37, 0.7706449587034582),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (37, 0.7706449587034582),
[92mINFO [0m:      	               (38, 0.769737898766734),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (38, 0.769737898766734),
[92mINFO [0m:      	               (39, 0.7533686612691947),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (39, 0.7533686612691947),
[92mINFO [0m:      	               (40, 0.7659960521039098)],
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (40, 0.7659960521039098)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 0.0544219739757796),
[2024-11-29 00:04:44,076][flwr][INFO] - 	 'ind_iou_1': [(0, 0.0544219739757796),
[92mINFO [0m:      	               (1, 0.9363470532395185),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (1, 0.9363470532395185),
[92mINFO [0m:      	               (2, 0.9558406180921017),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (2, 0.9558406180921017),
[92mINFO [0m:      	               (3, 0.962627727510885),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (3, 0.962627727510885),
[92mINFO [0m:      	               (4, 0.9638895096143001),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (4, 0.9638895096143001),
[92mINFO [0m:      	               (5, 0.9642580501099705),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (5, 0.9642580501099705),
[92mINFO [0m:      	               (6, 0.9664889241229515),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (6, 0.9664889241229515),
[92mINFO [0m:      	               (7, 0.9415039251310271),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (7, 0.9415039251310271),
[92mINFO [0m:      	               (8, 0.9677161197452596),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (8, 0.9677161197452596),
[92mINFO [0m:      	               (9, 0.9685413997652824),
[2024-11-29 00:04:44,076][flwr][INFO] - 	               (9, 0.9685413997652824),
[92mINFO [0m:      	               (10, 0.9636035958188761),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (10, 0.9636035958188761),
[92mINFO [0m:      	               (11, 0.968959024391846),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (11, 0.968959024391846),
[92mINFO [0m:      	               (12, 0.968552975884231),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (12, 0.968552975884231),
[92mINFO [0m:      	               (13, 0.9693645472229383),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (13, 0.9693645472229383),
[92mINFO [0m:      	               (14, 0.9676086916927787),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (14, 0.9676086916927787),
[92mINFO [0m:      	               (15, 0.9694128355500067),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (15, 0.9694128355500067),
[92mINFO [0m:      	               (16, 0.9698940083572806),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (16, 0.9698940083572806),
[92mINFO [0m:      	               (17, 0.9708628761125967),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (17, 0.9708628761125967),
[92mINFO [0m:      	               (18, 0.9695829823694017),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (18, 0.9695829823694017),
[92mINFO [0m:      	               (19, 0.9704836987993137),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (19, 0.9704836987993137),
[92mINFO [0m:      	               (20, 0.9702928639021118),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (20, 0.9702928639021118),
[92mINFO [0m:      	               (21, 0.9699164123215347),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (21, 0.9699164123215347),
[92mINFO [0m:      	               (22, 0.9710813877522105),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (22, 0.9710813877522105),
[92mINFO [0m:      	               (23, 0.970867874093388),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (23, 0.970867874093388),
[92mINFO [0m:      	               (24, 0.9708346582909262),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (24, 0.9708346582909262),
[92mINFO [0m:      	               (25, 0.9709504306561927),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (25, 0.9709504306561927),
[92mINFO [0m:      	               (26, 0.9706609580223797),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (26, 0.9706609580223797),
[92mINFO [0m:      	               (27, 0.9709532617555235),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (27, 0.9709532617555235),
[92mINFO [0m:      	               (28, 0.9706655447215863),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (28, 0.9706655447215863),
[92mINFO [0m:      	               (29, 0.9700831757658472),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (29, 0.9700831757658472),
[92mINFO [0m:      	               (30, 0.9703503673549448),
[2024-11-29 00:04:44,077][flwr][INFO] - 	               (30, 0.9703503673549448),
[92mINFO [0m:      	               (31, 0.9703306016666302),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (31, 0.9703306016666302),
[92mINFO [0m:      	               (32, 0.9703174980328881),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (32, 0.9703174980328881),
[92mINFO [0m:      	               (33, 0.9705246390896934),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (33, 0.9705246390896934),
[92mINFO [0m:      	               (34, 0.9697600748511228),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (34, 0.9697600748511228),
[92mINFO [0m:      	               (35, 0.9707749966443409),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (35, 0.9707749966443409),
[92mINFO [0m:      	               (36, 0.9698532945503832),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (36, 0.9698532945503832),
[92mINFO [0m:      	               (37, 0.9695113228799984),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (37, 0.9695113228799984),
[92mINFO [0m:      	               (38, 0.9688456325633542),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (38, 0.9688456325633542),
[92mINFO [0m:      	               (39, 0.9672903772408662),
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (39, 0.9672903772408662),
[92mINFO [0m:      	               (40, 0.9705781890043212)]}
[2024-11-29 00:04:44,078][flwr][INFO] - 	               (40, 0.9705781890043212)]}
[92mINFO [0m:      
[2024-11-29 00:04:44,078][flwr][INFO] - 
